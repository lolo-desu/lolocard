{"version":3,"file":"index.js","mappings":"AAAO,MAAMA,EAAc,CACzB,2BACA,0BACA,uBACA,+BACA,yCACA,0BACA,sBACA,8BACA,wBACA,8BACA,0BACA,2BACA,oBACA,0BACA,0BACA,wBACA,wBACA,6BACA,wBACA,4BACA,0BACA,4BACA,0BACA,2BACA,6BACA,0BACA,2BACA,8BACA,+BACA,6BACA,2BACA,4BACA,gCACA,kCACA,sCACA,+BACA,2BACA,6BACA,4BACA,8BACA,wBACA,8BACA,4BACA,wBACA,oBACA,sBACA,sBACA,2BACA,yBACA,2BACA,6BACA,oBACA,0BACA,iCACA,yBACA,yBACA,0BACA,0BACA,yBACA,yBACA,yBACA,2BACA,wBACA,+BACA,8BACA,0BACA,wBACA,wBACA,sBACA,wBACA,uBACA,0BACA,wBACA,0BACA,0BACA,sBACA,wBACA,yBACA,sBACA,uBACA,uBACA,wBACA,wBACA,sBACA,sBACA,yBACA,sBACA,qBACA,wBACA,0BACA,wBACA,sBACA,gBACA,gBACA,cACA,cACA,SACA,UACA,aACA,cACA,eACA,eACA,aACA,aACA,gBACA,gBACA,cACA,cACA,gBACA,gBACA,gBACA,cACA,cACA,WACA,eACA,gBACA,cACA,YACA,YACA,gBACA,cACA,cACA,iBACA,eACA,eACA,eACA,aACA,aACA,eACA,aACA,aACA,UACA,cACA,eACA,aACA,aACA,WACA,eACA,gBACA,cACA,cACA,eACA,aACA,aACA,UACA,WACA,eACA,gBACA,oBACA,kBACA,kBACA,iBACA,iBACA,eACA,eACA,gBACA,gBACA,gBACA,cACA,cACA,gBACA,gBACA,cACA,cACA,kBACA,kBACA,gBACA,gBACA,gBACA,cACA,cACA,gBACA,cACA,cACA,oBACA,oBACA,kBACA,kBACA,gBACA,gBACA,cACA,cACA,gBACA,gBACA,cACA,cACA,iBACA,iBACA,eACA,eACA,iBACA,eACA,eACA,iBACA,eACA,eACA,cACA,cACA,YACA,YACA,cACA,YACA,YACA,cACA,YACA,YACA,gBACA,gBACA,cACA,cACA,iBACA,eACA,eACA,eACA,aACA,gBACA,cACA,cACA,oBACA,cACA,YACA,aAEWC,EAAa,CACxB,SACA,YACA,aACA,YACA,cACA,eACA,aACA,gBACA,YACA,YACA,aACA,iBACA,aACA,cACA,aACA,YACA,aACA,YACA,aACA,YACA,aACA,cACA,aACA,eACA,cACA,iBACA,aACA,aACA,cACA,gBACA,kBACA,cACA,eACA,cACA,aACA,cACA,aACA,oBACA,cACA,aACA,aACA,cACA,aACA,eACA,cACA,iBACA,aACA,aACA,cACA,gBACA,kBACA,cACA,eACA,aACA,cACA,aACA,oBACA,cACA,aACA,YACA,YACA,cACA,aACA,YACA,YACA,aACA,eACA,iBACA,aACA,cACA,YACA,aACA,YACA,mBACA,aACA,YACA,YACA,YACA,cACA,YACA,YACA,aACA,eACA,iBACA,aACA,cACA,YACA,aACA,YACA,mBACA,aACA,aAEK,SAASC,EAAYC,GAC1B,MAAMC,EAAS,mEACf,OAAIH,EAAWI,SAASF,GACf,GAAGC,QAAaD,IAErBH,EAAYK,SAASF,GAChB,GAAGC,QAAaD,IAElB,IACT,CCvUA,MAAM,EAA+BG,ECM/BC,EAAS,OAAON,GAAYO,MAAM,UAGlCC,EAAS,SAAS,CACtBC,KAAM,WACNC,KAAM,WACNC,WAAY,WACZX,WAAY,QAAQ,CAClB,UAAU,YACV,UAAU,eACV,SAAS,CACPY,KAAM,SAAS,CACbV,GAAI,UAAU,MAAMK,MAAM,MAC1BM,OAAQP,IAEVQ,MAAO,SACG,CACNZ,GAAI,UAAU,MAAMK,MAAM,MAC1BM,OAAQP,IAETS,iBAST,MAAMC,EACJ,WAAAC,GACEC,KAAKC,aAAe,EACpBD,KAAKE,aAAc,EACnBF,KAAKG,iBAAmB,CAAC,EACzBH,KAAKI,iBAAkB,EACvBJ,KAAKK,cAAgB,GACrBL,KAAKM,cAAgB,GAGrBN,KAAKO,UAAYC,SAASC,eAAe,cACzCT,KAAKU,cAAgBF,SAASC,eAAe,kBAC7CT,KAAKW,WAAaH,SAASC,eAAe,eAC1CT,KAAKY,aAAeJ,SAASC,eAAe,4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","sources":["src://tavern_helper_template/src/日记络络/image.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/日记络络/界面/galgame/index.ts"],"sourcesContent":["export const backgrounds = [\n  'CG/傍晚户外海边堤坝上站着脸红看向旁边.jpg',\n  'CG/夜晚户外拿冰可乐触碰络络脸颊嬉笑.jpg',\n  'CG/夜晚户外林间站着抬头看夜空.jpg',\n  'CG/白天室内客厅坐着被主视角喂食脸红地看着前方.jpg',\n  'CG/白天室内教室里坐在钢琴前看向旁边表情平静包含幻想出的鲸鱼与云朵.jpg',\n  'CG/白天室内餐厅坐在桌子前用勺子吃饭.jpg',\n  'CG/白天户外学校天台眺望等待.jpg',\n  'CG/白天户外学校走廊站着拿着书包回头脸红微笑.jpg',\n  'CG/白天户外学校道路上脸红回头看.jpg',\n  'CG/白天户外海边坐在防波堤上看着猫咪表情温柔.jpg',\n  'CG/白天户外海边海鸥双手合十眺望远方.jpg',\n  'CG/白天户外街道上双手靠近脸颊脸红微笑.jpg',\n  'CG/白天户外躺在花海微笑.jpg',\n  'CG/简单背景双手张开抬头等待亲吻拥抱.jpg',\n  'CG/黄昏户外日落海边站立脸红直视玩家.jpg',\n  'NSFWCG/卧室床上口交主角主动.jpg',\n  'NSFWCG/卧室床上指交主角主动.jpg',\n  'NSFWCG/卧室床上指交主角主动POV视角.jpg',\n  'NSFWCG/卧室床上指交络络主动.jpg',\n  'NSFWCG/夜晚卧室床上口交预备微微坏笑.jpg',\n  'NSFWCG/夜晚卧室床上展示小穴足交.jpg',\n  'NSFWCG/夜晚卧室床上展示小穴足交射精.jpg',\n  'NSFWCG/夜晚卧室床上扑倒络络主动.jpg',\n  'NSFWCG/夜晚卧室床上扶腿插入回头望.jpg',\n  'NSFWCG/夜晚卧室床上扶腿插入回头望射精.jpg',\n  'NSFWCG/夜晚卧室床上指交主角主动.jpg',\n  'NSFWCG/夜晚卧室床上指交主角主动2.jpg',\n  'NSFWCG/夜晚卧室床上指交络络上位主角主动.jpg',\n  'NSFWCG/夜晚卧室床上正面口交预备含羞微笑脸.jpg',\n  'NSFWCG/夜晚卧室床上正面口交预备愉悦脸.jpg',\n  'NSFWCG/夜晚卧室床上正面插入M字腿.jpg',\n  'NSFWCG/夜晚卧室床上正面插入M字腿2.jpg',\n  'NSFWCG/夜晚卧室床上正面插入M字腿射精愉悦脸.jpg',\n  'NSFWCG/夜晚卧室床上正面插入前倾M字腿逆推女主动.jpg',\n  'NSFWCG/夜晚卧室床上正面插入前倾M字腿逆推女主动脸红射精.jpg',\n  'NSFWCG/夜晚卧室床上背对高举屁股脸下趴射精.jpg',\n  'NSFWCG/夜晚卧室床上背身撅屁股后入.jpg',\n  'NSFWCG/夜晚卧室床上背身撅屁股后入射精.jpg',\n  'NSFWCG/夜晚卧室床上趴男身上口交深喉.jpg',\n  'NSFWCG/夜晚卧室床上趴男身上口交深喉射精.jpg',\n  'NSFWCG/夜晚卧室指交络络主动.jpg',\n  'NSFWCG/夜晚卧室指交络络站立主角坐床主动.jpg',\n  'NSFWCG/夜晚卧室指教络络上位主角主动.jpg',\n  'NSFWCG/夜晚卧室络络扶墙自慰.jpg',\n  'NSFWCG/夜晚学校亲吻.jpg',\n  'NSFWCG/夜晚学校天台亲吻.jpg',\n  'NSFWCG/夜晚学校室内亲吻.jpg',\n  'NSFWCG/夜晚学校屋顶扶腿插入回头望.jpg',\n  'NSFWCG/夜晚学校屋顶趴栏杆后入.jpg',\n  'NSFWCG/夜晚学校屋顶趴栏杆后入射精.jpg',\n  'NSFWCG/夜晚学校屋顶趴栏杆后入射精脸红.jpg',\n  'NSFWCG/夜晚户外亲吻.jpg',\n  'NSFWCG/夜晚户外掀裙指交主角主动.jpg',\n  'NSFWCG/白天卧室床上下半身裸M字腿坐男上未性交.jpg',\n  'NSFWCG/白天卧室床上全裸后入1.jpg',\n  'NSFWCG/白天卧室床上全裸后入2.jpg',\n  'NSFWCG/白天卧室床上口交主角主动.jpg',\n  'NSFWCG/白天卧室床上口交深喉闭眼.jpg',\n  'NSFWCG/白天卧室床上口交男躺1.jpg',\n  'NSFWCG/白天卧室床上口交男躺2.jpg',\n  'NSFWCG/白天卧室床上口交男躺3.jpg',\n  'NSFWCG/白天卧室床上后入双手抓胳膊.jpg',\n  'NSFWCG/白天卧室床上后入女趴.jpg',\n  'NSFWCG/白天卧室床上指交主角主动POV视角.jpg',\n  'NSFWCG/白天卧室床上指交络络上位主角主动.jpg',\n  'NSFWCG/白天卧室床上指交络络主动.jpg',\n  'NSFWCG/白天卧室床上正面M腿.jpg',\n  'NSFWCG/白天卧室床上正面V腿.jpg',\n  'NSFWCG/白天卧室床上足交.jpg',\n  'NSFWCG/白天卧室床上骑乘前戏.jpg',\n  'NSFWCG/白天卧室性爱后拥抱.jpg',\n  'NSFWCG/白天学校天台指教主角主动.jpg',\n  'NSFWCG/白天学校屋顶正面站立.jpg',\n  'NSFWCG/白天学校屋顶趴围栏后入1.jpg',\n  'NSFWCG/白天学校屋顶趴围栏后入2.jpg',\n  'NSFWCG/白天室内法式舌吻.jpg',\n  'NSFWCG/白天巷子全裸正面M腿.jpg',\n  'NSFWCG/白天巷子后入扯胳膊跪地.jpg',\n  'NSFWCG/白天巷子后入牵手.jpg',\n  'NSFWCG/白天巷子扶墙后入1.jpg',\n  'NSFWCG/白天巷子扶墙后入2.jpg',\n  'NSFWCG/白天巷子正面M腿躺地.jpg',\n  'NSFWCG/白天教室后入M腿扶桌.jpg',\n  'NSFWCG/白天教室后入扶墙.jpg',\n  'NSFWCG/白天教室后入扶桌.jpg',\n  'NSFWCG/白天教室坐桌扶单腿正面.jpg',\n  'NSFWCG/白天教室正面V腿.jpg',\n  'NSFWCG/白天教室正面坐.jpg',\n  'NSFWCG/白天无人沙滩单腿站立.jpg',\n  'NSFWCG/白天沙滩双腿竖直向上正面.jpg',\n  'NSFWCG/白天沙滩岩石扶腿正面.jpg',\n  'NSFWCG/白天沙滩正面掀裙.jpg',\n  '上学路上/夜晚关灯.jpg',\n  '上学路上/夜晚开灯.jpg',\n  '上学路上/白天.jpg',\n  '上学路上/黄昏.jpg',\n  '书店.jpg',\n  '书店内.jpg',\n  '书店内/书店.jpg',\n  '书店内/书店内.jpg',\n  '住宅街/夜晚关灯.jpg',\n  '住宅街/夜晚开灯.jpg',\n  '住宅街/白天.jpg',\n  '住宅街/黄昏.jpg',\n  '住所客厅/夜晚关灯.jpg',\n  '住所客厅/夜晚开灯.jpg',\n  '住所客厅/白天.jpg',\n  '住所客厅/黄昏.jpg',\n  '住所玄关/夜晚关灯.jpg',\n  '住所玄关/夜晚夜灯.jpg',\n  '住所玄关/夜晚开灯.jpg',\n  '住所玄关/白天.jpg',\n  '住所玄关/黄昏.jpg',\n  '便利店内.jpg',\n  '便利店内/便利店.jpg',\n  '便利店内/便利店内.jpg',\n  '公园/夜晚开灯.jpg',\n  '公园/白天.jpg',\n  '公园/黄昏.jpg',\n  '公园凉亭/夜晚开灯.jpg',\n  '公园凉亭/白天.jpg',\n  '公园凉亭/黄昏.jpg',\n  '公园商店亭/夜晚开灯.jpg',\n  '公园商店亭/白天.jpg',\n  '公园商店亭/黄昏.jpg',\n  '咖啡厅/夜晚开灯.jpg',\n  '咖啡厅/白天.jpg',\n  '咖啡厅/黄昏.jpg',\n  '商店街/夜晚开灯.jpg',\n  '商店街/白天.jpg',\n  '商店街/黄昏.jpg',\n  '图书馆.jpg',\n  '图书馆/图书馆.jpg',\n  '图书馆/图书馆内.jpg',\n  '图书馆/晚上.jpg',\n  '图书馆/白天.jpg',\n  '图书馆内.jpg',\n  '图书馆内/图书馆.jpg',\n  '图书馆内/图书馆内.jpg',\n  '图书馆内/晚上.jpg',\n  '图书馆内/白天.jpg',\n  '地铁内/夜晚开灯.jpg',\n  '地铁内/白天.jpg',\n  '地铁内/黄昏.jpg',\n  '地铁站.jpg',\n  '地铁站内.jpg',\n  '地铁站内/地铁站.jpg',\n  '地铁站内/地铁站内.jpg',\n  '城市中的铁路道口/夜晚开灯.jpg',\n  '城市中的铁路道口/白天.jpg',\n  '城市中的铁路道口/黄昏.jpg',\n  '城镇街道上/夜晚关灯.jpg',\n  '城镇街道上/夜晚开灯.jpg',\n  '城镇街道上/白天.jpg',\n  '城镇街道上/黄昏.jpg',\n  '女生房间/夜晚关灯.jpg',\n  '女生房间/夜晚夜灯.jpg',\n  '女生房间/夜晚开灯.jpg',\n  '女生房间/白天.jpg',\n  '女生房间/黄昏.jpg',\n  '学校中庭/夜晚关灯.jpg',\n  '学校中庭/夜晚开灯.jpg',\n  '学校中庭/白天.jpg',\n  '学校中庭/黄昏.jpg',\n  '学校外侧楼梯/夜晚关灯.jpg',\n  '学校外侧楼梯/夜晚开灯.jpg',\n  '学校外侧楼梯/白天.jpg',\n  '学校外侧楼梯/黄昏.jpg',\n  '学校天台/夜晚关灯.jpg',\n  '学校天台/白天.jpg',\n  '学校天台/黄昏.jpg',\n  '学校屋顶/夜晚关灯.jpg',\n  '学校屋顶/白天.jpg',\n  '学校屋顶/黄昏.jpg',\n  '学校教学楼正门前/夜晚关灯.jpg',\n  '学校教学楼正门前/夜晚开灯.jpg',\n  '学校教学楼正门前/白天.jpg',\n  '学校教学楼正门前/黄昏.jpg',\n  '学校教室/夜晚关灯.jpg',\n  '学校教室/夜晚开灯.jpg',\n  '学校教室/白天.jpg',\n  '学校教室/黄昏.jpg',\n  '学校楼梯/夜晚关灯.jpg',\n  '学校楼梯/夜晚开灯.jpg',\n  '学校楼梯/白天.jpg',\n  '学校楼梯/黄昏.jpg',\n  '学校正门前/夜晚关灯.jpg',\n  '学校正门前/夜晚开灯.jpg',\n  '学校正门前/白天.jpg',\n  '学校正门前/黄昏.jpg',\n  '庙会小吃街/夜晚开灯.jpg',\n  '庙会小吃街/白天.jpg',\n  '庙会小吃街/黄昏.jpg',\n  '拱廊商店街/夜晚开灯.jpg',\n  '拱廊商店街/白天.jpg',\n  '拱廊商店街/黄昏.jpg',\n  '教室/夜晚关灯.jpg',\n  '教室/夜晚开灯.jpg',\n  '教室/白天.jpg',\n  '教室/黄昏.jpg',\n  '河旁/夜晚关灯.jpg',\n  '河旁/白天.jpg',\n  '河旁/黄昏.jpg',\n  '海滩/夜晚关灯.jpg',\n  '海滩/白天.jpg',\n  '海滩/黄昏.jpg',\n  '男生房间/夜晚关灯.jpg',\n  '男生房间/夜晚开灯.jpg',\n  '男生房间/白天.jpg',\n  '男生房间/黄昏.jpg',\n  '繁华商业街/夜晚开灯.jpg',\n  '繁华商业街/白天.jpg',\n  '繁华商业街/黄昏.jpg',\n  '美术馆/夜晚关灯.jpg',\n  '美术馆/白天.jpg',\n  '购物中心/夜晚关灯.jpg',\n  '购物中心/白天.jpg',\n  '购物中心/黄昏.jpg',\n  '购物中心二层/购物中心二层.jpg',\n  '餐馆/夜晚开灯.jpg',\n  '餐馆/白天.jpg',\n  '餐馆/黄昏.jpg',\n];\nexport const characters = [\n  '无人.png',\n  '开衫/无人.png',\n  '开衫/擦眼泪.png',\n  '开衫/微笑.png',\n  '开衫/稍微脸红.png',\n  '开衫/邪恶的笑容.png',\n  '开衫/等待吻.png',\n  '开衫/手托下巴思考.png',\n  '开衫/哭泣.png',\n  '开衫/浅笑.png',\n  '开衫/流口水.png',\n  '开衫/看透一切的坏笑.png',\n  '开衫/星星眼.png',\n  '开衫/猫爪生气.png',\n  '开衫/无表情.png',\n  '开衫/害羞.png',\n  '开衫/晕晕眼.png',\n  '开衫/惊讶.png',\n  '开衫/性高潮.png',\n  '开衫/生气.png',\n  '水手服/无人.png',\n  '水手服/擦眼泪.png',\n  '水手服/微笑.png',\n  '水手服/稍微脸红.png',\n  '水手服/等待吻.png',\n  '水手服/手托下巴思考.png',\n  '水手服/哭泣.png',\n  '水手服/浅笑.png',\n  '水手服/流口水.png',\n  '水手服/邪恶的坏笑.png',\n  '水手服/看透一切的坏笑.png',\n  '水手服/星星眼.png',\n  '水手服/猫爪生气.png',\n  '水手服/无表情.png',\n  '水手服/害羞.png',\n  '水手服/晕晕眼.png',\n  '水手服/惊讶.png',\n  '水手服/眼神空洞的催眠状态.png',\n  '水手服/性高潮.png',\n  '水手服/生气.png',\n  '格纹衫/无人.png',\n  '格纹衫/擦眼泪.png',\n  '格纹衫/微笑.png',\n  '格纹衫/稍微脸红.png',\n  '格纹衫/等待吻.png',\n  '格纹衫/手托下巴思考.png',\n  '格纹衫/哭泣.png',\n  '格纹衫/浅笑.png',\n  '格纹衫/流口水.png',\n  '格纹衫/邪恶的坏笑.png',\n  '格纹衫/看透一切的坏笑.png',\n  '格纹衫/星星眼.png',\n  '格纹衫/猫爪生气.png',\n  '格纹衫/害羞.png',\n  '格纹衫/晕晕眼.png',\n  '格纹衫/惊讶.png',\n  '格纹衫/眼神空洞的催眠状态.png',\n  '格纹衫/性高潮.png',\n  '格纹衫/生气.png',\n  '睡衣/无人.png',\n  '睡衣/微笑.png',\n  '睡衣/稍微脸红.png',\n  '睡衣/等待吻.png',\n  '睡衣/哭泣.png',\n  '睡衣/浅笑.png',\n  '睡衣/流口水.png',\n  '睡衣/邪恶的坏笑.png',\n  '睡衣/看透一切的坏笑.png',\n  '睡衣/星星眼.png',\n  '睡衣/猫爪生气.png',\n  '睡衣/害羞.png',\n  '睡衣/晕晕眼.png',\n  '睡衣/惊讶.png',\n  '睡衣/眼神空洞的催眠状态.png',\n  '睡衣/性高潮.png',\n  '睡衣/生气.png',\n  '全裸/无人.png',\n  '全裸/坏笑.png',\n  '全裸/稍微脸红.png',\n  '全裸/哭泣.png',\n  '全裸/浅笑.png',\n  '全裸/流口水.png',\n  '全裸/邪恶的坏笑.png',\n  '全裸/看透一切的坏笑.png',\n  '全裸/星星眼.png',\n  '全裸/等待接吻.png',\n  '全裸/害羞.png',\n  '全裸/晕晕眼.png',\n  '全裸/惊讶.png',\n  '全裸/眼神空洞的催眠状态.png',\n  '全裸/性高潮.png',\n  '全裸/生气.png',\n];\nexport function getImageUrl(id: string): string | null {\n  const prefix = 'https://testingcf.jsdelivr.net/gh/lolo-desu/lolocard/src/日记络络/图片' as const;\n  if (characters.includes(id)) {\n    return `${prefix}/立绘/${id}`;\n  }\n  if (backgrounds.includes(id)) {\n    return `${prefix}/背景/${id}`;\n  }\n  return null;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","// @ts-nocheck\nimport { characters, getImageUrl } from '@/日记络络/image';\nimport './index.scss';\n\nimport * as z from 'zod';\n\nconst Tachie = z.enum(characters).catch('无人.png');\n\ntype Dialog = z.infer<typeof Dialog>;\nconst Dialog = z.object({\n  name: z.string(),\n  text: z.string(),\n  background: z.string(),\n  characters: z.union([\n    z.literal('narrator'),\n    z.literal('protagonist'),\n    z.object({\n      left: z.object({\n        id: z.literal('络络').catch('络络'),\n        tachie: Tachie,\n      }),\n      right: z\n        .object({\n          id: z.literal('络络').catch('络络'),\n          tachie: Tachie,\n        })\n        .optional(),\n    }),\n  ]),\n});\n\n/**\n * 对话界面核心功能\n * 提供简单的对话显示和点击/空格下一步功能\n */\nclass GalgameEngine {\n  constructor() {\n    this.currentIndex = 0;\n    this.isAnimating = false;\n    this.activeCharacters = {}; // 存储当前活动的角色\n    this.isTransitioning = false; // 防止动画重叠\n    this.currentBgPath = ''; // 当前显示的背景路径\n    this.dialogHistory = []; // 存储对话历史\n\n    // 获取DOM元素\n    this.dialogBox = document.getElementById('dialog-box');\n    this.characterName = document.getElementById('character-name');\n    this.dialogText = document.getElementById('dialog-text');\n    this.currentImage = document.getElementById('background-image-current');\n    this.nextImage = document.getElementById('background-image-next');\n    this.characterContainer = document.getElementById('character-container');\n    this.historyPanel = document.getElementById('history-panel');\n    this.historyContent = document.getElementById('history-content');\n\n    try {\n      const message = SillyTavern.chat[getCurrentMessageId()].mes;\n      const gameDataString = message.match(/<galgame>\\s*```(?:json|yaml)?(.*)```\\s*<\\/galgame>/is)[1]; // 获取数据并去除首尾空格\n\n      if (!gameDataString) {\n        throw new Error('游戏数据 <Galgame> 为空。');\n      }\n\n      let parsedData = null;\n\n      // 尝试解析为 JSON\n      try {\n        parsedData = JSON.parse(gameDataString);\n        console.log('游戏数据加载成功 (JSON 格式)');\n      } catch (jsonError) {\n        console.warn('JSON 解析失败，尝试解析为 YAML:', jsonError.message);\n        // 如果 JSON 解析失败，尝试解析为 YAML\n        try {\n          parsedData = YAML.parse(gameDataString);\n        } catch (yamlError) {\n          console.error('YAML 解析也失败:', yamlError);\n          // 如果两种解析都失败，抛出合并的错误信息\n          throw new Error(\n            `数据解析失败：既不是有效的 JSON 也不是有效的 YAML。JSON 错误: ${jsonError.message} | YAML 错误: ${yamlError.message}`,\n          );\n        }\n      }\n\n      this.dialogData = z.array(Dialog).min(1).parse(parsedData, { reportInput: true });\n    } catch (error) {\n      // 捕获所有加载/解析过程中的错误\n      console.error('加载或解析游戏数据时出错:', error);\n      this.dialogData = [{ name: '系统提示', text: `加载对话数据失败：${error.message}`, characters: 'narrator' }];\n    }\n\n    // 初始化事件监听\n    this.initEventListeners();\n\n    // 显示第一条对话前，确保背景和界面已正确设置\n    this.initializeBackground();\n\n    // 显示第一条对话\n    this.showDialog(0);\n  }\n\n  // 初始化背景图片\n  initializeBackground() {\n    if (this.dialogData && this.dialogData.length > 0 && this.dialogData[0].background) {\n      // 设置初始背景\n      const initialBgPath = this.dialogData[0].background;\n      const initialBgUrl = this.getFullImageUrl(initialBgPath);\n\n      console.log('初始化背景图片:', initialBgUrl);\n\n      // 先检查元素是否存在\n      if (!this.currentImage) {\n        console.error('背景图片元素不存在!');\n        return;\n      }\n\n      // 记录当前显示的背景，方便后续比较\n      this.currentBgPath = initialBgPath;\n\n      // 直接设置当前背景图片\n      this.currentImage.src = initialBgUrl;\n      this.currentImage.style.opacity = '1';\n\n      this.currentImage.onerror = () => {\n        console.error('背景图片加载失败:', initialBgUrl);\n        // 尝试使用预设的CG URL\n        this.currentImage.src =\n          'https://testingcf.jsdelivr.net/gh/lolo-desu/lolocard/src/日记络络/图片/背景/商店街/黄昏.jpg';\n      };\n\n      // 检查图片是否已经加载完成\n      if (this.currentImage.complete) {\n        console.log('背景图片已加载完成');\n      } else {\n        this.currentImage.onload = () => {\n          console.log('背景图片加载完成');\n        };\n      }\n    }\n  }\n\n  // 获取完整的图片URL，处理URL编码问题\n  getFullImageUrl(id) {\n    if (!id) {\n      return '';\n    }\n    const url = getImageUrl(id);\n    if (!url) {\n      console.error('背景图片加载失败:', id);\n      return '';\n    }\n    return url;\n  }\n\n  initEventListeners() {\n    // 点击屏幕任意位置进入下一步\n    document.addEventListener('click', () => {\n      this.nextDialog();\n    });\n\n    // 按空格键进入下一步\n    document.addEventListener('keydown', event => {\n      if (event.code === 'Space') {\n        event.preventDefault();\n        this.nextDialog();\n      }\n    });\n  }\n\n  showDialog(index) {\n    if (index >= this.dialogData.length) {\n      // 对话结束，可以添加结束画面或循环播放\n      console.log('对话结束，重新开始');\n      this.currentIndex = 0;\n      this.showDialog(0);\n      return;\n    }\n\n    // 更新当前对话索引 - 非常重要\n    this.currentIndex = index;\n\n    const dialog = this.dialogData[index];\n    if (!dialog) {\n      console.error('对话数据不存在:', index);\n      return;\n    }\n\n    // 检查是否需要背景转场 - 比较当前背景与目标背景\n    const newBgPath = dialog.background || '';\n    const needBackgroundTransition = newBgPath && this.currentBgPath !== newBgPath;\n\n    console.log(\n      `显示对话 #${index}`,\n      dialog.name,\n      '当前背景:',\n      this.currentBgPath || '(无)',\n      '新背景:',\n      newBgPath || '(无)',\n      '需要转场:',\n      needBackgroundTransition,\n    );\n\n    // 如果需要背景转场，先执行背景转场\n    if (needBackgroundTransition) {\n      console.log('执行背景转场 - 从', this.currentBgPath || '(无)', '到', newBgPath);\n\n      // 修复：检查是否切换到CG（没有角色的情况），如果是，先隐藏所有当前角色\n      if (dialog.characters === 'narrator' || dialog.characters === 'protagonist' || !dialog.characters) {\n        // 先移除所有当前角色，再进行背景转场\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        // 清空活动角色记录\n        this.activeCharacters = {};\n      }\n\n      // 更新当前背景记录\n      this.currentBgPath = newBgPath;\n\n      this.fadeOutIn(() => {\n        return newBgPath;\n      }, dialog); // 传递当前对话以便在转场完成后更新\n    } else {\n      // 否则直接更新角色和对话\n      this.updateDialogContent(dialog);\n    }\n  }\n\n  // 更新对话内容\n  updateDialogContent(dialog) {\n    if (!dialog) {\n      console.error('更新对话内容失败: 对话数据为空');\n      return;\n    }\n\n    console.log('更新对话内容:', dialog.name, dialog.text);\n\n    // 更新角色立绘\n    this.updateCharacters(dialog);\n\n    // 应用打字机效果\n    this.characterName.textContent = dialog.name;\n    this.applyTypingEffect(dialog.text);\n\n    // 添加到对话历史\n    this.addToHistory(dialog);\n  }\n\n  applyTypingEffect(text) {\n    this.isAnimating = true;\n    this.dialogText.textContent = '';\n    document.getElementById('next-hint').style.opacity = '0'; // 隐藏提示\n\n    // 计算打字速度 - 根据文本长度动态调整\n    const baseSpeed = 30;\n    const speedModifier = Math.max(0.5, Math.min(1.5, 300 / text.length));\n    const speed = Math.floor(baseSpeed * speedModifier);\n\n    let i = 0;\n    // --- 修改点：移除了 lastPunctuation 变量 ---\n    // let lastPunctuation = 0; // 上一个标点符号的位置\n    // --- 修改结束 ---\n\n    const typeWriter = () => {\n      if (i < text.length && this.isAnimating) {\n        const char = text.charAt(i);\n        this.dialogText.textContent += char;\n        i++;\n        setTimeout(typeWriter, speed);\n      } else {\n        this.isAnimating = false;\n        document.getElementById('next-hint').style.opacity = '1'; // 显示提示\n      }\n    };\n\n    // 开始打字效果\n    typeWriter();\n  }\n\n  // 更新角色立绘显示\n  updateCharacters(dialog) {\n    // 转场中不更新角色显示，避免冲突\n    if (this.isTransitioning) {\n      console.log('正在转场中，延迟更新角色显示');\n      return;\n    }\n\n    // 记录新的角色显示状态\n    const newActiveCharacters = {};\n\n    // 处理特殊视角模式\n    document.body.classList.remove('narrator-mode', 'protagonist-mode');\n\n    // 处理角色立绘配置\n    if (dialog.characters) {\n      // 旁白模式\n      if (dialog.characters === 'narrator') {\n        document.body.classList.add('narrator-mode');\n        // 旁白模式下清空所有角色\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        this.activeCharacters = {};\n        return;\n      }\n      // 主角视角模式\n      else if (dialog.characters === 'protagonist') {\n        document.body.classList.add('protagonist-mode');\n        // 主角视角下清空所有角色\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        this.activeCharacters = {};\n        return;\n      }\n      // 单个居中角色（新格式）\n      else if (\n        typeof dialog.characters === 'object' &&\n        dialog.characters.id &&\n        !dialog.characters.left &&\n        !dialog.characters.right\n      ) {\n        const characterId = dialog.characters.id;\n        const tachie = dialog.characters.tachie;\n\n        newActiveCharacters[characterId] = {\n          position: 'center',\n          tachie: tachie,\n        };\n\n        this.showCharacter(characterId, 'center', dialog.name === characterId, tachie);\n      }\n      // 左右两个角色（新格式）\n      else if (typeof dialog.characters === 'object') {\n        // 如果只有一个角色，则居中显示\n        const hasLeftChar = !!dialog.characters.left;\n        const hasRightChar = !!dialog.characters.right;\n\n        if (hasLeftChar && !hasRightChar) {\n          // 只有左边角色，居中显示\n          const characterId = dialog.characters.left.id;\n          const tachie = dialog.characters.left.tachie;\n\n          newActiveCharacters[characterId] = {\n            position: 'center',\n            tachie: tachie,\n          };\n\n          this.showCharacter(characterId, 'center', dialog.name === characterId, tachie);\n        } else if (!hasLeftChar && hasRightChar) {\n          // 只有右边角色，居中显示\n          const characterId = dialog.characters.right.id;\n          const tachie = dialog.characters.right.tachie;\n\n          newActiveCharacters[characterId] = {\n            position: 'center',\n            tachie: tachie,\n          };\n\n          this.showCharacter(characterId, 'center', dialog.name === characterId, tachie);\n        } else {\n          // 两个角色都有，左右显示\n          if (dialog.characters.left && dialog.characters.left.id) {\n            const characterId = dialog.characters.left.id;\n            const tachie = dialog.characters.left.tachie;\n\n            newActiveCharacters[characterId] = {\n              position: 'left',\n              tachie: tachie,\n            };\n\n            this.showCharacter(characterId, 'left', dialog.name === characterId, tachie);\n          }\n\n          if (dialog.characters.right && dialog.characters.right.id) {\n            const characterId = dialog.characters.right.id;\n            const tachie = dialog.characters.right.tachie;\n\n            newActiveCharacters[characterId] = {\n              position: 'right',\n              tachie: tachie,\n            };\n\n            this.showCharacter(characterId, 'right', dialog.name === characterId, tachie);\n          }\n        }\n      }\n    } else {\n      // 没有角色配置时，隐藏所有角色\n      for (const characterId in this.activeCharacters) {\n        this.hideCharacter(characterId);\n      }\n      this.activeCharacters = {};\n      return;\n    }\n\n    // 移除不在新配置中的角色\n    for (const characterId in this.activeCharacters) {\n      if (!newActiveCharacters[characterId]) {\n        this.hideCharacter(characterId);\n      }\n    }\n\n    // 更新活动角色列表\n    this.activeCharacters = newActiveCharacters;\n  }\n\n  // 显示角色立绘\n  showCharacter(characterId, position, isSpeaking, tachie) {\n    // 转场中不更新角色显示，避免冲突\n    if (this.isTransitioning) {\n      console.log('正在转场中，跳过显示角色:', characterId);\n      return;\n    }\n\n    const spriteUrl = getImageUrl(tachie);\n\n    // 如果没有找到有效的立绘URL，则退出\n    if (!spriteUrl) return;\n\n    // 获取角色ID和表情的组合ID\n    const characterElementId = `character-${characterId}`;\n    const oldPosition = this.activeCharacters[characterId]?.position;\n\n    // 检查角色立绘是否已存在\n    let characterElement = document.getElementById(characterElementId);\n\n    // 如果不存在则创建新的立绘元素\n    if (!characterElement) {\n      characterElement = document.createElement('img');\n      characterElement.id = characterElementId;\n      characterElement.className = 'character-sprite character-enter';\n      characterElement.src = spriteUrl;\n      characterElement.dataset.tachie = tachie;\n      characterElement.alt = `${characterId}的立绘`;\n\n      // 过渡前准备 - 如果是从一侧切换到另一侧，先使用原来的位置\n      if (oldPosition && oldPosition !== position) {\n        characterElement.classList.add(`character-${oldPosition}`);\n      } else {\n        characterElement.classList.add(`character-${position}`);\n      }\n\n      this.characterContainer.appendChild(characterElement);\n\n      // 图片加载完成后添加激活类\n      setTimeout(() => {\n        // 再次检查是否在转场中，如果是则不显示\n        if (this.isTransitioning) {\n          if (characterElement && characterElement.parentNode) {\n            characterElement.parentNode.removeChild(characterElement);\n          }\n          return;\n        }\n\n        characterElement.classList.remove('character-enter');\n        characterElement.classList.add('character-active');\n\n        // 如果位置改变，延迟后更新位置\n        if (oldPosition && oldPosition !== position) {\n          setTimeout(() => {\n            characterElement.classList.remove(`character-${oldPosition}`);\n            characterElement.classList.add(`character-${position}`);\n            characterElement.dataset.position = position;\n          }, 50);\n        }\n\n        // 单人居中显示时的特殊处理\n        this.applyPositionStyle(characterElement, position);\n      }, 50);\n    }\n    // 如果已存在但表情或位置不同\n    else {\n      // 表情变化\n      if (characterElement.dataset.tachie !== tachie) {\n        characterElement.src = spriteUrl;\n        characterElement.dataset.tachie = tachie;\n      }\n\n      // 位置变化\n      if (characterElement.dataset.position !== position) {\n        // 使用过渡动画平滑切换位置\n        setTimeout(() => {\n          // 再次检查是否在转场中\n          if (this.isTransitioning) return;\n\n          characterElement.classList.remove(`character-${characterElement.dataset.position}`);\n          characterElement.classList.add(`character-${position}`);\n          characterElement.dataset.position = position;\n\n          // 更新定位样式\n          this.applyPositionStyle(characterElement, position);\n        }, 50);\n      }\n    }\n\n    // 应用说话/不说话状态 - 只用滤镜区分，不用透明度\n    if (isSpeaking) {\n      characterElement.classList.add('character-speaking');\n      characterElement.classList.remove('character-dimmed');\n      characterElement.style.opacity = '1'; // 确保完全不透明\n      characterElement.style.zIndex = '10'; // 确保说话角色在前面\n    } else {\n      characterElement.classList.remove('character-speaking');\n      characterElement.classList.add('character-dimmed');\n      characterElement.style.opacity = '1'; // 确保完全不透明\n      characterElement.style.zIndex = '5'; // 非说话角色在后面\n    }\n  }\n\n  // 应用位置样式的辅助函数\n  applyPositionStyle(element, position) {\n    // 单人居中显示时的特殊处理\n    if (position === 'center') {\n      // 确保完全居中且底部不露出背景\n      element.style.left = '50%';\n      element.style.right = 'auto';\n      element.style.transform = 'translateX(-50%)';\n      element.style.bottom = '0';\n      element.style.height = '98%';\n      element.style.maxHeight = '98%';\n    } else if (position === 'left') {\n      // 左侧定位 - 调整为更靠近中心\n      element.style.left = '30%';\n      element.style.right = 'auto';\n      element.style.transform = 'translateX(-50%)';\n      element.style.bottom = '0';\n      element.style.height = '95%';\n      element.style.maxHeight = '95%';\n    } else if (position === 'right') {\n      // 右侧定位 - 调整为更靠近中心\n      element.style.right = '30%';\n      element.style.left = 'auto';\n      element.style.transform = 'translateX(50%)';\n      element.style.bottom = '0';\n      element.style.height = '95%';\n      element.style.maxHeight = '95%';\n    }\n  }\n\n  // 隐藏角色立绘\n  hideCharacter(characterId) {\n    const characterElement = document.getElementById(`character-${characterId}`);\n    if (characterElement) {\n      // 防止重复触发淡出动画\n      if (characterElement.classList.contains('character-exit')) return;\n\n      characterElement.classList.add('character-exit');\n      characterElement.classList.remove('character-active', 'character-speaking');\n\n      // 动画结束后移除元素\n      setTimeout(() => {\n        if (characterElement && characterElement.parentNode) {\n          characterElement.parentNode.removeChild(characterElement);\n        }\n      }, 800); // 增加延迟以配合CSS过渡时间\n    }\n  }\n\n  nextDialog() {\n    // 如果正在动画中，则跳过打字效果直接显示全部文本\n    if (this.isAnimating) {\n      this.isAnimating = false;\n      const currentDialog = this.dialogData[this.currentIndex];\n      this.dialogText.textContent = currentDialog.text;\n      document.getElementById('next-hint').style.opacity = '1'; // 显示提示\n      return;\n    }\n\n    // 增加对话索引\n    this.currentIndex++;\n\n    // --- 修改点：检查是否超出对话数据范围 ---\n    if (this.currentIndex >= this.dialogData.length) {\n      console.log('对话已全部播放完毕。');\n      // 将索引退回到最后一条，防止后续可能的错误引用\n      this.currentIndex = this.dialogData.length - 1;\n\n      // 可选：隐藏\"下一步\"提示，明确告知用户对话结束\n      const nextHint = document.getElementById('next-hint');\n      if (nextHint) {\n        nextHint.style.display = 'none';\n      }\n\n      // 显示重新播放按钮\n      const restartBtn = document.getElementById('restart-btn');\n      if (restartBtn) {\n        restartBtn.style.display = 'block';\n      }\n\n      // 阻止进一步的操作，不再调用 showDialog\n      return;\n    }\n    // --- 修改结束 ---\n\n    // 如果索引有效，则显示下一条对话\n    this.showDialog(this.currentIndex);\n  }\n\n  // 重新开始对话播放\n  restartDialog() {\n    console.log('重新开始对话播放');\n\n    // 重置索引\n    this.currentIndex = 0;\n\n    // 重置角色立绘\n    for (const characterId in this.activeCharacters) {\n      this.hideCharacter(characterId);\n    }\n    this.activeCharacters = {};\n\n    // 重置背景到初始状态\n    if (this.dialogData && this.dialogData.length > 0 && this.dialogData[0].background) {\n      this.currentBgPath = this.dialogData[0].background;\n      const initialBgUrl = this.getFullImageUrl(this.currentBgPath);\n      this.currentImage.src = initialBgUrl;\n    }\n\n    // 重置对话界面状态\n    const nextHint = document.getElementById('next-hint');\n    if (nextHint) {\n      nextHint.style.display = 'block';\n      nextHint.style.opacity = '1';\n    }\n\n    // 隐藏重新播放按钮\n    const restartBtn = document.getElementById('restart-btn');\n    if (restartBtn) {\n      restartBtn.style.display = 'none';\n    }\n\n    // 显示第一条对话\n    this.showDialog(0);\n  }\n\n  fadeOutIn(callback, dialogToUpdate) {\n    // 如果已经在转场，则忽略\n    if (this.isTransitioning) {\n      console.log('已在转场中，忽略新的转场请求');\n      return;\n    }\n\n    this.isTransitioning = true;\n    console.log('开始背景转场');\n\n    // 获取下一张图片的URL\n    const relativeImagePath = callback(); // 获取 JSON 中定义的相对路径 (例如 \"教室/白天.jpg\")\n    if (!relativeImagePath) {\n      console.log('背景路径为空，跳过转场');\n      this.isTransitioning = false;\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n      return;\n    }\n\n    const nextImageUrl = this.getFullImageUrl(relativeImagePath);\n    console.log('切换背景图片:', relativeImagePath, '->', nextImageUrl);\n\n    // 如果URL获取失败或与当前图片相同，则不执行转场\n    if (!nextImageUrl || nextImageUrl === this.currentImage.src) {\n      console.log('跳过背景转场: URL为空或相同');\n      this.isTransitioning = false;\n      // 即使没有转场，也要更新对话内容\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n      return;\n    }\n\n    // 执行转场动画\n    const executeTransition = () => {\n      console.log('执行背景转场动画');\n      // 添加转场动画类\n      document.body.classList.add('transitioning');\n\n      // 淡入下一张图片\n      this.nextImage.style.opacity = '1';\n\n      // 转场完成后的处理\n      setTimeout(() => {\n        // 将下一张图片的URL复制到当前图片\n        this.currentImage.src = this.nextImage.src;\n        console.log('背景转场完成，当前背景:', this.currentImage.src);\n        // 重置下一张图片的不透明度\n        this.nextImage.style.opacity = '0';\n        // 移除转场动画类\n        document.body.classList.remove('transitioning');\n        // 重置转场状态\n        this.isTransitioning = false;\n\n        // 转场完成后更新对话内容\n        if (dialogToUpdate) {\n          console.log('转场完成，更新对话内容:', dialogToUpdate.name);\n          // 修复：确保转场完全结束后再更新对话内容和角色\n          setTimeout(() => {\n            this.updateDialogContent(dialogToUpdate);\n          }, 50);\n        }\n      }, 1200); // 与CSS过渡时间匹配\n    };\n\n    // 设置下一张图片的URL\n    this.nextImage.src = nextImageUrl;\n\n    // 添加错误处理\n    this.nextImage.onerror = () => {\n      console.error('背景图片加载失败:', nextImageUrl);\n      this.isTransitioning = false;\n      // 即使加载失败，也要尝试更新对话内容\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n    };\n\n    this.nextImage.onload = () => {\n      console.log('背景图片加载完成');\n      executeTransition();\n    };\n  }\n\n  // 添加对话到历史记录\n  addToHistory(dialog) {\n    // 检查是否已经存在相同的对话（避免重复添加）\n    const isDuplicate = this.dialogHistory.some(item => item.name === dialog.name && item.text === dialog.text);\n\n    if (!isDuplicate) {\n      this.dialogHistory.push({\n        name: dialog.name,\n        text: dialog.text,\n        background: dialog.background || '',\n      });\n\n      // 更新历史面板内容\n      this.updateHistoryPanel();\n    }\n  }\n\n  // 更新历史面板内容\n  updateHistoryPanel() {\n    // 清空当前内容\n    this.historyContent.innerHTML = '';\n\n    // 如果没有历史记录，显示提示信息\n    if (this.dialogHistory.length === 0) {\n      const emptyMsg = document.createElement('div');\n      emptyMsg.textContent = '暂无对话历史';\n      emptyMsg.style.textAlign = 'center';\n      emptyMsg.style.color = '#7D5B65';\n      emptyMsg.style.padding = '20px';\n      this.historyContent.appendChild(emptyMsg);\n      return;\n    }\n\n    // 为每条历史记录创建元素\n    this.dialogHistory.forEach((dialog, index) => {\n      const historyItem = document.createElement('div');\n      historyItem.className = 'history-item';\n      historyItem.style.marginBottom = '15px';\n      historyItem.style.padding = '15px';\n      historyItem.style.borderRadius = '12px';\n      historyItem.style.background = 'rgba(255, 255, 255, 0.5)';\n      historyItem.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05), 0 0 0 1px rgba(255,255,255,0.7) inset';\n      historyItem.style.transition = 'transform 0.2s ease, box-shadow 0.2s ease';\n\n      // 鼠标悬停效果\n      historyItem.onmouseover = function () {\n        this.style.transform = 'translateY(-2px)';\n        this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.08), 0 0 0 1px rgba(255,255,255,0.8) inset';\n      };\n\n      historyItem.onmouseout = function () {\n        this.style.transform = 'none';\n        this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05), 0 0 0 1px rgba(255,255,255,0.7) inset';\n      };\n\n      // 如果有角色名，则显示\n      if (dialog.name && dialog.name !== '旁白') {\n        const nameElem = document.createElement('div');\n        nameElem.className = 'history-name';\n        nameElem.textContent = dialog.name;\n        nameElem.style.fontWeight = 'bold';\n        nameElem.style.color = '#C18E98';\n        nameElem.style.marginBottom = '8px';\n        nameElem.style.position = 'relative';\n        nameElem.style.paddingLeft = '15px';\n\n        // 添加装饰元素\n        const decorElem = document.createElement('span');\n        decorElem.textContent = '❀';\n        decorElem.style.position = 'absolute';\n        decorElem.style.left = '0';\n        decorElem.style.top = '50%';\n        decorElem.style.transform = 'translateY(-50%)';\n        decorElem.style.color = '#FFB0C0';\n        decorElem.style.fontSize = '12px';\n\n        nameElem.appendChild(decorElem);\n        historyItem.appendChild(nameElem);\n      } else if (dialog.name === '旁白') {\n        // 旁白样式特殊处理\n        historyItem.style.fontStyle = 'italic';\n        historyItem.style.background = 'rgba(245, 235, 235, 0.7)';\n        historyItem.style.borderLeft = '3px solid #FFCAD5';\n      }\n\n      // 添加对话文本\n      const textElem = document.createElement('div');\n      textElem.className = 'history-text';\n      textElem.textContent = dialog.text;\n      textElem.style.color = '#4D2B35';\n      textElem.style.lineHeight = '1.5';\n      textElem.style.letterSpacing = '0.3px';\n      historyItem.appendChild(textElem);\n\n      // 添加到历史内容区\n      this.historyContent.appendChild(historyItem);\n    });\n\n    // 滚动到底部\n    setTimeout(() => {\n      this.historyContent.scrollTop = this.historyContent.scrollHeight;\n    }, 100);\n  }\n\n  // 显示/隐藏历史面板\n  toggleHistoryPanel(show) {\n    if (show) {\n      this.updateHistoryPanel();\n      this.historyPanel.style.display = 'block';\n\n      // 添加淡入动画效果\n      this.historyPanel.style.opacity = '0';\n      this.historyPanel.style.transition = 'opacity 0.3s ease';\n      setTimeout(() => {\n        this.historyPanel.style.opacity = '1';\n      }, 10);\n    } else {\n      // 淡出动画效果\n      this.historyPanel.style.opacity = '0';\n      setTimeout(() => {\n        this.historyPanel.style.display = 'none';\n      }, 300);\n    }\n  }\n}\n\n// 当页面加载完成后初始化游戏引擎\n$(() => {\n  const engine = new GalgameEngine();\n\n  // 处理UI显示/隐藏功能\n  function initToggleUIButton() {\n    const toggleBtn = document.getElementById('toggle-ui-btn');\n    if (toggleBtn) {\n      toggleBtn.addEventListener('click', function (e) {\n        e.stopPropagation(); // 防止点击事件触发对话推进\n        document.body.classList.toggle('ui-hidden');\n\n        // 更新按钮文本\n        if (document.body.classList.contains('ui-hidden')) {\n          toggleBtn.textContent = '💬';\n          toggleBtn.title = '显示界面';\n\n          // 在UI隐藏模式下取消角色立绘的高亮/淡化效果\n          const characterElements = document.querySelectorAll('.character-sprite');\n          characterElements.forEach(element => {\n            element.classList.remove('character-speaking', 'character-dimmed');\n          });\n        } else {\n          toggleBtn.textContent = '💭';\n          toggleBtn.title = '隐藏界面';\n\n          // 恢复当前对话的角色状态\n          engine.updateCharacters(engine.dialogData[engine.currentIndex]);\n        }\n      });\n\n      // 设置初始状态\n      toggleBtn.textContent = '💭';\n      toggleBtn.title = '隐藏界面';\n    }\n  }\n\n  // 初始化UI切换按钮\n  initToggleUIButton();\n\n  // 初始化历史对话按钮\n  const historyBtn = document.getElementById('history-btn');\n  const closeHistoryBtn = document.getElementById('close-history');\n\n  if (historyBtn && closeHistoryBtn) {\n    // 打开历史面板\n    historyBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.toggleHistoryPanel(true);\n    });\n\n    // 关闭历史面板\n    closeHistoryBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.toggleHistoryPanel(false);\n    });\n\n    // 点击历史面板内部不触发对话推进\n    document.getElementById('history-panel').addEventListener('click', function (e) {\n      e.stopPropagation();\n    });\n\n    // ESC键关闭历史面板\n    document.addEventListener('keydown', function (e) {\n      if (e.key === 'Escape' && engine.historyPanel.style.display === 'block') {\n        engine.toggleHistoryPanel(false);\n      }\n    });\n  }\n\n  // 初始化重新播放按钮\n  const restartBtn = document.getElementById('restart-btn');\n  if (restartBtn) {\n    restartBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.restartDialog();\n    });\n\n    // 设置按钮标题\n    restartBtn.title = '重新开始';\n  }\n});\n"],"names":["backgrounds","characters","getImageUrl","id","prefix","includes","z","Tachie","catch","Dialog","name","text","background","left","tachie","right","optional","GalgameEngine","constructor","this","currentIndex","isAnimating","activeCharacters","isTransitioning","currentBgPath","dialogHistory","dialogBox","document","getElementById","characterName","dialogText","currentImage","nextImage","characterContainer","historyPanel","historyContent","gameDataString","SillyTavern","chat","getCurrentMessageId","mes","match","Error","parsedData","JSON","parse","console","log","jsonError","warn","message","YAML","yamlError","error","dialogData","min","reportInput","initEventListeners","initializeBackground","showDialog","length","initialBgPath","initialBgUrl","getFullImageUrl","src","style","opacity","onerror","complete","onload","url","addEventListener","nextDialog","event","code","preventDefault","index","dialog","newBgPath","needBackgroundTransition","characterId","hideCharacter","fadeOutIn","updateDialogContent","updateCharacters","textContent","applyTypingEffect","addToHistory","speedModifier","Math","max","speed","floor","i","typeWriter","char","charAt","setTimeout","newActiveCharacters","body","classList","remove","hasLeftChar","hasRightChar","position","showCharacter","add","isSpeaking","spriteUrl","characterElementId","oldPosition","characterElement","dataset","applyPositionStyle","createElement","className","alt","appendChild","parentNode","removeChild","zIndex","element","transform","bottom","height","maxHeight","contains","currentDialog","nextHint","display","restartBtn","restartDialog","callback","dialogToUpdate","relativeImagePath","nextImageUrl","executeTransition","some","item","push","updateHistoryPanel","innerHTML","emptyMsg","textAlign","color","padding","forEach","historyItem","marginBottom","borderRadius","boxShadow","transition","onmouseover","onmouseout","nameElem","fontWeight","paddingLeft","decorElem","top","fontSize","fontStyle","borderLeft","textElem","lineHeight","letterSpacing","scrollTop","scrollHeight","toggleHistoryPanel","show","$","engine","toggleBtn","e","stopPropagation","toggle","title","querySelectorAll","initToggleUIButton","historyBtn","closeHistoryBtn","key"],"ignoreList":[],"sourceRoot":""}