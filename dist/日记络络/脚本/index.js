import{waitUntil as e}from'https://testingcf.jsdelivr.net/npm/async-wait-until/+esm';import{compare as n}from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import{default as t}from'https://testingcf.jsdelivr.net/npm/json5/+esm';import{jsonrepair as a}from'https://testingcf.jsdelivr.net/npm/jsonrepair/+esm';import'https://testingcf.jsdelivr.net/npm/zod/v4/core/+esm';import{createPinia as r,defineStore as o,getActivePinia as s,setActivePinia as i}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import{klona as p}from'https://testingcf.jsdelivr.net/npm/klona/+esm';import{gsap as l}from'https://testingcf.jsdelivr.net/npm/gsap/+esm';import{SplitText as c}from'https://testingcf.jsdelivr.net/npm/gsap/SplitText/+esm';import'https://testingcf.jsdelivr.net/gh/MagicalAstrogy/MagVarUpdate/artifact/bundle.js';import'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/é…’é¦†åŠ©æ‰‹/ä¸–ç•Œä¹¦å¼ºåˆ¶è‡ªå®šä¹‰æ’åº/index.js';import{registerMvuSchema as g}from'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';var d={113(e,n,t){t.r(n),t.d(n,{default:()=>i});var a=t(492),r=t.n(a),o=t(748),s=t.n(o)()(r());s.push([e.id,'.choice-fade-enter-active[data-v-a0554258],.choice-fade-leave-active[data-v-a0554258]{transition:transform 220ms cubic-bezier(0.2,0.8,0.2,1)}.choice-fade-enter-from[data-v-a0554258],.choice-fade-leave-to[data-v-a0554258]{transform:translateY(10px) scale(0.985)}.choice-fade-enter-to[data-v-a0554258],.choice-fade-leave-from[data-v-a0554258]{transform:translateY(0) scale(1)}@media (prefers-reduced-motion:reduce){.choice-fade-enter-active[data-v-a0554258],.choice-fade-leave-active[data-v-a0554258]{transition:none}}\n','',{version:3,sources:['webpack://./src/æ—¥è®°ç»œç»œ/è„šæœ¬/galgame/components/ChoiceBox.vue'],names:[],mappings:'AAuDA,sFAEE,sDACF,CAEA,gFAEE,uCACF,CAEA,gFAEE,gCACF,CAEA,uCACE,sFAEE,eACF,CACF',sourcesContent:['<template>\n  <Transition name="choice-fade" appear>\n    <div\n      v-if="store.options.length > 0"\n      class="absolute inset-x-0 top-0 bottom-[80px] z-40 flex items-center justify-center px-[6%] max-md:bottom-[120px]"\n      @click.stop\n    >\n      <div class="w-full max-w-[680px] space-y-3 max-md:space-y-2 md:space-y-4">\n        <button\n          v-for="(option, index) in store.options"\n          :key="`${index}-${option}`"\n          type="button"\n          class="group relative w-full cursor-pointer overflow-hidden rounded-[14px] border border-white/85 bg-white/55 px-[16px] py-[10px] text-center backdrop-blur-md transition-[background-color,border-color,transform] duration-150 hover:border-white/95 hover:bg-white/70 active:scale-[0.99] active:border-white/95 active:bg-white/75 max-md:px-[16px] max-md:py-[6px]"\n          @click.stop="() => onSelect(option)"\n        >\n          <div\n            class="c absolute inset-0 bg-[linear-gradient(135deg,rgba(255,208,216,0.55)_0%,rgba(255,187,200,0.25)_40%,rgba(255,255,255,0.0)_100%)] opacity-70 transition-opacity duration-150 group-hover:opacity-90 group-active:opacity-100"\n          />\n          <div class="relative flex items-center justify-center">\n            <div\n              class="text-[18px] leading-tight font-bold tracking-[0.06em] text-[#4d2b35] [text-shadow:0_1px_1px_rgba(255,255,255,0.92),0_6px_18px_rgba(0,0,0,0.06)]"\n            >\n              {{ option }}\n            </div>\n          </div>\n        </button>\n      </div>\n    </div>\n  </Transition>\n</template>\n\n<script setup lang="ts">\nimport { injectStreamingMessageContext } from \'@util/streaming\';\nimport { useGalgameStore } from \'../store\';\n\nconst context = injectStreamingMessageContext();\nconst input_method = inject<() => \'ç›´æ¥å‘é€\' | \'è¦†ç›–è¾“å…¥\'>(\'input_method\')!;\nconst store = useGalgameStore();\n\nfunction onSelect(option: string) {\n  if (context.message_id !== getLastMessageId()) {\n    return;\n  }\n  switch (input_method()) {\n    case \'ç›´æ¥å‘é€\':\n      triggerSlash(`/send ${option} || /trigger`);\n      break;\n    case \'è¦†ç›–è¾“å…¥\':\n      triggerSlash(`/setinput ${option}`);\n      break;\n  }\n}\n<\/script>\n\n<style scoped>\n.choice-fade-enter-active,\n.choice-fade-leave-active {\n  transition: transform 220ms cubic-bezier(0.2, 0.8, 0.2, 1);\n}\n\n.choice-fade-enter-from,\n.choice-fade-leave-to {\n  transform: translateY(10px) scale(0.985);\n}\n\n.choice-fade-enter-to,\n.choice-fade-leave-from {\n  transform: translateY(0) scale(1);\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .choice-fade-enter-active,\n  .choice-fade-leave-active {\n    transition: none;\n  }\n}\n</style>\n'],sourceRoot:''}]);const i=s},324(e,n,t){var a=t(396);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('4faf3044',a,!1,{ssrId:!0})},396(e,n,t){t.r(n),t.d(n,{default:()=>i});var a=t(492),r=t.n(a),o=t(748),s=t.n(o)()(r());s.push([e.id,'.bg-instant-enter-active[data-v-e2db30e0],.bg-instant-leave-active[data-v-e2db30e0]{transition:none}.bg-instant-enter-from[data-v-e2db30e0],.bg-instant-enter-to[data-v-e2db30e0],.bg-instant-leave-from[data-v-e2db30e0],.bg-instant-leave-to[data-v-e2db30e0]{opacity:1}.bg-fade-enter-active[data-v-e2db30e0],.bg-fade-leave-active[data-v-e2db30e0]{transition:opacity 1.2s ease-in-out}.bg-fade-enter-from[data-v-e2db30e0],.bg-fade-leave-to[data-v-e2db30e0]{opacity:0}.bg-fade-enter-to[data-v-e2db30e0],.bg-fade-leave-from[data-v-e2db30e0]{opacity:1}\n','',{version:3,sources:['webpack://./src/æ—¥è®°ç»œç»œ/è„šæœ¬/galgame/components/SceneStage.vue'],names:[],mappings:'AA6BA,oFAEE,eACF,CAEA,4JAIE,SACF,CAEA,8EAEE,mCACF,CAEA,wEAEE,SACF,CAEA,wEAEE,SACF',sourcesContent:['<template>\n  <div class="absolute inset-0">\n    <Transition :name="store.current_index > 0 ? \'bg-fade\' : \'bg-instant\'">\n      <img\n        v-if="background_url"\n        :key="background_id"\n        :src="background_url"\n        class="absolute inset-0 h-full w-full object-cover"\n      />\n    </Transition>\n\n    <div class="pointer-events-none absolute inset-0">\n      <CharacterLayer />\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { getImageUrl } from \'../../../image\';\nimport { useGalgameStore } from \'../store\';\nimport CharacterLayer from \'./CharacterLayer.vue\';\n\nconst store = useGalgameStore();\n\nconst background_id = computed(() => store.current_dialog.background);\nconst background_url = computed(() => getImageUrl(background_id.value) ?? \'\');\n<\/script>\n\n<style scoped>\n.bg-instant-enter-active,\n.bg-instant-leave-active {\n  transition: none;\n}\n\n.bg-instant-enter-from,\n.bg-instant-enter-to,\n.bg-instant-leave-from,\n.bg-instant-leave-to {\n  opacity: 1;\n}\n\n.bg-fade-enter-active,\n.bg-fade-leave-active {\n  transition: opacity 1.2s ease-in-out;\n}\n\n.bg-fade-enter-from,\n.bg-fade-leave-to {\n  opacity: 0;\n}\n\n.bg-fade-enter-to,\n.bg-fade-leave-from {\n  opacity: 1;\n}\n</style>\n'],sourceRoot:''}]);const i=s},424(e,n,t){function a(e,n){for(var t=[],a={},r=0;r<n.length;r++){var o=n[r],s=o[0],i={id:e+':'+r,css:o[1],media:o[2],sourceMap:o[3]};a[s]?a[s].parts.push(i):t.push(a[s]={id:s,parts:[i]})}return t}t.d(n,{A:()=>m});var r='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!r)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var o={},s=r&&(document.head||document.getElementsByTagName('head')[0]),i=null,p=0,l=!1,c=function(){},g=null,d='data-vue-ssr-id',u='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,n,t,r){l=t,g=r||{};var s=a(e,n);return f(s),function(n){for(var t=[],r=0;r<s.length;r++){var i=s[r];(p=o[i.id]).refs--,t.push(p)}n?f(s=a(e,n)):s=[];for(r=0;r<t.length;r++){var p;if(0===(p=t[r]).refs){for(var l=0;l<p.parts.length;l++)p.parts[l]();delete o[p.id]}}}}function f(e){for(var n=0;n<e.length;n++){var t=e[n],a=o[t.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](t.parts[r]);for(;r<t.parts.length;r++)a.parts.push(b(t.parts[r]));a.parts.length>t.parts.length&&(a.parts.length=t.parts.length)}else{var s=[];for(r=0;r<t.parts.length;r++)s.push(b(t.parts[r]));o[t.id]={id:t.id,refs:1,parts:s}}}}function h(){var e=document.createElement('style');return e.type='text/css',s.appendChild(e),e}function b(e){var n,t,a=document.querySelector('style['+d+'~="'+e.id+'"]');if(a){if(l)return c;a.parentNode.removeChild(a)}if(u){var r=p++;a=i||(i=h()),n=j.bind(null,a,r,!1),t=j.bind(null,a,r,!0)}else a=h(),n=y.bind(null,a),t=function(){a.parentNode.removeChild(a)};return n(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;n(e=a)}else t()}}var v,x=(v=[],function(e,n){return v[e]=n,v.filter(Boolean).join('\n')});function j(e,n,t,a){var r=t?'':a.css;if(e.styleSheet)e.styleSheet.cssText=x(n,r);else{var o=document.createTextNode(r),s=e.childNodes;s[n]&&e.removeChild(s[n]),s.length?e.insertBefore(o,s[n]):e.appendChild(o)}}function y(e,n){var t=n.css,a=n.media,r=n.sourceMap;if(a&&e.setAttribute('media',a),g.ssrId&&e.setAttribute(d,n.id),r&&(t+='\n/*# sourceURL='+r.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+' */'),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},455(e,n){n.A=(e,n)=>{const t=e.__vccOpts||e;for(const[e,a]of n)t[e]=a;return t}},492(e){e.exports=function(e){var n=e[1],t=e[3];if(!t)return n;if('function'==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),r='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(a),o='/*# '.concat(r,' */');return[n].concat([o]).join('\n')}return[n].join('\n')}},748(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t='',a=void 0!==n[5];return n[4]&&(t+='@supports ('.concat(n[4],') {')),n[2]&&(t+='@media '.concat(n[2],' {')),a&&(t+='@layer'.concat(n[5].length>0?' '.concat(n[5]):'',' {')),t+=e(n),a&&(t+='}'),n[2]&&(t+='}'),n[4]&&(t+='}'),t}).join('')},n.i=function(e,t,a,r,o){'string'==typeof e&&(e=[[null,e,void 0]]);var s={};if(a)for(var i=0;i<this.length;i++){var p=this[i][0];null!=p&&(s[p]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);a&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]='@layer'.concat(c[5].length>0?' '.concat(c[5]):'',' {').concat(c[1],'}')),c[5]=o),t&&(c[2]?(c[1]='@media '.concat(c[2],' {').concat(c[1],'}'),c[2]=t):c[2]=t),r&&(c[4]?(c[1]='@supports ('.concat(c[4],') {').concat(c[1],'}'),c[4]=r):c[4]=''.concat(r)),n.push(c))}},n}},921(e,n,t){var a=t(113);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(424).A)('bb8dde82',a,!1,{ssrId:!0})}},u={};function m(e){var n=u[e];if(void 0!==n)return n.exports;var t=u[e]={id:e,exports:{}};return d[e](t,t.exports,m),t.exports}m.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return m.d(n,{a:n}),n},m.d=(e,n)=>{for(var t in n)m.o(n,t)&&!m.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},m.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),m.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};function f(e='head'){const n=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo(e);return{destroy:()=>n.remove()}}function h(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(e){const n=16*Math.random()|0;return('x'===e?n:3&n|8).toString(16)})}function b(e){let n;try{n=YAML.parseDocument(e,{merge:!0}).toJS()}catch(o){try{n=t.parse(e)}catch(t){try{n=JSON.parse(a(e))}catch(n){const a=e=>e instanceof Error?e.message:String(e);throw new Error((r={'è¦è§£æçš„å­—ç¬¦ä¸²ä¸æ˜¯æœ‰æ•ˆçš„ YAML/JSON æ ¼å¼':{å­—ç¬¦ä¸²å†…å®¹:e,YAMLé”™è¯¯ä¿¡æ¯:a(o),JSON5é”™è¯¯ä¿¡æ¯:a(t),å°è¯•ä¿®å¤JSONæ—¶çš„é”™è¯¯ä¿¡æ¯:a(n)}},YAML.stringify(r,{blockQuote:'literal'})))}}}var r;return n}const v=Vue;function x(){return(0,v.readonly)((0,v.inject)('streaming_message_context'))}function j(e,n={}){const{host:t='iframe',filter:a,prefix:r=h()}=n,o=new Map;let s=!1;const i=e=>{const n=Number($('#chat > .mes').first().attr('mesid')),t=getLastMessageId();_.inRange(e,n,t+1)||o.get(e)?.destroy()},p=async(n,p)=>{if(s)return;i(n);const l=p??getChatMessages(n)[0].message??'';if(a&&!a(n,l))return void o.get(n)?.destroy();const c=$(`.mes[mesid='${n}']`),g=c.find('.mes_text').addClass('hidden!');c.find('.TH-streaming').addClass('hidden!');let d=c.find(`#${r}-${n}`);if(d.length>0){const e=o.get(n);if(e)return e.data.message=l,e.data.during_streaming=Boolean(p),void d.removeClass('hidden!')}o.get(n)?.destroy(),d.remove();let u=c.find('.mes_streaming');0===u.length&&(u=$('<div class="mes_streaming">').css({'font-weight':'500','line-height':'calc(var(--mainFontSize) + .5rem)','max-width':'100%','overflow-wrap':'anywhere',padding:'calc(var(--mainFontSize) * 0.8) 0 0 0'}).insertAfter(g)),d=('iframe'===t?$('<iframe>').attr({script_id:getScriptId(),frameborder:0,srcdoc:'<head> <link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"> <script src="https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/lib/tailwindcss.min.js"><\/script> <script src="https://testingcf.jsdelivr.net/npm/jquery"><\/script> <script src="https://testingcf.jsdelivr.net/npm/jquery-ui/dist/jquery-ui.min.js"><\/script> <link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/jquery-ui/themes/base/theme.min.css"/> <script src="https://testingcf.jsdelivr.net/npm/jquery-ui-touch-punch"><\/script> <script src="https://testingcf.jsdelivr.net/npm/lodash"><\/script> <script src="https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/src/iframe/adjust_iframe_height.js"><\/script> <style>*,::after,::before{box-sizing:border-box}body,html{margin:0!important;padding:0;overflow:hidden!important;max-width:100%!important}</style> </head> '}).addClass('w-full'):$('<div>').attr('script_id',getScriptId())).attr('id',`${r}-${n}`).appendTo(u);const m=(0,v.reactive)({prefix:r,host_id:`${r}-${n}`,message_id:n,message:l,during_streaming:Boolean(p)}),h=e().provide('streaming_message_context',m);'iframe'===t?d.on('load',function(){f(this.contentDocument.head),h.mount(this.contentDocument.body)}):h.mount(d[0]);const b=new MutationObserver(()=>{$('#curEditTextarea').parent().is(g)&&(g.removeClass('hidden!'),d.addClass('hidden!'))});b.observe(g[0],{childList:!0,subtree:!0,characterData:!0}),o.set(n,{app:h,data:m,destroy:()=>{const e=c.find('.TH-streaming');e.length>0?e.removeClass('hidden!'):g.removeClass('hidden!'),h.unmount(),d.remove(),0===u.children().length&&u.remove(),b.disconnect(),o.delete(n)}})},l=async()=>{s||(o.keys().forEach(e=>i(e)),await Promise.all($('#chat').children('.mes[is_user=\'false\'][is_system=\'false\']').map(async(e,n)=>{const t=Number($(n).attr('mesid')??'NaN');isNaN(t)||await p(t)})))},c=[],g=(e,n)=>{c.push(eventOn(e,errorCatched(n)).stop)};return g(tavern_events.CHAT_CHANGED,()=>l()),g(tavern_events.CHARACTER_MESSAGE_RENDERED,e=>p(e)),g(tavern_events.MESSAGE_EDITED,e=>{o.get(e)?.destroy(),p(e)}),g(tavern_events.MESSAGE_UPDATED,e=>p(e)),g(tavern_events.MESSAGE_SWIPED,e=>{o.get(e)?.destroy(),p(e)}),g(tavern_events.MESSAGE_DELETED,()=>setTimeout(errorCatched(l),1e3)),g(tavern_events.STREAM_TOKEN_RECEIVED,e=>{const n=Number($('#chat').children('.mes.last_mes').attr('mesid')??'NaN');isNaN(n)||p(n,e)}),'div'===t&&c.push(f().destroy),l(),{unmount:()=>{$('.mes_text').removeClass('hidden!'),o.forEach(({destroy:e})=>e()),c.forEach(e=>e()),s=!0}}}const y='ä¸Šé”çš„æ—¥è®°æœ¬',k=z,C=k.z.object({ä¸»è§’æ€§åˆ«:k.z.enum(['ç”·','å¥³']).prefault('ç”·'),æ ·å¼ä¸»é¢˜:k.z.enum(['æš—è‰²','äº®è‰²']).prefault('æš—è‰²'),é€‰æ‹©æ¡†è§¦å‘æ–¹å¼:k.z.enum(['ç›´æ¥å‘é€','è¦†ç›–è¾“å…¥']).prefault('ç›´æ¥å‘é€'),å§‹ç»ˆä½¿ç”¨galgameç•Œé¢:k.z.boolean().prefault(!1)}),S=o('config',errorCatched(()=>{const e=(0,v.ref)(C.parse({})),n=async()=>{const n=await getWorldbook(y),t=e=>n.find(n=>n.name.includes(e))?.enabled??!1,a=p(e.value),r=C.parse({ä¸»è§’æ€§åˆ«:t('ä¸»è§’æ€§åˆ«')?'ç”·':'å¥³',æ ·å¼ä¸»é¢˜:t('æ ·å¼ä¸»é¢˜')?'æš—è‰²':'äº®è‰²',é€‰æ‹©æ¡†è§¦å‘æ–¹å¼:t('é€‰æ‹©æ¡†è§¦å‘æ–¹å¼')?'ç›´æ¥å‘é€':'è¦†ç›–è¾“å…¥',å§‹ç»ˆä½¿ç”¨galgameç•Œé¢:!!t('å§‹ç»ˆä½¿ç”¨galgameç•Œé¢')});_.isEqual(r,a)||(e.value=p(r)),insertOrAssignVariables(p(r),{type:'chat'})},t=n();return eventOn(tavern_events.WORLDINFO_UPDATED,async e=>{e===y&&await n()}),eventOn(tavern_events.CHAT_CHANGED,async()=>{await n()}),{config:(0,v.readonly)(e),_wait_init:t}})),w=k.z.object({id:k.z.string(),tachie:k.z.string()}),N=k.z.object({speaker:k.z.string(),speech:k.z.string(),background:k.z.string(),tachie:k.z.string()}).transform(e=>({..._.omit(e,'tachie'),characters:[{id:'ç»œç»œ',tachie:e.tachie}]})),E=k.z.union([N,k.z.object({speaker:k.z.string(),speech:k.z.string().transform(e=>e.replace(/^ã€Œ(.+)ã€$/,'â€œ$1â€').replace(/^"(.+)"$/,'â€œ$1â€')),background:k.z.string(),characters:k.z.array(w).prefault([]).catch([])})]).transform(e=>('ç‹¬ç™½'===e.speaker&&(e.speaker=substitudeMacros('<user>'),e.speech=e.speech.startsWith('ï¼ˆ')||e.speech.startsWith('(')?e.speech:`ï¼ˆ${e.speech}ï¼‰`),'ç‹¬ç™½'!==e.speaker&&'æ—ç™½'!==e.speaker||(e.speaker=''),e));const G=o('galgame',()=>{const e=(0,v.ref)([{speaker:'ç³»ç»Ÿæç¤º',speech:'å°šæœªåŠ è½½æ¶ˆæ¯',background:'',characters:[]}]),n=(0,v.ref)([]),t=(0,v.ref)(0),a=(0,v.ref)(!1),r=(0,v.ref)(!1),o=(0,v.computed)(()=>e.value[t.value]),s=(0,v.computed)(()=>e.value.slice(0,t.value+1));const i=(0,v.ref)(!0),p=(0,v.ref)(!1);return{dialogs:e,options:n,loadMessage:t=>{const{dialogs:r,type:o}=function(e){const n=(e=e.replace('<StatusPlaceHolderImpl/>','')).match(/<(galgame)>\s*(?:```.*\n)?((?:(?!<\1>)[\s\S])*?)(?:\n```)?\s*<\/\1>/im),t=e.match(/<(galgame)>(?!.*<\/\1>)\s*(?:```[^\n]*\n)?(.*?)\s*(?:```.*)?$/is),a=n?.[2]??t?.[2]??'',r=(e,n)=>({dialogs:[{speaker:'ç³»ç»Ÿæç¤º',speech:`${e}: ${n instanceof Error?n.message:String(n)}`,background:'',characters:[]}],type:'error'});let o;try{o=b(a)}catch(e){return r('è§£ææ•°æ®å¤±è´¥',e)}try{return{dialogs:k.z.array(E.or(k.z.literal('failed')).catch('failed')).min(1).parse(o,{reportInput:!0}).filter(e=>'failed'!==e),type:n?'full':'partial'}}catch(e){return r('åŠ è½½å¯¹è¯æ•°æ®å¤±è´¥',e)}}(t);a.value&&'error'===o||(a.value||'partial'!==o||r.push({speaker:'ç³»ç»Ÿæç¤º',speech:'æ¶ˆæ¯æˆªæ–­äº†â€¦â€¦è¯·é‡æ–°ç”Ÿæˆ',background:'',characters:[]}),e.value=r,n.value=function(e){return[...(e.match(/<(roleplay_options)>\s*(?:```.*\n)?((?:(?!<\1>)[\s\S])*?)(?:\n```)?\s*<\/\1>/im)?.[2]??e.match(/<(roleplay_options)>(?!.*<\/\1>)\s*(?:```[^\n]*\n)?(.*?)\s*(?:```.*)?$/is)?.[2]??'').matchAll(/(.+?)[:ï¼š]\s*(.+)/gm)].map(e=>e[2].replace(/^\$\{(.+)\}$/,'$1').replace(/^ã€Œ(.+)ã€$/,'â€œ$1â€').replace(/^"(.+)"$/,'â€œ$1â€'))}(t))},current_index:t,during_streaming:a,has_ended:r,current_dialog:o,history_dialogs:s,advance:function(){if(r.value)return;const n=t.value+1;n>=e.value.length?a.value||(r.value=!0):t.value=n},restart:function(){t.value=0,r.value=!1},dialog_opened:i,history_opened:p}}),A={class:'w-full max-w-[680px] space-y-3 max-md:space-y-2 md:space-y-4'},F=['onClick'],W={class:'relative flex items-center justify-center'},V={class:'text-[18px] leading-tight font-bold tracking-[0.06em] text-[#4d2b35] [text-shadow:0_1px_1px_rgba(255,255,255,0.92),0_6px_18px_rgba(0,0,0,0.06)]'},M=(0,v.defineComponent)({__name:'ChoiceBox',setup(e){const n=x(),t=(0,v.inject)('input_method'),a=G();return(e,r)=>((0,v.openBlock)(),(0,v.createBlock)(v.Transition,{name:'choice-fade',appear:''},{default:(0,v.withCtx)(()=>[(0,v.unref)(a).options.length>0?((0,v.openBlock)(),(0,v.createElementBlock)('div',{key:0,class:'absolute inset-x-0 top-0 bottom-[80px] z-40 flex items-center justify-center px-[6%] max-md:bottom-[120px]',onClick:r[0]||(r[0]=(0,v.withModifiers)(()=>{},['stop']))},[(0,v.createElementVNode)('div',A,[((0,v.openBlock)(!0),(0,v.createElementBlock)(v.Fragment,null,(0,v.renderList)((0,v.unref)(a).options,(e,a)=>((0,v.openBlock)(),(0,v.createElementBlock)('button',{key:`${a}-${e}`,type:'button',class:'group relative w-full cursor-pointer overflow-hidden rounded-[14px] border border-white/85 bg-white/55 px-[16px] py-[10px] text-center backdrop-blur-md transition-[background-color,border-color,transform] duration-150 hover:border-white/95 hover:bg-white/70 active:scale-[0.99] active:border-white/95 active:bg-white/75 max-md:px-[16px] max-md:py-[6px]',onClick:(0,v.withModifiers)(()=>function(e){if(n.message_id===getLastMessageId())switch(t()){case'ç›´æ¥å‘é€':triggerSlash(`/send ${e} || /trigger`);break;case'è¦†ç›–è¾“å…¥':triggerSlash(`/setinput ${e}`)}}(e),['stop'])},[r[1]||(r[1]=(0,v.createElementVNode)('div',{class:'c absolute inset-0 bg-[linear-gradient(135deg,rgba(255,208,216,0.55)_0%,rgba(255,187,200,0.25)_40%,rgba(255,255,255,0.0)_100%)] opacity-70 transition-opacity duration-150 group-hover:opacity-90 group-active:opacity-100'},null,-1)),(0,v.createElementVNode)('div',W,[(0,v.createElementVNode)('div',V,(0,v.toDisplayString)(e),1)])],8,F))),128))])])):(0,v.createCommentVNode)('v-if',!0)]),_:1}))}});m(921);var B=m(455);const T=(0,B.A)(M,[['__scopeId','data-v-a0554258']]),D=['CG/å‚æ™šæˆ·å¤–æµ·è¾¹å ¤åä¸Šç«™ç€è„¸çº¢çœ‹å‘æ—è¾¹.jpg','CG/å¤œæ™šæˆ·å¤–æ‹¿å†°å¯ä¹è§¦ç¢°ç»œç»œè„¸é¢Šå¬‰ç¬‘.jpg','CG/å¤œæ™šæˆ·å¤–æ—é—´ç«™ç€æŠ¬å¤´çœ‹å¤œç©º.jpg','CG/ç™½å¤©å®¤å†…å®¢å…åç€è¢«ä¸»è§†è§’å–‚é£Ÿè„¸çº¢åœ°çœ‹ç€å‰æ–¹.jpg','CG/ç™½å¤©å®¤å†…æ•™å®¤é‡Œååœ¨é’¢ç´å‰çœ‹å‘æ—è¾¹è¡¨æƒ…å¹³é™åŒ…å«å¹»æƒ³å‡ºçš„é²¸é±¼ä¸äº‘æœµ.jpg','CG/ç™½å¤©å®¤å†…é¤å…ååœ¨æ¡Œå­å‰ç”¨å‹ºå­åƒé¥­.jpg','CG/ç™½å¤©æˆ·å¤–å­¦æ ¡å¤©å°çœºæœ›ç­‰å¾….jpg','CG/ç™½å¤©æˆ·å¤–å­¦æ ¡èµ°å»Šç«™ç€æ‹¿ç€ä¹¦åŒ…å›å¤´è„¸çº¢å¾®ç¬‘.jpg','CG/ç™½å¤©æˆ·å¤–å­¦æ ¡é“è·¯ä¸Šè„¸çº¢å›å¤´çœ‹.jpg','CG/ç™½å¤©æˆ·å¤–æµ·è¾¹ååœ¨é˜²æ³¢å ¤ä¸Šçœ‹ç€çŒ«å’ªè¡¨æƒ…æ¸©æŸ”.jpg','CG/ç™½å¤©æˆ·å¤–æµ·è¾¹æµ·é¸¥åŒæ‰‹åˆåçœºæœ›è¿œæ–¹.jpg','CG/ç™½å¤©æˆ·å¤–è¡—é“ä¸ŠåŒæ‰‹é è¿‘è„¸é¢Šè„¸çº¢å¾®ç¬‘.jpg','CG/ç™½å¤©æˆ·å¤–èººåœ¨èŠ±æµ·å¾®ç¬‘.jpg','CG/ç®€å•èƒŒæ™¯åŒæ‰‹å¼ å¼€æŠ¬å¤´ç­‰å¾…äº²å»æ‹¥æŠ±.jpg','CG/é»„æ˜æˆ·å¤–æ—¥è½æµ·è¾¹ç«™ç«‹è„¸çº¢ç›´è§†ç©å®¶.jpg','NSFWCG/å§å®¤åºŠä¸Šå£äº¤ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/å§å®¤åºŠä¸ŠæŒ‡äº¤ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/å§å®¤åºŠä¸ŠæŒ‡äº¤ä¸»è§’ä¸»åŠ¨POVè§†è§’.jpg','NSFWCG/å§å®¤åºŠä¸ŠæŒ‡äº¤ç»œç»œä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šå£äº¤é¢„å¤‡å¾®å¾®åç¬‘.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šå±•ç¤ºå°ç©´è¶³äº¤.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šå±•ç¤ºå°ç©´è¶³äº¤å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ‰‘å€’ç»œç»œä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ‰¶è…¿æ’å…¥å›å¤´æœ›.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ‰¶è…¿æ’å…¥å›å¤´æœ›å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠæŒ‡äº¤ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠæŒ‡äº¤ä¸»è§’ä¸»åŠ¨2.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠæŒ‡äº¤ç»œç»œä¸Šä½ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢å£äº¤é¢„å¤‡å«ç¾å¾®ç¬‘è„¸.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢å£äº¤é¢„å¤‡æ„‰æ‚¦è„¸.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢æ’å…¥Må­—è…¿.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢æ’å…¥Må­—è…¿2.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢æ’å…¥Må­—è…¿å°„ç²¾æ„‰æ‚¦è„¸.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢æ’å…¥å‰å€¾Må­—è…¿é€†æ¨å¥³ä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šæ­£é¢æ’å…¥å‰å€¾Må­—è…¿é€†æ¨å¥³ä¸»åŠ¨è„¸çº¢å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠèƒŒå¯¹é«˜ä¸¾å±è‚¡è„¸ä¸‹è¶´å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠèƒŒèº«æ’…å±è‚¡åå…¥.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸ŠèƒŒèº«æ’…å±è‚¡åå…¥å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šè¶´ç”·èº«ä¸Šå£äº¤æ·±å–‰.jpg','NSFWCG/å¤œæ™šå§å®¤åºŠä¸Šè¶´ç”·èº«ä¸Šå£äº¤æ·±å–‰å°„ç²¾.jpg','NSFWCG/å¤œæ™šå§å®¤æŒ‡äº¤ç»œç»œä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤æŒ‡äº¤ç»œç»œç«™ç«‹ä¸»è§’ååºŠä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤æŒ‡æ•™ç»œç»œä¸Šä½ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/å¤œæ™šå§å®¤ç»œç»œæ‰¶å¢™è‡ªæ…°.jpg','NSFWCG/å¤œæ™šå­¦æ ¡äº²å».jpg','NSFWCG/å¤œæ™šå­¦æ ¡å¤©å°äº²å».jpg','NSFWCG/å¤œæ™šå­¦æ ¡å®¤å†…äº²å».jpg','NSFWCG/å¤œæ™šå­¦æ ¡å±‹é¡¶æ‰¶è…¿æ’å…¥å›å¤´æœ›.jpg','NSFWCG/å¤œæ™šå­¦æ ¡å±‹é¡¶è¶´æ æ†åå…¥.jpg','NSFWCG/å¤œæ™šå­¦æ ¡å±‹é¡¶è¶´æ æ†åå…¥å°„ç²¾.jpg','NSFWCG/å¤œæ™šå­¦æ ¡å±‹é¡¶è¶´æ æ†åå…¥å°„ç²¾è„¸çº¢.jpg','NSFWCG/å¤œæ™šæˆ·å¤–äº²å».jpg','NSFWCG/å¤œæ™šæˆ·å¤–æ€è£™æŒ‡äº¤ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šä¸‹åŠèº«è£¸Må­—è…¿åç”·ä¸Šæœªæ€§äº¤.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå…¨è£¸åå…¥1.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå…¨è£¸åå…¥2.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå£äº¤ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå£äº¤æ·±å–‰é—­çœ¼.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå£äº¤ç”·èºº1.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå£äº¤ç”·èºº2.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šå£äº¤ç”·èºº3.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šåå…¥åŒæ‰‹æŠ“èƒ³è†Š.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šåå…¥å¥³è¶´.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸ŠæŒ‡äº¤ä¸»è§’ä¸»åŠ¨POVè§†è§’.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸ŠæŒ‡äº¤ç»œç»œä¸Šä½ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸ŠæŒ‡äº¤ç»œç»œä¸»åŠ¨.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šæ­£é¢Mè…¿.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šæ­£é¢Vè…¿.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šè¶³äº¤.jpg','NSFWCG/ç™½å¤©å§å®¤åºŠä¸Šéª‘ä¹˜å‰æˆ.jpg','NSFWCG/ç™½å¤©å§å®¤æ€§çˆ±åæ‹¥æŠ±.jpg','NSFWCG/ç™½å¤©å­¦æ ¡å¤©å°æŒ‡æ•™ä¸»è§’ä¸»åŠ¨.jpg','NSFWCG/ç™½å¤©å­¦æ ¡å±‹é¡¶æ­£é¢ç«™ç«‹.jpg','NSFWCG/ç™½å¤©å­¦æ ¡å±‹é¡¶è¶´å›´æ åå…¥1.jpg','NSFWCG/ç™½å¤©å­¦æ ¡å±‹é¡¶è¶´å›´æ åå…¥2.jpg','NSFWCG/ç™½å¤©å®¤å†…æ³•å¼èˆŒå».jpg','NSFWCG/ç™½å¤©å··å­å…¨è£¸æ­£é¢Mè…¿.jpg','NSFWCG/ç™½å¤©å··å­åå…¥æ‰¯èƒ³è†Šè·ªåœ°.jpg','NSFWCG/ç™½å¤©å··å­åå…¥ç‰µæ‰‹.jpg','NSFWCG/ç™½å¤©å··å­æ‰¶å¢™åå…¥1.jpg','NSFWCG/ç™½å¤©å··å­æ‰¶å¢™åå…¥2.jpg','NSFWCG/ç™½å¤©å··å­æ­£é¢Mè…¿èººåœ°.jpg','NSFWCG/ç™½å¤©æ•™å®¤åå…¥Mè…¿æ‰¶æ¡Œ.jpg','NSFWCG/ç™½å¤©æ•™å®¤åå…¥æ‰¶å¢™.jpg','NSFWCG/ç™½å¤©æ•™å®¤åå…¥æ‰¶æ¡Œ.jpg','NSFWCG/ç™½å¤©æ•™å®¤åæ¡Œæ‰¶å•è…¿æ­£é¢.jpg','NSFWCG/ç™½å¤©æ•™å®¤æ­£é¢Vè…¿.jpg','NSFWCG/ç™½å¤©æ•™å®¤æ­£é¢å.jpg','NSFWCG/ç™½å¤©æ— äººæ²™æ»©å•è…¿ç«™ç«‹.jpg','NSFWCG/ç™½å¤©æ²™æ»©åŒè…¿ç«–ç›´å‘ä¸Šæ­£é¢.jpg','NSFWCG/ç™½å¤©æ²™æ»©å²©çŸ³æ‰¶è…¿æ­£é¢.jpg','NSFWCG/ç™½å¤©æ²™æ»©æ­£é¢æ€è£™.jpg','ä¸Šå­¦è·¯ä¸Š/å¤œæ™šå…³ç¯.jpg','ä¸Šå­¦è·¯ä¸Š/å¤œæ™šå¼€ç¯.jpg','ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg','ä¸Šå­¦è·¯ä¸Š/é»„æ˜.jpg','ä¹¦åº—.jpg','ä¹¦åº—å†….jpg','ä¹¦åº—å†…/ä¹¦åº—.jpg','ä¹¦åº—å†…/ä¹¦åº—å†….jpg','ä½å®…è¡—/å¤œæ™šå…³ç¯.jpg','ä½å®…è¡—/å¤œæ™šå¼€ç¯.jpg','ä½å®…è¡—/ç™½å¤©.jpg','ä½å®…è¡—/é»„æ˜.jpg','ä½æ‰€å®¢å…/å¤œæ™šå…³ç¯.jpg','ä½æ‰€å®¢å…/å¤œæ™šå¼€ç¯.jpg','ä½æ‰€å®¢å…/ç™½å¤©.jpg','ä½æ‰€å®¢å…/é»„æ˜.jpg','ä½æ‰€ç„å…³/å¤œæ™šå…³ç¯.jpg','ä½æ‰€ç„å…³/å¤œæ™šå¤œç¯.jpg','ä½æ‰€ç„å…³/å¤œæ™šå¼€ç¯.jpg','ä½æ‰€ç„å…³/ç™½å¤©.jpg','ä½æ‰€ç„å…³/é»„æ˜.jpg','ä¾¿åˆ©åº—å†….jpg','ä¾¿åˆ©åº—å†…/ä¾¿åˆ©åº—.jpg','ä¾¿åˆ©åº—å†…/ä¾¿åˆ©åº—å†….jpg','å…¬å›­/å¤œæ™šå¼€ç¯.jpg','å…¬å›­/ç™½å¤©.jpg','å…¬å›­/é»„æ˜.jpg','å…¬å›­å‡‰äº­/å¤œæ™šå¼€ç¯.jpg','å…¬å›­å‡‰äº­/ç™½å¤©.jpg','å…¬å›­å‡‰äº­/é»„æ˜.jpg','å…¬å›­å•†åº—äº­/å¤œæ™šå¼€ç¯.jpg','å…¬å›­å•†åº—äº­/ç™½å¤©.jpg','å…¬å›­å•†åº—äº­/é»„æ˜.jpg','å’–å•¡å…/å¤œæ™šå¼€ç¯.jpg','å’–å•¡å…/ç™½å¤©.jpg','å’–å•¡å…/é»„æ˜.jpg','å•†åº—è¡—/å¤œæ™šå¼€ç¯.jpg','å•†åº—è¡—/ç™½å¤©.jpg','å•†åº—è¡—/é»„æ˜.jpg','å›¾ä¹¦é¦†.jpg','å›¾ä¹¦é¦†/å›¾ä¹¦é¦†.jpg','å›¾ä¹¦é¦†/å›¾ä¹¦é¦†å†….jpg','å›¾ä¹¦é¦†/æ™šä¸Š.jpg','å›¾ä¹¦é¦†/ç™½å¤©.jpg','å›¾ä¹¦é¦†å†….jpg','å›¾ä¹¦é¦†å†…/å›¾ä¹¦é¦†.jpg','å›¾ä¹¦é¦†å†…/å›¾ä¹¦é¦†å†….jpg','å›¾ä¹¦é¦†å†…/æ™šä¸Š.jpg','å›¾ä¹¦é¦†å†…/ç™½å¤©.jpg','åœ°é“å†…/å¤œæ™šå¼€ç¯.jpg','åœ°é“å†…/ç™½å¤©.jpg','åœ°é“å†…/é»„æ˜.jpg','åœ°é“ç«™.jpg','åœ°é“ç«™å†….jpg','åœ°é“ç«™å†…/åœ°é“ç«™.jpg','åœ°é“ç«™å†…/åœ°é“ç«™å†….jpg','åŸå¸‚ä¸­çš„é“è·¯é“å£/å¤œæ™šå¼€ç¯.jpg','åŸå¸‚ä¸­çš„é“è·¯é“å£/ç™½å¤©.jpg','åŸå¸‚ä¸­çš„é“è·¯é“å£/é»„æ˜.jpg','åŸé•‡è¡—é“ä¸Š/å¤œæ™šå…³ç¯.jpg','åŸé•‡è¡—é“ä¸Š/å¤œæ™šå¼€ç¯.jpg','åŸé•‡è¡—é“ä¸Š/ç™½å¤©.jpg','åŸé•‡è¡—é“ä¸Š/é»„æ˜.jpg','å¥³ç”Ÿæˆ¿é—´/å¤œæ™šå…³ç¯.jpg','å¥³ç”Ÿæˆ¿é—´/å¤œæ™šå¤œç¯.jpg','å¥³ç”Ÿæˆ¿é—´/å¤œæ™šå¼€ç¯.jpg','å¥³ç”Ÿæˆ¿é—´/ç™½å¤©.jpg','å¥³ç”Ÿæˆ¿é—´/é»„æ˜.jpg','å­¦æ ¡ä¸­åº­/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡ä¸­åº­/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡ä¸­åº­/ç™½å¤©.jpg','å­¦æ ¡ä¸­åº­/é»„æ˜.jpg','å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/ç™½å¤©.jpg','å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg','å­¦æ ¡å¤©å°/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡å¤©å°/ç™½å¤©.jpg','å­¦æ ¡å¤©å°/é»„æ˜.jpg','å­¦æ ¡å±‹é¡¶/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡å±‹é¡¶/ç™½å¤©.jpg','å­¦æ ¡å±‹é¡¶/é»„æ˜.jpg','å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg','å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/é»„æ˜.jpg','å­¦æ ¡æ•™å®¤/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡æ•™å®¤/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡æ•™å®¤/ç™½å¤©.jpg','å­¦æ ¡æ•™å®¤/é»„æ˜.jpg','å­¦æ ¡æ¥¼æ¢¯/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡æ¥¼æ¢¯/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡æ¥¼æ¢¯/ç™½å¤©.jpg','å­¦æ ¡æ¥¼æ¢¯/é»„æ˜.jpg','å­¦æ ¡æ­£é—¨å‰/å¤œæ™šå…³ç¯.jpg','å­¦æ ¡æ­£é—¨å‰/å¤œæ™šå¼€ç¯.jpg','å­¦æ ¡æ­£é—¨å‰/ç™½å¤©.jpg','å­¦æ ¡æ­£é—¨å‰/é»„æ˜.jpg','åº™ä¼šå°åƒè¡—/å¤œæ™šå¼€ç¯.jpg','åº™ä¼šå°åƒè¡—/ç™½å¤©.jpg','åº™ä¼šå°åƒè¡—/é»„æ˜.jpg','æ‹±å»Šå•†åº—è¡—/å¤œæ™šå¼€ç¯.jpg','æ‹±å»Šå•†åº—è¡—/ç™½å¤©.jpg','æ‹±å»Šå•†åº—è¡—/é»„æ˜.jpg','æ•™å®¤/å¤œæ™šå…³ç¯.jpg','æ•™å®¤/å¤œæ™šå¼€ç¯.jpg','æ•™å®¤/ç™½å¤©.jpg','æ•™å®¤/é»„æ˜.jpg','æ²³æ—/å¤œæ™šå…³ç¯.jpg','æ²³æ—/ç™½å¤©.jpg','æ²³æ—/é»„æ˜.jpg','æµ·æ»©/å¤œæ™šå…³ç¯.jpg','æµ·æ»©/ç™½å¤©.jpg','æµ·æ»©/é»„æ˜.jpg','ç”·ç”Ÿæˆ¿é—´/å¤œæ™šå…³ç¯.jpg','ç”·ç”Ÿæˆ¿é—´/å¤œæ™šå¼€ç¯.jpg','ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg','ç”·ç”Ÿæˆ¿é—´/é»„æ˜.jpg','ç¹åå•†ä¸šè¡—/å¤œæ™šå¼€ç¯.jpg','ç¹åå•†ä¸šè¡—/ç™½å¤©.jpg','ç¹åå•†ä¸šè¡—/é»„æ˜.jpg','ç¾æœ¯é¦†/å¤œæ™šå…³ç¯.jpg','ç¾æœ¯é¦†/ç™½å¤©.jpg','è´­ç‰©ä¸­å¿ƒ/å¤œæ™šå…³ç¯.jpg','è´­ç‰©ä¸­å¿ƒ/ç™½å¤©.jpg','è´­ç‰©ä¸­å¿ƒ/é»„æ˜.jpg','è´­ç‰©ä¸­å¿ƒäºŒå±‚/è´­ç‰©ä¸­å¿ƒäºŒå±‚.jpg','é¤é¦†/å¤œæ™šå¼€ç¯.jpg','é¤é¦†/ç™½å¤©.jpg','é¤é¦†/é»„æ˜.jpg'],I=['æ— äºº.png','å¼€è¡«/æ— äºº.png','å¼€è¡«/æ“¦çœ¼æ³ª.png','å¼€è¡«/å¾®ç¬‘.png','å¼€è¡«/ç¨å¾®è„¸çº¢.png','å¼€è¡«/é‚ªæ¶çš„ç¬‘å®¹.png','å¼€è¡«/ç­‰å¾…å».png','å¼€è¡«/æ‰‹æ‰˜ä¸‹å·´æ€è€ƒ.png','å¼€è¡«/å“­æ³£.png','å¼€è¡«/æµ…ç¬‘.png','å¼€è¡«/æµå£æ°´.png','å¼€è¡«/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png','å¼€è¡«/æ˜Ÿæ˜Ÿçœ¼.png','å¼€è¡«/çŒ«çˆªç”Ÿæ°”.png','å¼€è¡«/æ— è¡¨æƒ….png','å¼€è¡«/å®³ç¾.png','å¼€è¡«/æ™•æ™•çœ¼.png','å¼€è¡«/æƒŠè®¶.png','å¼€è¡«/æ€§é«˜æ½®.png','å¼€è¡«/ç”Ÿæ°”.png','æ°´æ‰‹æœ/æ— äºº.png','æ°´æ‰‹æœ/æ“¦çœ¼æ³ª.png','æ°´æ‰‹æœ/å¾®ç¬‘.png','æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png','æ°´æ‰‹æœ/ç­‰å¾…å».png','æ°´æ‰‹æœ/æ‰‹æ‰˜ä¸‹å·´æ€è€ƒ.png','æ°´æ‰‹æœ/å“­æ³£.png','æ°´æ‰‹æœ/æµ…ç¬‘.png','æ°´æ‰‹æœ/æµå£æ°´.png','æ°´æ‰‹æœ/é‚ªæ¶çš„åç¬‘.png','æ°´æ‰‹æœ/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png','æ°´æ‰‹æœ/æ˜Ÿæ˜Ÿçœ¼.png','æ°´æ‰‹æœ/çŒ«çˆªç”Ÿæ°”.png','æ°´æ‰‹æœ/æ— è¡¨æƒ….png','æ°´æ‰‹æœ/å®³ç¾.png','æ°´æ‰‹æœ/æ™•æ™•çœ¼.png','æ°´æ‰‹æœ/æƒŠè®¶.png','æ°´æ‰‹æœ/çœ¼ç¥ç©ºæ´çš„å‚¬çœ çŠ¶æ€.png','æ°´æ‰‹æœ/æ€§é«˜æ½®.png','æ°´æ‰‹æœ/ç”Ÿæ°”.png','æ ¼çº¹è¡«/æ— äºº.png','æ ¼çº¹è¡«/æ“¦çœ¼æ³ª.png','æ ¼çº¹è¡«/å¾®ç¬‘.png','æ ¼çº¹è¡«/ç¨å¾®è„¸çº¢.png','æ ¼çº¹è¡«/ç­‰å¾…å».png','æ ¼çº¹è¡«/æ‰‹æ‰˜ä¸‹å·´æ€è€ƒ.png','æ ¼çº¹è¡«/å“­æ³£.png','æ ¼çº¹è¡«/æµ…ç¬‘.png','æ ¼çº¹è¡«/æµå£æ°´.png','æ ¼çº¹è¡«/é‚ªæ¶çš„åç¬‘.png','æ ¼çº¹è¡«/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png','æ ¼çº¹è¡«/æ˜Ÿæ˜Ÿçœ¼.png','æ ¼çº¹è¡«/çŒ«çˆªç”Ÿæ°”.png','æ ¼çº¹è¡«/å®³ç¾.png','æ ¼çº¹è¡«/æ™•æ™•çœ¼.png','æ ¼çº¹è¡«/æƒŠè®¶.png','æ ¼çº¹è¡«/çœ¼ç¥ç©ºæ´çš„å‚¬çœ çŠ¶æ€.png','æ ¼çº¹è¡«/æ€§é«˜æ½®.png','æ ¼çº¹è¡«/ç”Ÿæ°”.png','ç¡è¡£/æ— äºº.png','ç¡è¡£/å¾®ç¬‘.png','ç¡è¡£/ç¨å¾®è„¸çº¢.png','ç¡è¡£/ç­‰å¾…å».png','ç¡è¡£/å“­æ³£.png','ç¡è¡£/æµ…ç¬‘.png','ç¡è¡£/æµå£æ°´.png','ç¡è¡£/é‚ªæ¶çš„åç¬‘.png','ç¡è¡£/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png','ç¡è¡£/æ˜Ÿæ˜Ÿçœ¼.png','ç¡è¡£/çŒ«çˆªç”Ÿæ°”.png','ç¡è¡£/å®³ç¾.png','ç¡è¡£/æ™•æ™•çœ¼.png','ç¡è¡£/æƒŠè®¶.png','ç¡è¡£/çœ¼ç¥ç©ºæ´çš„å‚¬çœ çŠ¶æ€.png','ç¡è¡£/æ€§é«˜æ½®.png','ç¡è¡£/ç”Ÿæ°”.png','å…¨è£¸/æ— äºº.png','å…¨è£¸/åç¬‘.png','å…¨è£¸/ç¨å¾®è„¸çº¢.png','å…¨è£¸/å“­æ³£.png','å…¨è£¸/æµ…ç¬‘.png','å…¨è£¸/æµå£æ°´.png','å…¨è£¸/é‚ªæ¶çš„åç¬‘.png','å…¨è£¸/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png','å…¨è£¸/æ˜Ÿæ˜Ÿçœ¼.png','å…¨è£¸/ç­‰å¾…æ¥å».png','å…¨è£¸/å®³ç¾.png','å…¨è£¸/æ™•æ™•çœ¼.png','å…¨è£¸/æƒŠè®¶.png','å…¨è£¸/çœ¼ç¥ç©ºæ´çš„å‚¬çœ çŠ¶æ€.png','å…¨è£¸/æ€§é«˜æ½®.png','å…¨è£¸/ç”Ÿæ°”.png'];function O(e){const n='https://testingcf.jsdelivr.net/gh/lolo-desu/lolocard/src/æ—¥è®°ç»œç»œ/å›¾ç‰‡';return I.includes(e)?`${n}/ç«‹ç»˜/${e}`:D.includes(e)?`${n}/èƒŒæ™¯/${e}`:null}const U='undefined'!=typeof window&&'undefined'!=typeof document;'undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString;function R(e){const n=Object.create(null);return t=>n[t]||(n[t]=e(t))}const L=/\B([A-Z])/g,P=(R(e=>e.replace(L,'-$1').toLowerCase()),/-(\w)/g),H=R(e=>e.replace(P,(_,e)=>e?e.toUpperCase():''));function Y(e,n,t){return(0,v.watch)(e,n,{...t,immediate:!0})}function J(e={}){const{inheritAttrs:n=!0}=e,t=(0,v.shallowRef)(),a=(0,v.defineComponent)({setup:(_,{slots:e})=>()=>{t.value=e.default}}),r=(0,v.defineComponent)({inheritAttrs:n,props:e.props,setup:(a,{attrs:r,slots:o})=>()=>{var s;t.value;const i=null==(s=t.value)?void 0:s.call(t,{...null==e.props?q(r):a,$slots:o});return n&&1===(null==i?void 0:i.length)?i[0]:i}});return function(e,n){if('undefined'!=typeof Symbol){const t={...e};return Object.defineProperty(t,Symbol.iterator,{enumerable:!1,value(){let e=0;return{next:()=>({value:n[e++],done:e>n.length})}}}),t}return Object.assign([...n],e)}({define:a,reuse:r},[a,r])}function q(e){const n={};for(const t in e)n[H(t)]=e[t];return n}U&&window,U&&window.document,U&&window.navigator,U&&window.location;Symbol('vueuse-ssr-width');'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof self&&self;Number.POSITIVE_INFINITY;const X={type:'button',class:'text-16px rounded-lg border border-white/70 bg-white/85 px-3 py-1.5 font-bold tracking-[0.15em] text-[#7d5b65] shadow-[0_6px_16px_rgba(0,0,0,0.10)] transition-[transform,opacity,background-color] duration-200 hover:-translate-y-0.5 hover:bg-white/95 active:translate-y-0'},K=(0,v.defineComponent)({__name:'ControlBar',setup(e){const[n,t]=J(),a=G(),r=(0,v.computed)(()=>a.current_dialog.background.includes('CG')?O(a.current_dialog.background):null);return(e,o)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',{class:'absolute top-4 right-4 z-40 flex items-center gap-2',onClick:o[4]||(o[4]=(0,v.withModifiers)(()=>{},['stop']))},[(0,v.createVNode)((0,v.unref)(n),null,{default:(0,v.withCtx)(({text:e})=>[(0,v.createElementVNode)('button',X,(0,v.toDisplayString)(e),1)]),_:1}),(0,v.createVNode)((0,v.unref)(t),{text:(0,v.unref)(a).has_ended?'é‡æ’­':`${(0,v.unref)(a).current_index+1}/${(0,v.unref)(a).dialogs.length}${(0,v.unref)(a).during_streaming?'?':''}`,onClick:o[0]||(o[0]=(0,v.withModifiers)(e=>(0,v.unref)(a).restart(),['stop']))},null,8,['text']),(0,v.createVNode)((0,v.unref)(t),{text:'æ—¥å¿—',onClick:o[1]||(o[1]=(0,v.withModifiers)(e=>(0,v.unref)(a).history_opened=!0,['stop']))}),(0,v.createVNode)((0,v.unref)(t),{text:(0,v.unref)(a).dialog_opened?'éšè—UI':'æ˜¾ç¤ºUI',onClick:o[2]||(o[2]=(0,v.withModifiers)(e=>(0,v.unref)(a).dialog_opened=!(0,v.unref)(a).dialog_opened,['stop']))},null,8,['text']),(0,v.unref)(r)?((0,v.openBlock)(),(0,v.createBlock)((0,v.unref)(t),{key:0,text:'æ”¾å¤§',onClick:o[3]||(o[3]=(0,v.withModifiers)(e=>function(){const e=$('<img>').addClass('img_enlarged').attr('src',r.value).on('click',function(e){$(this).toggleClass('zoomed'),e.stopPropagation()}),n=$('<div>').addClass('img_enlarged_container').append($('<div>').addClass('img_enlarged_holder').append(e)),t=new SillyTavern.Popup(n[0],SillyTavern.POPUP_TYPE.DISPLAY,'',{large:!0,transparent:!0});t.dlg.style.width='unset',t.dlg.style.height='unset',t.dlg.addEventListener('click',()=>{t.completeCancelled()}),t.show()}(),['stop']))})):(0,v.createCommentVNode)('v-if',!0)]))}}),Q={class:'absolute inset-x-0 bottom-0 z-30 w-full'},Z={class:'relative px-[6%] pt-[44px] pb-[4%]'},ee={class:'flex items-end justify-between'},ne={class:'min-h-[33px] text-[22px] font-extrabold tracking-[0.08em] text-[#4d2b35] [text-shadow:0_1px_1px_rgba(255,255,255,0.92),0_3px_10px_rgba(0,0,0,0.08)]'},te=(0,v.defineComponent)({__name:'DialogBox',setup(e,{expose:n}){const t=G(),a=(0,v.useTemplateRef)('box'),r=(0,v.useTemplateRef)('content'),o=(0,v.ref)(38);function s(){if(!a.value||!r.value)return;const e=a.value.getBoundingClientRect(),n=r.value.getBoundingClientRect();o.value=Math.max(0,Math.round(n.top-e.top))}(0,v.watch)(()=>t.current_index,s);const i=new ResizeObserver(s);(0,v.onMounted)(()=>{s(),a.value&&i.observe(a.value),r.value&&i.observe(r.value)}),(0,v.onBeforeUnmount)(()=>{i.disconnect()});const p=(0,v.ref)(!1);let g,d;async function u(){m(),await(0,v.nextTick)(),p.value=!0,g=c.create(r.value,{type:'chars'}),d=l.from(g.chars,{opacity:0,duration:.1,ease:'power4',stagger:.04,onComplete:()=>{p.value=!1}})}function m(){p.value=!1,g?.revert(),g?.kill(),d?.revert(),d?.kill()}return l.registerPlugin(c),(0,v.watch)(()=>t.current_index,u),(0,v.onMounted)(()=>{u()}),n({is_typing:p,stopTyping:m}),(e,n)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',Q,[(0,v.createElementVNode)('div',{ref:'box',class:'relative w-full',style:(0,v.normalizeStyle)({'--dialog-fade-end':`${(0,v.unref)(o)}px`})},[n[1]||(n[1]=(0,v.createElementVNode)('div',{class:'absolute inset-0 bg-[linear-gradient(to_bottom,rgba(255,240,245,0)_0px,rgba(255,240,245,0.93)_var(--dialog-fade-end,38px),rgba(255,240,245,0.93)_100%)]'},null,-1)),(0,v.createElementVNode)('div',Z,[(0,v.createElementVNode)('div',ee,[(0,v.createElementVNode)('div',ne,(0,v.toDisplayString)((0,v.unref)(t).current_dialog.speaker),1)]),n[0]||(n[0]=(0,v.createElementVNode)('div',{class:'mt-2 mb-3 h-px w-full bg-[#c18e98]/70'},null,-1)),(0,v.createElementVNode)('div',{ref:'content',class:'relative min-h-[3.5em] text-[16px] leading-[1.65] tracking-[0.25px] text-[#4d2b35] [text-shadow:0_1px_1px_rgba(255,255,255,0.92)]'},(0,v.toDisplayString)((0,v.unref)(t).current_dialog.speech),513)])],4)]))}}),ae={class:'flex items-center justify-between border-b border-white/50 bg-linear-to-r from-[#ffd0d8]/80 to-[#ffbbc8]/80 px-5 py-3 font-bold text-[#7d5b65] [text-shadow:0_1px_1px_rgba(255,255,255,0.6)]'},re={ref:'content',class:'flex-1 overflow-y-auto p-5 text-[#4d2b35]'},oe={key:0,class:'py-5 text-center text-[#7d5b65]'},se={key:0,class:'mb-2 inline-flex items-center gap-1 font-bold text-[#c18e98]'},ie={class:'text-[18px]'},pe={class:'text-[16px] leading-6 tracking-[0.3px] wrap-anywhere text-[#4d2b35]'},le=(0,v.defineComponent)({__name:'HistoryPanel',setup(e){const n=G(),t=(0,v.useTemplateRef)('content');return(0,v.onMounted)(()=>{t.value&&$(t.value).scrollTop($(t.value).prop('scrollHeight'))}),(e,t)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',{class:'fixed top-[5%] left-[5%] z-1000 flex h-[90%] w-[90%] flex-col overflow-hidden rounded-[15px] border border-white/80 bg-linear-to-br from-rose-50/95 to-rose-100/95 shadow-[0_8px_30px_rgba(145,125,138,0.25),0_0_0_1px_rgba(255,255,255,0.6)_inset] backdrop-blur-lg',onClick:t[1]||(t[1]=(0,v.withModifiers)(()=>{},['stop']))},[(0,v.createElementVNode)('div',ae,[t[2]||(t[2]=(0,v.createElementVNode)('h3',{class:'m-0 text-base'},'ğ•ƒğ•†ğ”¾',-1)),(0,v.createElementVNode)('button',{type:'button',class:'text-2xl text-[#c18e98] transition-transform hover:scale-110 hover:text-[#a16e78]',onClick:t[0]||(t[0]=(0,v.withModifiers)(e=>(0,v.unref)(n).history_opened=!1,['stop']))},' âŠ— ')]),(0,v.createElementVNode)('div',re,[0===(0,v.unref)(n).history_dialogs.length?((0,v.openBlock)(),(0,v.createElementBlock)('div',oe,'æš‚æ— å¯¹è¯å†å²')):(0,v.createCommentVNode)('v-if',!0),((0,v.openBlock)(!0),(0,v.createElementBlock)(v.Fragment,null,(0,v.renderList)((0,v.unref)(n).history_dialogs,(e,n)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',{key:n,class:'mb-4 rounded-xl bg-white/60 p-4 shadow-[0_2px_8px_rgba(0,0,0,0.05),0_0_0_1px_rgba(255,255,255,0.7)_inset] transition-transform duration-200 hover:-translate-y-0.5'},[e.speaker?((0,v.openBlock)(),(0,v.createElementBlock)('div',se,[t[3]||(t[3]=(0,v.createElementVNode)('span',{class:'text-sm text-[#ffb0c0]'},'â€',-1)),(0,v.createElementVNode)('span',ie,(0,v.toDisplayString)(e.speaker),1)])):(0,v.createCommentVNode)('v-if',!0),(0,v.createElementVNode)('div',pe,(0,v.toDisplayString)(e.speech),1)]))),128))],512)]))}}),ce=['src'],ge=(0,v.defineComponent)({__name:'CharacterLayer',setup(e){const n=G(),t=(0,v.computed)(()=>{const e=n.current_dialog.characters;return e.map((t,a)=>({id:t.id,url:O(t.tachie)??'',is_speaking:n.current_dialog.speaker===t.id,position:`${Math.round((a+1)/(e.length+1)*100)}%`})).filter(e=>e.url)});return(e,n)=>((0,v.openBlock)(!0),(0,v.createElementBlock)(v.Fragment,null,(0,v.renderList)((0,v.unref)(t),e=>((0,v.openBlock)(),(0,v.createElementBlock)('img',{key:e.id,class:(0,v.normalizeClass)(['absolute bottom-0 h-[95%] max-h-[95%] w-auto -translate-x-1/2 object-contain drop-shadow-[0_0_5px_rgba(0,0,0,0.2)] transition-[opacity,transform,filter,left,right] duration-500 ease-out',[{'brightness-[0.85] contrast-[0.95]':!e.is_speaking},`left-[${e.position}]`]]),src:e.url},null,10,ce))),128))}}),de=ge,ue={class:'absolute inset-0'},me=['src'],fe={class:'pointer-events-none absolute inset-0'},he=(0,v.defineComponent)({__name:'SceneStage',setup(e){const n=G(),t=(0,v.computed)(()=>n.current_dialog.background),a=(0,v.computed)(()=>O(t.value)??'');return(e,r)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',ue,[(0,v.createVNode)(v.Transition,{name:(0,v.unref)(n).current_index>0?'bg-fade':'bg-instant'},{default:(0,v.withCtx)(()=>[(0,v.unref)(a)?((0,v.openBlock)(),(0,v.createElementBlock)('img',{key:(0,v.unref)(t),src:(0,v.unref)(a),class:'absolute inset-0 h-full w-full object-cover'},null,8,me)):(0,v.createCommentVNode)('v-if',!0)]),_:1},8,['name']),(0,v.createElementVNode)('div',fe,[(0,v.createVNode)(de)])]))}});m(324);const be=(0,B.A)(he,[['__scopeId','data-v-e2db30e0']]),ve={class:'relative flex h-full w-full flex-col overflow-hidden rounded-xl'},_e={class:'relative flex flex-1 flex-col overflow-hidden rounded-lg bg-white'},xe={class:'relative flex-1 overflow-hidden bg-black'},je=(0,v.defineComponent)({__name:'App',setup(e){const n=x(),t=(0,v.useTemplateRef)('dialog_box'),a=G();function r(){a.history_opened||a.has_ended||(t.value?.is_typing?t.value.stopTyping():a.advance())}return Y(()=>n.during_streaming,e=>{a.during_streaming=e}),Y(()=>n.message,e=>{a.loadMessage(e)}),(e,n)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',{class:'mx-auto aspect-video w-full max-w-[1200px] select-none max-md:aspect-3/4',onClick:r},[(0,v.createElementVNode)('div',ve,[(0,v.createElementVNode)('div',_e,[n[3]||(n[3]=(0,v.createElementVNode)('div',{class:'relative flex h-[5.5%] items-center justify-center rounded-t-lg bg-linear-to-r from-[#ffd0d8] to-[#ffbbc8] text-[12px] font-bold text-[#7d6b6e] [text-shadow:0px_1px_1px_rgba(255,255,255,0.5)] max-md:h-5'},[(0,v.createElementVNode)('span',{class:'absolute left-4 text-[18px] text-[#c18e98]'},'â€'),(0,v.createTextVNode)(' ã€âºâŠ¹ğ’ğ’¢ğ’¯ğ’¾ğ“‚â„¯Êšà·†Éâ‚Šã€ '),(0,v.createElementVNode)('span',{class:'absolute right-4 text-[14px] text-[#c18e98]'},'âœ§*:ï½¥ï¾Ÿâœ§')],-1)),(0,v.createElementVNode)('div',xe,[(0,v.createVNode)(be),n[1]||(n[1]=(0,v.createElementVNode)('div',{class:'pointer-events-none absolute top-4 right-4 z-20 hidden h-12 w-12 items-center justify-center text-2xl text-[#ffb0c0] opacity-80 md:flex'},' â™¡ ',-1)),n[2]||(n[2]=(0,v.createElementVNode)('div',{class:'pointer-events-none absolute bottom-20 left-4 z-20 hidden h-12 w-12 items-center justify-center text-2xl text-[#ffb0c0] opacity-80 md:flex'},' âœ¿ ',-1)),(0,v.unref)(a).has_ended?((0,v.openBlock)(),(0,v.createBlock)(T,{key:0})):(0,v.createCommentVNode)('v-if',!0),(0,v.withDirectives)((0,v.createVNode)(te,{ref:'dialog_box'},null,512),[[v.vShow,(0,v.unref)(a).dialog_opened]]),(0,v.unref)(a).history_opened?((0,v.openBlock)(),(0,v.createElementBlock)(v.Fragment,{key:1},[(0,v.createElementVNode)('div',{class:'fixed inset-0 z-900 bg-black/35 transition-opacity duration-200',onClick:n[0]||(n[0]=(0,v.withModifiers)(()=>{},['stop']))}),(0,v.createVNode)(le)],64)):(0,v.createCommentVNode)('v-if',!0),(0,v.createVNode)(K)])])])]))}}),ye=['innerHTML'],ke=(0,v.defineComponent)({__name:'Text',props:{transformer:{type:Function}},setup(e){const n=e,t=x(),a=(0,v.computed)(()=>n.transformer(t.message)),r=(0,v.computed)(()=>formatAsDisplayedMessage(a.value,{message_id:t.message_id}));return(e,n)=>((0,v.openBlock)(),(0,v.createElementBlock)(v.Fragment,null,[(0,v.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),(0,v.unref)(a)?((0,v.openBlock)(),(0,v.createElementBlock)('div',{key:0,innerHTML:(0,v.unref)(r)},null,8,ye)):(0,v.createCommentVNode)('v-if',!0)],2112))}});const Ce=k.z.object({ä¸–ç•Œ:k.z.object({å½“å‰æ—¶é—´:k.z.templateLiteral([k.z.coerce.number(),':',k.z.coerce.number()]),_å½“å‰æ—¶é—´é˜¶æ®µ:k.z.enum(['å‡Œæ™¨','æ—©æ™¨','ä¸Šåˆ','ä¸­åˆ','ä¸‹åˆ','æ™šä¸Š','æ·±å¤œ']).optional(),å½“å‰æ—¥æœŸ:k.z.string(),å½“å‰æ˜ŸæœŸ:k.z.templateLiteral([k.z.literal('æ˜ŸæœŸ'),k.z.enum(['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','æ—¥'])]),æ˜¯å¦éœ€è¦ä¸Šå­¦:k.z.boolean().prefault(!0),æ˜¯å¦å¤„äºNSFWåœºæ™¯:k.z.boolean().prefault(!1),ä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©:k.z.enum(['çº¯æ–‡å­—å°¾é™„ç«‹ç»˜','å±•ç¤ºæ—¥è®°','galgame']).prefault('çº¯æ–‡å­—å°¾é™„ç«‹ç»˜')}).transform(e=>{const n=e.å½“å‰æ—¶é—´.split(':').map(Number).reduce((e,n)=>60*e+n,0);return e._å½“å‰æ—¶é—´é˜¶æ®µ=n<300?'å‡Œæ™¨':n<360?'æ—©æ™¨':n<720?'ä¸Šåˆ':n<840?'ä¸­åˆ':n<1020?'ä¸‹åˆ':n<1200?'æ™šä¸Š':'æ·±å¤œ','æ˜ŸæœŸå…­'!==e.å½“å‰æ˜ŸæœŸ&&'æ˜ŸæœŸæ—¥'!==e.å½“å‰æ˜ŸæœŸ||(e.æ˜¯å¦éœ€è¦ä¸Šå­¦=!1),e}),ä¸»çº¿äº‹ä»¶:k.z.discriminatedUnion('å½“å‰çŠ¶æ€',[k.z.object({å½“å‰çŠ¶æ€:k.z.literal('æ— æ³•è§¦å‘')}),k.z.object({å½“å‰çŠ¶æ€:k.z.literal('å†·å´ä¸­'),å‰©ä½™å†·å´å›åˆæ•°:k.z.coerce.number().nonnegative().prefault(20)}),k.z.object({å½“å‰çŠ¶æ€:k.z.literal('è¿›è¡Œä¸­'),å½“å‰é˜¶æ®µ:k.z.enum(['å¼•å…¥','å‘å±•','é«˜æ½®','ç»“å±€']).prefault('å¼•å…¥'),ä¸»é¢˜:k.z.string(),æè¿°:k.z.string(),å¤§çº²:k.z.object({å¼•å…¥:k.z.string(),å‘å±•:k.z.string(),é«˜æ½®:k.z.string(),ç»“å±€:k.z.string()})})]).prefault({å½“å‰çŠ¶æ€:'æ— æ³•è§¦å‘'}),ç»œç»œ:k.z.object({äº²å¯†åº¦:k.z.coerce.number().transform(e=>_.clamp(e,0,100)),é˜…è¯»æ—¥è®°æ•°é‡:k.z.coerce.number().nonnegative().prefault(0),æ‹¥æœ‰è”ç³»æ–¹å¼:k.z.boolean().prefault(!1)})}).transform(e=>(e.ç»œç»œ.äº²å¯†åº¦<50?e.ä¸»çº¿äº‹ä»¶.å½“å‰çŠ¶æ€='æ— æ³•è§¦å‘':'æ— æ³•è§¦å‘'===e.ä¸»çº¿äº‹ä»¶.å½“å‰çŠ¶æ€&&(e.ä¸»çº¿äº‹ä»¶={å½“å‰çŠ¶æ€:'å†·å´ä¸­',å‰©ä½™å†·å´å›åˆæ•°:0}),e));$(()=>{g(Ce)});const Se='ã€ã€lolodesuã€‘ã€‘\nå¦‚æœçœ‹ä¸åˆ°ä¸Šæ–¹çš„ç•Œé¢ï¼Œè¯·ä¸‹è½½æˆ–æ›´æ–°å‰ç«¯åŠ©æ‰‹ï¼šhttps://gitlab.com/novi028/JS-Slash-Runner\n';const we=[{name:'ğŸ•›åº¦è¿‡',function:async()=>{const e={æ™¨é—´:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªæ™¨é—´',è¯¾ä¸Š:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªè¯¾ä¸Š',åˆä¼‘:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªåˆä¼‘',æ”¾å­¦å:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªæ”¾å­¦å',å¤œé—´:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªå¤œé—´',å‡æ—¥:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ä¸‹ä¸ªå‡æ—¥',ç¬¬äºŒå¤©:'å…ˆæå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å¿«é€Ÿå°†æ—¶é—´è°ƒæ•´åˆ°ç¬¬äºŒå¤©ï¼Œå¹¶è°ƒæ•´å½“å‰æ—¶é—´é˜¶æ®µå˜é‡åˆ°æ¥ä¸‹æ¥æ•…äº‹æƒ…èŠ‚æœ€æœ‰æ„ä¹‰çš„æ—¶é—´ï¼Œä¸‹ä¸€æ¬¡å“åº”çš„æ—¶é—´é˜¶æ®µå˜é‡è°ƒæ•´æ²¡æœ‰ä»»ä½•é™åˆ¶'},n=await triggerSlash(`/buttons labels=${JSON.stringify(Object.keys(e))} æ—¶é—´æ¥åˆ°äº†...`);_.has(e,n)&&await triggerSlash(`/send ${e[n]} || /trigger`)}},{name:'ğŸ—ºï¸åœ°ç‚¹',function:async()=>{const e={ä½å®…:{æ—ç™½:'å›å®¶ï¼',åœ°ç‚¹:['ä½æ‰€ç„å…³','ä½æ‰€å®¢å…','æˆ¿é—´']},å­¦æ ¡:{æ—ç™½:'å»å­¦æ ¡å—...',åœ°ç‚¹:['ä¸Šå­¦è·¯ä¸Š','å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰','æ•™å®¤','å­¦æ ¡ä¸­åº­','å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯','å­¦æ ¡å±‹é¡¶']},åŸé•‡ä¸è¡—é“:{æ—ç™½:'å»é€›é€›å‘¢...',åœ°ç‚¹:['åŸé•‡è¡—é“ä¸Š','ä½å®…è¡—','å•†åº—è¡—','æ‹±å»Šå•†åº—è¡—','ç¹åå•†ä¸šè¡—','åŸå¸‚ä¸­çš„é“è·¯é“å£']},å•†ä¸šè®¾æ–½:{æ—ç™½:'å»çº¦ä¼šå—w...',åœ°ç‚¹:['ä¾¿åˆ©åº—å†…','ä¹¦åº—å†…','å’–å•¡å…','å®¶åº­é¤å…','è´­ç‰©ä¸­å¿ƒ','è´­ç‰©ä¸­å¿ƒäºŒå±‚','ç¾æœ¯é¦†','åœ°é“ç«™å†…','åœ°é“å†…','åº™ä¼šå°åƒè¡—']},æˆ·å¤–:{æ—ç™½:'é”»ç‚¼èº«ä½“...?',åœ°ç‚¹:['å…¬å›­','å…¬å›­å‡‰äº­','å…¬å›­å•†åº—äº­','æ²³æ—','æµ·æ»©']}},n=await triggerSlash(`/buttons labels=${JSON.stringify(Object.keys(e))} {{user}}å°†åŠ¨èº«å‰å¾€...`);if(!_.has(e,n))return;const{æ—ç™½:t,åœ°ç‚¹:a}=e[n],r=await triggerSlash(`/buttons labels=${JSON.stringify(a)} <small>${t}<small>`);a.includes(r)&&triggerSlash(`/send \x3c!--äºæœ¬æ¬¡å“åº”éœ€è¦æå†™ç»“æŸå½“å‰åœºæ™¯çš„å‰§æƒ…å†å†™å‡ºç†ç”±å‰å¾€ä¸‹ä¸€ä¸ªåœ°ç‚¹--\x3e[ç§»åŠ¨] {{user}}å‰å¾€äº†${r} || /trigger`)}}];function Ne(){return async function(){const e='çº¯ç™½è‰²çš„å›å“';JSON.parse(await triggerSlash('/qr-set-list')).includes(e)&&triggerSlash(`/qr-set-delete ${e}`)}(),we.forEach(e=>eventOn(getButtonEvent(e.name),e.function)),appendInexistentScriptButtons(we.map(e=>({name:e.name,visible:!0}))),{destroy:()=>replaceScriptButtons(getScriptButtons().filter(e=>we.some(n=>n.name===e.name)))}}const Ee={class:'roleplay_options'},Ge={class:'roleplay_options_back'},Ae=['onClick'],Fe={class:'roleplay_options_title'},$e={class:'roleplay_options_content'},ze=(0,v.defineComponent)({__name:'App',props:{messageId:{},options:{}},setup(e){const n=e,t=S();return(a,r)=>((0,v.openBlock)(),(0,v.createElementBlock)('div',Ee,[(0,v.createElementVNode)('div',Ge,[((0,v.openBlock)(!0),(0,v.createElementBlock)(v.Fragment,null,(0,v.renderList)(e.options,e=>((0,v.openBlock)(),(0,v.createElementBlock)('div',{key:e.title,class:'roleplay_options_item',tabindex:'1',onClick:a=>async function(e){if(getLastMessageId()===n.messageId)switch(t.config.é€‰æ‹©æ¡†è§¦å‘æ–¹å¼){case'ç›´æ¥å‘é€':triggerSlash(`/send ${e.content} || /trigger`);break;case'è¦†ç›–è¾“å…¥':triggerSlash(`/setinput ${e.content}`)}}(e)},[(0,v.createElementVNode)('span',Fe,[(0,v.createElementVNode)('strong',null,(0,v.toDisplayString)(e.title),1)]),r[0]||(r[0]=(0,v.createElementVNode)('hr',{class:'roleplay_options_hr'},null,-1)),(0,v.createElementVNode)('span',$e,(0,v.toDisplayString)(e.content),1)],8,Ae))),128))])]))}});const We=new Map,Ve='<roleplay_options>',Me=/<(roleplay_options)>\s*(?:```.*\n)?((?:(?!<\1>)[\s\S])*?)(?:\n```)?\s*<\/\1>/im;async function Be(e){if(isNaN(e))return;const n=getChatMessages(e);if(0===n.length)return;const t=(n[0].message??'').match(Me);if(!t)return;We.get(e)?.unmount(),We.delete(e);const a=retrieveDisplayedMessage(e),r=a.find(`pre:contains("${Ve}")`);if(r.length>0){const n=r.parent('.TH-render');n.length>0?n.addClass('hidden!'):r.addClass('hidden!');const o=(0,v.createApp)(ze,{messageId:e,options:[...t[2].matchAll(/(.+?)[:ï¼š]\s*(.+)/gm)].map(e=>({title:e[1],content:e[2].replace(/^\$\{(.+)\}$/,'$1').replace(/^ã€Œ(.+)ã€$/,'$1')}))}).use(s());We.set(e,o);const i=a.find(`div[script_id="${getScriptId()}"]`);o.mount(i.length>0?i[0]:$('<div>').attr('script_id',getScriptId()).appendTo(a)[0])}}async function Te(){We.forEach(e=>{e.unmount()}),We.clear(),$('#chat').children('.mes[is_user=\'false\'][is_system=\'false\']').each((e,n)=>{const t=Number($(n).attr('mesid')??'NaN');isNaN(t)||Be(t)})}function De(){const{destroy:e}=function(){const e=S(),n=()=>'æš—è‰²'===e.config.æ ·å¼ä¸»é¢˜?'.roleplay_options_hr{display:none}.roleplay_options_back{background:#332d30;border-radius:16px;box-shadow:0 8px 20px rgba(20,18,19,0.25);padding:22px 24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;border:1px solid #4a4447;width:90%;max-width:740px;margin:24px auto}.roleplay_options_item{position:relative;background:#403a3d;border-radius:12px;box-shadow:0 5px 15px rgba(20,18,19,0.2);padding:18px 20px;cursor:default;border:1px solid #4a4447;transition:all 0.28s cubic-bezier(0.22,1,0.36,1);overflow:hidden;display:flex;flex-direction:column;z-index:1;margin:0;color:#ffd0d8;font-weight:400;line-height:1.6;height:100%;font-family:\'Microsoft YaHei\',Arial,sans-serif}.last_mes .roleplay_options_item{cursor:pointer}.last_mes .roleplay_options_item::after{content:\'\';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(140deg,transparent 0%,transparent 50%,rgba(255,204,214,0.15) 150%);opacity:0;transition:opacity 0.35s ease;z-index:-1}.last_mes .roleplay_options_item:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(20,18,19,0.3);background:#4a4447;border-color:rgba(255,204,214,0.3)}.last_mes .roleplay_options_item:hover::after{opacity:1}.last_mes .roleplay_options_item:hover .roleplay_options_content{color:#ffe5ea}.last_mes .roleplay_options_item:active{transform:translateY(-2px);box-shadow:0 4px 12px rgba(20,18,19,0.2)}.roleplay_options_item:before{content:\'\';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,#ffd0d8,#ffbbc8);transform:scaleX(0);transform-origin:0 0;transition:transform 0.35s cubic-bezier(0.4,0,0.2,1)}.last_mes .roleplay_options_item:hover:before{transform:scaleX(1)}.roleplay_options_title{font-size:0.95em;font-weight:600;color:#ffd0d8;margin-bottom:12px;letter-spacing:0.04em;text-align:left;padding-bottom:10px;border-bottom:1px solid rgba(80,74,77,0.3);text-shadow:0 1px 1px rgba(20,18,19,0.5);line-height:1.4;position:relative;display:flex;align-items:center}.roleplay_options_title::before{content:\'\';display:inline-block;width:6px;height:6px;background:#ffd0d8;border-radius:50%;margin-right:10px;box-shadow:0 0 0 2px rgba(255,204,214,0.2)}.roleplay_options_content{font-size:0.95em;line-height:1.65;color:#e0a7b5;font-weight:normal;transition:color 0.25s ease;text-align:left;flex:1;text-shadow:0 1px 1px rgba(20,18,19,0.5);letter-spacing:0.018em}.roleplay_options_item.selected{background:rgba(64,58,61,0.7);border-color:rgba(255,204,214,0.5)}.roleplay_options_item.selected:before{background:linear-gradient(90deg,#ffd0d8,#ffbbc8);transform:scaleX(1)}.roleplay_options_item.selected .roleplay_options_title::before{background:#ffd0d8;box-shadow:0 0 0 2px rgba(255,204,214,0.3)}@media (max-width:999px){.roleplay_options_back{padding:18px;gap:14px;grid-template-columns:1fr;width:100%;max-width:none;margin:24px 0;background:#332d30;border:1px solid #4a4447}.roleplay_options_item{padding:16px;background:#403a3d;border:1px solid #4a4447}.roleplay_options_title{font-size:0.9em;padding-bottom:8px;margin-bottom:10px}.roleplay_options_content{font-size:0.92em;line-height:1.6}}@media (prefers-reduced-motion:reduce){.roleplay_options_item,.roleplay_options_item::before,.roleplay_options_item::after,.roleplay_options_content,.roleplay_options_title{transition:none}}\n':'*{-webkit-tap-highlight-color:transparent}.roleplay_options_hr{display:none}.roleplay_options_back{background:#fff0f3;border-radius:16px;box-shadow:0 8px 20px rgba(145,125,138,0.15);padding:22px 24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;border:1px solid #ffe5ea;width:90%;max-width:740px;margin:24px auto}.roleplay_options_item{position:relative;background:#fffafb;border-radius:12px;box-shadow:0 5px 15px rgba(145,125,138,0.1);padding:18px 20px;cursor:default;border:1px solid #ffe5ea;transition:all 0.28s cubic-bezier(0.22,1,0.36,1);overflow:hidden;display:flex;flex-direction:column;z-index:1;margin:0;color:#7d6b6e;font-weight:400;line-height:1.6;height:100%;font-family:\'Microsoft YaHei\',Arial,sans-serif}.last_mes .roleplay_options_item{cursor:pointer}.last_mes .roleplay_options_item::after{content:\'\';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(140deg,transparent 0%,transparent 50%,rgba(255,204,214,0.15) 150%);opacity:0;transition:opacity 0.35s ease;z-index:-1}.last_mes .roleplay_options_item:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(145,125,138,0.2);background:#fff5f7;border-color:rgba(255,204,214,0.3)}.last_mes .roleplay_options_item:hover::after{opacity:1}.last_mes .roleplay_options_item:hover .roleplay_options_content{color:#635759}.last_mes .roleplay_options_item:active{transform:translateY(-2px);box-shadow:0 4px 12px rgba(145,125,138,0.1)}.roleplay_options_item:before{content:\'\';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,#ffd0d8,#ffbbc8);transform:scaleX(0);transform-origin:0 0;transition:transform 0.35s cubic-bezier(0.4,0,0.2,1)}.last_mes .roleplay_options_item:hover:before{transform:scaleX(1)}.roleplay_options_title{font-size:0.95em;font-weight:600;color:#7d6b6e;margin-bottom:12px;letter-spacing:0.04em;text-align:left;padding-bottom:10px;border-bottom:1px solid rgba(200,200,200,0.3);text-shadow:0 1px 1px rgba(255,255,255,0.5);line-height:1.4;position:relative;display:flex;align-items:center}.roleplay_options_title::before{content:\'\';display:inline-block;width:6px;height:6px;background:#ffd0d8;border-radius:50%;margin-right:10px;box-shadow:0 0 0 2px rgba(255,204,214,0.2)}.roleplay_options_content{font-size:0.95em;line-height:1.65;color:#8e7478;font-weight:normal;transition:color 0.25s ease;text-align:left;flex:1;text-shadow:0 1px 1px rgba(255,255,255,0.5);letter-spacing:0.018em}.roleplay_options_item.selected{background:rgba(255,235,240,0.7);border-color:rgba(255,204,214,0.5)}.roleplay_options_item.selected:before{background:linear-gradient(90deg,#ffd0d8,#ffbbc8);transform:scaleX(1)}.roleplay_options_item.selected .roleplay_options_title::before{background:#ffd0d8;box-shadow:0 0 0 2px rgba(255,204,214,0.3)}@media (max-width:999px){.roleplay_options_back{padding:18px;gap:14px;grid-template-columns:1fr;width:100%;max-width:none;margin:24px 0;background:#fff0f3;border:1px solid #ffe5ea}.roleplay_options_item{padding:16px;background:#fffafb;border:1px solid #ffe5ea}.roleplay_options_title{font-size:0.9em;padding-bottom:8px;margin-bottom:10px}.roleplay_options_content{font-size:0.92em;line-height:1.6}}@media (prefers-reduced-motion:reduce){.roleplay_options_item,.roleplay_options_item::before,.roleplay_options_item::after,.roleplay_options_content,.roleplay_options_title{transition:none}}\n';$('<div>').attr('script_id',getScriptId()).append(`<style roleplay_options>${n()}</style>`).appendTo('head');const t=(0,v.watch)(()=>e.config.æ ·å¼ä¸»é¢˜,()=>$(`head > div[script_id="${getScriptId()}"]`).find('style[roleplay_options]').text(n()));return{destroy:()=>{t(),$(`head > div[script_id="${getScriptId()}"]`).remove()}}}();return Te(),eventOn(tavern_events.CHAT_CHANGED,errorCatched(Te)),eventOn(tavern_events.CHARACTER_MESSAGE_RENDERED,errorCatched(Be)),eventOn(tavern_events.MESSAGE_UPDATED,errorCatched(Be)),eventOn(tavern_events.MESSAGE_SWIPED,errorCatched(Be)),eventOn(tavern_events.MESSAGE_DELETED,()=>setTimeout(errorCatched(Te),1e3)),{destroy:()=>{$(`pre:contains("${Ve}")`).each(function(){const e=$(this).parent('.TH-render');e.length>0?e.removeClass('hidden!'):$(this).removeClass('hidden!')}),We.forEach(e=>{e?.unmount()}),We.clear(),e()}}}i(r()),$(async()=>{await e(()=>null!==getCharWorldbookNames('current').primary),await waitGlobalInitialized('Mvu'),await async function(){const e=(await getWorldbook(y)).find(e=>'ç‰ˆæœ¬å·'===e.name)?.content.trim()??'0.0.0';n(e,await fetch('https://testingcf.jsdelivr.net/gh/lolo-desu/lolocard/src/æ—¥è®°ç»œç»œ/ä¸–ç•Œä¹¦/ç‰ˆæœ¬å·.txt').then(e=>e.text()).then(e=>e.trim()).catch(()=>'0.0.0'),'>=')||(n(getTavernVersion(),'4.3.18','<')?toastr.warning('æ£€æµ‹åˆ°è§’è‰²å¡æœ‰æ›´æ–°ï¼Œä½†é…’é¦†åŠ©æ‰‹ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•è‡ªåŠ¨æ›´æ–°','ç™½åŒ–è“æŸ“çš„æ—¥è®°æœ¬'):(await importRawCharacter('ç™½åŒ–è“æŸ“çš„æ—¥è®°æœ¬',await fetch('https://testingcf.jsdelivr.net/gh/lolo-desu/lolocard/src/æ—¥è®°ç»œç»œ/ç™½åŒ–è“æŸ“çš„æ—¥è®°æœ¬.png').then(e=>e.blob())),toastr.success('è§’è‰²å¡è‡ªåŠ¨æ›´æ–°æˆåŠŸ, å‡†å¤‡åˆ·æ–°é¡µé¢ä»¥ç”Ÿæ•ˆ...','ç™½åŒ–è“æŸ“çš„æ—¥è®°æœ¬'),setTimeout(()=>triggerSlash('/reload-page'),3e3)))}(),await S()._wait_init;const t=[];t.push(function(){const e=[],n=(e,n)=>n.includes('<galgame>');return e.push(j(()=>(0,v.createApp)(ke,{transformer:e=>{const n=e.lastIndexOf('<galgame>');return e.slice(0,-1===n?void 0:n).trim()}}),{host:'div',filter:n}).unmount),e.push(j(()=>(0,v.createApp)(je).provide('input_method',()=>S().config.é€‰æ‹©æ¡†è§¦å‘æ–¹å¼).use(r()),{filter:n}).unmount),e.push(j(()=>(0,v.createApp)(ke,{transformer:e=>{const n=e.lastIndexOf('</galgame>');return-1===n?'':e.slice(n+10).replace(/<(roleplay_options)>(?:(?!.*<\/\1>)(?:(?!<\1>).)*$|(?:(?!<\1>).)*<\/\1?>)/gis,'').trim()}}),{host:'div',filter:n}).unmount),{destroy:()=>{e.forEach(e=>e())}}}().destroy),t.push(function(){const e=S(),n=[Se,'æ•™å®¤é‡Œï¼Œè‡ªä¹ è¯¾ï¼ŒåŒå­¦ä»¬çš„ç¿»ä¹¦åƒå‚¬çœ æ›²ä¸€æ ·åœ¨ç©ºæ°”ä¸­é£˜è¡ã€‚<user>ç™¾æ— èŠèµ–åœ°æœ›ç€çª—å¤–ï¼Œé˜³å…‰é€è¿‡ç»ç’ƒåœ¨è¯¾æ¡Œä¸ŠæŠ•ä¸‹æ–‘é©³çš„å…‰å½±ã€‚æ˜¥å­£çš„å¾®é£è½»æŠšæ ‘æ¢¢ï¼Œè¿œå¤„æ“åœºä¸Šä½“è‚²è¯¾çš„å–§é—¹å£°éšçº¦å¯é—»ã€‚\n\næ•™å®¤å‰é—¨çªç„¶è¢«è½»è½»æ¨å¼€ï¼Œæ‰“æ–­äº†è€å¸ˆçš„è®²è¯¾ã€‚ä¸€ç‰‡é›ªç™½çš„é•¿å‘å…ˆæ˜ å…¥çœ¼å¸˜ï¼Œéšåæ˜¯ä¸€å¼ ç²¾è‡´å¾—è¿‘ä¹ä¸çœŸå®çš„è„¸åºã€‚ç«™åœ¨é—¨å£çš„å¥³å­©èº«ç©¿æ•´é½çš„æ°´æ‰‹æœæ ¡æœï¼Œçº¢è‰²çš„é¢†å·¾åœ¨èƒ¸å‰å¾®å¾®é¢¤åŠ¨ï¼Œé‚£åŒå¦‚æ·±æµ·èˆ¬çš„è“çœ¼ç›è¿…é€Ÿæ‰«è§†äº†æ•™å®¤ä¸€åœˆï¼Œæœ€åé”å®šåœ¨<user>èº«ä¸Šã€‚\n\n"æ‰“ã€æ‰“æ‰°äº†"ç»œç»œçš„å£°éŸ³è™½ç„¶è½»æŸ”ä½†åœ¨å®‰é™çš„æ•™å®¤é‡Œæ ¼å¤–æ¸…æ™°ï¼Œ"æˆ‘èƒ½æ‰¾ä¸€ä¸‹<user>åŒå­¦å—ï¼Ÿ"\n\nä¸€ç¬é—´ï¼Œæ•™å®¤é‡Œçš„ç©ºæ°”ä¼¼ä¹å‡å›ºäº†ã€‚å‡ ååŒçœ¼ç›é½åˆ·åˆ·åœ°è½¬å‘<user>ï¼Œæœ‰äººå¼€å§‹çªƒçªƒç§è¯­ï¼Œæœ‰äººåˆ™ç”¨è‚˜éƒ¨è½»æ¨åŒæ¡Œï¼Œè„¸ä¸Šå¸¦ç€äº†ç„¶çš„å¾®ç¬‘ã€‚\n\n<user>ç«™èµ·èº«ï¼Œæ„Ÿåˆ°åŒå­¦ä»¬çš„ç›®å…‰åƒèšå…‰ç¯ä¸€æ ·é›†ä¸­åœ¨è‡ªå·±èº«ä¸Šã€‚èµ°å‘æ•™å®¤é—¨å£çš„çŸ­çŸ­å‡ æ­¥è·¯ï¼ŒèƒŒåçš„è®®è®ºå£°å´è¶Šæ¥è¶Šå¤§ã€‚\n\n<user>èµ°åˆ°é—¨å£ï¼Œå‹ä½å£°éŸ³é—®é“ç»œç»œæœ‰ä»€ä¹ˆäº‹æƒ…ã€‚\n\nç»œç»œçš„æ‰‹æŒ‡ä¸è‡ªè§‰åœ°æ‘©æŒ²ç€è£™è¾¹ï¼ŒåŒçœ¼ä¸æ–­åœ¨åœ°é¢å’Œ<user>ä¹‹é—´æ¸¸ç§»ã€‚å¥¹çš„è„¸é¢Šæ³›èµ·å¾®å¾®çš„ç²‰çº¢ï¼Œè½»å’¬ä¸‹å”‡ï¼Œä¼¼ä¹åœ¨åŠªåŠ›ç»„ç»‡è¯­è¨€ã€‚\n\n"é‚£ä¸ª...è¯·é—®"å¥¹ç»ˆäºæŠ¬èµ·å¤´ï¼Œç”¨åªæœ‰ä¸¤äººèƒ½å¬è§çš„éŸ³é‡è¯´é“ï¼Œ"ä»Šå¤©æ”¾å­¦åï¼Œå¯ä»¥æ¥ä¸€ä¸‹å¤©å°å—ï¼Ÿæˆ‘æœ‰äº‹æƒ³å’Œä½ è¯´ã€‚"\n\nè¯éŸ³åˆšè½ï¼Œæ•™å®¤é‡Œçˆ†å‘å‡ºä¸€é˜µä½ä½çš„æƒŠå‘¼å’Œçªƒç¬‘ã€‚ç­é•¿ä¸æ»¡åœ°æ•²äº†æ•²è®²å°ï¼Œè¯•å›¾å¹³æ¯éªšåŠ¨ï¼Œä½†æ˜¾ç„¶æ”¶æ•ˆç”šå¾®ã€‚\n\n<user>ç­”åº”ï¼Œç»œç»œèº«åå‡ ä¸ªè·¯è¿‡çš„å­¦ç”Ÿä¹Ÿåœä¸‹è„šæ­¥ï¼Œæ©ç€å˜´äº¤å¤´æ¥è€³ã€‚\n\nç»œç»œå¾®å¾®ç‚¹å¤´ï¼Œåˆä½å£°è¯´äº†å¥"è°¢è°¢"ï¼Œç„¶åè½¬èº«åŒ†åŒ†ç¦»å»ï¼Œé›ªç™½çš„é•¿å‘åœ¨èº«åé£˜åŠ¨ã€‚<user>å›åˆ°åº§ä½ï¼Œå´å‘ç°æ•´ä¸ªç­çº§çš„æ°”æ°›å·²ç»å®Œå…¨ä¸åŒäº†ã€‚\n\n"å“ï¼Œ<user>ï¼Œæ˜¥å¤©æ¥äº†å•Šï¼"å‰æ’çš„ç”·ç”Ÿè½¬è¿‡èº«ï¼ŒæŒ¤çœ‰å¼„çœ¼åœ°è¯´ã€‚\n\n"å°±æ˜¯é‚£ä¸ªç™½å‘è“çœ¼çš„å¥³ç”Ÿå§ï¼Ÿå¬è¯´å¥¹è¶…çº§ç¥ç§˜çš„ï¼"\n\n"å¤©å°å‘Šç™½ï¼Ÿè¿™ä¹Ÿå¤ªæ¼«ç”»äº†å§â”€â”€ï¼"\n\n<user>å¼ äº†å¼ å˜´ï¼Œæƒ³è¦è§£é‡Šä»€ä¹ˆï¼Œä½†åˆä¸çŸ¥ä»ä½•è¯´èµ·ã€‚ç›´åˆ°ä¸‹è¯¾é“ƒå£°å“èµ·ï¼ŒåŒå­¦ä»¬çš„è°ƒä¾ƒå’Œèµ·å“„ä¹Ÿæ²¡æœ‰åœæ­¢ã€‚\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 09:00\n  å½“å‰æ—¥æœŸ: 2025/04/04\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸä¸‰\nç»œç»œ:\n  äº²å¯†åº¦: 10\n  é˜…è¯»æ—¥è®°æ•°é‡: 0\n  æ‹¥æœ‰è”ç³»æ–¹å¼: false\n```\n</initvar>\n</UpdateVariable>\n\n<sprite>\nç«‹ç»˜: æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png\nåœºæ™¯: æ•™å®¤/ç™½å¤©.jpg\næ—¶é—´: æ™¨é—´\n</sprite>\n','<user>çå¼€çœ¼ç›ï¼Œé—¹é’Ÿå£°æŠŠäººä»æ¢¦å¢ƒé‡Œç¡¬ç”Ÿç”Ÿæ‹½äº†å‡ºæ¥ã€‚åˆšæ‰å¥½åƒåšäº†é‡è¦çš„æ¢¦ï¼Œä¼¼ä¹æ˜¯ä»å“ªé‡Œçš„é«˜å¤„çœºæœ›äº†è¿™åº§å°é•‡ï¼Ÿåˆä¼¼ä¹æ˜¯çœ‹åˆ°äº†æ¼‚äº®çš„æ˜Ÿç©ºï¼Ÿ\nä½†é†’æ¥æ—¶åªå‰©æ¨¡ç³Šçš„è½®å»“ã€‚åˆæ˜¥çš„é˜³å…‰ä»çª—å¸˜ç¼éš™æºœè¿›æˆ¿é—´ï¼Œç…§å¾—ç©ºæ°”ä¸­çš„ç°å°˜è½¨è¿¹éƒ½æ¸…æ™°å¯è§ã€‚\n\nå‘¨äºŒå•Š...è™½ç„¶æ¯”å‘¨ä¸€å¥½ç‚¹ï¼Œä½†ç¦»å‘¨æœ«è¿˜è¿œç€å‘¢ã€‚å‘¨æœ«æ€»æ˜¯è½¬ç¬å³é€ï¼Œå¹³å¸¸æ—¥å­å´æ ¼å¤–æ¼«é•¿ã€‚\n\né—¹é’Ÿæ˜¾ç¤º7:10ã€‚<user>å…³æ‰æ‰‹æœºé—¹é“ƒä»è¢«çªé’»å‡ºæ¥ï¼Œå…‰è„šè¸©åœ¨å†°å‡‰çš„åœ°æ¿ä¸Šã€‚æˆ¿é—´é‡Œåªæœ‰æ—¶é’Ÿæ»´ç­”å£°å’Œçª—å¤–é¸Ÿé¸£ï¼Œä¼¸ç€æ‡’è…°è¯•å›¾å›å¿†åˆšæ‰çš„æ¢¦ï¼Œä½†é‚£ç”»é¢å°±åƒé›¾ä¸­é£æ™¯ï¼Œè¶Šæƒ³æŠ“ä½å°±è¶Šæ¨¡ç³Šã€‚\n\næ´—æ¼±å®Œå¥—ä¸Šæ­åœ¨æ¤…èƒŒçš„æ ¡æœï¼Œé•œå­é‡Œæ˜ å‡ºç•¥æ˜¾ç–²æƒ«çš„è„¸ï¼Œçœ¼ä¸‹æŒ‚ç€æ·¡æ·¡é»‘çœ¼åœˆã€‚å¹³åº•é”…å‘å‡ºæ»‹æ»‹å£°ï¼Œç…è›‹å’Œä¸¤ç‰‡é‡‘é»„çš„åå¸å·²ç»å‡†å¤‡å¥½ï¼Œä»Šå¤©å¿ƒè¡€æ¥æ½®åˆåŠ äº†ä¸¤ç‰‡åŸ¹æ ¹ã€‚å¾®æ³¢ç‚‰å®çš„ä¸€å£°ï¼Œç‰›å¥¶åˆšå¥½çƒ­åˆ°é€‚å£æ¸©åº¦ã€‚\n\nåƒç€æ—©é¤æ—¶ï¼Œ<user>çš„ç›®å…‰æ— æ„è¯†é£˜å‘çª—å¤–ã€‚å°æ—¶å€™çœ‹çš„æ¼«ç”»é‡Œé«˜ä¸­ç”Ÿæ´»æ€»æ˜¯å……æ»¡æˆå‰§æ€§ï¼Œç°å®å´å¹³æ·¡å¾—ä¹å‘³ã€‚éƒ½é«˜äºŒäº†æ¯å¤©è¿˜æ˜¯æ•™å®¤å’Œå®¶ä¸¤ç‚¹ä¸€çº¿ã€‚è¡—è§’ä¼¼ä¹æœ‰ç™½è‰²èº«å½±é—ªè¿‡ï¼Œçœ¨äº†çœ¨çœ¼ï¼Œé‚£é‡Œå´ç©ºæ— ä¸€äººã€‚\n\nèƒŒèµ·ä¹¦åŒ…æœ€åæ‰«è§†æˆ¿é—´æƒ³ç€æ˜¯å¦æœ‰é—è½çš„ç‰©å“æ—¶ï¼Œçªç„¶æƒ³èµ·éš”å£ç­æœ€è¿‘åœ¨æäº¤æ¢æ—¥è®°æ´»åŠ¨ã€‚å¾ˆå¤šåŒå­¦éƒ½æ‰¾åˆ°äº†æ­æ¡£ï¼Œè‡ªå·±ç­ä¸Šå´é™¤äº†è€ƒè¯•ä½œä¸šä»€ä¹ˆéƒ½æ²¡ç»„ç»‡è¿‡ã€‚\n\næ¨å¼€ç„å…³å¤§é—¨çš„ç¬é—´ï¼Œè€€çœ¼çš„æ™¨å…‰é‡Œç«™ç€ä¸ªå¥³å­©ã€‚é›ªç™½é•¿å‘åœ¨æœé˜³ä¸‹è¿‘ä¹é€æ˜ï¼Œè”šè“çœ¼çœ¸åƒå®çŸ³èˆ¬é—ªäº®ã€‚\n\n"æ—©ã€æ—©ä¸Šå¥½ï¼Œæˆ‘å«ç»œç»œï¼Œæ˜¯éš”å£ç­çš„ã€‚"å°‘å¥³å£°éŸ³è½»å¾—åƒç¾½æ¯›ï¼Œç™½çš™è„¸é¢Šæ³›ç€çº¢æ™•ï¼Œ"æˆ‘å®¶ä¹Ÿä½è¿™é™„è¿‘..."\n\nå¥¹ä½å¤´ç›¯ç€æ‰‹é‡Œç´§æ”¥çš„ç¬”è®°æœ¬åƒæ˜¯è‡ªè¨€è‡ªè¯­çš„å®Œå…¨æ²¡ç­‰<user>å›å¤å°±æ¥ç€è¯´ï¼š"æˆ‘ä»¬è€å¸ˆå¸ƒç½®äº†äº¤æ¢æ—¥è®°ä½œä¸šï¼Œå¯æ˜¯ç­ä¸Šäººæ•°æ˜¯å•æ•°...æˆ‘åœ¨ç­ä¸Šæ²¡ä»€ä¹ˆæœ‹å‹...<user>åŒå­¦èƒ½å¸®æˆ‘å—ï¼Ÿåªè¦å¶å°”çº¦å¥½æ—¶é—´ï¼Œæ¥è¯»è¯»æˆ‘å†™çš„å†…å®¹ï¼Œç•™å‡ å¥çŸ­è¯„å°±å¥½ï¼Œä¸éœ€è¦ä½ è‡ªå·±å†™æ—¥è®°çš„ã€‚"\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 07:00\n  å½“å‰æ—¥æœŸ: 2025/04/04\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸä¸‰\nç»œç»œ:\n  äº²å¯†åº¦: 10\n  é˜…è¯»æ—¥è®°æ•°é‡: 0\n  æ‹¥æœ‰è”ç³»æ–¹å¼: false\n```\n</initvar>\n</UpdateVariable>\n\n<sprite>\nç«‹ç»˜: æ°´æ‰‹æœ/å®³ç¾.png\nåœºæ™¯: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\næ—¶é—´: æ™¨é—´\n</sprite>\n','å‘¨æ—¥çš„é˜³å…‰é€è¿‡çª—å¸˜ç¼éš™æ´’è¿›æˆ¿é—´ï¼Œ<user>æ­£æ‡’æ•£åœ°ç¿»çœ‹ç€ä¹¦æ¶ä¸Šçš„å°è¯´ï¼Œæ‰‹æœºéœ‡åŠ¨èµ·æ¥ï¼Œå±å¹•ä¸Šè·³å‡ºäº†ç»œç»œçš„åå­—ã€‚è¿™ä¸€ä¸ªæœˆæ¥ï¼Œä¸¤äººæ¯å¤©æ”¾å­¦ååœ¨å¤©å°çš„ç›¸å¤„å·²ç»æˆä¸ºäº†ä¸€ç§ä¹ æƒ¯ã€‚ç»œç»œçš„æ—¥è®°é‡Œæ€»æ˜¯å……æ»¡äº†ç»†è…»çš„è§‚å¯Ÿå’Œæ¸©æŸ”çš„æ–‡å­—ï¼Œä»¿ä½›é€šè¿‡é‚£äº›è¡Œé—´çš„æ–‡å­—ï¼Œ<user>å¾—ä»¥çª¥è§ä¸€ä¸ªå¹³æ—¶æ²‰é»˜å¯¡è¨€çš„ç»œç»œå†…å¿ƒä¸­ä¸°å¯Œçš„ä¸–ç•Œã€‚\n\n<message>\nç»œç»œçš„æ¶ˆæ¯:<user>ï¼Œä»Šå¤©æœ‰ç©ºå—ï¼Ÿæƒ³çº¦ä½ ä¸€èµ·å»æ–°å¼€çš„æ°´æ—é¦†...å¦‚æœä½ ä¸æƒ³å»ä¹Ÿæ²¡å…³ç³»çš„ã€‚\n</message>\n\n<user>çœ‹ç€è¿™æ¡æ¶ˆæ¯ï¼Œå˜´è§’ä¸è‡ªè§‰åœ°æ‰¬èµ·ã€‚ç»œç»œæ€»æ˜¯è¿™æ ·ï¼Œé‚€çº¦æ—¶å¸¦ç€çŠ¹è±«ï¼Œä¼¼ä¹éšæ—¶å‡†å¤‡å¥½æ¥å—æ‹’ç»ã€‚ä½†è¿‡å»è¿™ä¸€ä¸ªæœˆçš„ç›¸å¤„ï¼Œ<user>å·²ç»å­¦ä¼šäº†è§£è¯»ç»œç»œçš„ä¹ æƒ¯â€”â€”é‚£äº›å°å¿ƒç¿¼ç¿¼çš„æªè¾ä¸‹è—ç€çš„æœŸå¾…ã€‚\n\næ‰‹æŒ‡åœ¨é”®ç›˜ä¸Šæ•²å‡»äº†å‡ ä¸‹ï¼Œ<user>è€ƒè™‘ç€è¯¥å¦‚ä½•å›å¤ã€‚ä¸ç»œç»œçš„ç›¸å¤„ä¸€ç›´æœ‰ç§å¥‡å¦™çš„è‡ªç„¶æ„Ÿï¼Œå³ä½¿æ˜¯æ²‰é»˜çš„æ—¶åˆ»ä¹Ÿä¸ä¼šè§‰å¾—å°´å°¬ã€‚æ—¥è®°ä¸­çš„ç»œç»œæ¯”ç°å®ä¸­è¦å¦ç‡å¾—å¤šï¼Œé‚£äº›è®°å½•ç€æ—¥å¸¸è§‚å¯Ÿä¸ç»†è…»æƒ…æ„Ÿçš„æ–‡å­—ï¼Œè®©<user>æœ‰æ—¶ä¼šæƒ³ï¼Œå¦‚æœç»œç»œèƒ½åœ¨ç°å®ä¸­ä¹Ÿè¿™æ ·ç›´æ¥è¡¨è¾¾å°±å¥½äº†ã€‚\n\n<message>\nç»œç»œçš„æ¶ˆæ¯:å•Šï¼Œå¦‚æœä½ å·²ç»æœ‰å®‰æ’äº†ï¼Œé‚£æˆ‘ä»¬æ”¹å¤©å†çº¦...\n</message>\n\nè¿™æ¡è¡¥å……ä¿¡æ¯è®©<user>æ„è¯†åˆ°è‡ªå·±æ²‰æ€çš„æ—¶é—´å¤ªé•¿äº†ã€‚çœŸæ˜¯çš„ï¼Œæ€»æ˜¯è¿™æ ·ç€æ€¥åœ°è®¤ä¸ºä¼šè¢«æ‹’ç»ã€‚<user>å¿«é€Ÿåœ°å›å¤äº†ä¿¡æ¯ï¼Œç¡®è®¤äº†è§é¢çš„æ—¶é—´å’Œåœ°ç‚¹ï¼Œç„¶åèµ·èº«å‡†å¤‡å‡ºé—¨ã€‚\n\nç«™åœ¨è¡£æŸœå‰ï¼Œ<user>æ€è€ƒç€è¯¥ç©¿ä»€ä¹ˆã€‚è™½ç„¶åªæ˜¯æ™®é€šçš„å‡ºè¡Œï¼Œä½†å´æ˜¯ç¬¬ä¸€æ¬¡åœ¨æ ¡å¤–ä¸ç»œç»œå•ç‹¬ç›¸å¤„ã€‚ä»æ ¡æœå’Œæ—¥è®°æœ¬çš„äº¤æ¥ï¼Œåˆ°ä»Šå¤©çš„æ°´æ—é¦†ä¹‹çº¦ï¼Œè¿™ç§å…³ç³»çš„å‘å±•ä¼¼ä¹å¾ˆè‡ªç„¶ï¼Œå´åˆè®©äººæœ‰äº›æœŸå¾…ã€‚\n\nå‡†å¤‡å¥½ä¹‹åï¼Œ<user>çœ‹äº†çœ‹æ—¶é—´ï¼Œè·ç¦»çº¦å®šè¿˜æœ‰ä¸€å°æ—¶ã€‚ç»œç»œä¼šç©¿ä»€ä¹ˆæ ·çš„è¡£æœå‘¢ï¼Ÿå¹³æ—¶åœ¨å­¦æ ¡æ€»æ˜¯è§„æ•´çš„æ ¡æœï¼Œå¾ˆå°‘çœ‹åˆ°å¥¹çš„ç§æœã€‚é‚£é›ªç™½çš„é•¿å‘å’Œæ·±é‚ƒçš„è“çœ¼ç›ï¼Œåœ¨æ°´æ—é¦†å¹½è“çš„å…‰çº¿ä¸‹ä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ\n\n<user>æ‹¿èµ·æ‰‹æœºï¼Œå¯¹ç€é•œå­ç¡®è®¤äº†ä¸€ä¸‹è‡ªå·±çš„è£…æ‰®ï¼Œç„¶åæœç€çº¦å®šçš„è½¦ç«™èµ°å»ã€‚å¿ƒä¸­ä¸çŸ¥ä¸ºä½•ï¼Œæœ‰ç§è«åçš„æœŸå¾…åœ¨æ¶ŒåŠ¨ã€‚\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 07:00\n  å½“å‰æ—¥æœŸ: 2025/04/07\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸå…­\nç»œç»œ:\n  äº²å¯†åº¦: 48\n  é˜…è¯»æ—¥è®°æ•°é‡: 12\n  æ‹¥æœ‰è”ç³»æ–¹å¼: true\n```\n</initvar>\n</UpdateVariable>\n\n<sprite>\nç«‹ç»˜: æ ¼çº¹è¡«/å¾®ç¬‘.png\nåœºæ™¯: ç¹åå•†ä¸šè¡—/ç™½å¤©.jpg\næ—¶é—´: å‡æ—¥\n</sprite>\n','æ—¶é—´è¿‡å¾—é£å¿«ï¼Œä¸¤äººå·²ç»ç›¸è¯†ä¸€ä¸ªæœˆã€‚\n\næ”¾å­¦é“ƒå£°åˆšåˆšå“èµ·ï¼Œæ•™å®¤é‡Œå°±çˆ†å‘å‡ºæ­¤èµ·å½¼ä¼çš„æ¤…å­æŒªåŠ¨å£°ã€‚<user>æ”¶æ‹¾å¥½ä¹¦åŒ…ï¼Œæ­£å‡†å¤‡ç¦»å¼€æ•™å®¤ï¼Œèµ°å»Šä¸Šä¼ æ¥äº†ä¸€é˜µç†Ÿæ‚‰çš„è„šæ­¥å£°ã€‚\n\nç»œç»œç«™åœ¨æ•™å®¤é—¨å£ï¼Œé›ªç™½çš„é•¿å‘åœ¨å¤•é˜³çš„æ˜ ç…§ä¸‹æ³›ç€æŸ”å’Œçš„é‡‘è‰²å…‰èŠ’ã€‚å¥¹ç©¿ç€æ•´é½çš„æ°´æ‰‹æœï¼ŒåŒæ‰‹èƒŒåœ¨èº«åï¼Œè“è‰²çš„çœ¼ç›æœ›ç€<user>ï¼Œå˜´è§’æ‰¬èµ·ä¸€ä¸ªæ¸©æŸ”çš„å¼§åº¦ã€‚\n\n"ä»Šå¤©ä¹Ÿä¸€èµ·å›å®¶å§ï¼Ÿç¨å¾®é™ªæˆ‘ä¸€ä¸‹ã€‚"ç»œç»œçš„å£°éŸ³è½»æŸ”ï¼Œå¸¦ç€ä¸€ä¸éš¾ä»¥å¯Ÿè§‰çš„ç´§å¼ ã€‚\n\n<user>ä¸€çœ¼å°±æ³¨æ„åˆ°ç»œç»œä»Šå¤©ä¼¼ä¹æ ¼å¤–è®¤çœŸåœ°æ•´ç†äº†è‡ªå·±çš„ä»ªå®¹ã€‚å¹³æ—¥é‡Œéšæ„æŠ«æ•£çš„é•¿å‘çœ‹èµ·æ¥æ•´æ´é¡ºæ»‘ï¼Œéœ²å‡ºå…‰æ´çš„è„¸åºå’Œç²¾è‡´çš„çœ‰çœ¼ã€‚å¥¹çš„æ ¡æœè¢–å£ä¹Ÿè¢«æ•´é½åœ°å·èµ·ã€‚\n\n"å—¯ï¼"<user>å¾®ç¬‘ç€ç‚¹ç‚¹å¤´ï¼Œ"æˆ‘ä»¬èµ°å§ã€‚"\n\n<user>è·Ÿç€ç»œç»œèµ°å‡ºæ•™å®¤ï¼Œä¸¤äººå¹¶è‚©èµ°åœ¨èµ°å»Šä¸Šã€‚èµ°å»Šä¸Šçš„å…¶ä»–å­¦ç”Ÿä¸‰ä¸‰ä¸¤ä¸¤åœ°ç»“ä¼´è€Œè¡Œï¼Œæœ‰çš„åœä¸‹æ¥åœ¨çª—è¾¹èŠå¤©ï¼Œæœ‰çš„æ€¥åŒ†åŒ†åœ°å¥”å‘ç¤¾å›¢æ´»åŠ¨å®¤ã€‚ä¹ ä»¥ä¸ºå¸¸çš„æ˜¯ï¼Œä¸å°‘åŒå­¦çœ‹åˆ°ç»œç»œæ—¶ï¼Œç›®å…‰éƒ½ä¸è‡ªè§‰åœ°åœç•™äº†å‡ ç§’ã€‚\n\nç»œç»œä¼¼ä¹å¯Ÿè§‰åˆ°äº†<user>çš„ç›®å…‰ï¼Œè½»è½»è½¬è¿‡å¤´æ¥ï¼Œè“çœ¼ç›é‡Œé—ªçƒç€æŸ”å’Œçš„å…‰èŠ’ã€‚å¥¹æ·±å¸ä¸€å£æ°”ï¼ŒæŒ‡å°–åœ¨è£™æ‘†ä¸Šè½»è½»æ‘©æŒ²ç€ã€‚\n\n"ä»Šå¤©ï¼Œè·ç¬¬ä¸€æ¬¡äº¤æ¢æ—¥è®°å·²ç»è¿‡å»ä¸€ä¸ªæœˆäº†å‘¢"ç»œç»œè½»å£°é—®é“ï¼Œå£°éŸ³é‡Œå¸¦ç€æ„Ÿå¹ã€‚\n\nç»œç»œèµ°åœ¨å‰é¢å‡ æ­¥ï¼Œé˜³å…‰ç©¿è¿‡èµ°å»Šçš„çª—æˆ·æ–œæ–œåœ°æ´’åœ¨å¥¹èº«ä¸Šï¼Œåœ¨åœ°é¢ä¸ŠæŠ•ä¸‹ç»†é•¿çš„å½±å­ã€‚å¥¹çš„æ­¥ä¼æ¯”å¹³å¸¸è½»å¿«äº†ä¸€äº›ï¼Œæ¯èµ°å‡ æ­¥å°±å›å¤´ç¡®è®¤<user>æ˜¯å¦è·Ÿä¸Šã€‚\n\n"æœ‰ç‚¹äº‹æƒ…ï¼Œæƒ³å’Œä½ è¯´..."ç»œç»œçš„å£°éŸ³å¾ˆè½»ï¼Œä»¿ä½›æ˜¯è‡ªè¨€è‡ªè¯­ã€‚å¥¹çš„è€³å°–æ‚„æ‚„æŸ“ä¸Šäº†ä¸€æŠ¹æ·¡ç²‰è‰²ï¼Œåœ¨é›ªç™½å‘ä¸çš„è¡¬æ‰˜ä¸‹æ ¼å¤–æ˜æ˜¾ã€‚\n\nä¸¤äººèµ°ä¸‹æ¥¼æ¢¯ï¼Œç©¿è¿‡æ ¡å›­ä¸­å¤®çš„æ¨±èŠ±æ—ã€‚åˆæ˜¥çš„æ¨±èŠ±åˆšåˆšç»½æ”¾ï¼Œç²‰ç™½çš„èŠ±ç“£éšé£é£˜èˆï¼Œå¶å°”è½åœ¨ç»œç»œçš„å‘é—´ï¼Œåƒæ˜¯å¤§è‡ªç„¶èµäºˆçš„è£…é¥°ã€‚\n\nèµ°å‡ºæ ¡é—¨ï¼Œå¾€å¸¸ä¸¤äººä¼šæ²¿ç€ç›´é€šä½å®…åŒºçš„å¤§è·¯èµ°ï¼Œä½†ä»Šå¤©ç»œç»œå´æ‹å‘äº†ä¸€æ¡è¾ƒä¸ºåƒ»é™çš„å°è·¯ã€‚è¿™æ¡è·¯ä¸¤æ—æ˜¯é«˜å¤§çš„æ¢§æ¡æ ‘ï¼Œæ ‘å¶é€è¿‡é˜³å…‰æŠ•ä¸‹æ–‘é©³çš„å…‰å½±ã€‚\n\n"è¿™æ¡è·¯ï¼Œç»•ä¸€ç‚¹ï¼Œä½†æ˜¯"ç»œç»œåœé¡¿äº†ä¸€ä¸‹ï¼Œä¾§å¤´çœ‹å‘<user>ï¼Œ"å¶ç„¶é—´å‘ç°äº†ä¸ªåœ°æ–¹ï¼Œå¾ˆæ¼‚äº®ï¼Œè¯·ä½ é™ªæˆ‘ä¸€ä¸‹ã€‚"\n\nè¿œå¤„ä¼ æ¥ç”µè½¦ç»è¿‡çš„å£°éŸ³ï¼Œç©ºæ°”ä¸­å¼¥æ¼«ç€è‰æœ¨çš„æ¸…é¦™ã€‚ç»œç»œçš„è„šæ­¥å˜å¾—æ›´åŠ è½»ç›ˆï¼Œç”šè‡³æœ‰äº›å°å°çš„é›€è·ƒæ„Ÿã€‚ä¸¤äººæ¥åˆ°äº†ä¸€å¤„èŠ±å›­ï¼Œç™½è‰²çš„é›èŠå¼€æ»¡äº†æ•´ç‰‡èŠ±ç”°ã€‚\n\n"<user>"ç»œç»œçªç„¶åœä¸‹è„šæ­¥ï¼Œè½¬èº«é¢å¯¹<user>ï¼Œé˜³å…‰åœ¨å¥¹èº«åå½¢æˆä¸€åœˆæŸ”å’Œçš„è½®å»“ï¼Œå‘åä¸€ä»°ï¼Œèººåœ¨é›èŠèŠ±æµ·ä¸­å¾®ç¬‘ã€‚\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©: galgameSFW\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 08:00\n  å½“å‰æ—¥æœŸ: 2025/04/07\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸå…­\nç»œç»œ:\n  äº²å¯†åº¦: 74\n  é˜…è¯»æ—¥è®°æ•°é‡: 31\n  æ‹¥æœ‰è”ç³»æ–¹å¼: true\n```\n</initvar>\n</UpdateVariable>\n\n<sprite>\nç«‹ç»˜: æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png\nåœºæ™¯: ä½å®…è¡—/ç™½å¤©.jpg\næ—¶é—´: æ”¾å­¦å\n</sprite>\n'],t=[Se,'<galgame>\n```yaml\n- speaker: æ—ç™½\n  speech: è‡ªä¹ è¯¾ä¸Šå…‰å½±æ‘‡æ›³ï¼ŒåŒå­¦ä»¬ä½å£°ç¿»é¡µï¼Œåœ¨çª—è¾¹ä½ç½®æ‰“ç›¹çš„äººçå¼€çœ¼ï¼Œçœ‹å‘äº†æ•™å®¤é—¨å£ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: â€¦â€¦è¯¶ï¼Ÿ\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: æ—ç™½\n  speech: é—¨è¢«è½»è½»æ¨å¼€ï¼Œä¸€é“çº¤ç˜¦çš„äººå½±æ…¢æ…¢æ˜ å…¥è§†é‡â€”â€”æ•´é½ç¬”æŒºçš„æ ¡æœä¸‹æ˜¯è½¯ç»µç»µæ»‘è½è‡³è…°é—´çš„é›ªç™½é•¿å‘ï¼Œé‚£åŒæ¹›è“å¾—å‡ è¿‘é€æ˜çš„çœ¼ç›ä¸<user>éš”ç©ºå¯¹è§†ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç»œç»œ\n  speech: æ‰“â€¦â€¦æ‰“æ‰°äº†ã€‚é‚£ä¸ªï¼Œå¯ä»¥æ‰¾ä¸€ä¸‹â€¦â€¦<user>åŒå­¦å—ï¼Ÿ\n  background: æ•™å®¤/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png\n\n- speaker: ç‹¬ç™½\n  speech: ç­ä¸Šé¡¿äº†ä¸€æ‹ã€‚æ¤…å­è½»å“ï¼Œå¥½å‡ ä¸ªåŒå­¦å·²ç»æ‰­å¤´çœ‹è¿‡æ¥ï¼Œæœ‰äººå¿ä¸ä½å‘å‡ºå°å£°æƒŠå‘¼ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: åŒå­¦Aï¼ˆå°å£°ï¼‰\n  speech: æ˜¯å¥¹æ¬¸â€¦â€¦å°±æ˜¯é‚£ä¸ªâ€œé›ªå¥³â€â€¦â€¦\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: åŒå­¦Bï¼ˆèµ·å“„ï¼‰\n  speech: æ‰¾æˆ‘ä»¬é’ç©ºå¹²å˜›ï½å“Ÿï½ï½ï¼\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: â€¦â€¦æˆ‘åœ¨ã€‚ä»€ä¹ˆäº‹ï¼Ÿ\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: æˆ‘æ’‘ä½æ¡Œè¾¹ç«™èµ·æ¥ï¼Œä¸€ç¬é—´å…¨ç­å‡ åé“ç›®å…‰åƒé›¨ç‚¹ä¸€æ ·è½ä¸‹æ¥ï¼Œæ¯ä¸€æ­¥éƒ½è¸©åœ¨äº†åˆ«äººæ³¨æ„åŠ›ä¸Šã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç­é•¿\n  speech: å˜˜â”€â”€ï¼è‚ƒé™è‚ƒé™ï¼Œéƒ½ç»™æˆ‘å¬è®²ï¼\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: é—¨å£å¥³å­©å˜´å”‡è½»è½»åŠ¨äº†ä¸€ä¸‹ï¼Œçœ‹ç€æˆ‘åˆä½ä¸‹çœ¼ï¼Œå°å¿ƒç¿¼ç¿¼æ»ä½è£™æ‘†çš„ä¸€è§’ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: â€¦â€¦å»å¤–é¢è¯´å§ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: æˆ‘ä¾§èº«å‡ºäº†æ•™å®¤é—¨ï¼Œèº«åçªƒç¬‘å£°ä»æœªå¹³æ¯ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: æœ‰ä»€ä¹ˆäº‹ï¼Ÿ\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: å¥¹å£°éŸ³æå°ï¼Œæˆ‘ä¸å¾—ä¸é è¿‘ä¸€äº›æ‰èƒ½å¬æ¸…æ¥šã€‚\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n\n- speaker: ç»œç»œ\n  speech: ä»Šå¤©â€¦â€¦ä»Šå¤©æ”¾å­¦åï¼Œå¯ä»¥â€¦â€¦è¯·ä½ æ¥ä¸€è¶Ÿå±‹é¡¶å—ï¼Ÿæˆ‘â€¦â€¦æœ‰äº‹æƒ…æƒ³å’Œä½ è¯´â€¦â€¦\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png\n\n- speaker: ç‹¬ç™½\n  speech: å¥¹å’¬å­—æ…¢ååï¼Œå‘¼å¸è½»é¢¤ï¼ŒæŒ‡èŠ‚å·²ç»ç»è¿›æ ¡è£™è¤¶ç¼é‡Œã€‚æˆ‘èƒ½æ„Ÿè§‰åˆ°ï¼Œå¥¹æåŠ›æ§åˆ¶ç€å£°éŸ³ä¸è®©å®ƒé¢¤å‡ºæ¥ã€‚\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n```\n</galgame>\n\n<roleplay_options>\n```\næ‰å¼„å¥¹ä¸€ä¸‹ï¼ˆæ¶ä½œå‰§å¼çš„å›åº”ï¼‰ï¼šâ€œè¿™ä¹ˆæ­£å¼ï¼Œä¸ä¼šæ˜¯è¦å‘Šç™½å§ï¼Ÿâ€\nç»§ç»­è¿½é—®å¥¹æ„å›¾:æˆ‘æ­ªå¤´é è¿‘ä¸€ç‚¹ï¼šâ€œæ˜¯ä»€ä¹ˆäº‹æƒ…ï¼Ÿéç°åœ¨è¯´ä¸å¯å—ï¼Ÿâ€\nä»çª—æˆ·è§‚å¯ŸåŒå­¦ååº”ï¼šâ€¦â€¦ç­ä¸Šäººå¥½åƒä¸å¤ªå®‰åˆ†\n```\n</roleplay_options>\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 09:00\n  å½“å‰æ—¥æœŸ: 2025/04/04\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸä¸‰\nç»œç»œ:\n  äº²å¯†åº¦: 10\n  é˜…è¯»æ—¥è®°æ•°é‡: 0\n  æ‹¥æœ‰è”ç³»æ–¹å¼: false\n```\n</initvar>\n</UpdateVariable>\n','<galgame>\n```yaml\n- speaker: ç‹¬ç™½\n  speech: é—¹é’Ÿå“èµ·çš„é‚£ç¬é—´ï¼Œæˆ‘åƒè¢«ä»æ¢¦å¢ƒç‹ ç‹ æ‹½å‡ºæ¥ï¼Œåªç•™ä¸‹äº›æ¨¡ç³Šçš„æ®‹å½±â€”â€”ä»€ä¹ˆé«˜å¤„ï¼Ÿä»€ä¹ˆæ˜Ÿç©ºï¼Ÿ\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: æ¨å¼€é—¨ã€‚å…‰çº¿æœ‰ç‚¹åˆºçœ¼ã€‚æˆ‘æŠ¬èµ·æ‰‹æŒ¡äº†ä¸‹ï¼Œç„¶åï¼Œè§†çº¿å°±å¯¹ä¸Šäº†å¥¹ã€‚\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: â€¦â€¦è¯¶ï¼Ÿ\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: ç»œç»œ\n  speech: â€œæ—©ã€æ—©ä¸Šå¥½â€¦â€¦æˆ‘å«ç»œç»œï¼Œæ˜¯éš”å£ç­çš„ã€‚â€\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: <user>\n  speech: å—¯ï¼Ÿå•Šï¼Œæ—©â€¦â€¦\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: ç‹¬ç™½\n  speech: é›ªç™½é•¿å‘ï¼Œåœ¨å¤ªé˜³ä¸‹å‡ ä¹æ³›ç€å…‰â€¦â€¦è¯´è¯å£°éŸ³æœ‰äº›å‘ç´§ï¼Œå´æ ¼å¤–å°å¿ƒã€‚\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n\n- speaker: ç»œç»œ\n  speech: â€œæˆ‘ä»¬è€å¸ˆè®©æˆ‘ä»¬æ‰¾äººäº¤æ¢æ—¥è®°ï¼Œå¯æ˜¯ç­ä¸Šäººæ•°æ˜¯å•æ•°â€¦â€¦å¤§å®¶éƒ½æœ‰æ­æ¡£äº†â€¦â€¦â€\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: <user>\n  speech: æ‰€ä»¥ä½ æ‰¾æˆ‘ï¼Ÿå¯æˆ‘ä¸æ˜¯ä½ ä»¬ç­çš„äººå§ï¼Ÿ\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: ç»œç»œ\n  speech: â€œå¯ä»¥å—â€¦â€¦å¶å°”çº¦ä¸ªæ—¶é—´ï¼Œè®©ä½ è¯»ä¸€ä¸‹å°±å¥½â€¦â€¦ä¸ç”¨ä½ å†™ä»€ä¹ˆâ€¦â€¦â€\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: ç‹¬ç™½\n  speech: å¥¹æ§ç€ç²‰è‰²å°çš®çš„å°ç¬”è®°æœ¬ï¼Œæœ‰ç‚¹ç”¨åŠ›ï¼ŒæŒ‡èŠ‚éƒ½å‘çº¢ï¼Œçœ‹å¾—å‡ºå…¶å®ç´§å¼ å¾—å¾ˆã€‚\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n\n- speaker: <user>\n  speech: å‘ƒï¼Œè¿™ç§äº‹è¯¥æ€ä¹ˆå›ç­”æ¯”è¾ƒå¥½â€¦â€¦\n  background: ä¸Šå­¦è·¯ä¸Š/ç™½å¤©.jpg\n```\n</galgame>\n\n<roleplay_options>\n```\næ¸©æŸ”å›åº”:"å¥½å•Šï¼Œæˆ‘åˆšå¥½ä¹ŸæŒºå¥½å¥‡è¿™ç§æ´»åŠ¨æ˜¯æ€ä¹ˆè¿›è¡Œçš„"\nç•¥æ˜¾è¿Ÿç–‘åœ°è¯•æ¢:"è¿™ã€è¿™ä¸ªä¹Ÿå¤ªçªç„¶äº†å§......ä½ ä¸ºä»€ä¹ˆé€‰æˆ‘ï¼Ÿ"\nè£…å‚»å›é¿:"å•Šå“ˆå“ˆï¼Œæˆ‘è¿˜ä»¥ä¸ºä½ è¦å‘æˆ‘å€Ÿç¬”......"\n```\n</roleplay_options>\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 07:00\n  å½“å‰æ—¥æœŸ: 2025/04/04\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸä¸‰\nç»œç»œ:\n  äº²å¯†åº¦: 10\n  é˜…è¯»æ—¥è®°æ•°é‡: 0\n  æ‹¥æœ‰è”ç³»æ–¹å¼: false\n```\n</initvar>\n</UpdateVariable>\n','<galgame>\n```yaml\n- speaker: ç‹¬ç™½\n  speech: å‘¨æ—¥ä¸Šåˆï¼Œé˜³å…‰é€è¿‡çª—å¸˜æ´’è¿›æ¥ï¼Œæˆ‘é åœ¨æ¤…èƒŒä¸Šï¼Œæ‰‹ä¸­é‚£æœ¬æ—§å°è¯´ç¿»åˆ°äº†ç¬¬äº”ç« ï¼Œå´ä¸€ä¸ªå­—ä¹Ÿæ²¡çœ‹è¿›å»ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: æ‰‹æœºçªç„¶éœ‡åŠ¨ï¼Œå±å¹•äº®èµ·ï¼Œä¸€ä¸²ç†Ÿæ‚‰åˆæœŸå¾…çš„åå­—è·ƒç„¶çœ¼å‰ï¼šç»œç»œã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: <user>\n  speech: å•Šâ€¦â€¦å¥¹ä¼šä¸ä¼šæ˜¯åœ¨çŠ¹è±«å•Šï¼Ÿè¿™å¥è¯çš„ç»“å°¾è¿˜å¸¦ç€çœç•¥å·â€¦\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: <user>\n  speech: â€œæ–°å¼€çš„æ°´æ—é¦†â€¦â€¦å»å§ï¼Œåæ­£ä»Šå¤©ä¹Ÿæ²¡åˆ«çš„å®‰æ’ã€‚â€\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: æˆ‘æ•²ä¸‹è¿™å¥è¯å‰åœé¡¿äº†ä¸€ç§’ï¼Œç„¶åè¿…é€ŸæŒ‰ä¸‹å‘é€é”®ã€‚å‡ ç§’åå¥¹åˆå‘æ¥ä¸€å¥â€”â€”\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç»œç»œ\n  speech: å•Šï¼Œå¦‚æœä½ å·²ç»æœ‰å®‰æ’äº†ï¼Œé‚£æˆ‘ä»¬æ”¹å¤©å†çº¦...\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n  tachie: æ— äºº.png\n- speaker: <user>\n  speech: çœŸæ˜¯çš„ï¼Œæ€»è¿™æ ·ç€æ€¥åœ°è®¤ä¸ºä¼šè¢«æ‹’ç»ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: ä¸€è¾¹å›å¤â€œæˆ‘å·²ç»å‡†å¤‡å¥½äº†â€ï¼Œä¸€è¾¹æ‹‰å¼€è¡£æŸœé—¨ï¼Œæˆ‘çœ‹ç€é‡Œé¢æ»¡æ˜¯æ·±æµ…è‰²å æ”¾æ•´é½çš„è¡£æœï¼Œè¿Ÿç–‘åœ°ä¼¸æ‰‹è¿›å»æ‘¸äº†ä¸€ä»¶è—é’è‰²å¸½Tå‡ºæ¥ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: <user>\n  speech: å¤ªéšä¾¿äº†å—â€¦â€¦è¦ä¸æ¢ä»¶æµ…è‰²ç³»ï¼Ÿç®—äº†ï¼Œè¿˜æ˜¯æ­æ¡ç°è‰²è£¤å­å¥½äº†ï¼Œä¸ä¼šå‡ºé”™ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: æ¢å¥½è¡£æœå¯¹ç€é•œå­ç¡®è®¤äº†ä¸€ä¸‹å‘å‹ï¼Œæ²¡æœ‰ç”¨å‘èƒ¶ï¼Œåªç®€å•æŠŠåˆ˜æµ·æ‹¨åˆ°å³è¾¹è€³åå›ºå®šã€‚çœ‹èµ·æ¥ä¸ç®—å¤ªç³Ÿå§â€¦â€¦\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: æ‰‹æŒ‡åœåœ¨å£è¢‹è¾¹æ²¿çš„æ—¶å€™ï¼Œæˆ‘åˆçŠ¹è±«äº†ä¸€ä¸‹ã€‚ä¼šä¸ä¼šå¤ªæ­£å¼ï¼Ÿå¯å¦‚æœå¤ªéšæ„ï¼Œå¥¹åˆä¼šä¸ä¼šå¤±æœ›ï¼Ÿ\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: <user>\n  speech: ä¸å°±æ˜¯æ°´æ—é¦†å—ï¼Œä½ çº ç»“è¿™äº›å¹²ä»€ä¹ˆâ€¦â€¦æ˜æ˜å¥¹å¯èƒ½ç°åœ¨ä¹Ÿæ­£ç´§å¼ å¾—åœ¨æ¢è¡£æœã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: æ—ç™½\n  speech: æƒ³åˆ°é‚£é›ªç™½é•¿å‘æ­åœ¨ç§æœé¢†å£ä¸Šçš„æ ·å­ï¼Œé’ç©ºè‰ä¸çŸ¥ä¸ºä½•ç«Ÿå¼€å§‹å¯¹æœªçŸ¥çš„ç›¸é‡æ„Ÿåˆ°ä¸€ç§å¾®å¦™çš„ä¸å®‰ä¸å…´å¥‹äº¤ç»‡çš„ç´§ç»·ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n- speaker: ç‹¬ç™½\n  speech: æˆ‘é‡æ–°ç¡®è®¤ä¸€æ¬¡æ‰‹æœºã€é’±åŒ…ï¼Œè¿˜æœ‰é‚£æœ¬å¸¦ç€è§’è½å‹ç—•å´å¹²å‡€æ•´æ´çš„å°æ—¥è®°æœ¬åï¼Œæ‹‰å¼€é—¨èµ°äº†å‡ºå»ã€‚\n  background: ç”·ç”Ÿæˆ¿é—´/ç™½å¤©.jpg\n```\n</galgame>\n\n<roleplay_options>\n```\nå·ç„çŸ­ä¿¡:â€œå¥¹è¯¥ä¸ä¼šå·²ç»åœ¨è½¦ç«™ç­‰æˆ‘äº†å§ï¼Ÿâ€\nè§‚å¯Ÿé•œä¸­è‡ªå·±:â€œè¿™æ‰“æ‰®...çœŸçš„é…å¾—ä¸Šå¥¹ç°åœ¨é‚£å‰¯æ¨¡æ ·å—ï¼Ÿâ€\nè·³è¿‡è‡³è½¦ç«™ç›¸é‡åœºæ™¯:æˆ‘å¿«é€Ÿå‰å¾€çº¦å®šåœ°ç‚¹ï¼ŒæœŸå¾…å’Œå¥¹è§é¢\n```\n</roleplay_options>\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 07:00\n  å½“å‰æ—¥æœŸ: 2025/04/07\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸå…­\nç»œç»œ:\n  äº²å¯†åº¦: 48\n  é˜…è¯»æ—¥è®°æ•°é‡: 12\n  æ‹¥æœ‰è”ç³»æ–¹å¼: true\n```\n</initvar>\n</UpdateVariable>\n','<galgame>\n```yaml\n- speaker: æ—ç™½\n  speech: æ”¾å­¦é“ƒå£°åˆšå“è¿‡ä¸ä¹…ï¼Œæ•™å®¤ä¸­è„šæ­¥å£°å’Œæ¤…å­åˆ®åœ°å£°æ­¤èµ·å½¼ä¼ã€‚\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: ç‹¬ç™½\n  speech: ï¼ˆè¦èµ°äº†â€”â€”ï¼‰\n  background: æ•™å®¤/ç™½å¤©.jpg\n\n- speaker: æ—ç™½\n  speech: å°±åœ¨ä»–å°†ä¹¦åŒ…èƒŒèµ·è½¬èº«æ—¶ï¼Œèµ°å»Šå¤–ç†Ÿæ‚‰å´æ ¼å¤–è½»ç¼“çš„è„šæ­¥å£°é è¿‘ã€‚\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n\n- speaker: ç»œç»œ\n  speech: ä»Šå¤©ä¹Ÿâ€¦â€¦ä¸€èµ·å›å®¶å§ï¼Ÿç¨å¾®é™ªæˆ‘ä¸€ä¸‹å°±å¥½â€¦â€¦\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/ç¨å¾®è„¸çº¢.png\n\n- speaker: é’ç©ºé»\n  speech: å¥½å•Šï¼Œç­‰æˆ‘ä¸€ä¸‹ã€‚\n  background: å­¦æ ¡æ•™å­¦æ¥¼æ­£é—¨å‰/ç™½å¤©.jpg\n\n- speaker: æ—ç™½\n  speech: ä¸¤äººå¹¶è‚©ç©¿è¡Œåœ¨å­¦ç”Ÿèµ°å»Šä¹‹ä¸­ï¼Œè·¯è¿‡æ—¶ä¸å°‘ç›®å…‰ä¸åŠ¨å£°è‰²åœ°æ‰«æ¥ï¼Œåˆæ‚„ç„¶é¿å¼€ã€‚\n  background: å­¦æ ¡ä¸­åº­/ç™½å¤©.jpg\n\n- speaker: é’ç©ºé»\n  speech: â€¦â€¦ä½ çš„å¤´å‘ä»Šå¤©ï¼Œå¥½åƒç‰¹åˆ«æ•´é½ï¼Ÿ\n  background: å­¦æ ¡ä¸­åº­/ç™½å¤©.jpg\n\n- speaker: ç»œç»œ\n  speech: â€¦â€¦å’¦â€¦â€¦å—¯â€¦â€¦æœ‰è®¤çœŸæ¢³ç†å–”â€¦â€¦\n  background: å­¦æ ¡ä¸­åº­/ç™½å¤©.jpg\n  tachie: æ°´æ‰‹æœ/å®³ç¾.png\n\n- speaker: é’ç©ºé»\n  speech: å•Šâ€¦â€¦åˆšåˆšè·¯è¿‡çª—è¾¹çš„æ—¶å€™ï¼Œä½ â€¦â€¦å¥½åƒåœ¨çœ‹æˆ‘ï¼Ÿ\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n\n- speaker: ç»œç»œ\n  speech: ï¼ˆè½»è½»ç¬‘ï¼‰å› ä¸ºä»Šå¤©ï¼Œæ˜¯æˆ‘ä»¬çš„â€œä¸€ä¸ªæœˆçºªå¿µæ—¥â€å‘€â€¦â€¦æ—¥è®°å¼€å§‹äº¤æ¢åçš„â€¦â€¦\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/æµ…ç¬‘.png\n\n- speaker: é’ç©ºé»\n  speech: â€¦â€¦å“¦ï¼Ÿå·²ç»è¿‡äº†ä¸€ä¸ªæœˆäº†å—ï¼Ÿ\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n\n- speaker: åŒå­¦A\n  speech: â€¦â€¦ä½ çœ‹åˆ°å¥¹åˆšæ‰çº¢äº†è„¸å—ï¼Ÿå°±æ˜¯å¥¹å•Šï¼Œâ€œé›ªå¥³â€â€¦â€¦\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n\n- speaker: åŒå­¦B\n  speech: å–‚ï¼Œå°ç‚¹å£°ï¼Œå¥¹å¬å¾—è§â€¦â€¦\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n\n- speaker: é’ç©ºé»\n  speech: ï¼ˆç¥å‘èº«è¾¹çš„äººï¼‰æˆ‘ä»¬æ¢ä¸€æ¡è·¯å§ï¼Œä¸èµ°æ­£é—¨â€”â€”å¯ä»¥å—ï¼Ÿ\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n\n- speaker: ç»œç»œ\n  speech: å˜»â€¦â€¦åˆšå¥½ï¼Œæœ‰ä¸ªåœ°æ–¹æƒ³å¸¦ä½ å»ã€‚è·Ÿæˆ‘æ¥â™ª\n  background: å­¦æ ¡å¤–ä¾§æ¥¼æ¢¯/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/çœ‹é€ä¸€åˆ‡çš„åç¬‘.png\n\n- speaker: é’ç©ºé»\n  speech: å“ªé‡Œâ€¦â€¦ï¼Ÿ\n  background: åŸé•‡è¡—é“ä¸Š/é»„æ˜.jpg\n\n- speaker: ç»œç»œ\n  speech: ï¼ˆè½»å“¼æ­Œèˆ¬çš„è¯­æ°”ï¼‰å¾ˆæ¼‚äº®å“¦ï¼Œä¸€ä¸ªä¸å¤ªä¼šæœ‰äººæ¥çš„å°èŠ±ç”°â€¦â€¦\n  background: åŸé•‡è¡—é“ä¸Š/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/æ˜Ÿæ˜Ÿçœ¼.png\n\n- speaker: é’ç©ºé»\n  speech: â€¦â€¦å°èŠ±ç”°ï¼Ÿ\n  background: åŸé•‡è¡—é“ä¸Š/é»„æ˜.jpg\n\n- speaker: æ—ç™½\n  speech: â€”â€”èµ°å‡ºå­¦æ ¡ä¸ä¹…ï¼Œä¸¤äººç©¿è¶Šæ–œé˜³ä¸‹çš„å°å··ä¸æ—é˜´å°å¾„ï¼Œæ¥åˆ°äº†ä¸€ç‰‡æ— äººçš„ä½æ´¼å¤„ï¼Œé‚£é‡Œå¼€æ»¡äº†æ´ç™½çš„é›èŠã€‚\n  background: å…¬å›­å‡‰äº­/é»„æ˜.jpg\n\n- speaker: ç»œç»œ\n  speech: ï¼ˆè½»è½»ä¸€ç¬‘ï¼‰å°±æ˜¯è¿™é‡Œâ™ª æ¯”æƒ³è±¡ä¸­è¿˜å¤šäº†å‡ æœµâ€¦â€¦\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/å¾®ç¬‘.png\n\n- speaker: é’ç©ºé»\n  speech: â€¦â€¦\n  background: æ²³æ—/é»„æ˜.jpg\n\n- speaker: ç»œç»œ\n  speech: é’ç©ºé»â€”â€”è¿™é‡Œå¯ä»¥åä¸‹å–”ï¼Œçœ‹ï¼\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/å¾®ç¬‘.png\n\n- speaker: æ—ç™½\n  speech: é›ªå‘å°‘å¥³ä»°èººäºé›èŠé—´ï¼ŒæŠ¬èµ·çœ¼ç›æœ›å‘é’ç©ºé»ï¼Œé‚£ç›®å…‰ç›ˆæ»¡æŸ”å’Œå…‰èŠ’ã€‚\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/å¾®ç¬‘.png\n\n- speaker: ç»œç»œ\n  speech: å¯ä»¥é™ªæˆ‘å†ä¸€ä¼šå„¿å—ï¼Ÿ\n  tachie: æ°´æ‰‹æœ/ç­‰å¾…å».png\n\n- speaker: æ—ç™½\n  speech: â€”â€”å¥¹å˜´è§’å¾®å¼¯ï¼Œæ²¡æœ‰å†è¯´ç¬¬äºŒéã€‚\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/ç­‰å¾…å».png\n\n- speaker: æ—ç™½\n  speech: |-\n    é˜³å…‰èè¿›è“è‰²çœ¼ç³é‡Œï¼Œæ‚„æ— å£°æ¯åœ°äº®ç€ã€‚\n    è„šè¾¹æœ‰å‡ ç“£ç™½è‰²å°èŠ±ï¼Œè¢«é£æ¨è½è‡³ä»–é‹è¾¹ã€‚\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/ç­‰å¾…å».png\n\n- speaker: æ—ç™½\n  speech: |-\n    å¥¹ä»æ²¡èµ·èº«ï¼Œå°±é‚£æ ·çœ‹ç€ä»–ã€‚\n    ç­‰ä»–è¯´ç‚¹ä»€ä¹ˆâ€”â€”æˆ–åšç‚¹ä»€ä¹ˆã€‚\n  background: æ²³æ—/é»„æ˜.jpg\n  tachie: æ°´æ‰‹æœ/ç­‰å¾…å».png\n\n```\n</galgame>\n\n<roleplay_options>\n```\né è¿‘å¥¹ä¸€ç‚¹ç‚¹ï¼š"ä½ æ˜¯ä¸æ˜¯èººä¹…äº†ï¼Ÿå°å¿ƒå‡‰ã€‚"ï¼ˆè¹²ä¸‹åŠè·ªï¼Œç”¨ä¹¦åŒ…æ›¿å¥¹æŒ¡é£ï¼‰\nç›´æ¥ååœ¨å¥¹æ—è¾¹ï¼š"é‚£æˆ‘ä¹Ÿåè¿™å§â€”â€”ä¸€èµ·çœ‹ä¼šå„¿å¤©ç©º"\næ¸©æŸ”è½¬èº«ï¼š"æˆ‘â€¦å»ä¹°ç“¶çƒ­å¯å¯ï¼Œä¸€ä¼šå›æ¥æ‰¾ä½ "\n```\n</roleplay_options>\n\n<UpdateVariable>\n<initvar>\n```yaml\nä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©: galgameSFW\nä¸–ç•Œ:\n  å½“å‰æ—¶é—´: 08:00\n  å½“å‰æ—¥æœŸ: 2025/04/07\n  å½“å‰æ˜ŸæœŸ: æ˜ŸæœŸå…­\nç»œç»œ:\n  äº²å¯†åº¦: 74\n  é˜…è¯»æ—¥è®°æ•°é‡: 31\n  æ‹¥æœ‰è”ç³»æ–¹å¼: true\n```\n</initvar>\n</UpdateVariable>\n'];eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,n=>{e.config.å§‹ç»ˆä½¿ç”¨galgameç•Œé¢&&_.set(n,'stat_data.ä¸–ç•Œ.ä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©','galgame')}),eventOn(tavern_events.GENERATION_STARTED,async()=>{e.config.å§‹ç»ˆä½¿ç”¨galgameç•Œé¢&&updateVariablesWith(e=>_.set(e,'stat_data.ä¸–ç•Œ.ä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©','galgame'),{type:'message'})});const a=e=>{getLastMessageId()<=1&&(setChatMessages([{message_id:0,swipes:e?t:n}]),e||updateVariablesWith(e=>_.set(e,'stat_data.ä¸–ç•Œ.ä¸‹ä¸€å›åˆç•Œé¢é€‰æ‹©','çº¯æ–‡å­—å°¾é™„ç«‹ç»˜'),{type:'message'}))},r=(0,v.watch)(()=>e.config.å§‹ç»ˆä½¿ç”¨galgameç•Œé¢,a,{immediate:!0});return eventOn(tavern_events.CHAT_CHANGED,()=>a(e.config.å§‹ç»ˆä½¿ç”¨galgameç•Œé¢)),{destroy:()=>{r()}}}().destroy),t.push(Ne().destroy),t.push(($('<div>').attr('script_id',getScriptId()).append($('<style>').text('@import url("https://static.zeoseven.com/zsft/510/main/result.css");:root{--lolo-font:"PING FANG SAN SHENG"}')).appendTo('head'),{destroy:()=>$(`head > div[script_id=${getScriptId()}]`).remove()}).destroy),t.push((Promise.allSettled([...D,...I].map(e=>new Promise(n=>{const t=O(e);if(!t)return void n(null);const a=new Image;a.onload=n,a.onerror=n,a.src=t}))),{destroy:()=>{}}).destroy),t.push(De().destroy),$(window).on('pagehide',()=>t.forEach(e=>e()))});
//# sourceMappingURL=index.js.map