<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monastery Chronicles - ADV Test</title>
    <!-- Font Awesome for Icons (Optional, but used) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />

    <style>
      /* --- Base & Font --- */
      @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@400;700&display=swap'); /* Example fonts: Cinzel for headers, Lato for body */

      :root {
        --bg-color: #2a2a2a; /* Dark background */
        --text-color: #d1d1d1; /* Light grey text */
        --text-muted-color: #888;
        --primary-color: #8a6d3b; /* Muted gold/brown accent */
        --secondary-color: #5a4a2a;
        --border-color: #444;
        --container-bg: #333; /* Slightly lighter container background */
        --button-bg: #454545;
        --button-hover-bg: #555;
        --modal-bg: #3a3a3a;

        --font-heading: 'Cinzel', serif;
        --font-body: 'Lato', sans-serif;
      }

      html,
      body {
        height: 100%; /* Use full viewport height */
        margin: 0;
        padding: 0;
        font-family: var(--font-body);
        background-color: var(--bg-color);
        color: var(--text-color);
        font-size: 16px;
        line-height: 1.6;
        overflow-x: hidden; /* Prevent horizontal scroll */
      }

      /* --- Layout & Containers --- */
      .container-fluid {
        display: flex;
        flex-direction: column;
        height: 100%;
        padding: 0;
        max-width: 1200px; /* Optional: Max width for very large screens */
        margin: 0 auto;
        box-sizing: border-box;
      }

      .content-area {
        flex-grow: 1; /* Fill remaining vertical space */
        overflow-y: auto; /* Allow content to scroll */
        padding: 1rem;
        background-color: var(--bg-color); /* Keep consistent background */
        min-height: 0; /* Prevent flex blowout */
      }

      .page {
        display: none;
        animation: fadeIn 0.5s ease;
      }
      .page.active {
        display: block;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* --- Navigation Bar --- */
      .nav-tabs {
        list-style: none;
        padding: 0;
        margin: 0;
        background-color: var(--container-bg);
        display: flex;
        border-bottom: 1px solid var(--border-color);
        flex-shrink: 0;
      }
      .nav-item {
        margin: 0;
      }
      .nav-link {
        display: block;
        padding: 0.8rem 1.5rem;
        color: var(--text-muted-color);
        text-decoration: none;
        border: none;
        border-right: 1px solid var(--border-color);
        transition: background-color 0.3s ease, color 0.3s ease;
        white-space: nowrap;
        cursor: pointer;
      }
      .nav-link i {
        margin-right: 0.5rem;
      }
      .nav-link:hover {
        background-color: var(--button-hover-bg);
        color: var(--text-color);
      }
      .nav-link.active {
        background-color: var(--bg-color); /* Match content area bg */
        color: var(--primary-color);
        font-weight: bold;
        border-bottom: 2px solid var(--primary-color); /* Indicator */
        margin-bottom: -1px; /* Align border */
      }

      /* --- Buttons --- */
      .btn {
        padding: 0.4rem 0.8rem;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        font-size: 0.9em;
        border: 1px solid transparent;
        transition: background-color 0.2s ease, border-color 0.2s ease;
        display: inline-flex; /* Align icon and text */
        align-items: center;
        gap: 0.3rem;
      }
      .btn i {
        line-height: 1;
      } /* Better icon alignment */
      .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        color: #fff;
      }
      .btn-primary:hover {
        background-color: var(--secondary-color);
        border-color: var(--secondary-color);
      }
      .btn-secondary {
        background-color: var(--button-bg);
        border-color: var(--border-color);
        color: var(--text-color);
      }
      .btn-secondary:hover {
        background-color: var(--button-hover-bg);
      }
      .btn-outline-light {
        color: var(--text-color);
        border-color: var(--border-color);
      }
      .btn-outline-light:hover {
        background-color: var(--button-bg);
        color: #fff;
      }
      .btn-danger {
        background-color: #a94442; /* Dark red */
        border-color: #a94442;
        color: #fff;
      }
      .btn-danger:hover {
        background-color: #8a3735;
        border-color: #8a3735;
      }
      .btn-sm {
        padding: 0.25rem 0.5rem;
        font-size: 0.8em;
      }
      .btn-close {
        /* For modal */
        background: none;
        border: none;
        font-size: 1.5rem;
        color: var(--text-muted-color);
        cursor: pointer;
        padding: 0;
      }
      .btn-close:hover {
        color: var(--text-color);
      }

      /* --- Story Page Specific --- */
      .game-container {
        max-width: 900px;
        margin: 0 auto;
        background-color: var(--container-bg);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        min-height: 600px; /* Ensure minimum height */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .info-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.6rem 1rem;
        background-color: rgba(0, 0, 0, 0.2); /* Slightly darker bar */
        border-bottom: 1px solid var(--border-color);
        flex-wrap: wrap; /* Allow wrapping on small screens */
        gap: 0.5rem;
        flex-shrink: 0;
      }
      .info-details {
        display: flex;
        flex-wrap: wrap; /* Allow wrapping */
        gap: 0.5rem 1rem; /* Row and column gap */
        font-size: 0.85em;
        color: var(--text-muted-color);
        flex-grow: 1;
      }
      .info-details i {
        margin-right: 0.3rem;
        color: var(--primary-color);
      }
      .info-actions {
        flex-shrink: 0;
      }

      .vn-container {
        position: relative;
        width: 100%;
        height: 450px; /* Fixed height for VN area */
        min-height: 300px;
        background-color: #000; /* Default background if scene fails */
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }
      .scene-container {
        position: relative;
        width: 100%;
        flex-grow: 1;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }
      .effect-overlay {
        /* Keep for potential future effects */
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 5;
      }
      .character-sprite {
        /* Add basic sprite styling */
        position: absolute;
        bottom: 0;
        height: 80%;
        max-width: 40%;
        object-fit: contain;
        z-index: 2;
        filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
        /* Add positioning classes later in JS as needed */
      }

      .text-box-container {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 10px 15px;
        z-index: 10;
        box-sizing: border-box;
      }
      .name-box {
        display: inline-block;
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 4px 12px;
        border-radius: 4px;
        margin-bottom: 5px;
        font-weight: bold;
        font-family: var(--font-heading);
      }
      .text-box {
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 10px 15px;
        border-radius: 4px;
        font-size: 1em;
        line-height: 1.6;
        width: 100%;
        box-sizing: border-box;
        max-height: 150px;
        overflow-y: auto;
        margin-bottom: 8px;
      }
      .text-controls {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        margin-top: auto;
      }
      .text-btn {
        background-color: rgba(0, 0, 0, 0.5);
        border: 1px solid #555;
        color: var(--text-muted-color);
        padding: 4px 10px;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 0.8em;
      }
      .text-btn:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
      }

      .interaction-options {
        background-color: rgba(0, 0, 0, 0.2); /* Match info bar */
        border-top: 1px solid var(--border-color);
        padding: 1rem;
        flex-shrink: 0;
      }
      .options-header h4 {
        margin: 0 0 0.8rem 0;
        font-family: var(--font-heading);
        color: var(--primary-color);
        font-size: 1.1em;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 0.5rem;
      }
      .options-list {
        padding: 0;
        margin: 0;
        list-style: none;
      }
      .btn-option {
        /* Style for generated option buttons */
        display: block;
        width: 100%;
        text-align: left;
        background-color: var(--button-bg);
        color: var(--text-color);
        border: 1px solid var(--border-color);
        padding: 0.6rem 1rem;
        margin-bottom: 0.5rem;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.2s ease, border-color 0.2s ease;
      }
      .btn-option:hover {
        background-color: var(--button-hover-bg);
        border-color: var(--primary-color);
      }
      .custom-option-input {
        margin-top: 1rem;
      }
      .custom-option-input label {
        font-size: 0.9em;
        color: var(--text-muted-color);
        margin-bottom: 0.3rem;
        display: block;
      }
      .input-group {
        display: flex;
      } /* Basic input group */
      .form-control {
        flex-grow: 1;
        padding: 0.5rem;
        background-color: #fff; /* Light input background for contrast */
        border: 1px solid #ccc;
        color: #333;
        border-radius: 4px 0 0 4px;
      }
      .custom-option-input .btn {
        border-radius: 0 4px 4px 0;
      } /* Adjust button radius */

      /* --- Function Page Specific --- */
      .function-container {
        display: flex;
        gap: 1rem;
        background-color: var(--container-bg);
        padding: 1rem;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        min-height: 500px;
      }
      .people-column {
        flex: 0 0 250px; /* Fixed width for people list */
        border-right: 1px solid var(--border-color);
        padding-right: 1rem;
      }
      .people-column h3,
      .knowledge-column h3 {
        font-family: var(--font-heading);
        color: var(--primary-color);
        margin-top: 0;
        margin-bottom: 1rem;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 0.5rem;
      }
      #peopleList {
        list-style: none;
        padding: 0;
        margin: 0;
        max-height: 450px; /* Allow scrolling if many people */
        overflow-y: auto;
      }
      #peopleList li {
        padding: 0.6rem 0.8rem;
        cursor: pointer;
        border-radius: 4px;
        margin-bottom: 0.3rem;
        transition: background-color 0.2s ease;
      }
      #peopleList li:hover,
      #peopleList li.active {
        background-color: var(--button-bg);
      }
      .knowledge-column {
        flex-grow: 1;
        overflow-y: auto; /* Allow content scroll */
      }
      #knowledgeContent {
        font-size: 0.95em;
        line-height: 1.7;
        color: var(--text-color);
      }
      #knowledgeContent h4 {
        /* Style for potential subheadings in content */
        font-family: var(--font-heading);
        color: var(--primary-color);
        margin-top: 1.5rem;
        margin-bottom: 0.5rem;
      }

      /* --- Summary Page Specific --- */
      .summary-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 1rem;
      }
      .summary-container h2 {
        font-family: var(--font-heading);
        color: var(--primary-color);
        text-align: center;
        margin-bottom: 1.5rem;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 0.8rem;
      }
      .summary-stack {
        padding: 0;
        margin: 0;
        list-style: none;
      }
      .summary-entry.card {
        /* Basic card style for summary */
        background-color: var(--container-bg);
        border: 1px solid var(--border-color);
        border-radius: 4px;
        padding: 1rem 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }
      .entry-meta {
        margin-bottom: 0.6rem;
        font-size: 0.8em;
        color: var(--text-muted-color);
        opacity: 0.8;
      }
      .entry-id {
        font-weight: bold;
        color: var(--primary-color);
      }
      .entry-content p {
        margin: 0;
        line-height: 1.7;
        color: var(--text-color);
      }

      /* --- Modal Specific --- */
      .modal {
        /* Basic modal overlay */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        backdrop-filter: blur(3px);
      }
      .modal-dialog {
        /* Use Bootstrap class or custom */
        max-width: 500px;
        width: 90%;
      }
      .modal-content {
        background-color: var(--modal-bg);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        max-height: 80vh; /* Limit modal height */
      }
      .modal-header {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .modal-title {
        font-family: var(--font-heading);
        margin: 0;
        font-size: 1.2em;
        color: var(--primary-color);
      }
      .modal-body {
        padding: 1rem;
        overflow-y: auto; /* Scroll body if needed */
      }
      .modal-footer {
        padding: 1rem;
        border-top: 1px solid var(--border-color);
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
      }
      #locationList {
        /* Style list inside modal */
        padding: 0;
        margin: 0;
        list-style: none;
      }
      #locationList button.list-group-item {
        /* Style locations as buttons */
        display: block;
        width: 100%;
        text-align: left;
        padding: 0.75rem 1.25rem;
        margin-bottom: -1px;
        background-color: var(--button-bg);
        color: var(--text-color);
        border: 1px solid var(--border-color);
        cursor: pointer;
        transition: background-color 0.2s ease;
      }
      #locationList button.list-group-item:first-child {
        border-top-left-radius: 0.25rem;
        border-top-right-radius: 0.25rem;
      }
      #locationList button.list-group-item:last-child {
        margin-bottom: 0;
        border-bottom-right-radius: 0.25rem;
        border-bottom-left-radius: 0.25rem;
      }
      #locationList button.list-group-item:hover {
        background-color: var(--button-hover-bg);
      }
      #locationList button.list-group-item.active {
        background-color: var(--primary-color);
        color: #fff;
        border-color: var(--primary-color);
      }

      /* --- Utility & Placeholders --- */
      .placeholder-text {
        color: var(--text-muted-color);
        font-style: italic;
      }
      .placeholder-item {
        color: var(--text-muted-color);
        padding: 0.5rem;
      }
      .ms-2 {
        margin-left: 0.5rem;
      }
      .ms-3 {
        margin-left: 1rem;
      }
      .mt-3 {
        margin-top: 1rem;
      }
      .mb-3 {
        margin-bottom: 1rem;
      }
      .list-group {
        list-style: none;
        padding-left: 0;
        margin-bottom: 1rem;
      } /* Basic list group reset */

      /* Add Responsive Design Adjustments Here if needed */
      @media (max-width: 768px) {
        .info-bar {
          flex-direction: column;
          align-items: flex-start;
        }
        .info-actions {
          margin-top: 0.5rem;
        }
        .function-container {
          flex-direction: column;
        }
        .people-column {
          border-right: none;
          border-bottom: 1px solid var(--border-color);
          padding-right: 0;
          margin-bottom: 1rem;
          padding-bottom: 1rem;
        }
        .vn-container {
          height: 350px;
        } /* Adjust VN height */
      }
    </style>
  <script type="module">var __webpack_modules__ = {
  "./src/圣约与静默/galgame/index.js"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _index_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index.scss */ \"./src/圣约与静默/galgame/index.scss\");\n\n\n/**\n * 对话界面核心功能\n * 提供简单的对话显示和点击/空格下一步功能\n */\n\nclass GalgameEngine {\n  constructor() {\n    this.currentIndex = 0;\n    this.isAnimating = false;\n    this.activeCharacters = {}; // 存储当前活动的角色\n    this.isTransitioning = false; // 防止动画重叠\n    this.currentBgPath = ''; // 当前显示的背景路径\n    this.dialogHistory = []; // 存储对话历史\n\n    // 获取DOM元素\n    this.dialogBox = document.getElementById('dialog-box');\n    this.characterName = document.getElementById('character-name');\n    this.dialogText = document.getElementById('dialog-text');\n    this.currentImage = document.getElementById('background-image-current');\n    this.nextImage = document.getElementById('background-image-next');\n    this.characterContainer = document.getElementById('character-container');\n    this.historyPanel = document.getElementById('history-panel');\n    this.historyContent = document.getElementById('history-content');\n\n    // ===== 第一处可自定义：CG图片链接 =====\n    // 在这里添加您的CG图片URL数组\n    // 可以添加任意数量的图片链接\n    // 注意: URL需要是可以直接访问的图片地址，你可以使用如catbox来进行将图片转为链接。推荐分辨率1920x1080\n    const cgUrls = [\n      // 示例格式：\n      // 'https://example.com/image1.jpg',\n      // 'https://example.com/image2.jpg',\n      // 'https://example.com/image3.jpg',\n      'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%95%86%E5%BA%97%E8%A1%97/%E9%BB%84%E6%98%8F.jpg',\n      'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%95%86%E5%BA%97%E8%A1%97/%E5%A4%9C%E6%99%9A%E5%BC%80%E7%81%AF.jpg',\n    ];\n\n    // ===== 可自定义背景图片基础 URL =====\n    this.imageBaseUrl = 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/背景/';\n\n    // ===== 可自定义角色立绘链接 =====\n    this.characterSpritesBaseUrl = 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/';\n\n    // ===== 新增可自定义：角色立绘链接 =====\n    // 角色立绘图片URL对象\n    // 键名作为角色的标识符，值是包含不同服装的对象，每种服装包含不同表情的立绘URL\n    const characterSprites = {\n      络络: {\n        水手服: {\n          '微笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/微笑.png',\n          '浅笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/浅笑.png',\n          '生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/生气.png',\n          '惊讶.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/惊讶.png',\n          '害羞.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/害羞.png',\n          '稍微脸红.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/稍微脸红.png',\n          '手托下巴思考.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/手托下巴思考.png',\n          '看透一切的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/看透一切的坏笑.png',\n          '邪恶的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/邪恶的坏笑.png',\n          '星星眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/星星眼.png',\n          '晕晕眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/晕晕眼.png',\n          '猫爪生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/猫爪生气.png',\n          '流口水.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/流口水.png',\n          '哭泣.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/哭泣.png',\n          '擦眼泪.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/擦眼泪.png',\n          '等待吻.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/等待吻.png',\n          '性高潮.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/性高潮.png',\n          '眼神空洞的催眠状态.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/眼神空洞的催眠状态.png',\n          '无表情.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/无表情.png',\n          '无人.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/水手服/无人.png',\n        },\n        格纹衫: {\n          '微笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/微笑.png',\n          '浅笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/浅笑.png',\n          '生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/生气.png',\n          '惊讶.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/惊讶.png',\n          '害羞.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/害羞.png',\n          '稍微脸红.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/稍微脸红.png',\n          '手托下巴思考.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/手托下巴思考.png',\n          '看透一切的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/看透一切的坏笑.png',\n          '邪恶的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/邪恶的坏笑.png',\n          '星星眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/星星眼.png',\n          '晕晕眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/晕晕眼.png',\n          '猫爪生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/猫爪生气.png',\n          '流口水.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/流口水.png',\n          '哭泣.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/哭泣.png',\n          '擦眼泪.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/擦眼泪.png',\n          '等待吻.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/等待吻.png',\n          '性高潮.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/性高潮.png',\n          '眼神空洞的催眠状态.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/眼神空洞的催眠状态.png',\n          '无人.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/格纹衫/无人.png',\n        },\n        开衫: {\n          '微笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/微笑.png',\n          '浅笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/浅笑.png',\n          '生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/生气.png',\n          '惊讶.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/惊讶.png',\n          '害羞.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/害羞.png',\n          '稍微脸红.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/稍微脸红.png',\n          '手托下巴思考.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/手托下巴思考.png',\n          '看透一切的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/看透一切的坏笑.png',\n          '邪恶的笑容.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/邪恶的笑容.png',\n          '星星眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/星星眼.png',\n          '晕晕眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/晕晕眼.png',\n          '猫爪生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/猫爪生气.png',\n          '流口水.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/流口水.png',\n          '哭泣.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/哭泣.png',\n          '擦眼泪.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/擦眼泪.png',\n          '等待吻.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/等待吻.png',\n          '性高潮.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/性高潮.png',\n          '无表情.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/无表情.png',\n          '无人.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/开衫/无人.png',\n        },\n        睡衣: {\n          '微笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/微笑.png',\n          '浅笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/浅笑.png',\n          '生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/生气.png',\n          '惊讶.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/惊讶.png',\n          '害羞.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/害羞.png',\n          '稍微脸红.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/稍微脸红.png',\n          '看透一切的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/看透一切的坏笑.png',\n          '邪恶的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/邪恶的坏笑.png',\n          '星星眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/星星眼.png',\n          '晕晕眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/晕晕眼.png',\n          '猫爪生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/猫爪生气.png',\n          '流口水.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/流口水.png',\n          '哭泣.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/哭泣.png',\n          '等待吻.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/等待吻.png',\n          '性高潮.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/性高潮.png',\n          '眼神空洞的催眠状态.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/眼神空洞的催眠状态.png',\n          '无人.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/睡衣/无人.png',\n        },\n        全裸: {\n          '浅笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸浅笑.png',\n          '生气.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸生气.png',\n          '惊讶.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸惊讶.png',\n          '害羞.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸害羞.png',\n          '稍微脸红.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸微微害羞.png',\n          '看透一切的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸得意脸smug.png',\n          '邪恶的坏笑.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸邪恶的笑容.png',\n          '坏笑.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸坏笑.png',\n          '星星眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸闪耀眼.png',\n          '晕晕眼.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸晕眼@_@.png',\n          '流口水.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸看到食物馋到流口水.png',\n          '哭泣.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸哭泣.png',\n          '等待吻.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸等待接吻.png',\n          '性高潮.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸色情高潮啊嘿颜.png',\n          '眼神空洞的催眠状态.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/全裸被催眠双眼无神留口水.png',\n          '无人.png': 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/角色/全裸/无人.png',\n        },\n      },\n      你: {\n        默认: {\n          '默认.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E7%AD%89%E5%BE%85%E5%90%BB.png',\n          '惊讶.png':\n            'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%93%AD%E6%B3%A3.png',\n        },\n      },\n    };\n\n    try {\n      const message = SillyTavern.chat[getCurrentMessageId()].mes;\n      const gameDataString = message.match(/<Galgame>\\s*```(?:json|yaml)?(.*)```\\s*<\\/Galgame>/s)[1]; // 获取数据并去除首尾空格\n\n      if (!gameDataString) {\n        throw new Error('游戏数据 <Galgame> 为空。');\n      }\n\n      let parsedData = null;\n\n      // 尝试解析为 JSON\n      try {\n        parsedData = JSON.parse(gameDataString);\n        console.log('游戏数据加载成功 (JSON 格式)');\n      } catch (jsonError) {\n        console.warn('JSON 解析失败，尝试解析为 YAML:', jsonError.message);\n        // 如果 JSON 解析失败，尝试解析为 YAML\n        try {\n          parsedData = YAML.parse(gameDataString);\n        } catch (yamlError) {\n          console.error('YAML 解析也失败:', yamlError);\n          // 如果两种解析都失败，抛出合并的错误信息\n          throw new Error(\n            `数据解析失败：既不是有效的 JSON 也不是有效的 YAML。JSON 错误: ${jsonError.message} | YAML 错误: ${yamlError.message}`,\n          );\n        }\n      }\n\n      // 检查解析后的数据是否有效（例如，是否为数组且不为空）\n      if (!Array.isArray(parsedData) || parsedData.length === 0) {\n        console.warn('加载的对话数据为空或格式无效 (预期为非空数组)，将加载默认提示信息。');\n        this.dialogData = [{ name: '系统提示', text: '加载的对话数据为空或格式无效。', characters: 'narrator' }];\n      } else {\n        this.dialogData = parsedData;\n        console.log('最终使用的游戏数据:', this.dialogData);\n      }\n    } catch (error) {\n      // 捕获所有加载/解析过程中的错误\n      console.error('加载或解析游戏数据时出错:', error);\n      this.dialogData = [{ name: '系统提示', text: `加载对话数据失败：${error.message}`, characters: 'narrator' }];\n    }\n    // ===== 数据加载结束 =====\n\n    // 设置角色立绘\n    this.characterSprites = characterSprites;\n\n    // 初始化事件监听\n    this.initEventListeners();\n\n    // 显示第一条对话前，确保背景和界面已正确设置\n    this.initializeBackground();\n\n    // 显示第一条对话\n    this.showDialog(0);\n  }\n\n  // 初始化背景图片\n  initializeBackground() {\n    if (this.dialogData && this.dialogData.length > 0 && this.dialogData[0].background) {\n      // 设置初始背景\n      const initialBgPath = this.dialogData[0].background;\n      const initialBgUrl = this.getFullImageUrl(initialBgPath);\n\n      console.log('初始化背景图片:', initialBgUrl);\n\n      // 先检查元素是否存在\n      if (!this.currentImage) {\n        console.error('背景图片元素不存在!');\n        return;\n      }\n\n      // 记录当前显示的背景，方便后续比较\n      this.currentBgPath = initialBgPath;\n\n      // 直接设置当前背景图片\n      this.currentImage.src = initialBgUrl;\n      this.currentImage.style.opacity = '1';\n\n      this.currentImage.onerror = () => {\n        console.error('背景图片加载失败:', initialBgUrl);\n        // 尝试使用预设的CG URL\n        this.currentImage.src =\n          'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%95%86%E5%BA%97%E8%A1%97/%E9%BB%84%E6%98%8F.jpg';\n      };\n\n      // 检查图片是否已经加载完成\n      if (this.currentImage.complete) {\n        console.log('背景图片已加载完成');\n      } else {\n        this.currentImage.onload = () => {\n          console.log('背景图片加载完成');\n        };\n      }\n    }\n  }\n\n  // 获取完整的图片URL，处理URL编码问题\n  getFullImageUrl(relativePath) {\n    if (!relativePath) return '';\n\n    // 使用预定义的硬编码URL\n    if (relativePath === '商店街/黄昏.jpg') {\n      return 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%95%86%E5%BA%97%E8%A1%97/%E9%BB%84%E6%98%8F.jpg';\n    } else if (relativePath === '商店街/夜晚开灯.jpg') {\n      return 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%95%86%E5%BA%97%E8%A1%97/%E5%A4%9C%E6%99%9A%E5%BC%80%E7%81%AF.jpg';\n    }\n\n    // 如果不是硬编码的图片，则尝试构建URL\n    // 拆分路径以便正确编码每个部分\n    try {\n      const pathParts = relativePath.split('/');\n      const encodedParts = pathParts.map(part => encodeURIComponent(part));\n      const encodedPath = encodedParts.join('/');\n\n      return this.imageBaseUrl + encodedPath;\n    } catch (error) {\n      console.error('URL编码失败:', error, '原始路径:', relativePath);\n      return '';\n    }\n  }\n\n  initEventListeners() {\n    // 点击屏幕任意位置进入下一步\n    document.addEventListener('click', () => {\n      this.nextDialog();\n    });\n\n    // 按空格键进入下一步\n    document.addEventListener('keydown', event => {\n      if (event.code === 'Space') {\n        event.preventDefault();\n        this.nextDialog();\n      }\n    });\n  }\n\n  showDialog(index) {\n    if (index >= this.dialogData.length) {\n      // 对话结束，可以添加结束画面或循环播放\n      console.log('对话结束，重新开始');\n      this.currentIndex = 0;\n      this.showDialog(0);\n      return;\n    }\n\n    // 更新当前对话索引 - 非常重要\n    this.currentIndex = index;\n\n    const dialog = this.dialogData[index];\n    if (!dialog) {\n      console.error('对话数据不存在:', index);\n      return;\n    }\n\n    // 检查是否需要背景转场 - 比较当前背景与目标背景\n    const newBgPath = dialog.background || '';\n    const needBackgroundTransition = newBgPath && this.currentBgPath !== newBgPath;\n\n    console.log(\n      `显示对话 #${index}`,\n      dialog.name,\n      '当前背景:',\n      this.currentBgPath || '(无)',\n      '新背景:',\n      newBgPath || '(无)',\n      '需要转场:',\n      needBackgroundTransition,\n    );\n\n    // 如果需要背景转场，先执行背景转场\n    if (needBackgroundTransition) {\n      console.log('执行背景转场 - 从', this.currentBgPath || '(无)', '到', newBgPath);\n\n      // 修复：检查是否切换到CG（没有角色的情况），如果是，先隐藏所有当前角色\n      if (dialog.characters === 'narrator' || dialog.characters === 'protagonist' || !dialog.characters) {\n        // 先移除所有当前角色，再进行背景转场\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        // 清空活动角色记录\n        this.activeCharacters = {};\n      }\n\n      // 更新当前背景记录\n      this.currentBgPath = newBgPath;\n\n      this.fadeOutIn(() => {\n        return newBgPath;\n      }, dialog); // 传递当前对话以便在转场完成后更新\n    } else {\n      // 否则直接更新角色和对话\n      this.updateDialogContent(dialog);\n    }\n  }\n\n  // 更新对话内容\n  updateDialogContent(dialog) {\n    if (!dialog) {\n      console.error('更新对话内容失败: 对话数据为空');\n      return;\n    }\n\n    console.log('更新对话内容:', dialog.name, dialog.text);\n\n    // 更新角色立绘\n    this.updateCharacters(dialog);\n\n    // 应用打字机效果\n    this.characterName.textContent = dialog.name;\n    this.applyTypingEffect(dialog.text);\n\n    // 添加到对话历史\n    this.addToHistory(dialog);\n  }\n\n  applyTypingEffect(text) {\n    this.isAnimating = true;\n    this.dialogText.textContent = '';\n    document.getElementById('next-hint').style.opacity = '0'; // 隐藏提示\n\n    // 计算打字速度 - 根据文本长度动态调整\n    const baseSpeed = 30;\n    const speedModifier = Math.max(0.5, Math.min(1.5, 300 / text.length));\n    const speed = Math.floor(baseSpeed * speedModifier);\n\n    let i = 0;\n    // --- 修改点：移除了 lastPunctuation 变量 ---\n    // let lastPunctuation = 0; // 上一个标点符号的位置\n    // --- 修改结束 ---\n\n    const typeWriter = () => {\n      if (i < text.length && this.isAnimating) {\n        const char = text.charAt(i);\n        this.dialogText.textContent += char;\n        i++;\n\n        // --- 修改点：移除了标点符号的特殊停顿判断 ---\n        // 不再检查是否为标点符号，统一使用计算出的 speed\n        setTimeout(typeWriter, speed);\n        // --- 修改结束 ---\n\n        // --- 移除的代码块 ---\n        // const isPunctuation = /[，。？！、：；]/.test(char);\n        // if (isPunctuation) {\n        //   lastPunctuation = i;\n        //   setTimeout(typeWriter, speed * 5); // 标点符号后停顿更长时间\n        // } else if (i - lastPunctuation <= 2) {\n        //   // 标点符号后的前两个字符也稍微慢一点\n        //   setTimeout(typeWriter, speed * 1.5);\n        // } else {\n        //   setTimeout(typeWriter, speed);\n        // }\n        // --- 移除结束 ---\n      } else {\n        this.isAnimating = false;\n        document.getElementById('next-hint').style.opacity = '1'; // 显示提示\n      }\n    };\n\n    // 开始打字效果\n    typeWriter();\n  }\n\n  // 更新角色立绘显示\n  updateCharacters(dialog) {\n    // 转场中不更新角色显示，避免冲突\n    if (this.isTransitioning) {\n      console.log('正在转场中，延迟更新角色显示');\n      return;\n    }\n\n    // 记录新的角色显示状态\n    const newActiveCharacters = {};\n\n    // 处理特殊视角模式\n    document.body.classList.remove('narrator-mode', 'protagonist-mode');\n\n    // 处理角色立绘配置\n    if (dialog.characters) {\n      // 旁白模式\n      if (dialog.characters === 'narrator') {\n        document.body.classList.add('narrator-mode');\n        // 旁白模式下清空所有角色\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        this.activeCharacters = {};\n        return;\n      }\n      // 主角视角模式\n      else if (dialog.characters === 'protagonist') {\n        document.body.classList.add('protagonist-mode');\n        // 主角视角下清空所有角色\n        for (const characterId in this.activeCharacters) {\n          this.hideCharacter(characterId);\n        }\n        this.activeCharacters = {};\n        return;\n      }\n      // 单个居中角色（新格式）\n      else if (\n        typeof dialog.characters === 'object' &&\n        dialog.characters.id &&\n        !dialog.characters.left &&\n        !dialog.characters.right\n      ) {\n        const characterId = dialog.characters.id;\n        const expression = dialog.characters.expression || '默认.png';\n        const costume = dialog.characters.costume || '水手服'; // 默认使用水手服\n\n        newActiveCharacters[characterId] = {\n          position: 'center',\n          expression: expression,\n          costume: costume, // 记录服装信息\n        };\n\n        this.showCharacter(characterId, 'center', dialog.name === characterId, expression, costume);\n      }\n      // 左右两个角色（新格式）\n      else if (typeof dialog.characters === 'object') {\n        // 如果只有一个角色，则居中显示\n        const hasLeftChar = !!dialog.characters.left;\n        const hasRightChar = !!dialog.characters.right;\n\n        if (hasLeftChar && !hasRightChar) {\n          // 只有左边角色，居中显示\n          const characterId = dialog.characters.left.id;\n          const expression = dialog.characters.left.expression || '默认.png';\n          const costume = dialog.characters.left.costume || '水手服'; // 默认使用水手服\n\n          newActiveCharacters[characterId] = {\n            position: 'center',\n            expression: expression,\n            costume: costume,\n          };\n\n          this.showCharacter(characterId, 'center', dialog.name === characterId, expression, costume);\n        } else if (!hasLeftChar && hasRightChar) {\n          // 只有右边角色，居中显示\n          const characterId = dialog.characters.right.id;\n          const expression = dialog.characters.right.expression || '默认.png';\n          const costume = dialog.characters.right.costume || '水手服'; // 默认使用水手服\n\n          newActiveCharacters[characterId] = {\n            position: 'center',\n            expression: expression,\n            costume: costume,\n          };\n\n          this.showCharacter(characterId, 'center', dialog.name === characterId, expression, costume);\n        } else {\n          // 两个角色都有，左右显示\n          if (dialog.characters.left && dialog.characters.left.id) {\n            const characterId = dialog.characters.left.id;\n            const expression = dialog.characters.left.expression || '默认.png';\n            const costume = dialog.characters.left.costume || '水手服'; // 默认使用水手服\n\n            newActiveCharacters[characterId] = {\n              position: 'left',\n              expression: expression,\n              costume: costume,\n            };\n\n            this.showCharacter(characterId, 'left', dialog.name === characterId, expression, costume);\n          }\n\n          if (dialog.characters.right && dialog.characters.right.id) {\n            const characterId = dialog.characters.right.id;\n            const expression = dialog.characters.right.expression || '默认.png';\n            const costume = dialog.characters.right.costume || '水手服'; // 默认使用水手服\n\n            newActiveCharacters[characterId] = {\n              position: 'right',\n              expression: expression,\n              costume: costume,\n            };\n\n            this.showCharacter(characterId, 'right', dialog.name === characterId, expression, costume);\n          }\n        }\n      }\n    } else {\n      // 没有角色配置时，隐藏所有角色\n      for (const characterId in this.activeCharacters) {\n        this.hideCharacter(characterId);\n      }\n      this.activeCharacters = {};\n      return;\n    }\n\n    // 移除不在新配置中的角色\n    for (const characterId in this.activeCharacters) {\n      if (!newActiveCharacters[characterId]) {\n        this.hideCharacter(characterId);\n      }\n    }\n\n    // 更新活动角色列表\n    this.activeCharacters = newActiveCharacters;\n  }\n\n  // 显示角色立绘\n  showCharacter(characterId, position, isSpeaking, expression = '默认', costume = '水手服') {\n    // 转场中不更新角色显示，避免冲突\n    if (this.isTransitioning) {\n      console.log('正在转场中，跳过显示角色:', characterId);\n      return;\n    }\n\n    // 获取角色的服装和表情立绘URL\n    if (!this.characterSprites[characterId]) return;\n\n    // 指定角色的服装，如果不存在则使用默认服装\n    const characterCostumes = this.characterSprites[characterId];\n    let costumeToUse = costume;\n\n    // 如果指定的服装不存在，则使用第一个可用的服装\n    if (!characterCostumes[costumeToUse]) {\n      costumeToUse = Object.keys(characterCostumes)[0];\n    }\n\n    // 获取指定服装下的表情\n    const costumeExpressions = characterCostumes[costumeToUse];\n\n    // 如果指定的表情不存在，则使用默认表情\n    let expressionToUse = expression;\n    if (!costumeExpressions[expressionToUse]) {\n      expressionToUse = Object.keys(costumeExpressions)[0] || '默认.png';\n    }\n\n    const spriteUrl = costumeExpressions[expressionToUse];\n\n    // 如果没有找到有效的立绘URL，则退出\n    if (!spriteUrl) return;\n\n    // 获取角色ID和表情的组合ID\n    const characterElementId = `character-${characterId}`;\n    const oldPosition = this.activeCharacters[characterId]?.position;\n\n    // 检查角色立绘是否已存在\n    let characterElement = document.getElementById(characterElementId);\n\n    // 如果不存在则创建新的立绘元素\n    if (!characterElement) {\n      characterElement = document.createElement('img');\n      characterElement.id = characterElementId;\n      characterElement.className = 'character-sprite character-enter';\n      characterElement.src = spriteUrl;\n      characterElement.dataset.expression = expressionToUse;\n      characterElement.dataset.position = position;\n      characterElement.alt = `${characterId}的立绘`;\n\n      // 过渡前准备 - 如果是从一侧切换到另一侧，先使用原来的位置\n      if (oldPosition && oldPosition !== position) {\n        characterElement.classList.add(`character-${oldPosition}`);\n      } else {\n        characterElement.classList.add(`character-${position}`);\n      }\n\n      this.characterContainer.appendChild(characterElement);\n\n      // 图片加载完成后添加激活类\n      setTimeout(() => {\n        // 再次检查是否在转场中，如果是则不显示\n        if (this.isTransitioning) {\n          if (characterElement && characterElement.parentNode) {\n            characterElement.parentNode.removeChild(characterElement);\n          }\n          return;\n        }\n\n        characterElement.classList.remove('character-enter');\n        characterElement.classList.add('character-active');\n\n        // 如果位置改变，延迟后更新位置\n        if (oldPosition && oldPosition !== position) {\n          setTimeout(() => {\n            characterElement.classList.remove(`character-${oldPosition}`);\n            characterElement.classList.add(`character-${position}`);\n            characterElement.dataset.position = position;\n          }, 50);\n        }\n\n        // 单人居中显示时的特殊处理\n        this.applyPositionStyle(characterElement, position);\n      }, 50);\n    }\n    // 如果已存在但表情或位置不同\n    else {\n      // 表情变化\n      if (characterElement.dataset.expression !== expressionToUse) {\n        characterElement.src = spriteUrl;\n        characterElement.dataset.expression = expressionToUse;\n      }\n\n      // 位置变化\n      if (characterElement.dataset.position !== position) {\n        // 使用过渡动画平滑切换位置\n        setTimeout(() => {\n          // 再次检查是否在转场中\n          if (this.isTransitioning) return;\n\n          characterElement.classList.remove(`character-${characterElement.dataset.position}`);\n          characterElement.classList.add(`character-${position}`);\n          characterElement.dataset.position = position;\n\n          // 更新定位样式\n          this.applyPositionStyle(characterElement, position);\n        }, 50);\n      }\n    }\n\n    // 应用说话/不说话状态 - 只用滤镜区分，不用透明度\n    if (isSpeaking) {\n      characterElement.classList.add('character-speaking');\n      characterElement.classList.remove('character-dimmed');\n      characterElement.style.opacity = '1'; // 确保完全不透明\n      characterElement.style.zIndex = '10'; // 确保说话角色在前面\n    } else {\n      characterElement.classList.remove('character-speaking');\n      characterElement.classList.add('character-dimmed');\n      characterElement.style.opacity = '1'; // 确保完全不透明\n      characterElement.style.zIndex = '5'; // 非说话角色在后面\n    }\n  }\n\n  // 应用位置样式的辅助函数\n  applyPositionStyle(element, position) {\n    // 单人居中显示时的特殊处理\n    if (position === 'center') {\n      // 确保完全居中且底部不露出背景\n      element.style.left = '50%';\n      element.style.right = 'auto';\n      element.style.transform = 'translateX(-50%)';\n      element.style.bottom = '0';\n      element.style.height = '98%';\n      element.style.maxHeight = '98%';\n    } else if (position === 'left') {\n      // 左侧定位 - 调整为更靠近中心\n      element.style.left = '30%';\n      element.style.right = 'auto';\n      element.style.transform = 'translateX(-50%)';\n      element.style.bottom = '0';\n      element.style.height = '95%';\n      element.style.maxHeight = '95%';\n    } else if (position === 'right') {\n      // 右侧定位 - 调整为更靠近中心\n      element.style.right = '30%';\n      element.style.left = 'auto';\n      element.style.transform = 'translateX(50%)';\n      element.style.bottom = '0';\n      element.style.height = '95%';\n      element.style.maxHeight = '95%';\n    }\n  }\n\n  // 隐藏角色立绘\n  hideCharacter(characterId) {\n    const characterElement = document.getElementById(`character-${characterId}`);\n    if (characterElement) {\n      // 防止重复触发淡出动画\n      if (characterElement.classList.contains('character-exit')) return;\n\n      characterElement.classList.add('character-exit');\n      characterElement.classList.remove('character-active', 'character-speaking');\n\n      // 动画结束后移除元素\n      setTimeout(() => {\n        if (characterElement && characterElement.parentNode) {\n          characterElement.parentNode.removeChild(characterElement);\n        }\n      }, 800); // 增加延迟以配合CSS过渡时间\n    }\n  }\n\n  nextDialog() {\n    // 如果正在动画中，则跳过打字效果直接显示全部文本\n    if (this.isAnimating) {\n      this.isAnimating = false;\n      const currentDialog = this.dialogData[this.currentIndex];\n      this.dialogText.textContent = currentDialog.text;\n      document.getElementById('next-hint').style.opacity = '1'; // 显示提示\n      return;\n    }\n\n    // 增加对话索引\n    this.currentIndex++;\n\n    // --- 修改点：检查是否超出对话数据范围 ---\n    if (this.currentIndex >= this.dialogData.length) {\n      console.log('对话已全部播放完毕。');\n      // 将索引退回到最后一条，防止后续可能的错误引用\n      this.currentIndex = this.dialogData.length - 1;\n\n      // 可选：隐藏\"下一步\"提示，明确告知用户对话结束\n      const nextHint = document.getElementById('next-hint');\n      if (nextHint) {\n        nextHint.style.display = 'none';\n      }\n\n      // 显示重新播放按钮\n      const restartBtn = document.getElementById('restart-btn');\n      if (restartBtn) {\n        restartBtn.style.display = 'block';\n      }\n\n      // 阻止进一步的操作，不再调用 showDialog\n      return;\n    }\n    // --- 修改结束 ---\n\n    // 如果索引有效，则显示下一条对话\n    this.showDialog(this.currentIndex);\n  }\n\n  // 重新开始对话播放\n  restartDialog() {\n    console.log('重新开始对话播放');\n\n    // 重置索引\n    this.currentIndex = 0;\n\n    // 重置角色立绘\n    for (const characterId in this.activeCharacters) {\n      this.hideCharacter(characterId);\n    }\n    this.activeCharacters = {};\n\n    // 重置背景到初始状态\n    if (this.dialogData && this.dialogData.length > 0 && this.dialogData[0].background) {\n      this.currentBgPath = this.dialogData[0].background;\n      const initialBgUrl = this.getFullImageUrl(this.currentBgPath);\n      this.currentImage.src = initialBgUrl;\n    }\n\n    // 重置对话界面状态\n    const nextHint = document.getElementById('next-hint');\n    if (nextHint) {\n      nextHint.style.display = 'block';\n      nextHint.style.opacity = '1';\n    }\n\n    // 隐藏重新播放按钮\n    const restartBtn = document.getElementById('restart-btn');\n    if (restartBtn) {\n      restartBtn.style.display = 'none';\n    }\n\n    // 显示第一条对话\n    this.showDialog(0);\n  }\n\n  fadeOutIn(callback, dialogToUpdate) {\n    // 如果已经在转场，则忽略\n    if (this.isTransitioning) {\n      console.log('已在转场中，忽略新的转场请求');\n      return;\n    }\n\n    this.isTransitioning = true;\n    console.log('开始背景转场');\n\n    // 获取下一张图片的URL\n    const relativeImagePath = callback(); // 获取 JSON 中定义的相对路径 (例如 \"教室/白天.jpg\")\n    if (!relativeImagePath) {\n      console.log('背景路径为空，跳过转场');\n      this.isTransitioning = false;\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n      return;\n    }\n\n    let nextImageUrl = this.getFullImageUrl(relativeImagePath);\n    console.log('切换背景图片:', relativeImagePath, '->', nextImageUrl);\n\n    // 如果URL获取失败或与当前图片相同，则不执行转场\n    if (!nextImageUrl || nextImageUrl === this.currentImage.src) {\n      console.log('跳过背景转场: URL为空或相同');\n      this.isTransitioning = false;\n      // 即使没有转场，也要更新对话内容\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n      return;\n    }\n\n    // 执行转场动画\n    const executeTransition = () => {\n      console.log('执行背景转场动画');\n      // 添加转场动画类\n      document.body.classList.add('transitioning');\n\n      // 淡入下一张图片\n      this.nextImage.style.opacity = '1';\n\n      // 转场完成后的处理\n      setTimeout(() => {\n        // 将下一张图片的URL复制到当前图片\n        this.currentImage.src = this.nextImage.src;\n        console.log('背景转场完成，当前背景:', this.currentImage.src);\n        // 重置下一张图片的不透明度\n        this.nextImage.style.opacity = '0';\n        // 移除转场动画类\n        document.body.classList.remove('transitioning');\n        // 重置转场状态\n        this.isTransitioning = false;\n\n        // 转场完成后更新对话内容\n        if (dialogToUpdate) {\n          console.log('转场完成，更新对话内容:', dialogToUpdate.name);\n          // 修复：确保转场完全结束后再更新对话内容和角色\n          setTimeout(() => {\n            this.updateDialogContent(dialogToUpdate);\n          }, 50);\n        }\n      }, 1200); // 与CSS过渡时间匹配\n    };\n\n    // 设置下一张图片的URL\n    this.nextImage.src = nextImageUrl;\n\n    // 添加错误处理\n    this.nextImage.onerror = () => {\n      console.error('背景图片加载失败:', nextImageUrl);\n      this.isTransitioning = false;\n      // 即使加载失败，也要尝试更新对话内容\n      if (dialogToUpdate) {\n        this.updateDialogContent(dialogToUpdate);\n      }\n    };\n\n    this.nextImage.onload = () => {\n      console.log('背景图片加载完成');\n      executeTransition();\n    };\n  }\n\n  // 添加对话到历史记录\n  addToHistory(dialog) {\n    // 检查是否已经存在相同的对话（避免重复添加）\n    const isDuplicate = this.dialogHistory.some(item => item.name === dialog.name && item.text === dialog.text);\n\n    if (!isDuplicate) {\n      this.dialogHistory.push({\n        name: dialog.name,\n        text: dialog.text,\n        background: dialog.background || '',\n      });\n\n      // 更新历史面板内容\n      this.updateHistoryPanel();\n    }\n  }\n\n  // 更新历史面板内容\n  updateHistoryPanel() {\n    // 清空当前内容\n    this.historyContent.innerHTML = '';\n\n    // 如果没有历史记录，显示提示信息\n    if (this.dialogHistory.length === 0) {\n      const emptyMsg = document.createElement('div');\n      emptyMsg.textContent = '暂无对话历史';\n      emptyMsg.style.textAlign = 'center';\n      emptyMsg.style.color = '#7D5B65';\n      emptyMsg.style.padding = '20px';\n      this.historyContent.appendChild(emptyMsg);\n      return;\n    }\n\n    // 为每条历史记录创建元素\n    this.dialogHistory.forEach((dialog, index) => {\n      const historyItem = document.createElement('div');\n      historyItem.className = 'history-item';\n      historyItem.style.marginBottom = '15px';\n      historyItem.style.padding = '15px';\n      historyItem.style.borderRadius = '12px';\n      historyItem.style.background = 'rgba(255, 255, 255, 0.5)';\n      historyItem.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05), 0 0 0 1px rgba(255,255,255,0.7) inset';\n      historyItem.style.transition = 'transform 0.2s ease, box-shadow 0.2s ease';\n\n      // 鼠标悬停效果\n      historyItem.onmouseover = function () {\n        this.style.transform = 'translateY(-2px)';\n        this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.08), 0 0 0 1px rgba(255,255,255,0.8) inset';\n      };\n\n      historyItem.onmouseout = function () {\n        this.style.transform = 'none';\n        this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05), 0 0 0 1px rgba(255,255,255,0.7) inset';\n      };\n\n      // 如果有角色名，则显示\n      if (dialog.name && dialog.name !== '旁白') {\n        const nameElem = document.createElement('div');\n        nameElem.className = 'history-name';\n        nameElem.textContent = dialog.name;\n        nameElem.style.fontWeight = 'bold';\n        nameElem.style.color = '#C18E98';\n        nameElem.style.marginBottom = '8px';\n        nameElem.style.position = 'relative';\n        nameElem.style.paddingLeft = '15px';\n\n        // 添加装饰元素\n        const decorElem = document.createElement('span');\n        decorElem.textContent = '❀';\n        decorElem.style.position = 'absolute';\n        decorElem.style.left = '0';\n        decorElem.style.top = '50%';\n        decorElem.style.transform = 'translateY(-50%)';\n        decorElem.style.color = '#FFB0C0';\n        decorElem.style.fontSize = '12px';\n\n        nameElem.appendChild(decorElem);\n        historyItem.appendChild(nameElem);\n      } else if (dialog.name === '旁白') {\n        // 旁白样式特殊处理\n        historyItem.style.fontStyle = 'italic';\n        historyItem.style.background = 'rgba(245, 235, 235, 0.7)';\n        historyItem.style.borderLeft = '3px solid #FFCAD5';\n      }\n\n      // 添加对话文本\n      const textElem = document.createElement('div');\n      textElem.className = 'history-text';\n      textElem.textContent = dialog.text;\n      textElem.style.color = '#4D2B35';\n      textElem.style.lineHeight = '1.5';\n      textElem.style.letterSpacing = '0.3px';\n      historyItem.appendChild(textElem);\n\n      // 添加到历史内容区\n      this.historyContent.appendChild(historyItem);\n    });\n\n    // 滚动到底部\n    setTimeout(() => {\n      this.historyContent.scrollTop = this.historyContent.scrollHeight;\n    }, 100);\n  }\n\n  // 显示/隐藏历史面板\n  toggleHistoryPanel(show) {\n    if (show) {\n      this.updateHistoryPanel();\n      this.historyPanel.style.display = 'block';\n\n      // 添加淡入动画效果\n      this.historyPanel.style.opacity = '0';\n      this.historyPanel.style.transition = 'opacity 0.3s ease';\n      setTimeout(() => {\n        this.historyPanel.style.opacity = '1';\n      }, 10);\n    } else {\n      // 淡出动画效果\n      this.historyPanel.style.opacity = '0';\n      setTimeout(() => {\n        this.historyPanel.style.display = 'none';\n      }, 300);\n    }\n  }\n}\n\n// 当页面加载完成后初始化游戏引擎\n$(() => {\n  const engine = new GalgameEngine();\n\n  // 处理UI显示/隐藏功能\n  function initToggleUIButton() {\n    const toggleBtn = document.getElementById('toggle-ui-btn');\n    if (toggleBtn) {\n      toggleBtn.addEventListener('click', function (e) {\n        e.stopPropagation(); // 防止点击事件触发对话推进\n        document.body.classList.toggle('ui-hidden');\n\n        // 更新按钮文本\n        if (document.body.classList.contains('ui-hidden')) {\n          toggleBtn.textContent = '💬';\n          toggleBtn.title = '显示界面';\n\n          // 在UI隐藏模式下取消角色立绘的高亮/淡化效果\n          const characterElements = document.querySelectorAll('.character-sprite');\n          characterElements.forEach(element => {\n            element.classList.remove('character-speaking', 'character-dimmed');\n          });\n        } else {\n          toggleBtn.textContent = '💭';\n          toggleBtn.title = '隐藏界面';\n\n          // 恢复当前对话的角色状态\n          engine.updateCharacters(engine.dialogData[engine.currentIndex]);\n        }\n      });\n\n      // 设置初始状态\n      toggleBtn.textContent = '💭';\n      toggleBtn.title = '隐藏界面';\n    }\n  }\n\n  // 初始化UI切换按钮\n  initToggleUIButton();\n\n  // 初始化历史对话按钮\n  const historyBtn = document.getElementById('history-btn');\n  const closeHistoryBtn = document.getElementById('close-history');\n\n  if (historyBtn && closeHistoryBtn) {\n    // 打开历史面板\n    historyBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.toggleHistoryPanel(true);\n    });\n\n    // 关闭历史面板\n    closeHistoryBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.toggleHistoryPanel(false);\n    });\n\n    // 点击历史面板内部不触发对话推进\n    document.getElementById('history-panel').addEventListener('click', function (e) {\n      e.stopPropagation();\n    });\n\n    // ESC键关闭历史面板\n    document.addEventListener('keydown', function (e) {\n      if (e.key === 'Escape' && engine.historyPanel.style.display === 'block') {\n        engine.toggleHistoryPanel(false);\n      }\n    });\n  }\n\n  // 初始化重新播放按钮\n  const restartBtn = document.getElementById('restart-btn');\n  if (restartBtn) {\n    restartBtn.addEventListener('click', function (e) {\n      e.stopPropagation(); // 防止点击事件触发对话推进\n      engine.restartDialog();\n    });\n\n    // 设置按钮标题\n    restartBtn.title = '重新开始';\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL2dhbGdhbWUvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7QUFBc0I7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDLGtDQUFrQztBQUNsQyw2QkFBNkI7QUFDN0IsNkJBQTZCOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBLHNHQUFzRzs7QUFFdEc7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxtQkFBbUIsYUFBYSxrQkFBa0I7QUFDekc7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwrREFBK0Q7QUFDNUYsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsMkJBQTJCLGdDQUFnQyxjQUFjLDJCQUEyQjtBQUNwRztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPLFdBQVc7QUFDbEIsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsOERBQThEOztBQUU5RDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0Esa0VBQWtFO0FBQ2xFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDs7QUFFNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRTs7QUFFbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7O0FBRXBFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7O0FBRXJFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0U7O0FBRXRFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDRDQUE0QyxZQUFZO0FBQ3hEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxZQUFZOztBQUU1QztBQUNBO0FBQ0Esb0RBQW9ELFlBQVk7QUFDaEUsUUFBUTtBQUNSLG9EQUFvRCxTQUFTO0FBQzdEOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxZQUFZO0FBQ3ZFLHdEQUF3RCxTQUFTO0FBQ2pFO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEseURBQXlELGtDQUFrQztBQUMzRixzREFBc0QsU0FBUztBQUMvRDs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUMsNENBQTRDO0FBQzVDLE1BQU07QUFDTjtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDLDJDQUEyQztBQUMzQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrRUFBa0UsWUFBWTtBQUM5RTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxRQUFRO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0U7QUFDaEU7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLE9BQU8sU0FBUztBQUNoQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxVQUFVO0FBQ1Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gvZ2FsZ2FtZS9pbmRleC5qcz9mOTJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnLi9pbmRleC5zY3NzJztcblxuLyoqXG4gKiDlr7nor53nlYzpnaLmoLjlv4Plip/og71cbiAqIOaPkOS+m+eugOWNleeahOWvueivneaYvuekuuWSjOeCueWHuy/nqbrmoLzkuIvkuIDmraXlip/og71cbiAqL1xuXG5jbGFzcyBHYWxnYW1lRW5naW5lIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jdXJyZW50SW5kZXggPSAwO1xuICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmFjdGl2ZUNoYXJhY3RlcnMgPSB7fTsgLy8g5a2Y5YKo5b2T5YmN5rS75Yqo55qE6KeS6ImyXG4gICAgdGhpcy5pc1RyYW5zaXRpb25pbmcgPSBmYWxzZTsgLy8g6Ziy5q2i5Yqo55S76YeN5Y+gXG4gICAgdGhpcy5jdXJyZW50QmdQYXRoID0gJyc7IC8vIOW9k+WJjeaYvuekuueahOiDjOaZr+i3r+W+hFxuICAgIHRoaXMuZGlhbG9nSGlzdG9yeSA9IFtdOyAvLyDlrZjlgqjlr7nor53ljoblj7JcblxuICAgIC8vIOiOt+WPlkRPTeWFg+e0oFxuICAgIHRoaXMuZGlhbG9nQm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpYWxvZy1ib3gnKTtcbiAgICB0aGlzLmNoYXJhY3Rlck5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hhcmFjdGVyLW5hbWUnKTtcbiAgICB0aGlzLmRpYWxvZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlhbG9nLXRleHQnKTtcbiAgICB0aGlzLmN1cnJlbnRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrZ3JvdW5kLWltYWdlLWN1cnJlbnQnKTtcbiAgICB0aGlzLm5leHRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrZ3JvdW5kLWltYWdlLW5leHQnKTtcbiAgICB0aGlzLmNoYXJhY3RlckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGFyYWN0ZXItY29udGFpbmVyJyk7XG4gICAgdGhpcy5oaXN0b3J5UGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGlzdG9yeS1wYW5lbCcpO1xuICAgIHRoaXMuaGlzdG9yeUNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGlzdG9yeS1jb250ZW50Jyk7XG5cbiAgICAvLyA9PT09PSDnrKzkuIDlpITlj6/oh6rlrprkuYnvvJpDR+WbvueJh+mTvuaOpSA9PT09PVxuICAgIC8vIOWcqOi/memHjOa3u+WKoOaCqOeahENH5Zu+54mHVVJM5pWw57uEXG4gICAgLy8g5Y+v5Lul5re75Yqg5Lu75oSP5pWw6YeP55qE5Zu+54mH6ZO+5o6lXG4gICAgLy8g5rOo5oSPOiBVUkzpnIDopoHmmK/lj6/ku6Xnm7TmjqXorr/pl67nmoTlm77niYflnLDlnYDvvIzkvaDlj6/ku6Xkvb/nlKjlpoJjYXRib3jmnaXov5vooYzlsIblm77niYfovazkuLrpk77mjqXjgILmjqjojZDliIbovqjnjocxOTIweDEwODBcbiAgICBjb25zdCBjZ1VybHMgPSBbXG4gICAgICAvLyDnpLrkvovmoLzlvI/vvJpcbiAgICAgIC8vICdodHRwczovL2V4YW1wbGUuY29tL2ltYWdlMS5qcGcnLFxuICAgICAgLy8gJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UyLmpwZycsXG4gICAgICAvLyAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZTMuanBnJyxcbiAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglODMlOEMlRTYlOTklQUYvJUU1JTk1JTg2JUU1JUJBJTk3JUU4JUExJTk3LyVFOSVCQiU4NCVFNiU5OCU4Ri5qcGcnLFxuICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCU4MyU4QyVFNiU5OSVBRi8lRTUlOTUlODYlRTUlQkElOTclRTglQTElOTcvJUU1JUE0JTlDJUU2JTk5JTlBJUU1JUJDJTgwJUU3JTgxJUFGLmpwZycsXG4gICAgXTtcblxuICAgIC8vID09PT09IOWPr+iHquWumuS5ieiDjOaZr+WbvueJh+WfuuehgCBVUkwgPT09PT1cbiAgICB0aGlzLmltYWdlQmFzZVVybCA9ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/og4zmma8vJztcblxuICAgIC8vID09PT09IOWPr+iHquWumuS5ieinkuiJsueri+e7mOmTvuaOpSA9PT09PVxuICAgIHRoaXMuY2hhcmFjdGVyU3ByaXRlc0Jhc2VVcmwgPSAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyLyc7XG5cbiAgICAvLyA9PT09PSDmlrDlop7lj6/oh6rlrprkuYnvvJrop5LoibLnq4vnu5jpk77mjqUgPT09PT1cbiAgICAvLyDop5LoibLnq4vnu5jlm77niYdVUkzlr7nosaFcbiAgICAvLyDplK7lkI3kvZzkuLrop5LoibLnmoTmoIfor4bnrKbvvIzlgLzmmK/ljIXlkKvkuI3lkIzmnI3oo4XnmoTlr7nosaHvvIzmr4/np43mnI3oo4XljIXlkKvkuI3lkIzooajmg4XnmoTnq4vnu5hVUkxcbiAgICBjb25zdCBjaGFyYWN0ZXJTcHJpdGVzID0ge1xuICAgICAg57uc57ucOiB7XG4gICAgICAgIOawtOaJi+acjToge1xuICAgICAgICAgICflvq7nrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v5b6u56yRLnBuZycsXG4gICAgICAgICAgJ+a1heeskS5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/mtYXnrJEucG5nJyxcbiAgICAgICAgICAn55Sf5rCULnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+eUn+awlC5wbmcnLFxuICAgICAgICAgICfmg4rorrYucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v5oOK6K62LnBuZycsXG4gICAgICAgICAgJ+Wus+e+ni5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/lrrPnvp4ucG5nJyxcbiAgICAgICAgICAn56iN5b6u6IS457qiLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+eojeW+ruiEuOe6oi5wbmcnLFxuICAgICAgICAgICfmiYvmiZjkuIvlt7TmgJ3ogIMucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+aJi+aJmOS4i+W3tOaAneiAgy5wbmcnLFxuICAgICAgICAgICfnnIvpgI/kuIDliIfnmoTlnY/nrJEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+eci+mAj+S4gOWIh+eahOWdj+eskS5wbmcnLFxuICAgICAgICAgICfpgqrmgbbnmoTlnY/nrJEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+mCquaBtueahOWdj+eskS5wbmcnLFxuICAgICAgICAgICfmmJ/mmJ/nnLwucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v5pif5pif55y8LnBuZycsXG4gICAgICAgICAgJ+aZleaZleecvC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/mmZXmmZXnnLwucG5nJyxcbiAgICAgICAgICAn54yr54iq55Sf5rCULnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+eMq+eIqueUn+awlC5wbmcnLFxuICAgICAgICAgICfmtYHlj6PmsLQucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v5rWB5Y+j5rC0LnBuZycsXG4gICAgICAgICAgJ+WTreazoy5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/lk63ms6MucG5nJyxcbiAgICAgICAgICAn5pOm55y85rOqLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+aTpuecvOazqi5wbmcnLFxuICAgICAgICAgICfnrYnlvoXlkLsucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v562J5b6F5ZC7LnBuZycsXG4gICAgICAgICAgJ+aAp+mrmOa9ri5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/mgKfpq5jmva4ucG5nJyxcbiAgICAgICAgICAn55y856We56m65rSe55qE5YKs55yg54q25oCBLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+awtOaJi+acjS/nnLznpZ7nqbrmtJ7nmoTlgqznnKDnirbmgIEucG5nJyxcbiAgICAgICAgICAn5peg6KGo5oOFLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5rC05omL5pyNL+aXoOihqOaDhS5wbmcnLFxuICAgICAgICAgICfml6DkuroucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/msLTmiYvmnI0v5peg5Lq6LnBuZycsXG4gICAgICAgIH0sXG4gICAgICAgIOagvOe6ueihqzoge1xuICAgICAgICAgICflvq7nrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/moLznurnooasv5b6u56yRLnBuZycsXG4gICAgICAgICAgJ+a1heeskS5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/mtYXnrJEucG5nJyxcbiAgICAgICAgICAn55Sf5rCULnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+eUn+awlC5wbmcnLFxuICAgICAgICAgICfmg4rorrYucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/moLznurnooasv5oOK6K62LnBuZycsXG4gICAgICAgICAgJ+Wus+e+ni5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/lrrPnvp4ucG5nJyxcbiAgICAgICAgICAn56iN5b6u6IS457qiLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+eojeW+ruiEuOe6oi5wbmcnLFxuICAgICAgICAgICfmiYvmiZjkuIvlt7TmgJ3ogIMucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+aJi+aJmOS4i+W3tOaAneiAgy5wbmcnLFxuICAgICAgICAgICfnnIvpgI/kuIDliIfnmoTlnY/nrJEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+eci+mAj+S4gOWIh+eahOWdj+eskS5wbmcnLFxuICAgICAgICAgICfpgqrmgbbnmoTlnY/nrJEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+mCquaBtueahOWdj+eskS5wbmcnLFxuICAgICAgICAgICfmmJ/mmJ/nnLwucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/moLznurnooasv5pif5pif55y8LnBuZycsXG4gICAgICAgICAgJ+aZleaZleecvC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/mmZXmmZXnnLwucG5nJyxcbiAgICAgICAgICAn54yr54iq55Sf5rCULnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+eMq+eIqueUn+awlC5wbmcnLFxuICAgICAgICAgICfmtYHlj6PmsLQucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/moLznurnooasv5rWB5Y+j5rC0LnBuZycsXG4gICAgICAgICAgJ+WTreazoy5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/lk63ms6MucG5nJyxcbiAgICAgICAgICAn5pOm55y85rOqLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+aTpuecvOazqi5wbmcnLFxuICAgICAgICAgICfnrYnlvoXlkLsucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/moLznurnooasv562J5b6F5ZC7LnBuZycsXG4gICAgICAgICAgJ+aAp+mrmOa9ri5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/mgKfpq5jmva4ucG5nJyxcbiAgICAgICAgICAn55y856We56m65rSe55qE5YKs55yg54q25oCBLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+agvOe6ueihqy/nnLznpZ7nqbrmtJ7nmoTlgqznnKDnirbmgIEucG5nJyxcbiAgICAgICAgICAn5peg5Lq6LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5qC857q56KGrL+aXoOS6ui5wbmcnLFxuICAgICAgICB9LFxuICAgICAgICDlvIDooas6IHtcbiAgICAgICAgICAn5b6u56yRLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+W+rueskS5wbmcnLFxuICAgICAgICAgICfmtYXnrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lvIDooasv5rWF56yRLnBuZycsXG4gICAgICAgICAgJ+eUn+awlC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/nlJ/msJQucG5nJyxcbiAgICAgICAgICAn5oOK6K62LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+aDiuiuti5wbmcnLFxuICAgICAgICAgICflrrPnvp4ucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lvIDooasv5a6z576eLnBuZycsXG4gICAgICAgICAgJ+eojeW+ruiEuOe6oi5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/nqI3lvq7ohLjnuqIucG5nJyxcbiAgICAgICAgICAn5omL5omY5LiL5be05oCd6ICDLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/miYvmiZjkuIvlt7TmgJ3ogIMucG5nJyxcbiAgICAgICAgICAn55yL6YCP5LiA5YiH55qE5Z2P56yRLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/nnIvpgI/kuIDliIfnmoTlnY/nrJEucG5nJyxcbiAgICAgICAgICAn6YKq5oG255qE56yR5a65LnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/pgqrmgbbnmoTnrJHlrrkucG5nJyxcbiAgICAgICAgICAn5pif5pif55y8LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+aYn+aYn+ecvC5wbmcnLFxuICAgICAgICAgICfmmZXmmZXnnLwucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lvIDooasv5pmV5pmV55y8LnBuZycsXG4gICAgICAgICAgJ+eMq+eIqueUn+awlC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/njKvniKrnlJ/msJQucG5nJyxcbiAgICAgICAgICAn5rWB5Y+j5rC0LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+a1geWPo+awtC5wbmcnLFxuICAgICAgICAgICflk63ms6MucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lvIDooasv5ZOt5rOjLnBuZycsXG4gICAgICAgICAgJ+aTpuecvOazqi5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/mk6bnnLzms6oucG5nJyxcbiAgICAgICAgICAn562J5b6F5ZC7LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+etieW+heWQuy5wbmcnLFxuICAgICAgICAgICfmgKfpq5jmva4ucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lvIDooasv5oCn6auY5r2uLnBuZycsXG4gICAgICAgICAgJ+aXoOihqOaDhS5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+W8gOihqy/ml6Dooajmg4UucG5nJyxcbiAgICAgICAgICAn5peg5Lq6LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5byA6KGrL+aXoOS6ui5wbmcnLFxuICAgICAgICB9LFxuICAgICAgICDnnaHooaM6IHtcbiAgICAgICAgICAn5b6u56yRLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+W+rueskS5wbmcnLFxuICAgICAgICAgICfmtYXnrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/nnaHooaMv5rWF56yRLnBuZycsXG4gICAgICAgICAgJ+eUn+awlC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/nlJ/msJQucG5nJyxcbiAgICAgICAgICAn5oOK6K62LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+aDiuiuti5wbmcnLFxuICAgICAgICAgICflrrPnvp4ucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/nnaHooaMv5a6z576eLnBuZycsXG4gICAgICAgICAgJ+eojeW+ruiEuOe6oi5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/nqI3lvq7ohLjnuqIucG5nJyxcbiAgICAgICAgICAn55yL6YCP5LiA5YiH55qE5Z2P56yRLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/nnIvpgI/kuIDliIfnmoTlnY/nrJEucG5nJyxcbiAgICAgICAgICAn6YKq5oG255qE5Z2P56yRLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/pgqrmgbbnmoTlnY/nrJEucG5nJyxcbiAgICAgICAgICAn5pif5pif55y8LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+aYn+aYn+ecvC5wbmcnLFxuICAgICAgICAgICfmmZXmmZXnnLwucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/nnaHooaMv5pmV5pmV55y8LnBuZycsXG4gICAgICAgICAgJ+eMq+eIqueUn+awlC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/njKvniKrnlJ/msJQucG5nJyxcbiAgICAgICAgICAn5rWB5Y+j5rC0LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+a1geWPo+awtC5wbmcnLFxuICAgICAgICAgICflk63ms6MucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/nnaHooaMv5ZOt5rOjLnBuZycsXG4gICAgICAgICAgJ+etieW+heWQuy5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+edoeihoy/nrYnlvoXlkLsucG5nJyxcbiAgICAgICAgICAn5oCn6auY5r2uLnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+aAp+mrmOa9ri5wbmcnLFxuICAgICAgICAgICfnnLznpZ7nqbrmtJ7nmoTlgqznnKDnirbmgIEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv552h6KGjL+ecvOelnuepuua0nueahOWCrOecoOeKtuaAgS5wbmcnLFxuICAgICAgICAgICfml6DkuroucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/nnaHooaMv5peg5Lq6LnBuZycsXG4gICAgICAgIH0sXG4gICAgICAgIOWFqOijuDoge1xuICAgICAgICAgICfmtYXnrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45rWF56yRLnBuZycsXG4gICAgICAgICAgJ+eUn+awlC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+WFqOijuC/lhajoo7jnlJ/msJQucG5nJyxcbiAgICAgICAgICAn5oOK6K62LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5YWo6KO4L+WFqOijuOaDiuiuti5wbmcnLFxuICAgICAgICAgICflrrPnvp4ucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45a6z576eLnBuZycsXG4gICAgICAgICAgJ+eojeW+ruiEuOe6oi5wbmcnOlxuICAgICAgICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45b6u5b6u5a6z576eLnBuZycsXG4gICAgICAgICAgJ+eci+mAj+S4gOWIh+eahOWdj+eskS5wbmcnOlxuICAgICAgICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45b6X5oSP6IS4c211Zy5wbmcnLFxuICAgICAgICAgICfpgqrmgbbnmoTlnY/nrJEucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5YWo6KO4L+WFqOijuOmCquaBtueahOeskeWuuS5wbmcnLFxuICAgICAgICAgICflnY/nrJEucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45Z2P56yRLnBuZycsXG4gICAgICAgICAgJ+aYn+aYn+ecvC5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+WFqOijuC/lhajoo7jpl6rogIDnnLwucG5nJyxcbiAgICAgICAgICAn5pmV5pmV55y8LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5YWo6KO4L+WFqOijuOaZleecvEBfQC5wbmcnLFxuICAgICAgICAgICfmtYHlj6PmsLQucG5nJzpcbiAgICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5YWo6KO4L+WFqOijuOeci+WIsOmjn+eJqemmi+WIsOa1geWPo+awtC5wbmcnLFxuICAgICAgICAgICflk63ms6MucG5nJzogJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lL+inkuiJsi/lhajoo7gv5YWo6KO45ZOt5rOjLnBuZycsXG4gICAgICAgICAgJ+etieW+heWQuy5wbmcnOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+WFqOijuC/lhajoo7jnrYnlvoXmjqXlkLsucG5nJyxcbiAgICAgICAgICAn5oCn6auY5r2uLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+WFqOijuC/lhajoo7joibLmg4Xpq5jmva7llYrlmL/popwucG5nJyxcbiAgICAgICAgICAn55y856We56m65rSe55qE5YKs55yg54q25oCBLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUv6KeS6ImyL+WFqOijuC/lhajoo7jooqvlgqznnKDlj4znnLzml6DnpZ7nlZnlj6PmsLQucG5nJyxcbiAgICAgICAgICAn5peg5Lq6LnBuZyc6ICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS/op5LoibIv5YWo6KO4L+aXoOS6ui5wbmcnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIOS9oDoge1xuICAgICAgICDpu5jorqQ6IHtcbiAgICAgICAgICAn6buY6K6kLnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTclQUQlODklRTUlQkUlODUlRTUlOTAlQkIucG5nJyxcbiAgICAgICAgICAn5oOK6K62LnBuZyc6XG4gICAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTUlOTMlQUQlRTYlQjMlQTMucG5nJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gU2lsbHlUYXZlcm4uY2hhdFtnZXRDdXJyZW50TWVzc2FnZUlkKCldLm1lcztcbiAgICAgIGNvbnN0IGdhbWVEYXRhU3RyaW5nID0gbWVzc2FnZS5tYXRjaCgvPEdhbGdhbWU+XFxzKmBgYCg/Ompzb258eWFtbCk/KC4qKWBgYFxccyo8XFwvR2FsZ2FtZT4vcylbMV07IC8vIOiOt+WPluaVsOaNruW5tuWOu+mZpOmmluWwvuepuuagvFxuXG4gICAgICBpZiAoIWdhbWVEYXRhU3RyaW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcign5ri45oiP5pWw5o2uIDxHYWxnYW1lPiDkuLrnqbrjgIInKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHBhcnNlZERhdGEgPSBudWxsO1xuXG4gICAgICAvLyDlsJ3or5Xop6PmnpDkuLogSlNPTlxuICAgICAgdHJ5IHtcbiAgICAgICAgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UoZ2FtZURhdGFTdHJpbmcpO1xuICAgICAgICBjb25zb2xlLmxvZygn5ri45oiP5pWw5o2u5Yqg6L295oiQ5YqfIChKU09OIOagvOW8jyknKTtcbiAgICAgIH0gY2F0Y2ggKGpzb25FcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0pTT04g6Kej5p6Q5aSx6LSl77yM5bCd6K+V6Kej5p6Q5Li6IFlBTUw6JywganNvbkVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAvLyDlpoLmnpwgSlNPTiDop6PmnpDlpLHotKXvvIzlsJ3or5Xop6PmnpDkuLogWUFNTFxuICAgICAgICB0cnkge1xuICAgICAgICAgIHBhcnNlZERhdGEgPSBZQU1MLnBhcnNlKGdhbWVEYXRhU3RyaW5nKTtcbiAgICAgICAgfSBjYXRjaCAoeWFtbEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignWUFNTCDop6PmnpDkuZ/lpLHotKU6JywgeWFtbEVycm9yKTtcbiAgICAgICAgICAvLyDlpoLmnpzkuKTnp43op6PmnpDpg73lpLHotKXvvIzmipvlh7rlkIjlubbnmoTplJnor6/kv6Hmga9cbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBg5pWw5o2u6Kej5p6Q5aSx6LSl77ya5pei5LiN5piv5pyJ5pWI55qEIEpTT04g5Lmf5LiN5piv5pyJ5pWI55qEIFlBTUzjgIJKU09OIOmUmeivrzogJHtqc29uRXJyb3IubWVzc2FnZX0gfCBZQU1MIOmUmeivrzogJHt5YW1sRXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+l6Kej5p6Q5ZCO55qE5pWw5o2u5piv5ZCm5pyJ5pWI77yI5L6L5aaC77yM5piv5ZCm5Li65pWw57uE5LiU5LiN5Li656m677yJXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyc2VkRGF0YSkgfHwgcGFyc2VkRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfliqDovb3nmoTlr7nor53mlbDmja7kuLrnqbrmiJbmoLzlvI/ml6DmlYggKOmihOacn+S4uumdnuepuuaVsOe7hCnvvIzlsIbliqDovb3pu5jorqTmj5DnpLrkv6Hmga/jgIInKTtcbiAgICAgICAgdGhpcy5kaWFsb2dEYXRhID0gW3sgbmFtZTogJ+ezu+e7n+aPkOekuicsIHRleHQ6ICfliqDovb3nmoTlr7nor53mlbDmja7kuLrnqbrmiJbmoLzlvI/ml6DmlYjjgIInLCBjaGFyYWN0ZXJzOiAnbmFycmF0b3InIH1dO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kaWFsb2dEYXRhID0gcGFyc2VkRGF0YTtcbiAgICAgICAgY29uc29sZS5sb2coJ+acgOe7iOS9v+eUqOeahOa4uOaIj+aVsOaNrjonLCB0aGlzLmRpYWxvZ0RhdGEpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyDmjZXojrfmiYDmnInliqDovb0v6Kej5p6Q6L+H56iL5Lit55qE6ZSZ6K+vXG4gICAgICBjb25zb2xlLmVycm9yKCfliqDovb3miJbop6PmnpDmuLjmiI/mlbDmja7ml7blh7rplJk6JywgZXJyb3IpO1xuICAgICAgdGhpcy5kaWFsb2dEYXRhID0gW3sgbmFtZTogJ+ezu+e7n+aPkOekuicsIHRleHQ6IGDliqDovb3lr7nor53mlbDmja7lpLHotKXvvJoke2Vycm9yLm1lc3NhZ2V9YCwgY2hhcmFjdGVyczogJ25hcnJhdG9yJyB9XTtcbiAgICB9XG4gICAgLy8gPT09PT0g5pWw5o2u5Yqg6L2957uT5p2fID09PT09XG5cbiAgICAvLyDorr7nva7op5LoibLnq4vnu5hcbiAgICB0aGlzLmNoYXJhY3RlclNwcml0ZXMgPSBjaGFyYWN0ZXJTcHJpdGVzO1xuXG4gICAgLy8g5Yid5aeL5YyW5LqL5Lu255uR5ZCsXG4gICAgdGhpcy5pbml0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIC8vIOaYvuekuuesrOS4gOadoeWvueivneWJje+8jOehruS/neiDjOaZr+WSjOeVjOmdouW3suato+ehruiuvue9rlxuICAgIHRoaXMuaW5pdGlhbGl6ZUJhY2tncm91bmQoKTtcblxuICAgIC8vIOaYvuekuuesrOS4gOadoeWvueivnVxuICAgIHRoaXMuc2hvd0RpYWxvZygwKTtcbiAgfVxuXG4gIC8vIOWIneWni+WMluiDjOaZr+WbvueJh1xuICBpbml0aWFsaXplQmFja2dyb3VuZCgpIHtcbiAgICBpZiAodGhpcy5kaWFsb2dEYXRhICYmIHRoaXMuZGlhbG9nRGF0YS5sZW5ndGggPiAwICYmIHRoaXMuZGlhbG9nRGF0YVswXS5iYWNrZ3JvdW5kKSB7XG4gICAgICAvLyDorr7nva7liJ3lp4vog4zmma9cbiAgICAgIGNvbnN0IGluaXRpYWxCZ1BhdGggPSB0aGlzLmRpYWxvZ0RhdGFbMF0uYmFja2dyb3VuZDtcbiAgICAgIGNvbnN0IGluaXRpYWxCZ1VybCA9IHRoaXMuZ2V0RnVsbEltYWdlVXJsKGluaXRpYWxCZ1BhdGgpO1xuXG4gICAgICBjb25zb2xlLmxvZygn5Yid5aeL5YyW6IOM5pmv5Zu+54mHOicsIGluaXRpYWxCZ1VybCk7XG5cbiAgICAgIC8vIOWFiOajgOafpeWFg+e0oOaYr+WQpuWtmOWcqFxuICAgICAgaWYgKCF0aGlzLmN1cnJlbnRJbWFnZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfog4zmma/lm77niYflhYPntKDkuI3lrZjlnKghJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6K6w5b2V5b2T5YmN5pi+56S655qE6IOM5pmv77yM5pa55L6/5ZCO57ut5q+U6L6DXG4gICAgICB0aGlzLmN1cnJlbnRCZ1BhdGggPSBpbml0aWFsQmdQYXRoO1xuXG4gICAgICAvLyDnm7TmjqXorr7nva7lvZPliY3og4zmma/lm77niYdcbiAgICAgIHRoaXMuY3VycmVudEltYWdlLnNyYyA9IGluaXRpYWxCZ1VybDtcbiAgICAgIHRoaXMuY3VycmVudEltYWdlLnN0eWxlLm9wYWNpdHkgPSAnMSc7XG5cbiAgICAgIHRoaXMuY3VycmVudEltYWdlLm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iDjOaZr+WbvueJh+WKoOi9veWksei0pTonLCBpbml0aWFsQmdVcmwpO1xuICAgICAgICAvLyDlsJ3or5Xkvb/nlKjpooTorr7nmoRDRyBVUkxcbiAgICAgICAgdGhpcy5jdXJyZW50SW1hZ2Uuc3JjID1cbiAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JTgzJThDJUU2JTk5JUFGLyVFNSU5NSU4NiVFNSVCQSU5NyVFOCVBMSU5Ny8lRTklQkIlODQlRTYlOTglOEYuanBnJztcbiAgICAgIH07XG5cbiAgICAgIC8vIOajgOafpeWbvueJh+aYr+WQpuW3sue7j+WKoOi9veWujOaIkFxuICAgICAgaWYgKHRoaXMuY3VycmVudEltYWdlLmNvbXBsZXRlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfog4zmma/lm77niYflt7LliqDovb3lrozmiJAnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY3VycmVudEltYWdlLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn6IOM5pmv5Zu+54mH5Yqg6L295a6M5oiQJyk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8g6I635Y+W5a6M5pW055qE5Zu+54mHVVJM77yM5aSE55CGVVJM57yW56CB6Zeu6aKYXG4gIGdldEZ1bGxJbWFnZVVybChyZWxhdGl2ZVBhdGgpIHtcbiAgICBpZiAoIXJlbGF0aXZlUGF0aCkgcmV0dXJuICcnO1xuXG4gICAgLy8g5L2/55So6aKE5a6a5LmJ55qE56Gs57yW56CBVVJMXG4gICAgaWYgKHJlbGF0aXZlUGF0aCA9PT0gJ+WVhuW6l+ihly/pu4TmmI8uanBnJykge1xuICAgICAgcmV0dXJuICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglODMlOEMlRTYlOTklQUYvJUU1JTk1JTg2JUU1JUJBJTk3JUU4JUExJTk3LyVFOSVCQiU4NCVFNiU5OCU4Ri5qcGcnO1xuICAgIH0gZWxzZSBpZiAocmVsYXRpdmVQYXRoID09PSAn5ZWG5bqX6KGXL+WknOaZmuW8gOeBry5qcGcnKSB7XG4gICAgICByZXR1cm4gJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCU4MyU4QyVFNiU5OSVBRi8lRTUlOTUlODYlRTUlQkElOTclRTglQTElOTcvJUU1JUE0JTlDJUU2JTk5JTlBJUU1JUJDJTgwJUU3JTgxJUFGLmpwZyc7XG4gICAgfVxuXG4gICAgLy8g5aaC5p6c5LiN5piv56Gs57yW56CB55qE5Zu+54mH77yM5YiZ5bCd6K+V5p6E5bu6VVJMXG4gICAgLy8g5ouG5YiG6Lev5b6E5Lul5L6/5q2j56Gu57yW56CB5q+P5Liq6YOo5YiGXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IHJlbGF0aXZlUGF0aC5zcGxpdCgnLycpO1xuICAgICAgY29uc3QgZW5jb2RlZFBhcnRzID0gcGF0aFBhcnRzLm1hcChwYXJ0ID0+IGVuY29kZVVSSUNvbXBvbmVudChwYXJ0KSk7XG4gICAgICBjb25zdCBlbmNvZGVkUGF0aCA9IGVuY29kZWRQYXJ0cy5qb2luKCcvJyk7XG5cbiAgICAgIHJldHVybiB0aGlzLmltYWdlQmFzZVVybCArIGVuY29kZWRQYXRoO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdVUkznvJbnoIHlpLHotKU6JywgZXJyb3IsICfljp/lp4vot6/lvoQ6JywgcmVsYXRpdmVQYXRoKTtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICBpbml0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8g54K55Ye75bGP5bmV5Lu75oSP5L2N572u6L+b5YWl5LiL5LiA5q2lXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLm5leHREaWFsb2coKTtcbiAgICB9KTtcblxuICAgIC8vIOaMieepuuagvOmUrui/m+WFpeS4i+S4gOatpVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7XG4gICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ1NwYWNlJykge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLm5leHREaWFsb2coKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHNob3dEaWFsb2coaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggPj0gdGhpcy5kaWFsb2dEYXRhLmxlbmd0aCkge1xuICAgICAgLy8g5a+56K+d57uT5p2f77yM5Y+v5Lul5re75Yqg57uT5p2f55S76Z2i5oiW5b6q546v5pKt5pS+XG4gICAgICBjb25zb2xlLmxvZygn5a+56K+d57uT5p2f77yM6YeN5paw5byA5aeLJyk7XG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7XG4gICAgICB0aGlzLnNob3dEaWFsb2coMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5pu05paw5b2T5YmN5a+56K+d57Si5byVIC0g6Z2e5bi46YeN6KaBXG4gICAgdGhpcy5jdXJyZW50SW5kZXggPSBpbmRleDtcblxuICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMuZGlhbG9nRGF0YVtpbmRleF07XG4gICAgaWYgKCFkaWFsb2cpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WvueivneaVsOaNruS4jeWtmOWcqDonLCBpbmRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5qOA5p+l5piv5ZCm6ZyA6KaB6IOM5pmv6L2s5Zy6IC0g5q+U6L6D5b2T5YmN6IOM5pmv5LiO55uu5qCH6IOM5pmvXG4gICAgY29uc3QgbmV3QmdQYXRoID0gZGlhbG9nLmJhY2tncm91bmQgfHwgJyc7XG4gICAgY29uc3QgbmVlZEJhY2tncm91bmRUcmFuc2l0aW9uID0gbmV3QmdQYXRoICYmIHRoaXMuY3VycmVudEJnUGF0aCAhPT0gbmV3QmdQYXRoO1xuXG4gICAgY29uc29sZS5sb2coXG4gICAgICBg5pi+56S65a+56K+dICMke2luZGV4fWAsXG4gICAgICBkaWFsb2cubmFtZSxcbiAgICAgICflvZPliY3og4zmma86JyxcbiAgICAgIHRoaXMuY3VycmVudEJnUGF0aCB8fCAnKOaXoCknLFxuICAgICAgJ+aWsOiDjOaZrzonLFxuICAgICAgbmV3QmdQYXRoIHx8ICco5pegKScsXG4gICAgICAn6ZyA6KaB6L2s5Zy6OicsXG4gICAgICBuZWVkQmFja2dyb3VuZFRyYW5zaXRpb24sXG4gICAgKTtcblxuICAgIC8vIOWmguaenOmcgOimgeiDjOaZr+i9rOWcuu+8jOWFiOaJp+ihjOiDjOaZr+i9rOWculxuICAgIGlmIChuZWVkQmFja2dyb3VuZFRyYW5zaXRpb24pIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzog4zmma/ovazlnLogLSDku44nLCB0aGlzLmN1cnJlbnRCZ1BhdGggfHwgJyjml6ApJywgJ+WIsCcsIG5ld0JnUGF0aCk7XG5cbiAgICAgIC8vIOS/ruWkje+8muajgOafpeaYr+WQpuWIh+aNouWIsENH77yI5rKh5pyJ6KeS6Imy55qE5oOF5Ya177yJ77yM5aaC5p6c5piv77yM5YWI6ZqQ6JeP5omA5pyJ5b2T5YmN6KeS6ImyXG4gICAgICBpZiAoZGlhbG9nLmNoYXJhY3RlcnMgPT09ICduYXJyYXRvcicgfHwgZGlhbG9nLmNoYXJhY3RlcnMgPT09ICdwcm90YWdvbmlzdCcgfHwgIWRpYWxvZy5jaGFyYWN0ZXJzKSB7XG4gICAgICAgIC8vIOWFiOenu+mZpOaJgOacieW9k+WJjeinkuiJsu+8jOWGjei/m+ihjOiDjOaZr+i9rOWculxuICAgICAgICBmb3IgKGNvbnN0IGNoYXJhY3RlcklkIGluIHRoaXMuYWN0aXZlQ2hhcmFjdGVycykge1xuICAgICAgICAgIHRoaXMuaGlkZUNoYXJhY3RlcihjaGFyYWN0ZXJJZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8g5riF56m65rS75Yqo6KeS6Imy6K6w5b2VXG4gICAgICAgIHRoaXMuYWN0aXZlQ2hhcmFjdGVycyA9IHt9O1xuICAgICAgfVxuXG4gICAgICAvLyDmm7TmlrDlvZPliY3og4zmma/orrDlvZVcbiAgICAgIHRoaXMuY3VycmVudEJnUGF0aCA9IG5ld0JnUGF0aDtcblxuICAgICAgdGhpcy5mYWRlT3V0SW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gbmV3QmdQYXRoO1xuICAgICAgfSwgZGlhbG9nKTsgLy8g5Lyg6YCS5b2T5YmN5a+56K+d5Lul5L6/5Zyo6L2s5Zy65a6M5oiQ5ZCO5pu05pawXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOWQpuWImeebtOaOpeabtOaWsOinkuiJsuWSjOWvueivnVxuICAgICAgdGhpcy51cGRhdGVEaWFsb2dDb250ZW50KGRpYWxvZyk7XG4gICAgfVxuICB9XG5cbiAgLy8g5pu05paw5a+56K+d5YaF5a65XG4gIHVwZGF0ZURpYWxvZ0NvbnRlbnQoZGlhbG9nKSB7XG4gICAgaWYgKCFkaWFsb2cpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+abtOaWsOWvueivneWGheWuueWksei0pTog5a+56K+d5pWw5o2u5Li656m6Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ+abtOaWsOWvueivneWGheWuuTonLCBkaWFsb2cubmFtZSwgZGlhbG9nLnRleHQpO1xuXG4gICAgLy8g5pu05paw6KeS6Imy56uL57uYXG4gICAgdGhpcy51cGRhdGVDaGFyYWN0ZXJzKGRpYWxvZyk7XG5cbiAgICAvLyDlupTnlKjmiZPlrZfmnLrmlYjmnpxcbiAgICB0aGlzLmNoYXJhY3Rlck5hbWUudGV4dENvbnRlbnQgPSBkaWFsb2cubmFtZTtcbiAgICB0aGlzLmFwcGx5VHlwaW5nRWZmZWN0KGRpYWxvZy50ZXh0KTtcblxuICAgIC8vIOa3u+WKoOWIsOWvueivneWOhuWPslxuICAgIHRoaXMuYWRkVG9IaXN0b3J5KGRpYWxvZyk7XG4gIH1cblxuICBhcHBseVR5cGluZ0VmZmVjdCh0ZXh0KSB7XG4gICAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG4gICAgdGhpcy5kaWFsb2dUZXh0LnRleHRDb250ZW50ID0gJyc7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtaGludCcpLnN0eWxlLm9wYWNpdHkgPSAnMCc7IC8vIOmakOiXj+aPkOekulxuXG4gICAgLy8g6K6h566X5omT5a2X6YCf5bqmIC0g5qC55o2u5paH5pys6ZW/5bqm5Yqo5oCB6LCD5pW0XG4gICAgY29uc3QgYmFzZVNwZWVkID0gMzA7XG4gICAgY29uc3Qgc3BlZWRNb2RpZmllciA9IE1hdGgubWF4KDAuNSwgTWF0aC5taW4oMS41LCAzMDAgLyB0ZXh0Lmxlbmd0aCkpO1xuICAgIGNvbnN0IHNwZWVkID0gTWF0aC5mbG9vcihiYXNlU3BlZWQgKiBzcGVlZE1vZGlmaWVyKTtcblxuICAgIGxldCBpID0gMDtcbiAgICAvLyAtLS0g5L+u5pS554K577ya56e76Zmk5LqGIGxhc3RQdW5jdHVhdGlvbiDlj5jph48gLS0tXG4gICAgLy8gbGV0IGxhc3RQdW5jdHVhdGlvbiA9IDA7IC8vIOS4iuS4gOS4quagh+eCueespuWPt+eahOS9jee9rlxuICAgIC8vIC0tLSDkv67mlLnnu5PmnZ8gLS0tXG5cbiAgICBjb25zdCB0eXBlV3JpdGVyID0gKCkgPT4ge1xuICAgICAgaWYgKGkgPCB0ZXh0Lmxlbmd0aCAmJiB0aGlzLmlzQW5pbWF0aW5nKSB7XG4gICAgICAgIGNvbnN0IGNoYXIgPSB0ZXh0LmNoYXJBdChpKTtcbiAgICAgICAgdGhpcy5kaWFsb2dUZXh0LnRleHRDb250ZW50ICs9IGNoYXI7XG4gICAgICAgIGkrKztcblxuICAgICAgICAvLyAtLS0g5L+u5pS554K577ya56e76Zmk5LqG5qCH54K556ym5Y+355qE54m55q6K5YGc6aG/5Yik5patIC0tLVxuICAgICAgICAvLyDkuI3lho3mo4Dmn6XmmK/lkKbkuLrmoIfngrnnrKblj7fvvIznu5/kuIDkvb/nlKjorqHnrpflh7rnmoQgc3BlZWRcbiAgICAgICAgc2V0VGltZW91dCh0eXBlV3JpdGVyLCBzcGVlZCk7XG4gICAgICAgIC8vIC0tLSDkv67mlLnnu5PmnZ8gLS0tXG5cbiAgICAgICAgLy8gLS0tIOenu+mZpOeahOS7o+eggeWdlyAtLS1cbiAgICAgICAgLy8gY29uc3QgaXNQdW5jdHVhdGlvbiA9IC9b77yM44CC77yf77yB44CB77ya77ybXS8udGVzdChjaGFyKTtcbiAgICAgICAgLy8gaWYgKGlzUHVuY3R1YXRpb24pIHtcbiAgICAgICAgLy8gICBsYXN0UHVuY3R1YXRpb24gPSBpO1xuICAgICAgICAvLyAgIHNldFRpbWVvdXQodHlwZVdyaXRlciwgc3BlZWQgKiA1KTsgLy8g5qCH54K556ym5Y+35ZCO5YGc6aG/5pu06ZW/5pe26Ze0XG4gICAgICAgIC8vIH0gZWxzZSBpZiAoaSAtIGxhc3RQdW5jdHVhdGlvbiA8PSAyKSB7XG4gICAgICAgIC8vICAgLy8g5qCH54K556ym5Y+35ZCO55qE5YmN5Lik5Liq5a2X56ym5Lmf56iN5b6u5oWi5LiA54K5XG4gICAgICAgIC8vICAgc2V0VGltZW91dCh0eXBlV3JpdGVyLCBzcGVlZCAqIDEuNSk7XG4gICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgIC8vICAgc2V0VGltZW91dCh0eXBlV3JpdGVyLCBzcGVlZCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gLS0tIOenu+mZpOe7k+adnyAtLS1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtaGludCcpLnN0eWxlLm9wYWNpdHkgPSAnMSc7IC8vIOaYvuekuuaPkOekulxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyDlvIDlp4vmiZPlrZfmlYjmnpxcbiAgICB0eXBlV3JpdGVyKCk7XG4gIH1cblxuICAvLyDmm7TmlrDop5LoibLnq4vnu5jmmL7npLpcbiAgdXBkYXRlQ2hhcmFjdGVycyhkaWFsb2cpIHtcbiAgICAvLyDovazlnLrkuK3kuI3mm7TmlrDop5LoibLmmL7npLrvvIzpgb/lhY3lhrLnqoFcbiAgICBpZiAodGhpcy5pc1RyYW5zaXRpb25pbmcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmraPlnKjovazlnLrkuK3vvIzlu7bov5/mm7TmlrDop5LoibLmmL7npLonKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDorrDlvZXmlrDnmoTop5LoibLmmL7npLrnirbmgIFcbiAgICBjb25zdCBuZXdBY3RpdmVDaGFyYWN0ZXJzID0ge307XG5cbiAgICAvLyDlpITnkIbnibnmrorop4bop5LmqKHlvI9cbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25hcnJhdG9yLW1vZGUnLCAncHJvdGFnb25pc3QtbW9kZScpO1xuXG4gICAgLy8g5aSE55CG6KeS6Imy56uL57uY6YWN572uXG4gICAgaWYgKGRpYWxvZy5jaGFyYWN0ZXJzKSB7XG4gICAgICAvLyDml4Hnmb3mqKHlvI9cbiAgICAgIGlmIChkaWFsb2cuY2hhcmFjdGVycyA9PT0gJ25hcnJhdG9yJykge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ25hcnJhdG9yLW1vZGUnKTtcbiAgICAgICAgLy8g5peB55m95qih5byP5LiL5riF56m65omA5pyJ6KeS6ImyXG4gICAgICAgIGZvciAoY29uc3QgY2hhcmFjdGVySWQgaW4gdGhpcy5hY3RpdmVDaGFyYWN0ZXJzKSB7XG4gICAgICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKGNoYXJhY3RlcklkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZUNoYXJhY3RlcnMgPSB7fTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8g5Li76KeS6KeG6KeS5qih5byPXG4gICAgICBlbHNlIGlmIChkaWFsb2cuY2hhcmFjdGVycyA9PT0gJ3Byb3RhZ29uaXN0Jykge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3Byb3RhZ29uaXN0LW1vZGUnKTtcbiAgICAgICAgLy8g5Li76KeS6KeG6KeS5LiL5riF56m65omA5pyJ6KeS6ImyXG4gICAgICAgIGZvciAoY29uc3QgY2hhcmFjdGVySWQgaW4gdGhpcy5hY3RpdmVDaGFyYWN0ZXJzKSB7XG4gICAgICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKGNoYXJhY3RlcklkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZUNoYXJhY3RlcnMgPSB7fTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8g5Y2V5Liq5bGF5Lit6KeS6Imy77yI5paw5qC85byP77yJXG4gICAgICBlbHNlIGlmIChcbiAgICAgICAgdHlwZW9mIGRpYWxvZy5jaGFyYWN0ZXJzID09PSAnb2JqZWN0JyAmJlxuICAgICAgICBkaWFsb2cuY2hhcmFjdGVycy5pZCAmJlxuICAgICAgICAhZGlhbG9nLmNoYXJhY3RlcnMubGVmdCAmJlxuICAgICAgICAhZGlhbG9nLmNoYXJhY3RlcnMucmlnaHRcbiAgICAgICkge1xuICAgICAgICBjb25zdCBjaGFyYWN0ZXJJZCA9IGRpYWxvZy5jaGFyYWN0ZXJzLmlkO1xuICAgICAgICBjb25zdCBleHByZXNzaW9uID0gZGlhbG9nLmNoYXJhY3RlcnMuZXhwcmVzc2lvbiB8fCAn6buY6K6kLnBuZyc7XG4gICAgICAgIGNvbnN0IGNvc3R1bWUgPSBkaWFsb2cuY2hhcmFjdGVycy5jb3N0dW1lIHx8ICfmsLTmiYvmnI0nOyAvLyDpu5jorqTkvb/nlKjmsLTmiYvmnI1cblxuICAgICAgICBuZXdBY3RpdmVDaGFyYWN0ZXJzW2NoYXJhY3RlcklkXSA9IHtcbiAgICAgICAgICBwb3NpdGlvbjogJ2NlbnRlcicsXG4gICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbixcbiAgICAgICAgICBjb3N0dW1lOiBjb3N0dW1lLCAvLyDorrDlvZXmnI3oo4Xkv6Hmga9cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnNob3dDaGFyYWN0ZXIoY2hhcmFjdGVySWQsICdjZW50ZXInLCBkaWFsb2cubmFtZSA9PT0gY2hhcmFjdGVySWQsIGV4cHJlc3Npb24sIGNvc3R1bWUpO1xuICAgICAgfVxuICAgICAgLy8g5bem5Y+z5Lik5Liq6KeS6Imy77yI5paw5qC85byP77yJXG4gICAgICBlbHNlIGlmICh0eXBlb2YgZGlhbG9nLmNoYXJhY3RlcnMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIOWmguaenOWPquacieS4gOS4quinkuiJsu+8jOWImeWxheS4reaYvuekulxuICAgICAgICBjb25zdCBoYXNMZWZ0Q2hhciA9ICEhZGlhbG9nLmNoYXJhY3RlcnMubGVmdDtcbiAgICAgICAgY29uc3QgaGFzUmlnaHRDaGFyID0gISFkaWFsb2cuY2hhcmFjdGVycy5yaWdodDtcblxuICAgICAgICBpZiAoaGFzTGVmdENoYXIgJiYgIWhhc1JpZ2h0Q2hhcikge1xuICAgICAgICAgIC8vIOWPquacieW3pui+ueinkuiJsu+8jOWxheS4reaYvuekulxuICAgICAgICAgIGNvbnN0IGNoYXJhY3RlcklkID0gZGlhbG9nLmNoYXJhY3RlcnMubGVmdC5pZDtcbiAgICAgICAgICBjb25zdCBleHByZXNzaW9uID0gZGlhbG9nLmNoYXJhY3RlcnMubGVmdC5leHByZXNzaW9uIHx8ICfpu5jorqQucG5nJztcbiAgICAgICAgICBjb25zdCBjb3N0dW1lID0gZGlhbG9nLmNoYXJhY3RlcnMubGVmdC5jb3N0dW1lIHx8ICfmsLTmiYvmnI0nOyAvLyDpu5jorqTkvb/nlKjmsLTmiYvmnI1cblxuICAgICAgICAgIG5ld0FjdGl2ZUNoYXJhY3RlcnNbY2hhcmFjdGVySWRdID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdjZW50ZXInLFxuICAgICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbixcbiAgICAgICAgICAgIGNvc3R1bWU6IGNvc3R1bWUsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRoaXMuc2hvd0NoYXJhY3RlcihjaGFyYWN0ZXJJZCwgJ2NlbnRlcicsIGRpYWxvZy5uYW1lID09PSBjaGFyYWN0ZXJJZCwgZXhwcmVzc2lvbiwgY29zdHVtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWhhc0xlZnRDaGFyICYmIGhhc1JpZ2h0Q2hhcikge1xuICAgICAgICAgIC8vIOWPquacieWPs+i+ueinkuiJsu+8jOWxheS4reaYvuekulxuICAgICAgICAgIGNvbnN0IGNoYXJhY3RlcklkID0gZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQuaWQ7XG4gICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IGRpYWxvZy5jaGFyYWN0ZXJzLnJpZ2h0LmV4cHJlc3Npb24gfHwgJ+m7mOiupC5wbmcnO1xuICAgICAgICAgIGNvbnN0IGNvc3R1bWUgPSBkaWFsb2cuY2hhcmFjdGVycy5yaWdodC5jb3N0dW1lIHx8ICfmsLTmiYvmnI0nOyAvLyDpu5jorqTkvb/nlKjmsLTmiYvmnI1cblxuICAgICAgICAgIG5ld0FjdGl2ZUNoYXJhY3RlcnNbY2hhcmFjdGVySWRdID0ge1xuICAgICAgICAgICAgcG9zaXRpb246ICdjZW50ZXInLFxuICAgICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbixcbiAgICAgICAgICAgIGNvc3R1bWU6IGNvc3R1bWUsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRoaXMuc2hvd0NoYXJhY3RlcihjaGFyYWN0ZXJJZCwgJ2NlbnRlcicsIGRpYWxvZy5uYW1lID09PSBjaGFyYWN0ZXJJZCwgZXhwcmVzc2lvbiwgY29zdHVtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5Lik5Liq6KeS6Imy6YO95pyJ77yM5bem5Y+z5pi+56S6XG4gICAgICAgICAgaWYgKGRpYWxvZy5jaGFyYWN0ZXJzLmxlZnQgJiYgZGlhbG9nLmNoYXJhY3RlcnMubGVmdC5pZCkge1xuICAgICAgICAgICAgY29uc3QgY2hhcmFjdGVySWQgPSBkaWFsb2cuY2hhcmFjdGVycy5sZWZ0LmlkO1xuICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IGRpYWxvZy5jaGFyYWN0ZXJzLmxlZnQuZXhwcmVzc2lvbiB8fCAn6buY6K6kLnBuZyc7XG4gICAgICAgICAgICBjb25zdCBjb3N0dW1lID0gZGlhbG9nLmNoYXJhY3RlcnMubGVmdC5jb3N0dW1lIHx8ICfmsLTmiYvmnI0nOyAvLyDpu5jorqTkvb/nlKjmsLTmiYvmnI1cblxuICAgICAgICAgICAgbmV3QWN0aXZlQ2hhcmFjdGVyc1tjaGFyYWN0ZXJJZF0gPSB7XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiAnbGVmdCcsXG4gICAgICAgICAgICAgIGV4cHJlc3Npb246IGV4cHJlc3Npb24sXG4gICAgICAgICAgICAgIGNvc3R1bWU6IGNvc3R1bWUsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnNob3dDaGFyYWN0ZXIoY2hhcmFjdGVySWQsICdsZWZ0JywgZGlhbG9nLm5hbWUgPT09IGNoYXJhY3RlcklkLCBleHByZXNzaW9uLCBjb3N0dW1lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQgJiYgZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQuaWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXJhY3RlcklkID0gZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQuaWQ7XG4gICAgICAgICAgICBjb25zdCBleHByZXNzaW9uID0gZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQuZXhwcmVzc2lvbiB8fCAn6buY6K6kLnBuZyc7XG4gICAgICAgICAgICBjb25zdCBjb3N0dW1lID0gZGlhbG9nLmNoYXJhY3RlcnMucmlnaHQuY29zdHVtZSB8fCAn5rC05omL5pyNJzsgLy8g6buY6K6k5L2/55So5rC05omL5pyNXG5cbiAgICAgICAgICAgIG5ld0FjdGl2ZUNoYXJhY3RlcnNbY2hhcmFjdGVySWRdID0ge1xuICAgICAgICAgICAgICBwb3NpdGlvbjogJ3JpZ2h0JyxcbiAgICAgICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbixcbiAgICAgICAgICAgICAgY29zdHVtZTogY29zdHVtZSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuc2hvd0NoYXJhY3RlcihjaGFyYWN0ZXJJZCwgJ3JpZ2h0JywgZGlhbG9nLm5hbWUgPT09IGNoYXJhY3RlcklkLCBleHByZXNzaW9uLCBjb3N0dW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5rKh5pyJ6KeS6Imy6YWN572u5pe277yM6ZqQ6JeP5omA5pyJ6KeS6ImyXG4gICAgICBmb3IgKGNvbnN0IGNoYXJhY3RlcklkIGluIHRoaXMuYWN0aXZlQ2hhcmFjdGVycykge1xuICAgICAgICB0aGlzLmhpZGVDaGFyYWN0ZXIoY2hhcmFjdGVySWQpO1xuICAgICAgfVxuICAgICAgdGhpcy5hY3RpdmVDaGFyYWN0ZXJzID0ge307XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g56e76Zmk5LiN5Zyo5paw6YWN572u5Lit55qE6KeS6ImyXG4gICAgZm9yIChjb25zdCBjaGFyYWN0ZXJJZCBpbiB0aGlzLmFjdGl2ZUNoYXJhY3RlcnMpIHtcbiAgICAgIGlmICghbmV3QWN0aXZlQ2hhcmFjdGVyc1tjaGFyYWN0ZXJJZF0pIHtcbiAgICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKGNoYXJhY3RlcklkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDmm7TmlrDmtLvliqjop5LoibLliJfooahcbiAgICB0aGlzLmFjdGl2ZUNoYXJhY3RlcnMgPSBuZXdBY3RpdmVDaGFyYWN0ZXJzO1xuICB9XG5cbiAgLy8g5pi+56S66KeS6Imy56uL57uYXG4gIHNob3dDaGFyYWN0ZXIoY2hhcmFjdGVySWQsIHBvc2l0aW9uLCBpc1NwZWFraW5nLCBleHByZXNzaW9uID0gJ+m7mOiupCcsIGNvc3R1bWUgPSAn5rC05omL5pyNJykge1xuICAgIC8vIOi9rOWcuuS4reS4jeabtOaWsOinkuiJsuaYvuekuu+8jOmBv+WFjeWGsueqgVxuICAgIGlmICh0aGlzLmlzVHJhbnNpdGlvbmluZykge1xuICAgICAgY29uc29sZS5sb2coJ+ato+WcqOi9rOWcuuS4re+8jOi3s+i/h+aYvuekuuinkuiJsjonLCBjaGFyYWN0ZXJJZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g6I635Y+W6KeS6Imy55qE5pyN6KOF5ZKM6KGo5oOF56uL57uYVVJMXG4gICAgaWYgKCF0aGlzLmNoYXJhY3RlclNwcml0ZXNbY2hhcmFjdGVySWRdKSByZXR1cm47XG5cbiAgICAvLyDmjIflrprop5LoibLnmoTmnI3oo4XvvIzlpoLmnpzkuI3lrZjlnKjliJnkvb/nlKjpu5jorqTmnI3oo4VcbiAgICBjb25zdCBjaGFyYWN0ZXJDb3N0dW1lcyA9IHRoaXMuY2hhcmFjdGVyU3ByaXRlc1tjaGFyYWN0ZXJJZF07XG4gICAgbGV0IGNvc3R1bWVUb1VzZSA9IGNvc3R1bWU7XG5cbiAgICAvLyDlpoLmnpzmjIflrprnmoTmnI3oo4XkuI3lrZjlnKjvvIzliJnkvb/nlKjnrKzkuIDkuKrlj6/nlKjnmoTmnI3oo4VcbiAgICBpZiAoIWNoYXJhY3RlckNvc3R1bWVzW2Nvc3R1bWVUb1VzZV0pIHtcbiAgICAgIGNvc3R1bWVUb1VzZSA9IE9iamVjdC5rZXlzKGNoYXJhY3RlckNvc3R1bWVzKVswXTtcbiAgICB9XG5cbiAgICAvLyDojrflj5bmjIflrprmnI3oo4XkuIvnmoTooajmg4VcbiAgICBjb25zdCBjb3N0dW1lRXhwcmVzc2lvbnMgPSBjaGFyYWN0ZXJDb3N0dW1lc1tjb3N0dW1lVG9Vc2VdO1xuXG4gICAgLy8g5aaC5p6c5oyH5a6a55qE6KGo5oOF5LiN5a2Y5Zyo77yM5YiZ5L2/55So6buY6K6k6KGo5oOFXG4gICAgbGV0IGV4cHJlc3Npb25Ub1VzZSA9IGV4cHJlc3Npb247XG4gICAgaWYgKCFjb3N0dW1lRXhwcmVzc2lvbnNbZXhwcmVzc2lvblRvVXNlXSkge1xuICAgICAgZXhwcmVzc2lvblRvVXNlID0gT2JqZWN0LmtleXMoY29zdHVtZUV4cHJlc3Npb25zKVswXSB8fCAn6buY6K6kLnBuZyc7XG4gICAgfVxuXG4gICAgY29uc3Qgc3ByaXRlVXJsID0gY29zdHVtZUV4cHJlc3Npb25zW2V4cHJlc3Npb25Ub1VzZV07XG5cbiAgICAvLyDlpoLmnpzmsqHmnInmib7liLDmnInmlYjnmoTnq4vnu5hVUkzvvIzliJnpgIDlh7pcbiAgICBpZiAoIXNwcml0ZVVybCkgcmV0dXJuO1xuXG4gICAgLy8g6I635Y+W6KeS6ImySUTlkozooajmg4XnmoTnu4TlkIhJRFxuICAgIGNvbnN0IGNoYXJhY3RlckVsZW1lbnRJZCA9IGBjaGFyYWN0ZXItJHtjaGFyYWN0ZXJJZH1gO1xuICAgIGNvbnN0IG9sZFBvc2l0aW9uID0gdGhpcy5hY3RpdmVDaGFyYWN0ZXJzW2NoYXJhY3RlcklkXT8ucG9zaXRpb247XG5cbiAgICAvLyDmo4Dmn6Xop5LoibLnq4vnu5jmmK/lkKblt7LlrZjlnKhcbiAgICBsZXQgY2hhcmFjdGVyRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNoYXJhY3RlckVsZW1lbnRJZCk7XG5cbiAgICAvLyDlpoLmnpzkuI3lrZjlnKjliJnliJvlu7rmlrDnmoTnq4vnu5jlhYPntKBcbiAgICBpZiAoIWNoYXJhY3RlckVsZW1lbnQpIHtcbiAgICAgIGNoYXJhY3RlckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgIGNoYXJhY3RlckVsZW1lbnQuaWQgPSBjaGFyYWN0ZXJFbGVtZW50SWQ7XG4gICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTmFtZSA9ICdjaGFyYWN0ZXItc3ByaXRlIGNoYXJhY3Rlci1lbnRlcic7XG4gICAgICBjaGFyYWN0ZXJFbGVtZW50LnNyYyA9IHNwcml0ZVVybDtcbiAgICAgIGNoYXJhY3RlckVsZW1lbnQuZGF0YXNldC5leHByZXNzaW9uID0gZXhwcmVzc2lvblRvVXNlO1xuICAgICAgY2hhcmFjdGVyRWxlbWVudC5kYXRhc2V0LnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICBjaGFyYWN0ZXJFbGVtZW50LmFsdCA9IGAke2NoYXJhY3RlcklkfeeahOeri+e7mGA7XG5cbiAgICAgIC8vIOi/h+a4oeWJjeWHhuWkhyAtIOWmguaenOaYr+S7juS4gOS+p+WIh+aNouWIsOWPpuS4gOS+p++8jOWFiOS9v+eUqOWOn+adpeeahOS9jee9rlxuICAgICAgaWYgKG9sZFBvc2l0aW9uICYmIG9sZFBvc2l0aW9uICE9PSBwb3NpdGlvbikge1xuICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoYGNoYXJhY3Rlci0ke29sZFBvc2l0aW9ufWApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKGBjaGFyYWN0ZXItJHtwb3NpdGlvbn1gKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jaGFyYWN0ZXJDb250YWluZXIuYXBwZW5kQ2hpbGQoY2hhcmFjdGVyRWxlbWVudCk7XG5cbiAgICAgIC8vIOWbvueJh+WKoOi9veWujOaIkOWQjua3u+WKoOa/gOa0u+exu1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8vIOWGjeasoeajgOafpeaYr+WQpuWcqOi9rOWcuuS4re+8jOWmguaenOaYr+WImeS4jeaYvuekulxuICAgICAgICBpZiAodGhpcy5pc1RyYW5zaXRpb25pbmcpIHtcbiAgICAgICAgICBpZiAoY2hhcmFjdGVyRWxlbWVudCAmJiBjaGFyYWN0ZXJFbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGNoYXJhY3RlckVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjaGFyYWN0ZXJFbGVtZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjaGFyYWN0ZXItZW50ZXInKTtcbiAgICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjaGFyYWN0ZXItYWN0aXZlJyk7XG5cbiAgICAgICAgLy8g5aaC5p6c5L2N572u5pS55Y+Y77yM5bu26L+f5ZCO5pu05paw5L2N572uXG4gICAgICAgIGlmIChvbGRQb3NpdGlvbiAmJiBvbGRQb3NpdGlvbiAhPT0gcG9zaXRpb24pIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNoYXJhY3RlckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShgY2hhcmFjdGVyLSR7b2xkUG9zaXRpb259YCk7XG4gICAgICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoYGNoYXJhY3Rlci0ke3Bvc2l0aW9ufWApO1xuICAgICAgICAgICAgY2hhcmFjdGVyRWxlbWVudC5kYXRhc2V0LnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgICAgfSwgNTApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8g5Y2V5Lq65bGF5Lit5pi+56S65pe255qE54m55q6K5aSE55CGXG4gICAgICAgIHRoaXMuYXBwbHlQb3NpdGlvblN0eWxlKGNoYXJhY3RlckVsZW1lbnQsIHBvc2l0aW9uKTtcbiAgICAgIH0sIDUwKTtcbiAgICB9XG4gICAgLy8g5aaC5p6c5bey5a2Y5Zyo5L2G6KGo5oOF5oiW5L2N572u5LiN5ZCMXG4gICAgZWxzZSB7XG4gICAgICAvLyDooajmg4Xlj5jljJZcbiAgICAgIGlmIChjaGFyYWN0ZXJFbGVtZW50LmRhdGFzZXQuZXhwcmVzc2lvbiAhPT0gZXhwcmVzc2lvblRvVXNlKSB7XG4gICAgICAgIGNoYXJhY3RlckVsZW1lbnQuc3JjID0gc3ByaXRlVXJsO1xuICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LmRhdGFzZXQuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub1VzZTtcbiAgICAgIH1cblxuICAgICAgLy8g5L2N572u5Y+Y5YyWXG4gICAgICBpZiAoY2hhcmFjdGVyRWxlbWVudC5kYXRhc2V0LnBvc2l0aW9uICE9PSBwb3NpdGlvbikge1xuICAgICAgICAvLyDkvb/nlKjov4fmuKHliqjnlLvlubPmu5HliIfmjaLkvY3nva5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgLy8g5YaN5qyh5qOA5p+l5piv5ZCm5Zyo6L2s5Zy65LitXG4gICAgICAgICAgaWYgKHRoaXMuaXNUcmFuc2l0aW9uaW5nKSByZXR1cm47XG5cbiAgICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoYGNoYXJhY3Rlci0ke2NoYXJhY3RlckVsZW1lbnQuZGF0YXNldC5wb3NpdGlvbn1gKTtcbiAgICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoYGNoYXJhY3Rlci0ke3Bvc2l0aW9ufWApO1xuICAgICAgICAgIGNoYXJhY3RlckVsZW1lbnQuZGF0YXNldC5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuXG4gICAgICAgICAgLy8g5pu05paw5a6a5L2N5qC35byPXG4gICAgICAgICAgdGhpcy5hcHBseVBvc2l0aW9uU3R5bGUoY2hhcmFjdGVyRWxlbWVudCwgcG9zaXRpb24pO1xuICAgICAgICB9LCA1MCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g5bqU55So6K+06K+dL+S4jeivtOivneeKtuaAgSAtIOWPqueUqOa7pOmVnOWMuuWIhu+8jOS4jeeUqOmAj+aYjuW6plxuICAgIGlmIChpc1NwZWFraW5nKSB7XG4gICAgICBjaGFyYWN0ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NoYXJhY3Rlci1zcGVha2luZycpO1xuICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjaGFyYWN0ZXItZGltbWVkJyk7XG4gICAgICBjaGFyYWN0ZXJFbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAnMSc7IC8vIOehruS/neWujOWFqOS4jemAj+aYjlxuICAgICAgY2hhcmFjdGVyRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAnOyAvLyDnoa7kv53or7Tor53op5LoibLlnKjliY3pnaJcbiAgICB9IGVsc2Uge1xuICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjaGFyYWN0ZXItc3BlYWtpbmcnKTtcbiAgICAgIGNoYXJhY3RlckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2hhcmFjdGVyLWRpbW1lZCcpO1xuICAgICAgY2hhcmFjdGVyRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gJzEnOyAvLyDnoa7kv53lrozlhajkuI3pgI/mmI5cbiAgICAgIGNoYXJhY3RlckVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzUnOyAvLyDpnZ7or7Tor53op5LoibLlnKjlkI7pnaJcbiAgICB9XG4gIH1cblxuICAvLyDlupTnlKjkvY3nva7moLflvI/nmoTovoXliqnlh73mlbBcbiAgYXBwbHlQb3NpdGlvblN0eWxlKGVsZW1lbnQsIHBvc2l0aW9uKSB7XG4gICAgLy8g5Y2V5Lq65bGF5Lit5pi+56S65pe255qE54m55q6K5aSE55CGXG4gICAgaWYgKHBvc2l0aW9uID09PSAnY2VudGVyJykge1xuICAgICAgLy8g56Gu5L+d5a6M5YWo5bGF5Lit5LiU5bqV6YOo5LiN6Zyy5Ye66IOM5pmvXG4gICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSAnNTAlJztcbiAgICAgIGVsZW1lbnQuc3R5bGUucmlnaHQgPSAnYXV0byc7XG4gICAgICBlbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC01MCUpJztcbiAgICAgIGVsZW1lbnQuc3R5bGUuYm90dG9tID0gJzAnO1xuICAgICAgZWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnOTglJztcbiAgICAgIGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gJzk4JSc7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ2xlZnQnKSB7XG4gICAgICAvLyDlt6bkvqflrprkvY0gLSDosIPmlbTkuLrmm7TpnaDov5HkuK3lv4NcbiAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9ICczMCUnO1xuICAgICAgZWxlbWVudC5zdHlsZS5yaWdodCA9ICdhdXRvJztcbiAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLTUwJSknO1xuICAgICAgZWxlbWVudC5zdHlsZS5ib3R0b20gPSAnMCc7XG4gICAgICBlbGVtZW50LnN0eWxlLmhlaWdodCA9ICc5NSUnO1xuICAgICAgZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSAnOTUlJztcbiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICAvLyDlj7PkvqflrprkvY0gLSDosIPmlbTkuLrmm7TpnaDov5HkuK3lv4NcbiAgICAgIGVsZW1lbnQuc3R5bGUucmlnaHQgPSAnMzAlJztcbiAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9ICdhdXRvJztcbiAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoNTAlKSc7XG4gICAgICBlbGVtZW50LnN0eWxlLmJvdHRvbSA9ICcwJztcbiAgICAgIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzk1JSc7XG4gICAgICBlbGVtZW50LnN0eWxlLm1heEhlaWdodCA9ICc5NSUnO1xuICAgIH1cbiAgfVxuXG4gIC8vIOmakOiXj+inkuiJsueri+e7mFxuICBoaWRlQ2hhcmFjdGVyKGNoYXJhY3RlcklkKSB7XG4gICAgY29uc3QgY2hhcmFjdGVyRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjaGFyYWN0ZXItJHtjaGFyYWN0ZXJJZH1gKTtcbiAgICBpZiAoY2hhcmFjdGVyRWxlbWVudCkge1xuICAgICAgLy8g6Ziy5q2i6YeN5aSN6Kem5Y+R5reh5Ye65Yqo55S7XG4gICAgICBpZiAoY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoYXJhY3Rlci1leGl0JykpIHJldHVybjtcblxuICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjaGFyYWN0ZXItZXhpdCcpO1xuICAgICAgY2hhcmFjdGVyRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjaGFyYWN0ZXItYWN0aXZlJywgJ2NoYXJhY3Rlci1zcGVha2luZycpO1xuXG4gICAgICAvLyDliqjnlLvnu5PmnZ/lkI7np7vpmaTlhYPntKBcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAoY2hhcmFjdGVyRWxlbWVudCAmJiBjaGFyYWN0ZXJFbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2hhcmFjdGVyRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDgwMCk7IC8vIOWinuWKoOW7tui/n+S7pemFjeWQiENTU+i/h+a4oeaXtumXtFxuICAgIH1cbiAgfVxuXG4gIG5leHREaWFsb2coKSB7XG4gICAgLy8g5aaC5p6c5q2j5Zyo5Yqo55S75Lit77yM5YiZ6Lez6L+H5omT5a2X5pWI5p6c55u05o6l5pi+56S65YWo6YOo5paH5pysXG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHtcbiAgICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgIGNvbnN0IGN1cnJlbnREaWFsb2cgPSB0aGlzLmRpYWxvZ0RhdGFbdGhpcy5jdXJyZW50SW5kZXhdO1xuICAgICAgdGhpcy5kaWFsb2dUZXh0LnRleHRDb250ZW50ID0gY3VycmVudERpYWxvZy50ZXh0O1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtaGludCcpLnN0eWxlLm9wYWNpdHkgPSAnMSc7IC8vIOaYvuekuuaPkOekulxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOWinuWKoOWvueivnee0ouW8lVxuICAgIHRoaXMuY3VycmVudEluZGV4Kys7XG5cbiAgICAvLyAtLS0g5L+u5pS554K577ya5qOA5p+l5piv5ZCm6LaF5Ye65a+56K+d5pWw5o2u6IyD5Zu0IC0tLVxuICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLmRpYWxvZ0RhdGEubGVuZ3RoKSB7XG4gICAgICBjb25zb2xlLmxvZygn5a+56K+d5bey5YWo6YOo5pKt5pS+5a6M5q+V44CCJyk7XG4gICAgICAvLyDlsIbntKLlvJXpgIDlm57liLDmnIDlkI7kuIDmnaHvvIzpmLLmraLlkI7nu63lj6/og73nmoTplJnor6/lvJXnlKhcbiAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gdGhpcy5kaWFsb2dEYXRhLmxlbmd0aCAtIDE7XG5cbiAgICAgIC8vIOWPr+mAie+8mumakOiXj1wi5LiL5LiA5q2lXCLmj5DnpLrvvIzmmI7noa7lkYrnn6XnlKjmiLflr7nor53nu5PmnZ9cbiAgICAgIGNvbnN0IG5leHRIaW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtaGludCcpO1xuICAgICAgaWYgKG5leHRIaW50KSB7XG4gICAgICAgIG5leHRIaW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB9XG5cbiAgICAgIC8vIOaYvuekuumHjeaWsOaSreaUvuaMiemSrlxuICAgICAgY29uc3QgcmVzdGFydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXJ0LWJ0bicpO1xuICAgICAgaWYgKHJlc3RhcnRCdG4pIHtcbiAgICAgICAgcmVzdGFydEJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIH1cblxuICAgICAgLy8g6Zi75q2i6L+b5LiA5q2l55qE5pON5L2c77yM5LiN5YaN6LCD55SoIHNob3dEaWFsb2dcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gLS0tIOS/ruaUuee7k+adnyAtLS1cblxuICAgIC8vIOWmguaenOe0ouW8leacieaViO+8jOWImeaYvuekuuS4i+S4gOadoeWvueivnVxuICAgIHRoaXMuc2hvd0RpYWxvZyh0aGlzLmN1cnJlbnRJbmRleCk7XG4gIH1cblxuICAvLyDph43mlrDlvIDlp4vlr7nor53mkq3mlL5cbiAgcmVzdGFydERpYWxvZygpIHtcbiAgICBjb25zb2xlLmxvZygn6YeN5paw5byA5aeL5a+56K+d5pKt5pS+Jyk7XG5cbiAgICAvLyDph43nva7ntKLlvJVcbiAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7XG5cbiAgICAvLyDph43nva7op5LoibLnq4vnu5hcbiAgICBmb3IgKGNvbnN0IGNoYXJhY3RlcklkIGluIHRoaXMuYWN0aXZlQ2hhcmFjdGVycykge1xuICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKGNoYXJhY3RlcklkKTtcbiAgICB9XG4gICAgdGhpcy5hY3RpdmVDaGFyYWN0ZXJzID0ge307XG5cbiAgICAvLyDph43nva7og4zmma/liLDliJ3lp4vnirbmgIFcbiAgICBpZiAodGhpcy5kaWFsb2dEYXRhICYmIHRoaXMuZGlhbG9nRGF0YS5sZW5ndGggPiAwICYmIHRoaXMuZGlhbG9nRGF0YVswXS5iYWNrZ3JvdW5kKSB7XG4gICAgICB0aGlzLmN1cnJlbnRCZ1BhdGggPSB0aGlzLmRpYWxvZ0RhdGFbMF0uYmFja2dyb3VuZDtcbiAgICAgIGNvbnN0IGluaXRpYWxCZ1VybCA9IHRoaXMuZ2V0RnVsbEltYWdlVXJsKHRoaXMuY3VycmVudEJnUGF0aCk7XG4gICAgICB0aGlzLmN1cnJlbnRJbWFnZS5zcmMgPSBpbml0aWFsQmdVcmw7XG4gICAgfVxuXG4gICAgLy8g6YeN572u5a+56K+d55WM6Z2i54q25oCBXG4gICAgY29uc3QgbmV4dEhpbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV4dC1oaW50Jyk7XG4gICAgaWYgKG5leHRIaW50KSB7XG4gICAgICBuZXh0SGludC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIG5leHRIaW50LnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgfVxuXG4gICAgLy8g6ZqQ6JeP6YeN5paw5pKt5pS+5oyJ6ZKuXG4gICAgY29uc3QgcmVzdGFydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXJ0LWJ0bicpO1xuICAgIGlmIChyZXN0YXJ0QnRuKSB7XG4gICAgICByZXN0YXJ0QnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuXG4gICAgLy8g5pi+56S656ys5LiA5p2h5a+56K+dXG4gICAgdGhpcy5zaG93RGlhbG9nKDApO1xuICB9XG5cbiAgZmFkZU91dEluKGNhbGxiYWNrLCBkaWFsb2dUb1VwZGF0ZSkge1xuICAgIC8vIOWmguaenOW3sue7j+WcqOi9rOWcuu+8jOWImeW/veeVpVxuICAgIGlmICh0aGlzLmlzVHJhbnNpdGlvbmluZykge1xuICAgICAgY29uc29sZS5sb2coJ+W3suWcqOi9rOWcuuS4re+8jOW/veeVpeaWsOeahOi9rOWcuuivt+axgicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNUcmFuc2l0aW9uaW5nID0gdHJ1ZTtcbiAgICBjb25zb2xlLmxvZygn5byA5aeL6IOM5pmv6L2s5Zy6Jyk7XG5cbiAgICAvLyDojrflj5bkuIvkuIDlvKDlm77niYfnmoRVUkxcbiAgICBjb25zdCByZWxhdGl2ZUltYWdlUGF0aCA9IGNhbGxiYWNrKCk7IC8vIOiOt+WPliBKU09OIOS4reWumuS5ieeahOebuOWvuei3r+W+hCAo5L6L5aaCIFwi5pWZ5a6kL+eZveWkqS5qcGdcIilcbiAgICBpZiAoIXJlbGF0aXZlSW1hZ2VQYXRoKSB7XG4gICAgICBjb25zb2xlLmxvZygn6IOM5pmv6Lev5b6E5Li656m677yM6Lez6L+H6L2s5Zy6Jyk7XG4gICAgICB0aGlzLmlzVHJhbnNpdGlvbmluZyA9IGZhbHNlO1xuICAgICAgaWYgKGRpYWxvZ1RvVXBkYXRlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlRGlhbG9nQ29udGVudChkaWFsb2dUb1VwZGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IG5leHRJbWFnZVVybCA9IHRoaXMuZ2V0RnVsbEltYWdlVXJsKHJlbGF0aXZlSW1hZ2VQYXRoKTtcbiAgICBjb25zb2xlLmxvZygn5YiH5o2i6IOM5pmv5Zu+54mHOicsIHJlbGF0aXZlSW1hZ2VQYXRoLCAnLT4nLCBuZXh0SW1hZ2VVcmwpO1xuXG4gICAgLy8g5aaC5p6cVVJM6I635Y+W5aSx6LSl5oiW5LiO5b2T5YmN5Zu+54mH55u45ZCM77yM5YiZ5LiN5omn6KGM6L2s5Zy6XG4gICAgaWYgKCFuZXh0SW1hZ2VVcmwgfHwgbmV4dEltYWdlVXJsID09PSB0aGlzLmN1cnJlbnRJbWFnZS5zcmMpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfot7Pov4fog4zmma/ovazlnLo6IFVSTOS4uuepuuaIluebuOWQjCcpO1xuICAgICAgdGhpcy5pc1RyYW5zaXRpb25pbmcgPSBmYWxzZTtcbiAgICAgIC8vIOWNs+S9v+ayoeaciei9rOWcuu+8jOS5n+imgeabtOaWsOWvueivneWGheWuuVxuICAgICAgaWYgKGRpYWxvZ1RvVXBkYXRlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlRGlhbG9nQ29udGVudChkaWFsb2dUb1VwZGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5omn6KGM6L2s5Zy65Yqo55S7XG4gICAgY29uc3QgZXhlY3V0ZVRyYW5zaXRpb24gPSAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM6IOM5pmv6L2s5Zy65Yqo55S7Jyk7XG4gICAgICAvLyDmt7vliqDovazlnLrliqjnlLvnsbtcbiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgndHJhbnNpdGlvbmluZycpO1xuXG4gICAgICAvLyDmt6HlhaXkuIvkuIDlvKDlm77niYdcbiAgICAgIHRoaXMubmV4dEltYWdlLnN0eWxlLm9wYWNpdHkgPSAnMSc7XG5cbiAgICAgIC8vIOi9rOWcuuWujOaIkOWQjueahOWkhOeQhlxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8vIOWwhuS4i+S4gOW8oOWbvueJh+eahFVSTOWkjeWItuWIsOW9k+WJjeWbvueJh1xuICAgICAgICB0aGlzLmN1cnJlbnRJbWFnZS5zcmMgPSB0aGlzLm5leHRJbWFnZS5zcmM7XG4gICAgICAgIGNvbnNvbGUubG9nKCfog4zmma/ovazlnLrlrozmiJDvvIzlvZPliY3og4zmma86JywgdGhpcy5jdXJyZW50SW1hZ2Uuc3JjKTtcbiAgICAgICAgLy8g6YeN572u5LiL5LiA5byg5Zu+54mH55qE5LiN6YCP5piO5bqmXG4gICAgICAgIHRoaXMubmV4dEltYWdlLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgICAgIC8vIOenu+mZpOi9rOWcuuWKqOeUu+exu1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3RyYW5zaXRpb25pbmcnKTtcbiAgICAgICAgLy8g6YeN572u6L2s5Zy654q25oCBXG4gICAgICAgIHRoaXMuaXNUcmFuc2l0aW9uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgLy8g6L2s5Zy65a6M5oiQ5ZCO5pu05paw5a+56K+d5YaF5a65XG4gICAgICAgIGlmIChkaWFsb2dUb1VwZGF0ZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfovazlnLrlrozmiJDvvIzmm7TmlrDlr7nor53lhoXlrrk6JywgZGlhbG9nVG9VcGRhdGUubmFtZSk7XG4gICAgICAgICAgLy8g5L+u5aSN77ya56Gu5L+d6L2s5Zy65a6M5YWo57uT5p2f5ZCO5YaN5pu05paw5a+56K+d5YaF5a655ZKM6KeS6ImyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURpYWxvZ0NvbnRlbnQoZGlhbG9nVG9VcGRhdGUpO1xuICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgfVxuICAgICAgfSwgMTIwMCk7IC8vIOS4jkNTU+i/h+a4oeaXtumXtOWMuemFjVxuICAgIH07XG5cbiAgICAvLyDorr7nva7kuIvkuIDlvKDlm77niYfnmoRVUkxcbiAgICB0aGlzLm5leHRJbWFnZS5zcmMgPSBuZXh0SW1hZ2VVcmw7XG5cbiAgICAvLyDmt7vliqDplJnor6/lpITnkIZcbiAgICB0aGlzLm5leHRJbWFnZS5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcign6IOM5pmv5Zu+54mH5Yqg6L295aSx6LSlOicsIG5leHRJbWFnZVVybCk7XG4gICAgICB0aGlzLmlzVHJhbnNpdGlvbmluZyA9IGZhbHNlO1xuICAgICAgLy8g5Y2z5L2/5Yqg6L295aSx6LSl77yM5Lmf6KaB5bCd6K+V5pu05paw5a+56K+d5YaF5a65XG4gICAgICBpZiAoZGlhbG9nVG9VcGRhdGUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVEaWFsb2dDb250ZW50KGRpYWxvZ1RvVXBkYXRlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5uZXh0SW1hZ2Uub25sb2FkID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ+iDjOaZr+WbvueJh+WKoOi9veWujOaIkCcpO1xuICAgICAgZXhlY3V0ZVRyYW5zaXRpb24oKTtcbiAgICB9O1xuICB9XG5cbiAgLy8g5re75Yqg5a+56K+d5Yiw5Y6G5Y+y6K6w5b2VXG4gIGFkZFRvSGlzdG9yeShkaWFsb2cpIHtcbiAgICAvLyDmo4Dmn6XmmK/lkKblt7Lnu4/lrZjlnKjnm7jlkIznmoTlr7nor53vvIjpgb/lhY3ph43lpI3mt7vliqDvvIlcbiAgICBjb25zdCBpc0R1cGxpY2F0ZSA9IHRoaXMuZGlhbG9nSGlzdG9yeS5zb21lKGl0ZW0gPT4gaXRlbS5uYW1lID09PSBkaWFsb2cubmFtZSAmJiBpdGVtLnRleHQgPT09IGRpYWxvZy50ZXh0KTtcblxuICAgIGlmICghaXNEdXBsaWNhdGUpIHtcbiAgICAgIHRoaXMuZGlhbG9nSGlzdG9yeS5wdXNoKHtcbiAgICAgICAgbmFtZTogZGlhbG9nLm5hbWUsXG4gICAgICAgIHRleHQ6IGRpYWxvZy50ZXh0LFxuICAgICAgICBiYWNrZ3JvdW5kOiBkaWFsb2cuYmFja2dyb3VuZCB8fCAnJyxcbiAgICAgIH0pO1xuXG4gICAgICAvLyDmm7TmlrDljoblj7LpnaLmnb/lhoXlrrlcbiAgICAgIHRoaXMudXBkYXRlSGlzdG9yeVBhbmVsKCk7XG4gICAgfVxuICB9XG5cbiAgLy8g5pu05paw5Y6G5Y+y6Z2i5p2/5YaF5a65XG4gIHVwZGF0ZUhpc3RvcnlQYW5lbCgpIHtcbiAgICAvLyDmuIXnqbrlvZPliY3lhoXlrrlcbiAgICB0aGlzLmhpc3RvcnlDb250ZW50LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8g5aaC5p6c5rKh5pyJ5Y6G5Y+y6K6w5b2V77yM5pi+56S65o+Q56S65L+h5oGvXG4gICAgaWYgKHRoaXMuZGlhbG9nSGlzdG9yeS5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IGVtcHR5TXNnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBlbXB0eU1zZy50ZXh0Q29udGVudCA9ICfmmoLml6Dlr7nor53ljoblj7InO1xuICAgICAgZW1wdHlNc2cuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICBlbXB0eU1zZy5zdHlsZS5jb2xvciA9ICcjN0Q1QjY1JztcbiAgICAgIGVtcHR5TXNnLnN0eWxlLnBhZGRpbmcgPSAnMjBweCc7XG4gICAgICB0aGlzLmhpc3RvcnlDb250ZW50LmFwcGVuZENoaWxkKGVtcHR5TXNnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDkuLrmr4/mnaHljoblj7LorrDlvZXliJvlu7rlhYPntKBcbiAgICB0aGlzLmRpYWxvZ0hpc3RvcnkuZm9yRWFjaCgoZGlhbG9nLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgaGlzdG9yeUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGhpc3RvcnlJdGVtLmNsYXNzTmFtZSA9ICdoaXN0b3J5LWl0ZW0nO1xuICAgICAgaGlzdG9yeUl0ZW0uc3R5bGUubWFyZ2luQm90dG9tID0gJzE1cHgnO1xuICAgICAgaGlzdG9yeUl0ZW0uc3R5bGUucGFkZGluZyA9ICcxNXB4JztcbiAgICAgIGhpc3RvcnlJdGVtLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcxMnB4JztcbiAgICAgIGhpc3RvcnlJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpJztcbiAgICAgIGhpc3RvcnlJdGVtLnN0eWxlLmJveFNoYWRvdyA9ICcwIDJweCA4cHggcmdiYSgwLDAsMCwwLjA1KSwgMCAwIDAgMXB4IHJnYmEoMjU1LDI1NSwyNTUsMC43KSBpbnNldCc7XG4gICAgICBoaXN0b3J5SXRlbS5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjJzIGVhc2UsIGJveC1zaGFkb3cgMC4ycyBlYXNlJztcblxuICAgICAgLy8g6byg5qCH5oKs5YGc5pWI5p6cXG4gICAgICBoaXN0b3J5SXRlbS5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtMnB4KSc7XG4gICAgICAgIHRoaXMuc3R5bGUuYm94U2hhZG93ID0gJzAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjA4KSwgMCAwIDAgMXB4IHJnYmEoMjU1LDI1NSwyNTUsMC44KSBpbnNldCc7XG4gICAgICB9O1xuXG4gICAgICBoaXN0b3J5SXRlbS5vbm1vdXNlb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJztcbiAgICAgICAgdGhpcy5zdHlsZS5ib3hTaGFkb3cgPSAnMCAycHggOHB4IHJnYmEoMCwwLDAsMC4wNSksIDAgMCAwIDFweCByZ2JhKDI1NSwyNTUsMjU1LDAuNykgaW5zZXQnO1xuICAgICAgfTtcblxuICAgICAgLy8g5aaC5p6c5pyJ6KeS6Imy5ZCN77yM5YiZ5pi+56S6XG4gICAgICBpZiAoZGlhbG9nLm5hbWUgJiYgZGlhbG9nLm5hbWUgIT09ICfml4Hnmb0nKSB7XG4gICAgICAgIGNvbnN0IG5hbWVFbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG5hbWVFbGVtLmNsYXNzTmFtZSA9ICdoaXN0b3J5LW5hbWUnO1xuICAgICAgICBuYW1lRWxlbS50ZXh0Q29udGVudCA9IGRpYWxvZy5uYW1lO1xuICAgICAgICBuYW1lRWxlbS5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuICAgICAgICBuYW1lRWxlbS5zdHlsZS5jb2xvciA9ICcjQzE4RTk4JztcbiAgICAgICAgbmFtZUVsZW0uc3R5bGUubWFyZ2luQm90dG9tID0gJzhweCc7XG4gICAgICAgIG5hbWVFbGVtLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgICAgbmFtZUVsZW0uc3R5bGUucGFkZGluZ0xlZnQgPSAnMTVweCc7XG5cbiAgICAgICAgLy8g5re75Yqg6KOF6aWw5YWD57SgXG4gICAgICAgIGNvbnN0IGRlY29yRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgZGVjb3JFbGVtLnRleHRDb250ZW50ID0gJ+KdgCc7XG4gICAgICAgIGRlY29yRWxlbS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGRlY29yRWxlbS5zdHlsZS5sZWZ0ID0gJzAnO1xuICAgICAgICBkZWNvckVsZW0uc3R5bGUudG9wID0gJzUwJSc7XG4gICAgICAgIGRlY29yRWxlbS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtNTAlKSc7XG4gICAgICAgIGRlY29yRWxlbS5zdHlsZS5jb2xvciA9ICcjRkZCMEMwJztcbiAgICAgICAgZGVjb3JFbGVtLnN0eWxlLmZvbnRTaXplID0gJzEycHgnO1xuXG4gICAgICAgIG5hbWVFbGVtLmFwcGVuZENoaWxkKGRlY29yRWxlbSk7XG4gICAgICAgIGhpc3RvcnlJdGVtLmFwcGVuZENoaWxkKG5hbWVFbGVtKTtcbiAgICAgIH0gZWxzZSBpZiAoZGlhbG9nLm5hbWUgPT09ICfml4Hnmb0nKSB7XG4gICAgICAgIC8vIOaXgeeZveagt+W8j+eJueauiuWkhOeQhlxuICAgICAgICBoaXN0b3J5SXRlbS5zdHlsZS5mb250U3R5bGUgPSAnaXRhbGljJztcbiAgICAgICAgaGlzdG9yeUl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKDI0NSwgMjM1LCAyMzUsIDAuNyknO1xuICAgICAgICBoaXN0b3J5SXRlbS5zdHlsZS5ib3JkZXJMZWZ0ID0gJzNweCBzb2xpZCAjRkZDQUQ1JztcbiAgICAgIH1cblxuICAgICAgLy8g5re75Yqg5a+56K+d5paH5pysXG4gICAgICBjb25zdCB0ZXh0RWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGV4dEVsZW0uY2xhc3NOYW1lID0gJ2hpc3RvcnktdGV4dCc7XG4gICAgICB0ZXh0RWxlbS50ZXh0Q29udGVudCA9IGRpYWxvZy50ZXh0O1xuICAgICAgdGV4dEVsZW0uc3R5bGUuY29sb3IgPSAnIzREMkIzNSc7XG4gICAgICB0ZXh0RWxlbS5zdHlsZS5saW5lSGVpZ2h0ID0gJzEuNSc7XG4gICAgICB0ZXh0RWxlbS5zdHlsZS5sZXR0ZXJTcGFjaW5nID0gJzAuM3B4JztcbiAgICAgIGhpc3RvcnlJdGVtLmFwcGVuZENoaWxkKHRleHRFbGVtKTtcblxuICAgICAgLy8g5re75Yqg5Yiw5Y6G5Y+y5YaF5a655Yy6XG4gICAgICB0aGlzLmhpc3RvcnlDb250ZW50LmFwcGVuZENoaWxkKGhpc3RvcnlJdGVtKTtcbiAgICB9KTtcblxuICAgIC8vIOa7muWKqOWIsOW6lemDqFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5oaXN0b3J5Q29udGVudC5zY3JvbGxUb3AgPSB0aGlzLmhpc3RvcnlDb250ZW50LnNjcm9sbEhlaWdodDtcbiAgICB9LCAxMDApO1xuICB9XG5cbiAgLy8g5pi+56S6L+makOiXj+WOhuWPsumdouadv1xuICB0b2dnbGVIaXN0b3J5UGFuZWwoc2hvdykge1xuICAgIGlmIChzaG93KSB7XG4gICAgICB0aGlzLnVwZGF0ZUhpc3RvcnlQYW5lbCgpO1xuICAgICAgdGhpcy5oaXN0b3J5UGFuZWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cbiAgICAgIC8vIOa3u+WKoOa3oeWFpeWKqOeUu+aViOaenFxuICAgICAgdGhpcy5oaXN0b3J5UGFuZWwuc3R5bGUub3BhY2l0eSA9ICcwJztcbiAgICAgIHRoaXMuaGlzdG9yeVBhbmVsLnN0eWxlLnRyYW5zaXRpb24gPSAnb3BhY2l0eSAwLjNzIGVhc2UnO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuaGlzdG9yeVBhbmVsLnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgICB9LCAxMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOa3oeWHuuWKqOeUu+aViOaenFxuICAgICAgdGhpcy5oaXN0b3J5UGFuZWwuc3R5bGUub3BhY2l0eSA9ICcwJztcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmhpc3RvcnlQYW5lbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfSwgMzAwKTtcbiAgICB9XG4gIH1cbn1cblxuLy8g5b2T6aG16Z2i5Yqg6L295a6M5oiQ5ZCO5Yid5aeL5YyW5ri45oiP5byV5pOOXG4kKCgpID0+IHtcbiAgY29uc3QgZW5naW5lID0gbmV3IEdhbGdhbWVFbmdpbmUoKTtcblxuICAvLyDlpITnkIZVSeaYvuekui/pmpDol4/lip/og71cbiAgZnVuY3Rpb24gaW5pdFRvZ2dsZVVJQnV0dG9uKCkge1xuICAgIGNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtdWktYnRuJyk7XG4gICAgaWYgKHRvZ2dsZUJ0bikge1xuICAgICAgdG9nZ2xlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8g6Ziy5q2i54K55Ye75LqL5Lu26Kem5Y+R5a+56K+d5o6o6L+bXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgndWktaGlkZGVuJyk7XG5cbiAgICAgICAgLy8g5pu05paw5oyJ6ZKu5paH5pysXG4gICAgICAgIGlmIChkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygndWktaGlkZGVuJykpIHtcbiAgICAgICAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSAn8J+SrCc7XG4gICAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ+aYvuekuueVjOmdoic7XG5cbiAgICAgICAgICAvLyDlnKhVSemakOiXj+aooeW8j+S4i+WPlua2iOinkuiJsueri+e7mOeahOmrmOS6ri/mt6HljJbmlYjmnpxcbiAgICAgICAgICBjb25zdCBjaGFyYWN0ZXJFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGFyYWN0ZXItc3ByaXRlJyk7XG4gICAgICAgICAgY2hhcmFjdGVyRWxlbWVudHMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2hhcmFjdGVyLXNwZWFraW5nJywgJ2NoYXJhY3Rlci1kaW1tZWQnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSAn8J+SrSc7XG4gICAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ+makOiXj+eVjOmdoic7XG5cbiAgICAgICAgICAvLyDmgaLlpI3lvZPliY3lr7nor53nmoTop5LoibLnirbmgIFcbiAgICAgICAgICBlbmdpbmUudXBkYXRlQ2hhcmFjdGVycyhlbmdpbmUuZGlhbG9nRGF0YVtlbmdpbmUuY3VycmVudEluZGV4XSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyDorr7nva7liJ3lp4vnirbmgIFcbiAgICAgIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9ICfwn5KtJztcbiAgICAgIHRvZ2dsZUJ0bi50aXRsZSA9ICfpmpDol4/nlYzpnaInO1xuICAgIH1cbiAgfVxuXG4gIC8vIOWIneWni+WMllVJ5YiH5o2i5oyJ6ZKuXG4gIGluaXRUb2dnbGVVSUJ1dHRvbigpO1xuXG4gIC8vIOWIneWni+WMluWOhuWPsuWvueivneaMiemSrlxuICBjb25zdCBoaXN0b3J5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hpc3RvcnktYnRuJyk7XG4gIGNvbnN0IGNsb3NlSGlzdG9yeUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZS1oaXN0b3J5Jyk7XG5cbiAgaWYgKGhpc3RvcnlCdG4gJiYgY2xvc2VIaXN0b3J5QnRuKSB7XG4gICAgLy8g5omT5byA5Y6G5Y+y6Z2i5p2/XG4gICAgaGlzdG9yeUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOyAvLyDpmLLmraLngrnlh7vkuovku7bop6blj5Hlr7nor53mjqjov5tcbiAgICAgIGVuZ2luZS50b2dnbGVIaXN0b3J5UGFuZWwodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICAvLyDlhbPpl63ljoblj7LpnaLmnb9cbiAgICBjbG9zZUhpc3RvcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8g6Ziy5q2i54K55Ye75LqL5Lu26Kem5Y+R5a+56K+d5o6o6L+bXG4gICAgICBlbmdpbmUudG9nZ2xlSGlzdG9yeVBhbmVsKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIC8vIOeCueWHu+WOhuWPsumdouadv+WGhemDqOS4jeinpuWPkeWvueivneaOqOi/m1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoaXN0b3J5LXBhbmVsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9KTtcblxuICAgIC8vIEVTQ+mUruWFs+mXreWOhuWPsumdouadv1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJyAmJiBlbmdpbmUuaGlzdG9yeVBhbmVsLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHtcbiAgICAgICAgZW5naW5lLnRvZ2dsZUhpc3RvcnlQYW5lbChmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyDliJ3lp4vljJbph43mlrDmkq3mlL7mjInpkq5cbiAgY29uc3QgcmVzdGFydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXJ0LWJ0bicpO1xuICBpZiAocmVzdGFydEJ0bikge1xuICAgIHJlc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8g6Ziy5q2i54K55Ye75LqL5Lu26Kem5Y+R5a+56K+d5o6o6L+bXG4gICAgICBlbmdpbmUucmVzdGFydERpYWxvZygpO1xuICAgIH0pO1xuXG4gICAgLy8g6K6+572u5oyJ6ZKu5qCH6aKYXG4gICAgcmVzdGFydEJ0bi50aXRsZSA9ICfph43mlrDlvIDlp4snO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/galgame/index.js\n\n}");
  },
  "./src/圣约与静默/galgame/index.scss"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL2dhbGdhbWUvaW5kZXguc2NzcyIsIm1hcHBpbmdzIjoiO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gvZ2FsZ2FtZS9pbmRleC5zY3NzP2IxZmUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307Il0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/圣约与静默/galgame/index.scss\n\n}");
  }
};

var __webpack_module_cache__ = {};

function __webpack_require__(moduleId) {
  var cachedModule = __webpack_module_cache__[moduleId];
  if (cachedModule !== undefined) {
    return cachedModule.exports;
  }
  if (__webpack_modules__[moduleId] === undefined) {
    var e = new Error("Cannot find module '" + moduleId + "'");
    e.code = "MODULE_NOT_FOUND";
    throw e;
  }
  var module = __webpack_module_cache__[moduleId] = {
    exports: {}
  };
  __webpack_modules__[moduleId](module, module.exports, __webpack_require__);
  return module.exports;
}

(() => {
  __webpack_require__.r = exports => {
    if (typeof Symbol !== "undefined" && Symbol.toStringTag) {
      Object.defineProperty(exports, Symbol.toStringTag, {
        value: "Module"
      });
    }
    Object.defineProperty(exports, "__esModule", {
      value: true
    });
  };
})();

var __webpack_exports__ = __webpack_require__("./src/圣约与静默/galgame/index.js");</script><style>/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** css ./node_modules/.pnpm/css-loader@7.1.2_webpack@5.104.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-487.use[1]!./node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.104.1/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@16.0.6_sass@1.97.2_webpack@5.104.1/node_modules/sass-loader/dist/cjs.js!./src/圣约与静默/galgame/index.scss ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
@charset "UTF-8";*{-webkit-tap-highlight-color:transparent;margin:0;padding:0;box-sizing:border-box;font-family:"Microsoft YaHei","Hiragino Sans GB",sans-serif;scrollbar-width:none !important;user-select:none !important;-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important}::-webkit-scrollbar{width:0 !important;display:none !important}body,html{width:100%;aspect-ratio:16/9;overflow:hidden;background-color:rgba(1,1,1,0);margin:0 !important;padding:0 !important;-ms-overflow-style:none !important;scrollbar-width:none !important}.main-container{width:100%;max-width:1200px;aspect-ratio:16/9;position:relative;margin:0 auto;background:linear-gradient(135deg,#fff0f3,#ffe5ea);border:1px solid white;border-radius:12px;box-shadow:0 0 20px rgba(145,125,138,0.15);overflow:hidden;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-height:95%;display:flex;flex-direction:column;box-sizing:border-box}.main-container::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;border:1px solid white;border-radius:12px;pointer-events:none;z-index:100;box-sizing:border-box}.inner-container{position:relative;width:97%;height:97%;margin:1.5% auto;background:white;border-radius:8px;box-shadow:0 5px 15px rgba(145,125,138,0.15);overflow:hidden;display:flex;flex-direction:column;flex:1;box-sizing:border-box}.title-bar{position:relative;height:5.5%;background:linear-gradient(to right,#ffd0d8,#ffbbc8);display:flex;align-items:center;justify-content:center;color:#7d6b6e;font-weight:bold;font-size:clamp(10px,1.5vw,16px);text-shadow:0px 1px 1px rgba(255,255,255,0.5);border-radius:8px 8px 0 0}.icon-left{position:absolute;left:15px;font-size:18px;color:#c18e98}.icon-right{position:absolute;right:15px;font-size:14px;color:#c18e98}.scene-area{position:relative;flex:1;overflow:hidden;background-color:#000;min-height:0}#cg-container{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;display:flex;align-items:center;justify-content:center}.background-image{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;transition:opacity 1.2s cubic-bezier(0.4,0,0.2,1);z-index:2;background-color:#000}#background-image-current{opacity:1;z-index:3}#background-image-next{opacity:0;z-index:4}#character-container{position:absolute;width:100%;height:100%;z-index:2;pointer-events:none;overflow:hidden}.character-sprite{position:absolute;bottom:0;height:95%;max-height:95%;width:auto;object-fit:contain;transition:opacity 0.8s ease,transform 0.5s ease,filter 0.5s ease,left 0.8s ease,right 0.8s ease;filter:drop-shadow(0 0 5px rgba(0,0,0,0.2));transform-origin:bottom center}.character-left{left:30%;transform:translateX(-50%)}.character-right{right:30%;transform:translateX(50%)}.character-center{position:absolute;left:50%;transform:translateX(-50%);bottom:0;height:98%;max-height:98%;width:auto;object-fit:contain}.character-enter{transform:scale(0.95);filter:blur(2px)}.character-exit{transform:scale(0.9);filter:blur(3px);transition:transform 0.5s ease,filter 0.5s ease}.character-active{opacity:1;transform:scale(1)}.character-speaking{filter:drop-shadow(0 0 8px rgba(0,0,0,0.3));transform:scale(1.05);z-index:3}.character-dimmed{filter:brightness(0.85) contrast(0.95)}#dialog-box{position:absolute;bottom:4%;left:50%;transform:translateX(-50%);width:50%;max-width:600px;background:linear-gradient(135deg,rgba(255,235,240,0.8),rgba(255,202,215,0.8));backdrop-filter:blur(8px);border-radius:10px;padding:clamp(6px,1.5%,12px) clamp(10px,2%,20px);color:#7d5b65;z-index:10;box-shadow:0 4px 12px rgba(145,125,138,0.15),0 0 0 1px rgba(255,255,255,0.4) inset;border:1px solid rgba(255,255,255,0.7);transition:transform 0.3s ease,opacity 0.3s ease}#dialog-box:hover{transform:translateX(-50%) translateY(-2px);box-shadow:0 6px 15px rgba(145,125,138,0.2),0 0 0 1px rgba(255,255,255,0.5) inset}#character-name{font-size:16px;font-weight:bold;color:#c18e98;margin-bottom:4px;text-shadow:0 0 5px rgba(255,255,255,0.7);position:relative;display:inline-block;padding-right:16px}#character-name:after{content:"❀";position:absolute;right:0;top:50%;transform:translateY(-50%);font-size:14px;color:#ffb0c0}#dialog-text{font-size:14px;line-height:1.4;min-height:50px;margin-bottom:8px;color:#4d2b35;text-shadow:0 1px 1px rgba(255,255,255,0.9);letter-spacing:0.2px;position:relative;padding:0 2px}#dialog-text:before,#dialog-text:after{content:"";position:absolute;height:80%;width:1px;background:linear-gradient(to bottom,rgba(255,180,190,0),rgba(255,180,190,0.5),rgba(255,180,190,0));top:10%}#dialog-text:before{left:0}#dialog-text:after{right:0}#next-hint{text-align:right;font-size:12px;color:rgba(193,142,152,0.8);animation:pulse 1.5s infinite;position:relative;padding-right:16px}#next-hint:after{content:"✿";position:absolute;right:0;top:50%;transform:translateY(-50%) rotate(5deg);font-size:14px;animation:float 2s ease-in-out infinite}@keyframes pulse{0%{opacity:0.4}50%{opacity:1}100%{opacity:0.4}}@keyframes float{0%,100%{transform:translateY(-50%) rotate(5deg)}50%{transform:translateY(-65%) rotate(10deg)}}.bottom-area{position:absolute;bottom:15px;right:15px;display:flex;align-items:center;z-index:900}.sweet-memories{display:flex;align-items:center}.history-button{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#ffb5c5,#ffd6e0);border:none;padding:10px;border-radius:50%;color:#7d5b65;font-size:16px;cursor:pointer;margin-right:10px;width:40px;height:40px;transition:transform 0.3s ease,opacity 0.3s ease,background 0.3s ease;box-shadow:0 2px 5px rgba(0,0,0,0.1)}.history-button:hover{transform:scale(1.1);opacity:0.9;background:linear-gradient(135deg,#ffd6e0,#ffb5c5)}.restart-button{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#ffb5c5,#ffd6e0);border:none;padding:10px;border-radius:50%;color:#7d5b65;font-size:16px;cursor:pointer;margin-right:10px;width:40px;height:40px;transition:transform 0.3s ease,opacity 0.3s ease,background 0.3s ease;box-shadow:0 2px 5px rgba(0,0,0,0.1);line-height:1;text-align:center;padding:0}.restart-button:hover{transform:scale(1.1);opacity:0.9;background:linear-gradient(135deg,#ffd6e0,#ffb5c5)}#toggle-ui-btn{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#ffb5c5,#ffd6e0);border:none;padding:10px;border-radius:50%;color:#7d5b65;font-size:16px;cursor:pointer;width:40px;height:40px;transition:transform 0.3s ease,opacity 0.3s ease,background 0.3s ease;box-shadow:0 2px 5px rgba(0,0,0,0.1)}#toggle-ui-btn:hover{transform:scale(1.1);opacity:0.9;background:linear-gradient(135deg,#ffd6e0,#ffb5c5)}body.ui-hidden #dialog-box{display:none !important}body.ui-hidden #toggle-ui-btn{background:linear-gradient(135deg,#ffadc0,#ff8da0) !important}body.ui-hidden .restart-button{opacity:1;visibility:visible}body.ui-hidden #character-container{z-index:3}body.ui-hidden .character-dimmed{filter:none !important}.decoration-sticker{position:absolute;width:50px;height:50px;background-size:contain;background-repeat:no-repeat;z-index:15;opacity:0.8;pointer-events:none}.sticker-1{top:15px;right:15px;transform:rotate(10deg);font-size:24px;color:#ffb0c0;display:flex;align-items:center;justify-content:center}.sticker-2{bottom:80px;left:15px;transform:rotate(-5deg);font-size:24px;color:#ffb0c0;display:flex;align-items:center;justify-content:center}body.transitioning .character-sprite{transition:opacity 1s ease,transform 1s ease,filter 1s ease,left 1s ease,right 1s ease}body.transitioning #next-hint{opacity:0;transition:opacity 0.6s ease}body.transitioning #dialog-box{opacity:0.7;transition:opacity 1.2s ease,transform 1.2s ease}body.transitioning .decoration-sticker{opacity:0.5;transition:opacity 1.2s ease}.narrator-mode #character-container,.protagonist-mode #character-container{opacity:0;pointer-events:none}.narrator-mode #dialog-box{background:linear-gradient(135deg,rgba(255,235,254,0.895),rgba(250,222,255,0.9))}.protagonist-mode #dialog-box{background:linear-gradient(135deg,rgba(245,225,235,0.9),rgba(235,215,230,0.9))}.narrator-mode #character-name{opacity:0;height:0;margin:0;overflow:hidden}@media (max-width:768px){body,html{aspect-ratio:3/4}#dialog-box{position:absolute;left:50%;bottom:-100%;width:100%;max-width:none;z-index:25;transition:none}#dialog-box:hover{box-shadow:0 4px 12px rgba(145,125,138,0.15),0 0 0 1px rgba(255,255,255,0.4) inset}body.transitioning #dialog-box{opacity:1;transition:none;transform:translateX(-50%)}.main-container{top:25%;overflow:visible}.inner-container{overflow:visible}.scene-area{overflow:visible}.title-bar{height:20px}.bottom-area{z-index:15;bottom:10px;right:10px}.decoration-sticker{display:none}#toggle-ui-btn{display:none !important}.history-button,#toggle-ui-btn{width:35px;height:35px;font-size:14px}#history-panel{width:96%;height:240% !important;max-height:300% !important;top:120% !important;border-radius:12px}#history-header{padding:12px 15px;font-size:16px;border-radius:12px 12px 0 0}#close-history{font-size:22px}#history-content::-webkit-scrollbar{width:6px !important}#history-content::-webkit-scrollbar-thumb{border:none}.history-item{padding:12px !important;margin-bottom:12px !important;border-radius:10px}.history-name{font-size:14px !important;margin-bottom:6px !important;padding-left:16px}.history-name::before{font-size:12px}.history-text{font-size:13px !important;line-height:1.5}}#history-panel{position:fixed;top:25%;left:5%;width:90%;height:90%;max-height:90%;background:linear-gradient(135deg,rgba(255,240,245,0.95),rgba(255,225,235,0.95));backdrop-filter:blur(10px);border-radius:15px;box-shadow:0 8px 30px rgba(145,125,138,0.25),0 0 0 1px rgba(255,255,255,0.6) inset;border:1px solid rgba(255,255,255,0.8);z-index:1000;display:none;flex-direction:column;box-sizing:border-box;transform:none;margin:0;overflow:hidden}#history-header{flex-shrink:0;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:linear-gradient(to right,rgba(255,208,216,0.8),rgba(255,187,200,0.8));border-bottom:1px solid rgba(255,255,255,0.5);border-radius:15px 15px 0 0;color:#7d5b65;font-weight:bold;font-size:clamp(14px,1.8vw,18px);text-shadow:0 1px 1px rgba(255,255,255,0.6)}#close-history{background:none;border:none;font-size:24px;color:#c18e98;cursor:pointer;padding:5px;line-height:1;transition:color 0.2s ease,transform 0.2s ease}#close-history:hover{color:#a16e78;transform:scale(1.1)}#history-content{flex-grow:1;overflow-y:auto;padding:20px;color:#4d2b35;scrollbar-width:thin;scrollbar-color:#ffb0c0 #fff0f3}#history-content::-webkit-scrollbar{width:8px !important;display:block !important}#history-content::-webkit-scrollbar-track{background:rgba(255,240,243,0.5);border-radius:4px}#history-content::-webkit-scrollbar-thumb{background-color:rgba(255,176,192,0.8);border-radius:4px;border:1px solid rgba(255,255,255,0.3)}#history-content::-webkit-scrollbar-thumb:hover{background-color:rgb(255,160,180)}.history-item{margin-bottom:15px;padding:15px;border-radius:12px;background:rgba(255,255,255,0.6);box-shadow:0 2px 8px rgba(0,0,0,0.05),0 0 0 1px rgba(255,255,255,0.7) inset;transition:transform 0.2s ease,box-shadow 0.2s ease}.history-item:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.08),0 0 0 1px rgba(255,255,255,0.8) inset}.history-name{font-weight:bold;color:#c18e98;margin-bottom:8px;position:relative;padding-left:18px;font-size:15px}.history-name::before{content:"❀";position:absolute;left:0;top:50%;transform:translateY(-50%);color:#ffb0c0;font-size:13px}.history-text{line-height:1.6;letter-spacing:0.3px;font-size:14px;color:#4d2b35}.history-item.narrator{font-style:italic;background:rgba(245,235,235,0.8);border-left:3px solid #ffcad5}
</style></head>
  <body>
    <div class="container-fluid">
      <!-- Navigation Bar -->
      <ul class="nav-tabs" id="mainNav">
        <li class="nav-item">
          <a class="nav-link active" data-page="story"><i class="fas fa-book-open"></i> 正文</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-page="function"><i class="fas fa-scroll"></i> 功能</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-page="summary"><i class="fas fa-list-alt"></i> 总结</a>
        </li>
      </ul>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Story Page -->
        <div id="storyPage" class="page active">
          <div class="game-container">
            <!-- Top Info Bar -->
            <div class="info-bar">
              <div class="info-details">
                <span id="story-date"><i class="far fa-calendar-alt"></i> Loading...</span>
                <span class="ms-3" id="story-location"><i class="fas fa-map-marker-alt"></i> Loading...</span>
                <span class="ms-3" id="story-chapter"><i class="fas fa-book"></i> Loading...</span>
                <span class="ms-3" id="story-resource"><i class="fas fa-coins"></i> Loading...</span>
                <!-- Changed from funds -->
              </div>
              <div class="info-actions">
                <button id="btn-show-locations" class="btn btn-sm btn-outline-light" title="前往...">
                  <i class="fas fa-route"></i> 前往
                </button>
                <button id="btn-show-history" class="btn btn-sm btn-outline-light ms-2" title="故事进展">
                  <i class="fas fa-history"></i> 进展
                </button>
              </div>
            </div>

            <!-- Visual Novel Area -->
            <div class="vn-container">
              <div id="scene-container" class="scene-container">
                <div id="effect-overlay" class="effect-overlay"></div>
                <!-- Character sprites will be added here by JS -->
              </div>
              <div class="text-box-container">
                <div id="name-box" class="name-box" style="display: none"></div>
                <div id="text-box" class="text-box">
                  <div id="story-content">Loading story...</div>
                </div>
                <div class="text-controls">
                  <button id="btn-auto" class="text-btn">自动</button>
                  <button id="btn-reset" class="text-btn">重看</button>
                  <!-- Add Save/Load buttons if needed -->
                  <button id="btn-load-save" class="text-btn">读档</button>
                  <button id="btn-delete-records" class="text-btn btn-danger" title="删除所有游戏数据">
                    <i class="fas fa-trash-alt"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Interaction Options -->
            <div class="interaction-options">
              <div class="options-header">
                <h4>你的选择是？</h4>
              </div>
              <div class="options-list" id="story-options">
                <!-- Options will be loaded here -->
                <p class="placeholder-text">Loading options...</p>
              </div>
              <div class="custom-option-input" id="customOptionContainer" style="display: none">
                <label for="customOptionInput" class="form-label small">其他行动/想法：</label>
                <div class="input-group">
                  <input
                    type="text"
                    class="form-control"
                    id="customOptionInput"
                    placeholder="例如：仔细观察周围的环境..."
                  />
                  <button class="btn btn-primary" type="button" id="submitCustomOptionBtn">确定</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Function Page (Codex/People) -->
        <div id="functionPage" class="page">
          <div class="function-container">
            <div class="people-column">
              <h3>人物</h3>
              <ul id="peopleList">
                <!-- People list items will be added here -->
                <li class="placeholder-item">Loading characters...</li>
              </ul>
            </div>
            <div class="knowledge-column">
              <div id="knowledgeDisplay">
                <h3 id="knowledgeTitle">知识库</h3>
                <div id="knowledgeContent">
                  <p class="placeholder-text">选择人物或等待发现知识条目。</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Summary Page -->
        <div id="summaryPage" class="page">
          <div class="summary-container">
            <h2>故事总结回顾</h2>
            <div id="storySummaryList" class="summary-stack">
              <!-- Summary cards will be added here -->
              <p class="placeholder-text">Loading summary...</p>
            </div>
          </div>
        </div>
      </div>
      <!-- End Content Area -->
    </div>
    <!-- End Container Fluid -->

    <!-- Location Selection Modal -->
    <div id="locationModal" class="modal" style="display: none">
      <div class="modal-dialog">
        <!-- Changed from modal to modal-dialog for potential Bootstrap compat -->
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">选择目的地</h5>
            <button type="button" class="btn-close close-modal-btn" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>选择你接下来想去的地方：</p>
            <ul id="locationList" class="list-group mb-3">
              <!-- Location list items (buttons or links) will be added by JS -->
              <!-- Use button elements within li or directly style buttons -->
              <li class="placeholder-item">Loading locations...</li>
              <!-- Example structure for JS population:
                         <li><button class="list-group-item" data-location="Chapel">Chapel (礼拜堂)</button></li>
                         <li><button class="list-group-item" data-location="Library">Library (图书馆)</button></li>
                         -->
            </ul>
            <div class="mb-3">
              <label for="locationCustomActionInput" class="form-label">附加行动/意图（可选）：</label>
              <input
                type="text"
                id="locationCustomActionInput"
                class="form-control"
                placeholder="例如：去图书馆查找古籍..."
              />
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary close-modal-btn">取消</button>
            <button type="button" class="btn btn-primary" id="btn-confirm-location">确认前往</button>
          </div>
        </div>
      </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal" style="display: none">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">故事进展</h5>
            <button type="button" class="btn-close close-modal-btn" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="historyContent" style="max-height: 400px; overflow-y: auto">
              <!-- History content will be populated by JS -->
              <p class="placeholder-text">Loading history...</p>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary close-modal-btn">关闭</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add JS Link Placeholder Here -->
    <script src="35f28f8356f7e42c4f64.js"></script>
  </body>
</html>
