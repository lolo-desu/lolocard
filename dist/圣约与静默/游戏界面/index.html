<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#2a2a2a" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>修道院箱庭 - 百合恋爱文字冒险</title>

    <!-- 引入字体 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Lato:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap"
      rel="stylesheet"
    />

    <!-- 引入Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" />

    <!-- 引入外部库 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
  <script type="module">var __webpack_modules__ = {
  "./src/圣约与静默/游戏界面/game.controller.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameController: () => (/* binding */ GameController)\n/* harmony export */ });\n/* harmony import */ var _scripts_components_backgroundManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scripts/components/backgroundManager */ \"./src/圣约与静默/游戏界面/scripts/components/backgroundManager.ts\");\n/* harmony import */ var _scripts_components_characterManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./scripts/components/characterManager */ \"./src/圣约与静默/游戏界面/scripts/components/characterManager.ts\");\n/* harmony import */ var _scripts_components_choiceManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scripts/components/choiceManager */ \"./src/圣约与静默/游戏界面/scripts/components/choiceManager.ts\");\n/* harmony import */ var _scripts_components_dialogueManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scripts/components/dialogueManager */ \"./src/圣约与静默/游戏界面/scripts/components/dialogueManager.ts\");\n/* harmony import */ var _scripts_components_journalManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scripts/components/journalManager */ \"./src/圣约与静默/游戏界面/scripts/components/journalManager.ts\");\n/* harmony import */ var _scripts_components_memoryManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./scripts/components/memoryManager */ \"./src/圣约与静默/游戏界面/scripts/components/memoryManager.ts\");\n/* harmony import */ var _scripts_components_memoryUIManager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./scripts/components/memoryUIManager */ \"./src/圣约与静默/游戏界面/scripts/components/memoryUIManager.ts\");\n/* harmony import */ var _scripts_components_saveManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scripts/components/saveManager */ \"./src/圣约与静默/游戏界面/scripts/components/saveManager.ts\");\n/* harmony import */ var _scripts_components_settingsManager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./scripts/components/settingsManager */ \"./src/圣约与静默/游戏界面/scripts/components/settingsManager.ts\");\n/* harmony import */ var _scripts_components_uiManager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./scripts/components/uiManager */ \"./src/圣约与静默/游戏界面/scripts/components/uiManager.ts\");\n/* harmony import */ var _services_character_resource_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./services/character-resource.service */ \"./src/圣约与静默/游戏界面/services/character-resource.service.ts\");\n/* harmony import */ var _services_game_data_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./services/game-data.service */ \"./src/圣约与静默/游戏界面/services/game-data.service.ts\");\n/* harmony import */ var _services_game_state_generation_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./services/game-state-generation.service */ \"./src/圣约与静默/游戏界面/services/game-state-generation.service.ts\");\n/**\n * 游戏控制器\n * 负责协调各个服务和组件，管理游戏的整体流程\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass GameController {\n    // 游戏状态数据\n    gameData = null;\n    // 服务\n    gameDataService;\n    gameStateGenerationService;\n    characterResourceService;\n    // 组件管理器\n    dialogueManager;\n    characterManager;\n    backgroundManager;\n    choiceManager;\n    memoryManager;\n    memoryUIManager;\n    uiManager;\n    saveManager;\n    journalManager;\n    settingsManager;\n    constructor() {\n        // 初始化服务\n        this.gameDataService = new _services_game_data_service__WEBPACK_IMPORTED_MODULE_11__.GameDataService();\n        this.gameStateGenerationService = new _services_game_state_generation_service__WEBPACK_IMPORTED_MODULE_12__.GameStateGenerationService();\n        this.characterResourceService = new _services_character_resource_service__WEBPACK_IMPORTED_MODULE_10__.CharacterResourceService();\n        // 初始化各个管理器\n        this.uiManager = new _scripts_components_uiManager__WEBPACK_IMPORTED_MODULE_9__.UIManager();\n        this.saveManager = new _scripts_components_saveManager__WEBPACK_IMPORTED_MODULE_7__.SaveManager(this.uiManager);\n        this.backgroundManager = new _scripts_components_backgroundManager__WEBPACK_IMPORTED_MODULE_0__.BackgroundManager();\n        this.characterManager = new _scripts_components_characterManager__WEBPACK_IMPORTED_MODULE_1__.CharacterManager(this.characterResourceService);\n        this.dialogueManager = new _scripts_components_dialogueManager__WEBPACK_IMPORTED_MODULE_3__.DialogueManager(this.characterResourceService, this.characterManager, this.backgroundManager);\n        this.choiceManager = new _scripts_components_choiceManager__WEBPACK_IMPORTED_MODULE_2__.ChoiceManager();\n        this.memoryManager = new _scripts_components_memoryManager__WEBPACK_IMPORTED_MODULE_5__.MemoryManager();\n        // 初始化新分离的管理器\n        this.journalManager = new _scripts_components_journalManager__WEBPACK_IMPORTED_MODULE_4__.JournalManager();\n        this.memoryUIManager = new _scripts_components_memoryUIManager__WEBPACK_IMPORTED_MODULE_6__.MemoryUIManager(this.memoryManager, this.saveManager, this.uiManager, this.gameStateGenerationService);\n        // 初始化设置管理器\n        this.settingsManager = new _scripts_components_settingsManager__WEBPACK_IMPORTED_MODULE_8__.SettingsManager();\n        // 初始化调试辅助功能\n        this.gameStateGenerationService.initDebugHelpers();\n        console.log('调试辅助功能已初始化，请在控制台使用 window.debugLLMResponse() 查看最近一次LLM响应');\n        // 初始化游戏\n        this.init();\n    }\n    /**\n     * 初始化游戏\n     */\n    async init() {\n        console.log('初始化游戏界面...');\n        // 注册事件监听器\n        this.registerEventListeners();\n        // 尝试获取游戏数据\n        await this.loadGameData();\n        // 更新UI\n        this.updateUI();\n        // 添加调试功能\n        this.initDebugFunctions();\n        console.log('游戏界面初始化完成!');\n    }\n    /**\n     * 初始化调试功能\n     */\n    initDebugFunctions() {\n        // 添加调试确认对话框的全局函数\n        window.testConfirmDialog = () => {\n            console.log('测试确认对话框');\n            // 创建一个计数变量\n            if (!window.confirmTestCount) {\n                window.confirmTestCount = 0;\n            }\n            // 增加计数\n            window.confirmTestCount++;\n            // 显示带计数的确认对话框\n            this.uiManager.showConfirmDialog(`这是一个测试确认对话框 #${window.confirmTestCount}，用于检查位置和点击功能。请点击\"确认\"按钮测试是否可点击。`, () => {\n                console.log('确认对话框被确认');\n                this.uiManager.showNotification(`确认对话框 #${window.confirmTestCount} 测试成功!`, 'success');\n            });\n        };\n        console.log('调试功能已初始化，可在控制台使用 window.testConfirmDialog() 测试确认对话框');\n    }\n    /**\n     * 注册事件监听器\n     */\n    registerEventListeners() {\n        // 标签切换按钮\n        $('.tab-button').on('click', e => {\n            const tabId = $(e.currentTarget).data('tab');\n            if (tabId) {\n                this.switchTab(tabId);\n            }\n        });\n        // 日记标签内的导航按钮\n        $('.journal-nav-item').on('click', e => {\n            const sectionId = $(e.currentTarget).data('section');\n            if (sectionId) {\n                this.journalManager.switchJournalSection(sectionId);\n            }\n        });\n        // 保存游戏按钮 - 使用右上角的按钮\n        $('#save-game').on('click', () => {\n            this.saveGame();\n        });\n        // 加载游戏按钮 - 使用右上角的按钮\n        $('#load-game').on('click', () => {\n            this.loadGame();\n        });\n        // 设置按钮\n        $('#settings-button').on('click', () => {\n            this.showSettings();\n        });\n        // 保存记忆按钮\n        $('#save-memory').on('click', () => {\n            const newMemory = this.memoryUIManager.saveMemory();\n            if (newMemory && this.gameData) {\n                // 更新游戏数据\n                this.gameData.storySummary.push(newMemory);\n            }\n        });\n        // 穿越记忆按钮\n        $('#travel-memory').on('click', () => {\n            this.memoryUIManager.travelToMemory(() => {\n                // 成功穿越后的回调\n                this.gameData = this.memoryUIManager.getGameData();\n                this.updateUI();\n                this.switchTab('story-tab');\n            });\n        });\n        // 历史记录按钮\n        $('#dialogue-history').on('click', () => {\n            this.showDialogueHistory();\n        });\n        // 选择按钮\n        $(document).on('click', '.choice-button', e => {\n            const choice = $(e.currentTarget).data('choice');\n            this.makeChoice(choice);\n        });\n        // 获取游戏数据事件\n        window.addEventListener('request_game_data', event => {\n            if (event.detail && typeof event.detail.callback === 'function') {\n                // 确保返回的游戏数据包含所有必要属性\n                const currentGameData = {\n                    story: this.gameData?.story || {\n                        date: '未知日期',\n                        location: '未知位置',\n                        scene: '未知场景',\n                        dialogue: [],\n                        options: [],\n                        currentDialogueIndex: 0,\n                        currentChapter: '第1章',\n                        currentFunds: 0,\n                    },\n                    storySummary: this.gameData?.storySummary || [],\n                };\n                // 返回当前游戏数据的副本\n                event.detail.callback(currentGameData);\n            }\n        });\n        // 游戏加载完成事件\n        window.addEventListener('gameloaded', event => {\n            if (event.detail && event.detail.gameData) {\n                // 更新游戏数据\n                this.gameData = event.detail.gameData;\n                // 重新渲染游戏状态\n                this.updateUI();\n                this.switchTab('story-tab');\n                // 显示成功加载的通知\n                this.uiManager.showNotification('游戏已加载', 'success');\n            }\n        });\n        // 对话框点击事件 - 点击对话框进入下一步或重新显示选项\n        $('#dialogue-container').on('click', e => {\n            // 防止点击对话控制按钮时触发下一步\n            if (!$(e.target).closest('.dialogue-controls').length) {\n                // 检查是否可以重新显示选项\n                if (this.choiceManager.canReshowChoices()) {\n                    this.choiceManager.reshowChoices();\n                }\n                else {\n                    this.nextDialogue();\n                }\n            }\n        });\n        // 选项选择回调\n        this.choiceManager.setOnChoiceSelected(choice => {\n            this.makeChoice(choice);\n        });\n    }\n    /**\n     * 加载游戏数据\n     */\n    async loadGameData() {\n        try {\n            this.gameData = await this.gameDataService.loadGameData();\n            // 更新各管理器的游戏数据\n            this.journalManager.setGameData(this.gameData);\n            this.memoryUIManager.setGameData(this.gameData);\n        }\n        catch (error) {\n            console.error('加载游戏数据失败:', error);\n        }\n    }\n    /**\n     * 切换标签页\n     */\n    switchTab(tabId) {\n        // 移除所有标签按钮的激活状态\n        $('.tab-button').removeClass('active');\n        // 移除所有标签内容的激活状态\n        $('.tab-pane').removeClass('active');\n        // 激活选中的标签按钮和内容\n        $(`[data-tab=\"${tabId}\"]`).addClass('active');\n        $(`#${tabId}`).addClass('active');\n        // 如果是记忆标签，刷新记忆时间轴\n        if (tabId === 'memory-tab') {\n            this.memoryUIManager.refreshMemoryTimeline();\n        }\n        // 如果是日记标签，刷新角色信息\n        if (tabId === 'journal-tab') {\n            this.journalManager.refreshJournalContent();\n        }\n    }\n    /**\n     * 显示对话历史记录\n     */\n    async showDialogueHistory() {\n        // 尝试从世界书获取对话历史\n        const dialogueHistory = await this.saveManager.getDialogueHistory();\n        if (dialogueHistory) {\n            this.dialogueManager.showDialogueHistory(dialogueHistory);\n        }\n    }\n    /**\n     * 显示设置\n     */\n    showSettings() {\n        console.log('显示设置');\n        this.settingsManager.showSettingsDialog();\n    }\n    /**\n     * 保存游戏\n     */\n    saveGame() {\n        console.log('保存游戏...');\n        // 显示确认对话框\n        this.uiManager.showInputDialog('请输入典籍标题', '当前进度记录', async (saveName) => {\n            try {\n                this.uiManager.showLoading('正在记录典籍...');\n                // 调用存档管理器保存游戏\n                const success = await this.saveManager.saveGameState(this.gameData, true, saveName);\n                if (success) {\n                    this.uiManager.showNotification('典籍记录成功', 'success');\n                }\n            }\n            catch (error) {\n                console.error('保存游戏失败:', error);\n                this.uiManager.showNotification('典籍记录失败', 'error');\n            }\n            finally {\n                this.uiManager.hideLoading();\n            }\n        });\n    }\n    /**\n     * 加载游戏\n     */\n    loadGame() {\n        console.log('加载游戏...');\n        // 显示存档列表\n        this.saveManager.loadGame();\n    }\n    /**\n     * 更新UI\n     */\n    updateUI() {\n        if (!this.gameData) {\n            console.error('无法更新UI：游戏数据不存在');\n            return;\n        }\n        try {\n            // 更新顶部日期\n            $('#game-date').text(this.gameData.story.date);\n            // 设置对话\n            this.dialogueManager.setDialogues(this.gameData.story.dialogue);\n            this.dialogueManager.renderDialogue(this.gameData.story.currentDialogueIndex);\n            // 设置背景\n            this.backgroundManager.setBackground(this.gameData.story.location, this.gameData.story.scene);\n            // 设置选项\n            this.choiceManager.setChoices(this.gameData.story.options);\n            // 更新内存UI（如果记忆标签是活跃的）\n            if ($('#memory-tab').hasClass('active')) {\n                this.memoryUIManager.refreshMemoryTimeline();\n            }\n            // 更新日记（如果日记标签是活跃的）\n            if ($('#journal-tab').hasClass('active')) {\n                this.journalManager.refreshJournalContent();\n            }\n            console.log('UI已更新');\n        }\n        catch (error) {\n            console.error('更新UI时发生错误:', error);\n        }\n    }\n    /**\n     * 显示下一条对话\n     */\n    nextDialogue() {\n        if (!this.gameData)\n            return;\n        // 尝试显示下一条对话\n        const hasMoreDialogue = this.dialogueManager.showNextDialogue();\n        if (hasMoreDialogue) {\n            // 更新游戏数据中的当前对话索引\n            this.gameData.story.currentDialogueIndex = this.dialogueManager.getCurrentDialogueIndex();\n        }\n        else if (this.gameData.story.options.length > 0) {\n            // 新增：检查是否是最后一条对话，且已经显示了选项\n            const isDialogueFinished = this.dialogueManager.isDialogueFinished();\n            const isChoicesAlreadyShown = this.choiceManager.areChoicesVisible();\n            // 只有在对话已结束且选项还没显示的情况下才显示选项\n            if (isDialogueFinished && !isChoicesAlreadyShown) {\n                console.log('对话已结束，显示选项');\n                this.choiceManager.showChoices();\n            }\n            else if (isChoicesAlreadyShown) {\n                console.log('选项已显示，不再重复显示');\n            }\n        }\n        else {\n            // 没有更多对话也没有选项，可以添加额外逻辑\n            console.log('对话结束，且没有可用选项');\n        }\n    }\n    /**\n     * 选择选项\n     */\n    async makeChoice(choice) {\n        if (!this.gameData)\n            return;\n        console.log(`玩家选择了: ${choice}`);\n        // 判断是否为自定义行动（不在预定义选项列表中）\n        const isCustomAction = !this.gameData.story.options.includes(choice);\n        // 隐藏选项\n        this.choiceManager.hideChoices();\n        // 显示加载提示\n        this.uiManager.showLoading('正在生成回应...');\n        // 保存玩家选择前的状态，以便出错时恢复\n        const previousDialogueLength = this.gameData.story.dialogue.length;\n        const previousDialogueIndex = this.gameData.story.currentDialogueIndex;\n        // 添加玩家选择到对话\n        const playerChoice = {\n            speaker: '玩家',\n            content: choice,\n            style: 'normal',\n            // 不设置portrait，使用默认规则\n        };\n        this.gameData.story.dialogue.push(playerChoice);\n        this.dialogueManager.setDialogues(this.gameData.story.dialogue);\n        this.gameData.story.currentDialogueIndex = this.gameData.story.dialogue.length - 1;\n        this.dialogueManager.showDialogue(this.gameData.story.currentDialogueIndex);\n        try {\n            // 根据是否是自定义行动调用不同的处理方法\n            const newGameState = isCustomAction\n                ? await this.gameStateGenerationService.handleCustomAction(choice)\n                : await this.gameStateGenerationService.generateNextGameState(choice);\n            if (newGameState) {\n                // 更新游戏状态\n                this.gameData = newGameState;\n                // 更新UI\n                this.updateUI();\n                // 保存到世界书\n                await this.saveManager.saveGameState(this.gameData);\n            }\n            else {\n                // 生成失败，恢复到玩家选择前的状态\n                if (this.gameData) {\n                    // 移除玩家选择\n                    this.gameData.story.dialogue = this.gameData.story.dialogue.slice(0, previousDialogueLength);\n                    this.gameData.story.currentDialogueIndex = previousDialogueIndex;\n                    // 更新对话显示\n                    this.dialogueManager.setDialogues(this.gameData.story.dialogue);\n                    this.dialogueManager.showDialogue(this.gameData.story.currentDialogueIndex);\n                    // 重新显示选项\n                    this.choiceManager.showChoices();\n                    this.uiManager.showNotification('生成游戏状态失败，请重新选择', 'warning');\n                }\n            }\n        }\n        catch (error) {\n            console.error('处理玩家选择时出错:', error);\n            // 出错时恢复到玩家选择前的状态\n            if (this.gameData) {\n                // 移除玩家选择\n                this.gameData.story.dialogue = this.gameData.story.dialogue.slice(0, previousDialogueLength);\n                this.gameData.story.currentDialogueIndex = previousDialogueIndex;\n                // 更新对话显示\n                this.dialogueManager.setDialogues(this.gameData.story.dialogue);\n                this.dialogueManager.showDialogue(this.gameData.story.currentDialogueIndex);\n                // 重新显示选项\n                this.choiceManager.showChoices();\n                this.uiManager.showNotification('生成响应时出错，请重新选择', 'error');\n            }\n        }\n        finally {\n            // 隐藏加载提示\n            this.uiManager.hideLoading();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9nYW1lLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7O0dBR0c7QUFDd0U7QUFDRjtBQUNOO0FBQ0k7QUFDRjtBQUNGO0FBQ0k7QUFDUjtBQUNRO0FBQ1o7QUFFc0I7QUFDbEI7QUFDdUI7QUFFL0UsTUFBTSxjQUFjO0lBQ3pCLFNBQVM7SUFDRCxRQUFRLEdBQW9CLElBQUksQ0FBQztJQUV6QyxLQUFLO0lBQ0csZUFBZSxDQUFrQjtJQUNqQywwQkFBMEIsQ0FBNkI7SUFDdkQsd0JBQXdCLENBQTJCO0lBRTNELFFBQVE7SUFDQSxlQUFlLENBQWtCO0lBQ2pDLGdCQUFnQixDQUFtQjtJQUNuQyxpQkFBaUIsQ0FBb0I7SUFDckMsYUFBYSxDQUFnQjtJQUM3QixhQUFhLENBQWdCO0lBQzdCLGVBQWUsQ0FBa0I7SUFDakMsU0FBUyxDQUFZO0lBQ3JCLFdBQVcsQ0FBYztJQUN6QixjQUFjLENBQWlCO0lBQy9CLGVBQWUsQ0FBa0I7SUFFekM7UUFDRSxRQUFRO1FBQ1IsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLHlFQUFlLEVBQUUsQ0FBQztRQUM3QyxJQUFJLENBQUMsMEJBQTBCLEdBQUcsSUFBSSxnR0FBMEIsRUFBRSxDQUFDO1FBQ25FLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLDJGQUF3QixFQUFFLENBQUM7UUFFL0QsV0FBVztRQUNYLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxvRUFBUyxFQUFFLENBQUM7UUFDakMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLHdFQUFXLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ25ELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLG9GQUFpQixFQUFFLENBQUM7UUFDakQsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksa0ZBQWdCLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLENBQUM7UUFDNUUs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LEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxzQkFBc0IsQ0FBQyxDQUFDO2dCQUM3RixJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsR0FBRyxxQkFBcUIsQ0FBQztnQkFFakUsU0FBUztnQkFDVCxJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDaEUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztnQkFFNUUsU0FBUztnQkFDVCxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUVqQyxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUM1RCxDQUFDO1FBQ0gsQ0FBQztnQkFBUyxDQUFDO1lBQ1QsU0FBUztZQUNULElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDL0IsQ0FBQztJQUNILENBQUM7Q0FDRiIsInNvdXJjZXMiOlsic3JjOi8vdGF2ZXJuX2hlbHBlcl90ZW1wbGF0ZS9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9nYW1lLmNvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDmuLjmiI/mjqfliLblmahcbiAqIOi0n+i0o+WNj+iwg+WQhOS4quacjeWKoeWSjOe7hOS7tu+8jOeuoeeQhua4uOaIj+eahOaVtOS9k+a1geeoi1xuICovXG5pbXBvcnQgeyBCYWNrZ3JvdW5kTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL2JhY2tncm91bmRNYW5hZ2VyJztcbmltcG9ydCB7IENoYXJhY3Rlck1hbmFnZXIgfSBmcm9tICcuL3NjcmlwdHMvY29tcG9uZW50cy9jaGFyYWN0ZXJNYW5hZ2VyJztcbmltcG9ydCB7IENob2ljZU1hbmFnZXIgfSBmcm9tICcuL3NjcmlwdHMvY29tcG9uZW50cy9jaG9pY2VNYW5hZ2VyJztcbmltcG9ydCB7IERpYWxvZ3VlTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL2RpYWxvZ3VlTWFuYWdlcic7XG5pbXBvcnQgeyBKb3VybmFsTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL2pvdXJuYWxNYW5hZ2VyJztcbmltcG9ydCB7IE1lbW9yeU1hbmFnZXIgfSBmcm9tICcuL3NjcmlwdHMvY29tcG9uZW50cy9tZW1vcnlNYW5hZ2VyJztcbmltcG9ydCB7IE1lbW9yeVVJTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL21lbW9yeVVJTWFuYWdlcic7XG5pbXBvcnQgeyBTYXZlTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL3NhdmVNYW5hZ2VyJztcbmltcG9ydCB7IFNldHRpbmdzTWFuYWdlciB9IGZyb20gJy4vc2NyaXB0cy9jb21wb25lbnRzL3NldHRpbmdzTWFuYWdlcic7XG5pbXBvcnQgeyBVSU1hbmFnZXIgfSBmcm9tICcuL3NjcmlwdHMvY29tcG9uZW50cy91aU1hbmFnZXInO1xuaW1wb3J0IHsgR2FtZURhdGEgfSBmcm9tICcuL3NjcmlwdHMvbW9kZWxzL2dhbWVEYXRhJztcbmltcG9ydCB7IENoYXJhY3RlclJlc291cmNlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvY2hhcmFjdGVyLXJlc291cmNlLnNlcnZpY2UnO1xuaW1wb3J0IHsgR2FtZURhdGFTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9nYW1lLWRhdGEuc2VydmljZSc7XG5pbXBvcnQgeyBHYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvZ2FtZS1zdGF0ZS1nZW5lcmF0aW9uLnNlcnZpY2UnO1xuXG5leHBvcnQgY2xhc3MgR2FtZUNvbnRyb2xsZXIge1xuICAvLyDmuLjmiI/nirbmgIHmlbDmja5cbiAgcHJpdmF0ZSBnYW1lRGF0YTogR2FtZURhdGEgfCBudWxsID0gbnVsbDtcblxuICAvLyDmnI3liqFcbiAgcHJpdmF0ZSBnYW1lRGF0YVNlcnZpY2U6IEdhbWVEYXRhU2VydmljZTtcbiAgcHJpdmF0ZSBnYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZTogR2FtZVN0YXRlR2VuZXJhdGlvblNlcnZpY2U7XG4gIHByaXZhdGUgY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlOiBDaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2U7XG5cbiAgLy8g57uE5Lu2566h55CG5ZmoXG4gIHByaXZhdGUgZGlhbG9ndWVNYW5hZ2VyOiBEaWFsb2d1ZU1hbmFnZXI7XG4gIHByaXZhdGUgY2hhcmFjdGVyTWFuYWdlcjogQ2hhcmFjdGVyTWFuYWdlcjtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kTWFuYWdlcjogQmFja2dyb3VuZE1hbmFnZXI7XG4gIHByaXZhdGUgY2hvaWNlTWFuYWdlcjogQ2hvaWNlTWFuYWdlcjtcbiAgcHJpdmF0ZSBtZW1vcnlNYW5hZ2VyOiBNZW1vcnlNYW5hZ2VyO1xuICBwcml2YXRlIG1lbW9yeVVJTWFuYWdlcjogTWVtb3J5VUlNYW5hZ2VyO1xuICBwcml2YXRlIHVpTWFuYWdlcjogVUlNYW5hZ2VyO1xuICBwcml2YXRlIHNhdmVNYW5hZ2VyOiBTYXZlTWFuYWdlcjtcbiAgcHJpdmF0ZSBqb3VybmFsTWFuYWdlcjogSm91cm5hbE1hbmFnZXI7XG4gIHByaXZhdGUgc2V0dGluZ3NNYW5hZ2VyOiBTZXR0aW5nc01hbmFnZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8g5Yid5aeL5YyW5pyN5YqhXG4gICAgdGhpcy5nYW1lRGF0YVNlcnZpY2UgPSBuZXcgR2FtZURhdGFTZXJ2aWNlKCk7XG4gICAgdGhpcy5nYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZSA9IG5ldyBHYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZSgpO1xuICAgIHRoaXMuY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlID0gbmV3IENoYXJhY3RlclJlc291cmNlU2VydmljZSgpO1xuXG4gICAgLy8g5Yid5aeL5YyW5ZCE5Liq566h55CG5ZmoXG4gICAgdGhpcy51aU1hbmFnZXIgPSBuZXcgVUlNYW5hZ2VyKCk7XG4gICAgdGhpcy5zYXZlTWFuYWdlciA9IG5ldyBTYXZlTWFuYWdlcih0aGlzLnVpTWFuYWdlcik7XG4gICAgdGhpcy5iYWNrZ3JvdW5kTWFuYWdlciA9IG5ldyBCYWNrZ3JvdW5kTWFuYWdlcigpO1xuICAgIHRoaXMuY2hhcmFjdGVyTWFuYWdlciA9IG5ldyBDaGFyYWN0ZXJNYW5hZ2VyKHRoaXMuY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlKTtcbiAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlciA9IG5ldyBEaWFsb2d1ZU1hbmFnZXIoXG4gICAgICB0aGlzLmNoYXJhY3RlclJlc291cmNlU2VydmljZSxcbiAgICAgIHRoaXMuY2hhcmFjdGVyTWFuYWdlcixcbiAgICAgIHRoaXMuYmFja2dyb3VuZE1hbmFnZXIsXG4gICAgKTtcbiAgICB0aGlzLmNob2ljZU1hbmFnZXIgPSBuZXcgQ2hvaWNlTWFuYWdlcigpO1xuICAgIHRoaXMubWVtb3J5TWFuYWdlciA9IG5ldyBNZW1vcnlNYW5hZ2VyKCk7XG5cbiAgICAvLyDliJ3lp4vljJbmlrDliIbnprvnmoTnrqHnkIblmahcbiAgICB0aGlzLmpvdXJuYWxNYW5hZ2VyID0gbmV3IEpvdXJuYWxNYW5hZ2VyKCk7XG4gICAgdGhpcy5tZW1vcnlVSU1hbmFnZXIgPSBuZXcgTWVtb3J5VUlNYW5hZ2VyKFxuICAgICAgdGhpcy5tZW1vcnlNYW5hZ2VyLFxuICAgICAgdGhpcy5zYXZlTWFuYWdlcixcbiAgICAgIHRoaXMudWlNYW5hZ2VyLFxuICAgICAgdGhpcy5nYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZSxcbiAgICApO1xuXG4gICAgLy8g5Yid5aeL5YyW6K6+572u566h55CG5ZmoXG4gICAgdGhpcy5zZXR0aW5nc01hbmFnZXIgPSBuZXcgU2V0dGluZ3NNYW5hZ2VyKCk7XG5cbiAgICAvLyDliJ3lp4vljJbosIPor5XovoXliqnlip/og71cbiAgICB0aGlzLmdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlLmluaXREZWJ1Z0hlbHBlcnMoKTtcbiAgICBjb25zb2xlLmxvZygn6LCD6K+V6L6F5Yqp5Yqf6IO95bey5Yid5aeL5YyW77yM6K+35Zyo5o6n5Yi25Y+w5L2/55SoIHdpbmRvdy5kZWJ1Z0xMTVJlc3BvbnNlKCkg5p+l55yL5pyA6L+R5LiA5qyhTExN5ZON5bqUJyk7XG5cbiAgICAvLyDliJ3lp4vljJbmuLjmiI9cbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbmuLjmiI9cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW5pdCgpIHtcbiAgICBjb25zb2xlLmxvZygn5Yid5aeL5YyW5ri45oiP55WM6Z2iLi4uJyk7XG5cbiAgICAvLyDms6jlhozkuovku7bnm5HlkKzlmahcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIC8vIOWwneivleiOt+WPlua4uOaIj+aVsOaNrlxuICAgIGF3YWl0IHRoaXMubG9hZEdhbWVEYXRhKCk7XG5cbiAgICAvLyDmm7TmlrBVSVxuICAgIHRoaXMudXBkYXRlVUkoKTtcblxuICAgIC8vIOa3u+WKoOiwg+ivleWKn+iDvVxuICAgIHRoaXMuaW5pdERlYnVnRnVuY3Rpb25zKCk7XG5cbiAgICBjb25zb2xlLmxvZygn5ri45oiP55WM6Z2i5Yid5aeL5YyW5a6M5oiQIScpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMluiwg+ivleWKn+iDvVxuICAgKi9cbiAgcHJpdmF0ZSBpbml0RGVidWdGdW5jdGlvbnMoKSB7XG4gICAgLy8g5re75Yqg6LCD6K+V56Gu6K6k5a+56K+d5qGG55qE5YWo5bGA5Ye95pWwXG4gICAgKHdpbmRvdyBhcyBhbnkpLnRlc3RDb25maXJtRGlhbG9nID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ+a1i+ivleehruiupOWvueivneahhicpO1xuXG4gICAgICAvLyDliJvlu7rkuIDkuKrorqHmlbDlj5jph49cbiAgICAgIGlmICghKHdpbmRvdyBhcyBhbnkpLmNvbmZpcm1UZXN0Q291bnQpIHtcbiAgICAgICAgKHdpbmRvdyBhcyBhbnkpLmNvbmZpcm1UZXN0Q291bnQgPSAwO1xuICAgICAgfVxuXG4gICAgICAvLyDlop7liqDorqHmlbBcbiAgICAgICh3aW5kb3cgYXMgYW55KS5jb25maXJtVGVzdENvdW50Kys7XG5cbiAgICAgIC8vIOaYvuekuuW4puiuoeaVsOeahOehruiupOWvueivneahhlxuICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd0NvbmZpcm1EaWFsb2coXG4gICAgICAgIGDov5nmmK/kuIDkuKrmtYvor5Xnoa7orqTlr7nor53moYYgIyR7XG4gICAgICAgICAgKHdpbmRvdyBhcyBhbnkpLmNvbmZpcm1UZXN0Q291bnRcbiAgICAgICAgfe+8jOeUqOS6juajgOafpeS9jee9ruWSjOeCueWHu+WKn+iDveOAguivt+eCueWHu1wi56Gu6K6kXCLmjInpkq7mtYvor5XmmK/lkKblj6/ngrnlh7vjgIJgLFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+ehruiupOWvueivneahhuiiq+ehruiupCcpO1xuICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oYOehruiupOWvueivneahhiAjJHsod2luZG93IGFzIGFueSkuY29uZmlybVRlc3RDb3VudH0g5rWL6K+V5oiQ5YqfIWAsICdzdWNjZXNzJyk7XG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZygn6LCD6K+V5Yqf6IO95bey5Yid5aeL5YyW77yM5Y+v5Zyo5o6n5Yi25Y+w5L2/55SoIHdpbmRvdy50ZXN0Q29uZmlybURpYWxvZygpIOa1i+ivleehruiupOWvueivneahhicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOS6i+S7tuebkeWQrOWZqFxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIOagh+etvuWIh+aNouaMiemSrlxuICAgICQoJy50YWItYnV0dG9uJykub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICBjb25zdCB0YWJJZCA9ICQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCd0YWInKTtcbiAgICAgIGlmICh0YWJJZCkge1xuICAgICAgICB0aGlzLnN3aXRjaFRhYih0YWJJZCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDml6XorrDmoIfnrb7lhoXnmoTlr7zoiKrmjInpkq5cbiAgICAkKCcuam91cm5hbC1uYXYtaXRlbScpLm9uKCdjbGljaycsIGUgPT4ge1xuICAgICAgY29uc3Qgc2VjdGlvbklkID0gJChlLmN1cnJlbnRUYXJnZXQpLmRhdGEoJ3NlY3Rpb24nKTtcbiAgICAgIGlmIChzZWN0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5qb3VybmFsTWFuYWdlci5zd2l0Y2hKb3VybmFsU2VjdGlvbihzZWN0aW9uSWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5L+d5a2Y5ri45oiP5oyJ6ZKuIC0g5L2/55So5Y+z5LiK6KeS55qE5oyJ6ZKuXG4gICAgJCgnI3NhdmUtZ2FtZScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2F2ZUdhbWUoKTtcbiAgICB9KTtcblxuICAgIC8vIOWKoOi9vea4uOaIj+aMiemSriAtIOS9v+eUqOWPs+S4iuinkueahOaMiemSrlxuICAgICQoJyNsb2FkLWdhbWUnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmxvYWRHYW1lKCk7XG4gICAgfSk7XG5cbiAgICAvLyDorr7nva7mjInpkq5cbiAgICAkKCcjc2V0dGluZ3MtYnV0dG9uJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zaG93U2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIC8vIOS/neWtmOiusOW/huaMiemSrlxuICAgICQoJyNzYXZlLW1lbW9yeScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IG5ld01lbW9yeSA9IHRoaXMubWVtb3J5VUlNYW5hZ2VyLnNhdmVNZW1vcnkoKTtcbiAgICAgIGlmIChuZXdNZW1vcnkgJiYgdGhpcy5nYW1lRGF0YSkge1xuICAgICAgICAvLyDmm7TmlrDmuLjmiI/mlbDmja5cbiAgICAgICAgdGhpcy5nYW1lRGF0YS5zdG9yeVN1bW1hcnkucHVzaChuZXdNZW1vcnkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g56m/6LaK6K6w5b+G5oyJ6ZKuXG4gICAgJCgnI3RyYXZlbC1tZW1vcnknKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLm1lbW9yeVVJTWFuYWdlci50cmF2ZWxUb01lbW9yeSgoKSA9PiB7XG4gICAgICAgIC8vIOaIkOWKn+epv+i2iuWQjueahOWbnuiwg1xuICAgICAgICB0aGlzLmdhbWVEYXRhID0gdGhpcy5tZW1vcnlVSU1hbmFnZXIuZ2V0R2FtZURhdGEoKTtcbiAgICAgICAgdGhpcy51cGRhdGVVSSgpO1xuICAgICAgICB0aGlzLnN3aXRjaFRhYignc3RvcnktdGFiJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIOWOhuWPsuiusOW9leaMiemSrlxuICAgICQoJyNkaWFsb2d1ZS1oaXN0b3J5Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zaG93RGlhbG9ndWVIaXN0b3J5KCk7XG4gICAgfSk7XG5cbiAgICAvLyDpgInmi6nmjInpkq5cbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNob2ljZS1idXR0b24nLCBlID0+IHtcbiAgICAgIGNvbnN0IGNob2ljZSA9ICQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCdjaG9pY2UnKTtcbiAgICAgIHRoaXMubWFrZUNob2ljZShjaG9pY2UpO1xuICAgIH0pO1xuXG4gICAgLy8g6I635Y+W5ri45oiP5pWw5o2u5LqL5Lu2XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3JlcXVlc3RfZ2FtZV9kYXRhJywgZXZlbnQgPT4ge1xuICAgICAgaWYgKGV2ZW50LmRldGFpbCAmJiB0eXBlb2YgZXZlbnQuZGV0YWlsLmNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIOehruS/nei/lOWbnueahOa4uOaIj+aVsOaNruWMheWQq+aJgOacieW/heimgeWxnuaAp1xuICAgICAgICBjb25zdCBjdXJyZW50R2FtZURhdGE6IEdhbWVEYXRhID0ge1xuICAgICAgICAgIHN0b3J5OiB0aGlzLmdhbWVEYXRhPy5zdG9yeSB8fCB7XG4gICAgICAgICAgICBkYXRlOiAn5pyq55+l5pel5pyfJyxcbiAgICAgICAgICAgIGxvY2F0aW9uOiAn5pyq55+l5L2N572uJyxcbiAgICAgICAgICAgIHNjZW5lOiAn5pyq55+l5Zy65pmvJyxcbiAgICAgICAgICAgIGRpYWxvZ3VlOiBbXSxcbiAgICAgICAgICAgIG9wdGlvbnM6IFtdLFxuICAgICAgICAgICAgY3VycmVudERpYWxvZ3VlSW5kZXg6IDAsXG4gICAgICAgICAgICBjdXJyZW50Q2hhcHRlcjogJ+esrDHnq6AnLFxuICAgICAgICAgICAgY3VycmVudEZ1bmRzOiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3RvcnlTdW1tYXJ5OiB0aGlzLmdhbWVEYXRhPy5zdG9yeVN1bW1hcnkgfHwgW10sXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8g6L+U5Zue5b2T5YmN5ri45oiP5pWw5o2u55qE5Ymv5pysXG4gICAgICAgIGV2ZW50LmRldGFpbC5jYWxsYmFjayhjdXJyZW50R2FtZURhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5ri45oiP5Yqg6L295a6M5oiQ5LqL5Lu2XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWVsb2FkZWQnLCBldmVudCA9PiB7XG4gICAgICBpZiAoZXZlbnQuZGV0YWlsICYmIGV2ZW50LmRldGFpbC5nYW1lRGF0YSkge1xuICAgICAgICAvLyDmm7TmlrDmuLjmiI/mlbDmja5cbiAgICAgICAgdGhpcy5nYW1lRGF0YSA9IGV2ZW50LmRldGFpbC5nYW1lRGF0YTtcblxuICAgICAgICAvLyDph43mlrDmuLLmn5PmuLjmiI/nirbmgIFcbiAgICAgICAgdGhpcy51cGRhdGVVSSgpO1xuICAgICAgICB0aGlzLnN3aXRjaFRhYignc3RvcnktdGFiJyk7XG5cbiAgICAgICAgLy8g5pi+56S65oiQ5Yqf5Yqg6L2955qE6YCa55+lXG4gICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+a4uOaIj+W3suWKoOi9vScsICdzdWNjZXNzJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDlr7nor53moYbngrnlh7vkuovku7YgLSDngrnlh7vlr7nor53moYbov5vlhaXkuIvkuIDmraXmiJbph43mlrDmmL7npLrpgInpoblcbiAgICAkKCcjZGlhbG9ndWUtY29udGFpbmVyJykub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICAvLyDpmLLmraLngrnlh7vlr7nor53mjqfliLbmjInpkq7ml7bop6blj5HkuIvkuIDmraVcbiAgICAgIGlmICghJChlLnRhcmdldCkuY2xvc2VzdCgnLmRpYWxvZ3VlLWNvbnRyb2xzJykubGVuZ3RoKSB7XG4gICAgICAgIC8vIOajgOafpeaYr+WQpuWPr+S7pemHjeaWsOaYvuekuumAiemhuVxuICAgICAgICBpZiAodGhpcy5jaG9pY2VNYW5hZ2VyLmNhblJlc2hvd0Nob2ljZXMoKSkge1xuICAgICAgICAgIHRoaXMuY2hvaWNlTWFuYWdlci5yZXNob3dDaG9pY2VzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5uZXh0RGlhbG9ndWUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g6YCJ6aG56YCJ5oup5Zue6LCDXG4gICAgdGhpcy5jaG9pY2VNYW5hZ2VyLnNldE9uQ2hvaWNlU2VsZWN0ZWQoY2hvaWNlID0+IHtcbiAgICAgIHRoaXMubWFrZUNob2ljZShjaG9pY2UpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9vea4uOaIj+aVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBsb2FkR2FtZURhdGEoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuZ2FtZURhdGEgPSBhd2FpdCB0aGlzLmdhbWVEYXRhU2VydmljZS5sb2FkR2FtZURhdGEoKTtcblxuICAgICAgLy8g5pu05paw5ZCE566h55CG5Zmo55qE5ri45oiP5pWw5o2uXG4gICAgICB0aGlzLmpvdXJuYWxNYW5hZ2VyLnNldEdhbWVEYXRhKHRoaXMuZ2FtZURhdGEpO1xuICAgICAgdGhpcy5tZW1vcnlVSU1hbmFnZXIuc2V0R2FtZURhdGEodGhpcy5nYW1lRGF0YSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9vea4uOaIj+aVsOaNruWksei0pTonLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouagh+etvumhtVxuICAgKi9cbiAgcHJpdmF0ZSBzd2l0Y2hUYWIodGFiSWQ6IHN0cmluZykge1xuICAgIC8vIOenu+mZpOaJgOacieagh+etvuaMiemSrueahOa/gOa0u+eKtuaAgVxuICAgICQoJy50YWItYnV0dG9uJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g56e76Zmk5omA5pyJ5qCH562+5YaF5a6555qE5r+A5rS754q25oCBXG4gICAgJCgnLnRhYi1wYW5lJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g5r+A5rS76YCJ5Lit55qE5qCH562+5oyJ6ZKu5ZKM5YaF5a65XG4gICAgJChgW2RhdGEtdGFiPVwiJHt0YWJJZH1cIl1gKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgJChgIyR7dGFiSWR9YCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g5aaC5p6c5piv6K6w5b+G5qCH562+77yM5Yi35paw6K6w5b+G5pe26Ze06L20XG4gICAgaWYgKHRhYklkID09PSAnbWVtb3J5LXRhYicpIHtcbiAgICAgIHRoaXMubWVtb3J5VUlNYW5hZ2VyLnJlZnJlc2hNZW1vcnlUaW1lbGluZSgpO1xuICAgIH1cblxuICAgIC8vIOWmguaenOaYr+aXpeiusOagh+etvu+8jOWIt+aWsOinkuiJsuS/oeaBr1xuICAgIGlmICh0YWJJZCA9PT0gJ2pvdXJuYWwtdGFiJykge1xuICAgICAgdGhpcy5qb3VybmFsTWFuYWdlci5yZWZyZXNoSm91cm5hbENvbnRlbnQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65a+56K+d5Y6G5Y+y6K6w5b2VXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNob3dEaWFsb2d1ZUhpc3RvcnkoKSB7XG4gICAgLy8g5bCd6K+V5LuO5LiW55WM5Lmm6I635Y+W5a+56K+d5Y6G5Y+yXG4gICAgY29uc3QgZGlhbG9ndWVIaXN0b3J5ID0gYXdhaXQgdGhpcy5zYXZlTWFuYWdlci5nZXREaWFsb2d1ZUhpc3RvcnkoKTtcbiAgICBpZiAoZGlhbG9ndWVIaXN0b3J5KSB7XG4gICAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlci5zaG93RGlhbG9ndWVIaXN0b3J5KGRpYWxvZ3VlSGlzdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuiuvue9rlxuICAgKi9cbiAgcHJpdmF0ZSBzaG93U2V0dGluZ3MoKSB7XG4gICAgY29uc29sZS5sb2coJ+aYvuekuuiuvue9ricpO1xuICAgIHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNob3dTZXR0aW5nc0RpYWxvZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOa4uOaIj1xuICAgKi9cbiAgcHJpdmF0ZSBzYXZlR2FtZSgpIHtcbiAgICBjb25zb2xlLmxvZygn5L+d5a2Y5ri45oiPLi4uJyk7XG4gICAgLy8g5pi+56S656Gu6K6k5a+56K+d5qGGXG4gICAgdGhpcy51aU1hbmFnZXIuc2hvd0lucHV0RGlhbG9nKCfor7fovpPlhaXlhbjnsY3moIfpopgnLCAn5b2T5YmN6L+b5bqm6K6w5b2VJywgYXN5bmMgc2F2ZU5hbWUgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd0xvYWRpbmcoJ+ato+WcqOiusOW9leWFuOexjS4uLicpO1xuICAgICAgICAvLyDosIPnlKjlrZjmoaPnrqHnkIblmajkv53lrZjmuLjmiI9cbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHRoaXMuc2F2ZU1hbmFnZXIuc2F2ZUdhbWVTdGF0ZSh0aGlzLmdhbWVEYXRhISwgdHJ1ZSwgc2F2ZU5hbWUpO1xuICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+WFuOexjeiusOW9leaIkOWKnycsICdzdWNjZXNzJyk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOa4uOaIj+Wksei0pTonLCBlcnJvcik7XG4gICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+WFuOexjeiusOW9leWksei0pScsICdlcnJvcicpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdGhpcy51aU1hbmFnZXIuaGlkZUxvYWRpbmcoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3muLjmiI9cbiAgICovXG4gIHByaXZhdGUgbG9hZEdhbWUoKSB7XG4gICAgY29uc29sZS5sb2coJ+WKoOi9vea4uOaIjy4uLicpO1xuICAgIC8vIOaYvuekuuWtmOaho+WIl+ihqFxuICAgIHRoaXMuc2F2ZU1hbmFnZXIubG9hZEdhbWUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrBVSVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVVSSgpIHtcbiAgICBpZiAoIXRoaXMuZ2FtZURhdGEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+aXoOazleabtOaWsFVJ77ya5ri45oiP5pWw5o2u5LiN5a2Y5ZyoJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOabtOaWsOmhtumDqOaXpeacn1xuICAgICAgJCgnI2dhbWUtZGF0ZScpLnRleHQodGhpcy5nYW1lRGF0YS5zdG9yeS5kYXRlKTtcblxuICAgICAgLy8g6K6+572u5a+56K+dXG4gICAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlci5zZXREaWFsb2d1ZXModGhpcy5nYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZSk7XG4gICAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlci5yZW5kZXJEaWFsb2d1ZSh0aGlzLmdhbWVEYXRhLnN0b3J5LmN1cnJlbnREaWFsb2d1ZUluZGV4KTtcblxuICAgICAgLy8g6K6+572u6IOM5pmvXG4gICAgICB0aGlzLmJhY2tncm91bmRNYW5hZ2VyLnNldEJhY2tncm91bmQodGhpcy5nYW1lRGF0YS5zdG9yeS5sb2NhdGlvbiwgdGhpcy5nYW1lRGF0YS5zdG9yeS5zY2VuZSk7XG5cbiAgICAgIC8vIOiuvue9rumAiemhuVxuICAgICAgdGhpcy5jaG9pY2VNYW5hZ2VyLnNldENob2ljZXModGhpcy5nYW1lRGF0YS5zdG9yeS5vcHRpb25zKTtcblxuICAgICAgLy8g5pu05paw5YaF5a2YVUnvvIjlpoLmnpzorrDlv4bmoIfnrb7mmK/mtLvot4PnmoTvvIlcbiAgICAgIGlmICgkKCcjbWVtb3J5LXRhYicpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICB0aGlzLm1lbW9yeVVJTWFuYWdlci5yZWZyZXNoTWVtb3J5VGltZWxpbmUoKTtcbiAgICAgIH1cblxuICAgICAgLy8g5pu05paw5pel6K6w77yI5aaC5p6c5pel6K6w5qCH562+5piv5rS76LeD55qE77yJXG4gICAgICBpZiAoJCgnI2pvdXJuYWwtdGFiJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgIHRoaXMuam91cm5hbE1hbmFnZXIucmVmcmVzaEpvdXJuYWxDb250ZW50KCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdVSeW3suabtOaWsCcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfmm7TmlrBVSeaXtuWPkeeUn+mUmeivrzonLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuS4i+S4gOadoeWvueivnVxuICAgKi9cbiAgcHJpdmF0ZSBuZXh0RGlhbG9ndWUoKSB7XG4gICAgaWYgKCF0aGlzLmdhbWVEYXRhKSByZXR1cm47XG5cbiAgICAvLyDlsJ3or5XmmL7npLrkuIvkuIDmnaHlr7nor51cbiAgICBjb25zdCBoYXNNb3JlRGlhbG9ndWUgPSB0aGlzLmRpYWxvZ3VlTWFuYWdlci5zaG93TmV4dERpYWxvZ3VlKCk7XG5cbiAgICBpZiAoaGFzTW9yZURpYWxvZ3VlKSB7XG4gICAgICAvLyDmm7TmlrDmuLjmiI/mlbDmja7kuK3nmoTlvZPliY3lr7nor53ntKLlvJVcbiAgICAgIHRoaXMuZ2FtZURhdGEuc3RvcnkuY3VycmVudERpYWxvZ3VlSW5kZXggPSB0aGlzLmRpYWxvZ3VlTWFuYWdlci5nZXRDdXJyZW50RGlhbG9ndWVJbmRleCgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5nYW1lRGF0YS5zdG9yeS5vcHRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIOaWsOWinu+8muajgOafpeaYr+WQpuaYr+acgOWQjuS4gOadoeWvueivne+8jOS4lOW3sue7j+aYvuekuuS6humAiemhuVxuICAgICAgY29uc3QgaXNEaWFsb2d1ZUZpbmlzaGVkID0gdGhpcy5kaWFsb2d1ZU1hbmFnZXIuaXNEaWFsb2d1ZUZpbmlzaGVkKCk7XG4gICAgICBjb25zdCBpc0Nob2ljZXNBbHJlYWR5U2hvd24gPSB0aGlzLmNob2ljZU1hbmFnZXIuYXJlQ2hvaWNlc1Zpc2libGUoKTtcblxuICAgICAgLy8g5Y+q5pyJ5Zyo5a+56K+d5bey57uT5p2f5LiU6YCJ6aG56L+Y5rKh5pi+56S655qE5oOF5Ya15LiL5omN5pi+56S66YCJ6aG5XG4gICAgICBpZiAoaXNEaWFsb2d1ZUZpbmlzaGVkICYmICFpc0Nob2ljZXNBbHJlYWR5U2hvd24pIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+WvueivneW3sue7k+adn++8jOaYvuekuumAiemhuScpO1xuICAgICAgICB0aGlzLmNob2ljZU1hbmFnZXIuc2hvd0Nob2ljZXMoKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNDaG9pY2VzQWxyZWFkeVNob3duKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfpgInpobnlt7LmmL7npLrvvIzkuI3lho3ph43lpI3mmL7npLonKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5rKh5pyJ5pu05aSa5a+56K+d5Lmf5rKh5pyJ6YCJ6aG577yM5Y+v5Lul5re75Yqg6aKd5aSW6YC76L6RXG4gICAgICBjb25zb2xlLmxvZygn5a+56K+d57uT5p2f77yM5LiU5rKh5pyJ5Y+v55So6YCJ6aG5Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOmAieaLqemAiemhuVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBtYWtlQ2hvaWNlKGNob2ljZTogc3RyaW5nKSB7XG4gICAgaWYgKCF0aGlzLmdhbWVEYXRhKSByZXR1cm47XG5cbiAgICBjb25zb2xlLmxvZyhg546p5a626YCJ5oup5LqGOiAke2Nob2ljZX1gKTtcblxuICAgIC8vIOWIpOaWreaYr+WQpuS4uuiHquWumuS5ieihjOWKqO+8iOS4jeWcqOmihOWumuS5iemAiemhueWIl+ihqOS4re+8iVxuICAgIGNvbnN0IGlzQ3VzdG9tQWN0aW9uID0gIXRoaXMuZ2FtZURhdGEuc3Rvcnkub3B0aW9ucy5pbmNsdWRlcyhjaG9pY2UpO1xuXG4gICAgLy8g6ZqQ6JeP6YCJ6aG5XG4gICAgdGhpcy5jaG9pY2VNYW5hZ2VyLmhpZGVDaG9pY2VzKCk7XG5cbiAgICAvLyDmmL7npLrliqDovb3mj5DnpLpcbiAgICB0aGlzLnVpTWFuYWdlci5zaG93TG9hZGluZygn5q2j5Zyo55Sf5oiQ5Zue5bqULi4uJyk7XG5cbiAgICAvLyDkv53lrZjnjqnlrrbpgInmi6nliY3nmoTnirbmgIHvvIzku6Xkvr/lh7rplJnml7bmgaLlpI1cbiAgICBjb25zdCBwcmV2aW91c0RpYWxvZ3VlTGVuZ3RoID0gdGhpcy5nYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZS5sZW5ndGg7XG4gICAgY29uc3QgcHJldmlvdXNEaWFsb2d1ZUluZGV4ID0gdGhpcy5nYW1lRGF0YS5zdG9yeS5jdXJyZW50RGlhbG9ndWVJbmRleDtcblxuICAgIC8vIOa3u+WKoOeOqeWutumAieaLqeWIsOWvueivnVxuICAgIGNvbnN0IHBsYXllckNob2ljZSA9IHtcbiAgICAgIHNwZWFrZXI6ICfnjqnlrrYnLFxuICAgICAgY29udGVudDogY2hvaWNlLFxuICAgICAgc3R5bGU6ICdub3JtYWwnIGFzIGNvbnN0LFxuICAgICAgLy8g5LiN6K6+572ucG9ydHJhaXTvvIzkvb/nlKjpu5jorqTop4TliJlcbiAgICB9O1xuXG4gICAgdGhpcy5nYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZS5wdXNoKHBsYXllckNob2ljZSk7XG4gICAgdGhpcy5kaWFsb2d1ZU1hbmFnZXIuc2V0RGlhbG9ndWVzKHRoaXMuZ2FtZURhdGEuc3RvcnkuZGlhbG9ndWUpO1xuICAgIHRoaXMuZ2FtZURhdGEuc3RvcnkuY3VycmVudERpYWxvZ3VlSW5kZXggPSB0aGlzLmdhbWVEYXRhLnN0b3J5LmRpYWxvZ3VlLmxlbmd0aCAtIDE7XG4gICAgdGhpcy5kaWFsb2d1ZU1hbmFnZXIuc2hvd0RpYWxvZ3VlKHRoaXMuZ2FtZURhdGEuc3RvcnkuY3VycmVudERpYWxvZ3VlSW5kZXgpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOagueaNruaYr+WQpuaYr+iHquWumuS5ieihjOWKqOiwg+eUqOS4jeWQjOeahOWkhOeQhuaWueazlVxuICAgICAgY29uc3QgbmV3R2FtZVN0YXRlID0gaXNDdXN0b21BY3Rpb25cbiAgICAgICAgPyBhd2FpdCB0aGlzLmdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlLmhhbmRsZUN1c3RvbUFjdGlvbihjaG9pY2UpXG4gICAgICAgIDogYXdhaXQgdGhpcy5nYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZS5nZW5lcmF0ZU5leHRHYW1lU3RhdGUoY2hvaWNlKTtcblxuICAgICAgaWYgKG5ld0dhbWVTdGF0ZSkge1xuICAgICAgICAvLyDmm7TmlrDmuLjmiI/nirbmgIFcbiAgICAgICAgdGhpcy5nYW1lRGF0YSA9IG5ld0dhbWVTdGF0ZTtcblxuICAgICAgICAvLyDmm7TmlrBVSVxuICAgICAgICB0aGlzLnVwZGF0ZVVJKCk7XG5cbiAgICAgICAgLy8g5L+d5a2Y5Yiw5LiW55WM5LmmXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZU1hbmFnZXIuc2F2ZUdhbWVTdGF0ZSh0aGlzLmdhbWVEYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOeUn+aIkOWksei0pe+8jOaBouWkjeWIsOeOqeWutumAieaLqeWJjeeahOeKtuaAgVxuICAgICAgICBpZiAodGhpcy5nYW1lRGF0YSkge1xuICAgICAgICAgIC8vIOenu+mZpOeOqeWutumAieaLqVxuICAgICAgICAgIHRoaXMuZ2FtZURhdGEuc3RvcnkuZGlhbG9ndWUgPSB0aGlzLmdhbWVEYXRhLnN0b3J5LmRpYWxvZ3VlLnNsaWNlKDAsIHByZXZpb3VzRGlhbG9ndWVMZW5ndGgpO1xuICAgICAgICAgIHRoaXMuZ2FtZURhdGEuc3RvcnkuY3VycmVudERpYWxvZ3VlSW5kZXggPSBwcmV2aW91c0RpYWxvZ3VlSW5kZXg7XG5cbiAgICAgICAgICAvLyDmm7TmlrDlr7nor53mmL7npLpcbiAgICAgICAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlci5zZXREaWFsb2d1ZXModGhpcy5nYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZSk7XG4gICAgICAgICAgdGhpcy5kaWFsb2d1ZU1hbmFnZXIuc2hvd0RpYWxvZ3VlKHRoaXMuZ2FtZURhdGEuc3RvcnkuY3VycmVudERpYWxvZ3VlSW5kZXgpO1xuXG4gICAgICAgICAgLy8g6YeN5paw5pi+56S66YCJ6aG5XG4gICAgICAgICAgdGhpcy5jaG9pY2VNYW5hZ2VyLnNob3dDaG9pY2VzKCk7XG5cbiAgICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfnlJ/miJDmuLjmiI/nirbmgIHlpLHotKXvvIzor7fph43mlrDpgInmi6knLCAnd2FybmluZycpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WkhOeQhueOqeWutumAieaLqeaXtuWHuumUmTonLCBlcnJvcik7XG5cbiAgICAgIC8vIOWHuumUmeaXtuaBouWkjeWIsOeOqeWutumAieaLqeWJjeeahOeKtuaAgVxuICAgICAgaWYgKHRoaXMuZ2FtZURhdGEpIHtcbiAgICAgICAgLy8g56e76Zmk546p5a626YCJ5oupXG4gICAgICAgIHRoaXMuZ2FtZURhdGEuc3RvcnkuZGlhbG9ndWUgPSB0aGlzLmdhbWVEYXRhLnN0b3J5LmRpYWxvZ3VlLnNsaWNlKDAsIHByZXZpb3VzRGlhbG9ndWVMZW5ndGgpO1xuICAgICAgICB0aGlzLmdhbWVEYXRhLnN0b3J5LmN1cnJlbnREaWFsb2d1ZUluZGV4ID0gcHJldmlvdXNEaWFsb2d1ZUluZGV4O1xuXG4gICAgICAgIC8vIOabtOaWsOWvueivneaYvuekulxuICAgICAgICB0aGlzLmRpYWxvZ3VlTWFuYWdlci5zZXREaWFsb2d1ZXModGhpcy5nYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZSk7XG4gICAgICAgIHRoaXMuZGlhbG9ndWVNYW5hZ2VyLnNob3dEaWFsb2d1ZSh0aGlzLmdhbWVEYXRhLnN0b3J5LmN1cnJlbnREaWFsb2d1ZUluZGV4KTtcblxuICAgICAgICAvLyDph43mlrDmmL7npLrpgInpoblcbiAgICAgICAgdGhpcy5jaG9pY2VNYW5hZ2VyLnNob3dDaG9pY2VzKCk7XG5cbiAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign55Sf5oiQ5ZON5bqU5pe25Ye66ZSZ77yM6K+36YeN5paw6YCJ5oupJywgJ2Vycm9yJyk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIOmakOiXj+WKoOi9veaPkOekulxuICAgICAgdGhpcy51aU1hbmFnZXIuaGlkZUxvYWRpbmcoKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/game.controller.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/index.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _game_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game.controller */ "./src/圣约与静默/游戏界面/game.controller.ts");\n/* harmony import */ var _styles_main_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./styles/main.scss */ "./src/圣约与静默/游戏界面/styles/main.scss");\n/**\n * 修道院箱庭游戏界面 - 主脚本\n */\n\n\n// 等待DOM加载完成后初始化游戏\n$(document).ready(() => {\n    new _game_controller__WEBPACK_IMPORTED_MODULE_0__.GameController();\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQTs7R0FFRztBQUNnRDtBQUV2QjtBQW9DNUIsa0JBQWtCO0FBQ2xCLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFO0lBQ3JCLElBQUksNERBQWMsRUFBRSxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gv5ri45oiP55WM6Z2iL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5L+u6YGT6Zmi566x5bqt5ri45oiP55WM6Z2iIC0g5Li76ISa5pysXG4gKi9cbmltcG9ydCB7IEdhbWVDb250cm9sbGVyIH0gZnJvbSAnLi9nYW1lLmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgR2FtZURhdGEgfSBmcm9tICcuL3NjcmlwdHMvbW9kZWxzL2dhbWVEYXRhJztcbmltcG9ydCAnLi9zdHlsZXMvbWFpbi5zY3NzJztcblxuLy8g5aOw5piO5YWo5bGA5Y+Y6YePXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIGdldENoYXRNZXNzYWdlczogKG1lc3NhZ2VJZDogbnVtYmVyKSA9PiBzdHJpbmdbXTtcbiAgICBnZXRDdXJyZW50TWVzc2FnZUlkOiAoKSA9PiBudW1iZXI7XG4gICAgZ2VuZXJhdGU6IChjb25maWc6IGFueSkgPT4gUHJvbWlzZTxzdHJpbmc+O1xuICAgIGdlbmVyYXRlUmF3OiAoY29uZmlnOiBhbnkpID0+IFByb21pc2U8c3RyaW5nPjtcbiAgICAvLyDkuJbnlYzkuabmk43kvZxBUElcbiAgICBnZXRMb3JlYm9va0VudHJpZXM6IChsb3JlYm9vazogc3RyaW5nKSA9PiBQcm9taXNlPGFueVtdPjtcbiAgICBjcmVhdGVMb3JlYm9va0VudHJ5OiAobG9yZWJvb2s6IHN0cmluZywgZmllbGRWYWx1ZXM6IGFueSkgPT4gUHJvbWlzZTxudW1iZXI+O1xuICAgIGRlbGV0ZUxvcmVib29rRW50cnk6IChsb3JlYm9vazogc3RyaW5nLCBsb3JlYm9va1VpZDogbnVtYmVyKSA9PiBQcm9taXNlPGJvb2xlYW4+O1xuICAgIGVkaXRMb3JlYm9va0VudHJ5OiAobG9yZWJvb2s6IHN0cmluZywgbG9yZWJvb2tVaWQ6IG51bWJlciwgZmllbGRWYWx1ZXM6IGFueSkgPT4gUHJvbWlzZTxib29sZWFuPjtcbiAgICB0cmlnZ2VyU2xhc2g6IChjb21tYW5kOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nPjtcbiAgICAvLyDogYrlpKnkuJbnlYzkuaZBUElcbiAgICBnZXRPckNyZWF0ZUNoYXRMb3JlYm9vazogKCkgPT4gUHJvbWlzZTxzdHJpbmc+O1xuICAgIC8vIOS6i+S7tuezu+e7nyAtIOiuvuS4uuWPr+mAieWxnuaAp++8jOmBv+WFjeacquWumuS5iemUmeivr1xuICAgIGV2ZW50T25jZT86IDxUIGV4dGVuZHMgc3RyaW5nPihldmVudF90eXBlOiBULCBsaXN0ZW5lcjogKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnkpID0+IHZvaWQ7XG4gICAgaWZyYW1lX2V2ZW50cz86IHtcbiAgICAgIEdFTkVSQVRJT05fU1RBUlRFRD86IHN0cmluZztcbiAgICAgIEdFTkVSQVRJT05fRU5ERUQ/OiBzdHJpbmc7XG4gICAgICBTVFJFQU1fVE9LRU5fUkVDRUlWRURfRlVMTFk/OiBzdHJpbmc7XG4gICAgICBTVFJFQU1fVE9LRU5fUkVDRUlWRURfSU5DUkVNRU5UQUxMWT86IHN0cmluZztcbiAgICAgIE1FU1NBR0VfSUZSQU1FX1JFTkRFUl9TVEFSVEVEPzogc3RyaW5nO1xuICAgICAgTUVTU0FHRV9JRlJBTUVfUkVOREVSX0VOREVEPzogc3RyaW5nO1xuICAgIH07XG4gIH1cblxuICAvLyDoh6rlrprkuYnkuovku7bnsbvlnotcbiAgaW50ZXJmYWNlIFdpbmRvd0V2ZW50TWFwIHtcbiAgICByZXF1ZXN0X2dhbWVfZGF0YTogQ3VzdG9tRXZlbnQ8eyBjYWxsYmFjazogKGdhbWVEYXRhOiBHYW1lRGF0YSkgPT4gdm9pZCB9PjtcbiAgICBnYW1lbG9hZGVkOiBDdXN0b21FdmVudDx7IGdhbWVEYXRhOiBHYW1lRGF0YSB9PjtcbiAgfVxufVxuXG4vLyDnrYnlvoVET03liqDovb3lrozmiJDlkI7liJ3lp4vljJbmuLjmiI9cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcbiAgbmV3IEdhbWVDb250cm9sbGVyKCk7XG59KTtcblxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/index.ts\n\n}');
  },
  "./src/圣约与静默/游戏界面/scripts/components/backgroundManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BackgroundManager: () => (/* binding */ BackgroundManager)\n/* harmony export */ });\n/**\n * 背景管理器组件\n * 负责管理游戏中的背景图片显示和切换\n */\nclass BackgroundManager {\n    // 背景图片映射\n    backgroundMap = {};\n    constructor() {\n        // 初始化背景图片映射\n        this.initBackgroundMap();\n        console.log('背景管理器初始化完成');\n    }\n    /**\n     * 初始化背景图片映射\n     */\n    initBackgroundMap() {\n        // 设置基本背景映射\n        this.backgroundMap = {\n            公园_白天: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%85%AC%E5%9B%AD/%E7%99%BD%E5%A4%A9.jpg?ref_type=heads',\n            公园_黄昏: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%85%AC%E5%9B%AD/%E9%BB%84%E6%98%8F.jpg?ref_type=heads',\n            书店_内部: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E4%B9%A6%E5%BA%97%E5%86%85/%E4%B9%A6%E5%BA%97.jpg?ref_type=heads',\n            修道院_图书室: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E4%B9%A6%E5%BA%97%E5%86%85/%E4%B9%A6%E5%BA%97.jpg?ref_type=heads',\n            修道院_办公室: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%85%AC%E5%9B%AD/%E9%BB%84%E6%98%8F.jpg?ref_type=heads',\n            修道院_花园: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%85%AC%E5%9B%AD/%E7%99%BD%E5%A4%A9.jpg?ref_type=heads',\n        };\n    }\n    /**\n     * 设置背景图片\n     * @param location 位置\n     * @param scene 场景\n     */\n    setBackground(location, scene) {\n        // 生成背景键\n        const backgroundKey = `${location}_${scene}`;\n        // 获取背景图片URL\n        let backgroundUrl = this.backgroundMap[backgroundKey];\n        // 如果没有找到特定的背景，尝试使用该位置的默认背景\n        if (!backgroundUrl) {\n            backgroundUrl = this.backgroundMap[`${location}_默认`];\n        }\n        // 如果还是没有找到，使用第一张图片作为默认\n        if (!backgroundUrl && !_.isEmpty(this.backgroundMap)) {\n            backgroundUrl = _.values(this.backgroundMap)[0];\n        }\n        if (backgroundUrl) {\n            // 设置背景图片\n            $('.background-container').css('backgroundImage', `url('${backgroundUrl}')`);\n            console.log(`已设置背景: ${backgroundKey}`);\n        }\n        else {\n            console.warn(`未找到背景: ${backgroundKey}`);\n            // 设置默认背景颜色\n            $('.background-container').css({\n                backgroundImage: 'none',\n                backgroundColor: '#2a2a2a',\n            });\n        }\n    }\n    /**\n     * 添加背景图片映射\n     * @param key 背景键\n     * @param url 图片URL\n     */\n    addBackground(key, url) {\n        this.backgroundMap[key] = url;\n    }\n    /**\n     * 应用背景切换特效\n     * @param effect 特效名称\n     */\n    applyBackgroundEffect(effect) {\n        // 移除所有特效类\n        $('.background-container').removeClass('effect-fade effect-slide effect-zoom');\n        if (effect) {\n            // 添加指定特效类并使用jQuery UI的效果\n            const $bg = $('.background-container');\n            switch (effect) {\n                case 'fade':\n                    $bg.addClass('effect-fade');\n                    $bg.hide().fadeIn(1000);\n                    break;\n                case 'slide':\n                    $bg.addClass('effect-slide');\n                    $bg.hide().slideDown(1000);\n                    break;\n                case 'zoom':\n                    $bg.addClass('effect-zoom');\n                    $bg.hide().show('scale', {}, 1000);\n                    break;\n            }\n            // 一段时间后移除特效类\n            setTimeout(() => {\n                $bg.removeClass(`effect-${effect}`);\n            }, 1000);\n        }\n    }\n    /**\n     * 获取所有背景键\n     */\n    getAllBackgroundKeys() {\n        return _.keys(this.backgroundMap);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvYmFja2dyb3VuZE1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7R0FHRztBQUVJLE1BQU0saUJBQWlCO0lBQzVCLFNBQVM7SUFDRCxhQUFhLEdBQXlCLEVBQUUsQ0FBQztJQUVqRDtRQUNFLFlBQVk7UUFDWixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUV6QixPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRDs7T0FFRztJQUNLLGlCQUFpQjtRQUN2QixXQUFXO1FBQ1gsSUFBSSxDQUFDLGFBQWEsR0FBRztZQUNuQixLQUFLLEVBQ0gsK0lBQStJO1lBQ2pKLEtBQUssRUFDSCwrSUFBK0k7WUFDakosS0FBSyxFQUNILHdKQUF3SjtZQUMxSixPQUFPLEVBQ0wsd0pBQXdKO1lBQzFKLE9BQU8sRUFDTCwrSUFBK0k7WUFDakosTUFBTSxFQUNKLCtJQUErSTtTQUNsSixDQUFDO0lBQ0osQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxhQUFhLENBQUMsUUFBZ0IsRUFBRSxLQUFhO1FBQ2xELFFBQVE7UUFDUixNQUFNLGFBQWEsR0FBRyxHQUFHLFFBQVEsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUU3QyxZQUFZO1FBQ1osSUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUV0RCwyQkFBMkI7UUFDM0IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ25CLGFBQWEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsUUFBUSxLQUFLLENBQUMsQ0FBQztRQUN2RCxDQUFDO1FBRUQsdUJBQXVCO1FBQ3ZCLElBQUksQ0FBQyxhQUFhLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1lBQ3JELGFBQWEsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDO1FBRUQsSUFBSSxhQUFhLEVBQUUsQ0FBQztZQUNsQixTQUFTO1lBQ1QsQ0FBQyxDQUFDLHVCQUF1QixDQUFDLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLFFBQVEsYUFBYSxJQUFJLENBQUMsQ0FBQztZQUM3RSxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsYUFBYSxFQUFFLENBQUMsQ0FBQztRQUN6QyxDQUFDO2FBQU0sQ0FBQztZQUNOLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxhQUFhLEVBQUUsQ0FBQyxDQUFDO1lBQ3hDLFdBQVc7WUFDWCxDQUFDLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxHQUFHLENBQUM7Z0JBQzdCLGVBQWUsRUFBRSxNQUFNO2dCQUN2QixlQUFlLEVBQUUsU0FBUzthQUMzQixDQUFDLENBQUM7UUFDTCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxhQUFhLENBQUMsR0FBVyxFQUFFLEdBQVc7UUFDM0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDaEMsQ0FBQztJQUVEOzs7T0FHRztJQUNJLHFCQUFxQixDQUFDLE1BQWlDO1FBQzVELFVBQVU7UUFDVixDQUFDLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxXQUFXLENBQUMsc0NBQXNDLENBQUMsQ0FBQztRQUUvRSxJQUFJLE1BQU0sRUFBRSxDQUFDO1lBQ1gseUJBQXlCO1lBQ3pCLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBRXZDLFFBQVEsTUFBTSxFQUFFLENBQUM7Z0JBQ2YsS0FBSyxNQUFNO29CQUNULEdBQUcsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7b0JBQzVCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ3hCLE1BQU07Z0JBQ1IsS0FBSyxPQUFPO29CQUNWLEdBQUcsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUM7b0JBQzdCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQzNCLE1BQU07Z0JBQ1IsS0FBSyxNQUFNO29CQUNULEdBQUcsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7b0JBQzVCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztvQkFDbkMsTUFBTTtZQUNWLENBQUM7WUFFRCxhQUFhO1lBQ2IsVUFBVSxDQUFDLEdBQUcsRUFBRTtnQkFDZCxHQUFHLENBQUMsV0FBVyxDQUFDLFVBQVUsTUFBTSxFQUFFLENBQUMsQ0FBQztZQUN0QyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDWCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksb0JBQW9CO1FBQ3pCLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDcEMsQ0FBQztDQUNGIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gv5ri45oiP55WM6Z2iL3NjcmlwdHMvY29tcG9uZW50cy9iYWNrZ3JvdW5kTWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIOiDjOaZr+euoeeQhuWZqOe7hOS7tlxuICog6LSf6LSj566h55CG5ri45oiP5Lit55qE6IOM5pmv5Zu+54mH5pi+56S65ZKM5YiH5o2iXG4gKi9cblxuZXhwb3J0IGNsYXNzIEJhY2tncm91bmRNYW5hZ2VyIHtcbiAgLy8g6IOM5pmv5Zu+54mH5pig5bCEXG4gIHByaXZhdGUgYmFja2dyb3VuZE1hcDogXy5EaWN0aW9uYXJ5PHN0cmluZz4gPSB7fTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyDliJ3lp4vljJbog4zmma/lm77niYfmmKDlsIRcbiAgICB0aGlzLmluaXRCYWNrZ3JvdW5kTWFwKCk7XG5cbiAgICBjb25zb2xlLmxvZygn6IOM5pmv566h55CG5Zmo5Yid5aeL5YyW5a6M5oiQJyk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW6IOM5pmv5Zu+54mH5pig5bCEXG4gICAqL1xuICBwcml2YXRlIGluaXRCYWNrZ3JvdW5kTWFwKCkge1xuICAgIC8vIOiuvue9ruWfuuacrOiDjOaZr+aYoOWwhFxuICAgIHRoaXMuYmFja2dyb3VuZE1hcCA9IHtcbiAgICAgIOWFrOWbrV/nmb3lpKk6XG4gICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglODMlOEMlRTYlOTklQUYvJUU1JTg1JUFDJUU1JTlCJUFELyVFNyU5OSVCRCVFNSVBNCVBOS5qcGc/cmVmX3R5cGU9aGVhZHMnLFxuICAgICAg5YWs5ZutX+m7hOaYjzpcbiAgICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCU4MyU4QyVFNiU5OSVBRi8lRTUlODUlQUMlRTUlOUIlQUQvJUU5JUJCJTg0JUU2JTk4JThGLmpwZz9yZWZfdHlwZT1oZWFkcycsXG4gICAgICDkuablupdf5YaF6YOoOlxuICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JTgzJThDJUU2JTk5JUFGLyVFNCVCOSVBNiVFNSVCQSU5NyVFNSU4NiU4NS8lRTQlQjklQTYlRTUlQkElOTcuanBnP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgIOS/rumBk+mZol/lm77kuablrqQ6XG4gICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglODMlOEMlRTYlOTklQUYvJUU0JUI5JUE2JUU1JUJBJTk3JUU1JTg2JTg1LyVFNCVCOSVBNiVFNSVCQSU5Ny5qcGc/cmVmX3R5cGU9aGVhZHMnLFxuICAgICAg5L+u6YGT6ZmiX+WKnuWFrOWupDpcbiAgICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCU4MyU4QyVFNiU5OSVBRi8lRTUlODUlQUMlRTUlOUIlQUQvJUU5JUJCJTg0JUU2JTk4JThGLmpwZz9yZWZfdHlwZT1oZWFkcycsXG4gICAgICDkv67pgZPpmaJf6Iqx5ZutOlxuICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JTgzJThDJUU2JTk5JUFGLyVFNSU4NSVBQyVFNSU5QiVBRC8lRTclOTklQkQlRTUlQTQlQTkuanBnP3JlZl90eXBlPWhlYWRzJyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruiDjOaZr+WbvueJh1xuICAgKiBAcGFyYW0gbG9jYXRpb24g5L2N572uXG4gICAqIEBwYXJhbSBzY2VuZSDlnLrmma9cbiAgICovXG4gIHB1YmxpYyBzZXRCYWNrZ3JvdW5kKGxvY2F0aW9uOiBzdHJpbmcsIHNjZW5lOiBzdHJpbmcpIHtcbiAgICAvLyDnlJ/miJDog4zmma/plK5cbiAgICBjb25zdCBiYWNrZ3JvdW5kS2V5ID0gYCR7bG9jYXRpb259XyR7c2NlbmV9YDtcblxuICAgIC8vIOiOt+WPluiDjOaZr+WbvueJh1VSTFxuICAgIGxldCBiYWNrZ3JvdW5kVXJsID0gdGhpcy5iYWNrZ3JvdW5kTWFwW2JhY2tncm91bmRLZXldO1xuXG4gICAgLy8g5aaC5p6c5rKh5pyJ5om+5Yiw54m55a6a55qE6IOM5pmv77yM5bCd6K+V5L2/55So6K+l5L2N572u55qE6buY6K6k6IOM5pmvXG4gICAgaWYgKCFiYWNrZ3JvdW5kVXJsKSB7XG4gICAgICBiYWNrZ3JvdW5kVXJsID0gdGhpcy5iYWNrZ3JvdW5kTWFwW2Ake2xvY2F0aW9ufV/pu5jorqRgXTtcbiAgICB9XG5cbiAgICAvLyDlpoLmnpzov5jmmK/msqHmnInmib7liLDvvIzkvb/nlKjnrKzkuIDlvKDlm77niYfkvZzkuLrpu5jorqRcbiAgICBpZiAoIWJhY2tncm91bmRVcmwgJiYgIV8uaXNFbXB0eSh0aGlzLmJhY2tncm91bmRNYXApKSB7XG4gICAgICBiYWNrZ3JvdW5kVXJsID0gXy52YWx1ZXModGhpcy5iYWNrZ3JvdW5kTWFwKVswXTtcbiAgICB9XG5cbiAgICBpZiAoYmFja2dyb3VuZFVybCkge1xuICAgICAgLy8g6K6+572u6IOM5pmv5Zu+54mHXG4gICAgICAkKCcuYmFja2dyb3VuZC1jb250YWluZXInKS5jc3MoJ2JhY2tncm91bmRJbWFnZScsIGB1cmwoJyR7YmFja2dyb3VuZFVybH0nKWApO1xuICAgICAgY29uc29sZS5sb2coYOW3suiuvue9ruiDjOaZrzogJHtiYWNrZ3JvdW5kS2V5fWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oYOacquaJvuWIsOiDjOaZrzogJHtiYWNrZ3JvdW5kS2V5fWApO1xuICAgICAgLy8g6K6+572u6buY6K6k6IOM5pmv6aKc6ImyXG4gICAgICAkKCcuYmFja2dyb3VuZC1jb250YWluZXInKS5jc3Moe1xuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6ICdub25lJyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzJhMmEyYScsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg6IOM5pmv5Zu+54mH5pig5bCEXG4gICAqIEBwYXJhbSBrZXkg6IOM5pmv6ZSuXG4gICAqIEBwYXJhbSB1cmwg5Zu+54mHVVJMXG4gICAqL1xuICBwdWJsaWMgYWRkQmFja2dyb3VuZChrZXk6IHN0cmluZywgdXJsOiBzdHJpbmcpIHtcbiAgICB0aGlzLmJhY2tncm91bmRNYXBba2V5XSA9IHVybDtcbiAgfVxuXG4gIC8qKlxuICAgKiDlupTnlKjog4zmma/liIfmjaLnibnmlYhcbiAgICogQHBhcmFtIGVmZmVjdCDnibnmlYjlkI3np7BcbiAgICovXG4gIHB1YmxpYyBhcHBseUJhY2tncm91bmRFZmZlY3QoZWZmZWN0OiAnZmFkZScgfCAnc2xpZGUnIHwgJ3pvb20nKSB7XG4gICAgLy8g56e76Zmk5omA5pyJ54m55pWI57G7XG4gICAgJCgnLmJhY2tncm91bmQtY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ2VmZmVjdC1mYWRlIGVmZmVjdC1zbGlkZSBlZmZlY3Qtem9vbScpO1xuXG4gICAgaWYgKGVmZmVjdCkge1xuICAgICAgLy8g5re75Yqg5oyH5a6a54m55pWI57G75bm25L2/55SoalF1ZXJ5IFVJ55qE5pWI5p6cXG4gICAgICBjb25zdCAkYmcgPSAkKCcuYmFja2dyb3VuZC1jb250YWluZXInKTtcblxuICAgICAgc3dpdGNoIChlZmZlY3QpIHtcbiAgICAgICAgY2FzZSAnZmFkZSc6XG4gICAgICAgICAgJGJnLmFkZENsYXNzKCdlZmZlY3QtZmFkZScpO1xuICAgICAgICAgICRiZy5oaWRlKCkuZmFkZUluKDEwMDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzbGlkZSc6XG4gICAgICAgICAgJGJnLmFkZENsYXNzKCdlZmZlY3Qtc2xpZGUnKTtcbiAgICAgICAgICAkYmcuaGlkZSgpLnNsaWRlRG93bigxMDAwKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnem9vbSc6XG4gICAgICAgICAgJGJnLmFkZENsYXNzKCdlZmZlY3Qtem9vbScpO1xuICAgICAgICAgICRiZy5oaWRlKCkuc2hvdygnc2NhbGUnLCB7fSwgMTAwMCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIOS4gOauteaXtumXtOWQjuenu+mZpOeJueaViOexu1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICRiZy5yZW1vdmVDbGFzcyhgZWZmZWN0LSR7ZWZmZWN0fWApO1xuICAgICAgfSwgMTAwMCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieiDjOaZr+mUrlxuICAgKi9cbiAgcHVibGljIGdldEFsbEJhY2tncm91bmRLZXlzKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gXy5rZXlzKHRoaXMuYmFja2dyb3VuZE1hcCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/backgroundManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/characterManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CharacterManager: () => (/* binding */ CharacterManager)\n/* harmony export */ });\n/**\n * 角色管理器组件\n * 负责管理游戏中的角色立绘显示\n */\nclass CharacterManager {\n    // 角色资源服务\n    characterResourceService;\n    // 当前显示的角色\n    currentCharacters = {};\n    constructor(characterResourceService) {\n        this.characterResourceService = characterResourceService;\n        console.log('角色管理器初始化完成');\n    }\n    /**\n     * 设置角色立绘\n     * @param characterId 角色ID\n     * @param emotion 表情差分\n     * @param position 位置 ('left' 或 'right')\n     */\n    setCharacter(characterId, emotion = 'default', position) {\n        const $element = $(`.character-${position}`);\n        if ($element.length === 0) {\n            console.error(`未找到${position}侧角色容器元素`);\n            return;\n        }\n        // 获取角色资源\n        const character = this.characterResourceService.getCharacter(characterId);\n        if (!character) {\n            console.error(`未找到ID为${characterId}的角色资源`);\n            this.hideCharacter(position);\n            return;\n        }\n        // 获取对应表情的立绘URL\n        const imageUrl = this.characterResourceService.getCharacterEmotionUrl(characterId, emotion);\n        if (!imageUrl) {\n            console.error(`角色${characterId}没有${emotion}表情差分`);\n            // 尝试使用默认表情\n            const defaultImageUrl = this.characterResourceService.getCharacterEmotionUrl(characterId);\n            if (!defaultImageUrl) {\n                this.hideCharacter(position);\n                return;\n            }\n            // 使用默认表情\n            this.setCharacterImage($element, character, defaultImageUrl, position, 'default');\n        }\n        else {\n            // 使用指定表情\n            this.setCharacterImage($element, character, imageUrl, position, emotion);\n        }\n    }\n    /**\n     * 设置角色图像\n     */\n    setCharacterImage($element, character, imageUrl, position, emotion) {\n        // 设置角色立绘\n        $element\n            .css({\n            backgroundImage: `url('${imageUrl}')`,\n            opacity: 1,\n        })\n            .data({\n            characterId: character.id,\n            characterName: character.name,\n        });\n        // 存储当前显示的角色\n        this.currentCharacters[position] = {\n            id: character.id,\n            emotion: emotion,\n        };\n        console.log(`已设置${character.name}的${emotion}表情立绘在${position}侧`);\n    }\n    /**\n     * 更新角色表情\n     * @param characterId 角色ID\n     * @param emotion 表情差分\n     */\n    updateEmotion(characterId, emotion = 'default') {\n        // 查找角色当前在哪一侧\n        let position = null;\n        if (this.currentCharacters.left?.id === characterId) {\n            position = 'left';\n        }\n        else if (this.currentCharacters.right?.id === characterId) {\n            position = 'right';\n        }\n        if (!position) {\n            console.warn(`未找到ID为${characterId}的角色在场景中`);\n            return;\n        }\n        // 更新表情\n        this.setCharacter(characterId, emotion, position);\n    }\n    /**\n     * 隐藏角色立绘\n     * @param position 位置 ('left', 'right' 或 'all')\n     */\n    hideCharacter(position) {\n        if (position === 'left' || position === 'all') {\n            $('.character-left').css({\n                backgroundImage: 'none',\n                opacity: 0,\n            });\n            delete this.currentCharacters.left;\n        }\n        if (position === 'right' || position === 'all') {\n            $('.character-right').css({\n                backgroundImage: 'none',\n                opacity: 0,\n            });\n            delete this.currentCharacters.right;\n        }\n    }\n    /**\n     * 设置角色立绘特效\n     * @param position 位置 ('left' 或 'right')\n     * @param effect 特效名称 ('shake', 'focus', 'blur', 等)\n     */\n    setCharacterEffect(position, effect) {\n        const $element = $(`.character-${position}`);\n        if ($element.length === 0) {\n            console.error(`未找到${position}侧角色容器元素`);\n            return;\n        }\n        // 移除所有效果类\n        $element.removeClass('effect-shake effect-focus effect-blur');\n        // 添加指定效果类\n        if (effect) {\n            $element.addClass(`effect-${effect}`);\n            // 使用jQuery UI的效果\n            switch (effect) {\n                case 'shake':\n                    $element.effect('shake', { times: 3, distance: 5 }, 500);\n                    break;\n                case 'focus':\n                    $('.characters-container .character').not($element).animate({ opacity: 0.5 }, 500);\n                    $element.animate({ opacity: 1 }, 500);\n                    break;\n                case 'blur':\n                    $element.fadeOut(250).fadeIn(250);\n                    break;\n            }\n        }\n    }\n    /**\n     * 交换角色立绘位置\n     */\n    swapCharacters() {\n        const $leftChar = $('.character-left');\n        const $rightChar = $('.character-right');\n        if ($leftChar.length === 0 || $rightChar.length === 0)\n            return;\n        // 保存当前角色状态\n        const leftChar = this.currentCharacters.left;\n        const rightChar = this.currentCharacters.right;\n        // 如果两边都有角色，交换它们\n        if (leftChar && rightChar) {\n            this.setCharacter(rightChar.id, rightChar.emotion, 'left');\n            this.setCharacter(leftChar.id, leftChar.emotion, 'right');\n            // 添加过渡动画\n            $leftChar.add($rightChar).css('transition', 'all 0.5s ease-in-out');\n        }\n    }\n    /**\n     * 根据对话更新角色显示\n     * @param speakerId 发言角色ID\n     * @param emotion 表情差分\n     */\n    updateCharactersByDialogue(speakerId, emotion = 'default') {\n        // 如果是旁白，不更新角色\n        if (speakerId === 'narrator')\n            return;\n        // 获取角色资源\n        const character = this.characterResourceService.getCharacter(speakerId);\n        if (!character) {\n            // 对于未预定义的角色，不执行立绘更新\n            console.log(`未找到ID为${speakerId}的角色资源，跳过立绘更新`);\n            return;\n        }\n        // 检查角色是否已在场景中\n        let position = 'right'; // 默认位置\n        if (this.currentCharacters.left?.id === speakerId) {\n            position = 'left';\n        }\n        else if (this.currentCharacters.right?.id === speakerId) {\n            position = 'right';\n        }\n        else {\n            // 如果角色不在场景中，根据角色预设位置添加\n            if (character.position === 'left' || character.position === 'right') {\n                position = character.position;\n            }\n            // 添加角色到场景\n            this.setCharacter(speakerId, emotion, position);\n            return;\n        }\n        // 更新已在场景中的角色表情\n        this.updateEmotion(speakerId, emotion);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvY2hhcmFjdGVyTWFuYWdlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztHQUdHO0FBSUksTUFBTSxnQkFBZ0I7SUFDM0IsU0FBUztJQUNELHdCQUF3QixDQUEyQjtJQUUzRCxVQUFVO0lBQ0YsaUJBQWlCLEdBR3JCLEVBQUUsQ0FBQztJQUVQLFlBQVksd0JBQWtEO1FBQzVELElBQUksQ0FBQyx3QkFBd0IsR0FBRyx3QkFBd0IsQ0FBQztRQUN6RCxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLFlBQVksQ0FBQyxXQUFtQixFQUFFLFVBQXVCLFNBQVMsRUFBRSxRQUEwQjtRQUNuRyxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsY0FBYyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBRTdDLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUMxQixPQUFPLENBQUMsS0FBSyxDQUFDLE1BQU0sUUFBUSxTQUFTLENBQUMsQ0FBQztZQUN2QyxPQUFPO1FBQ1QsQ0FBQztRQUVELFNBQVM7UUFDVCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRTFFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsU0FBUyxXQUFXLE9BQU8sQ0FBQyxDQUFDO1lBQzNDLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0IsT0FBTztRQUNULENBQUM7UUFFRCxlQUFlO1FBQ2YsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLHNCQUFzQixDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUU1RixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDZCxP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TyxDQUFDLEdBQUcsQ0FBQyxTQUFTLFNBQVMsY0FBYyxDQUFDLENBQUM7WUFDOUMsT0FBTztRQUNULENBQUM7UUFFRCxjQUFjO1FBQ2QsSUFBSSxRQUFRLEdBQXFCLE9BQU8sQ0FBQyxDQUFDLE9BQU87UUFFakQsSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLEVBQUUsS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUNsRCxRQUFRLEdBQUcsTUFBTSxDQUFDO1FBQ3BCLENBQUM7YUFBTSxJQUFJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQzFELFFBQVEsR0FBRyxPQUFPLENBQUM7UUFDckIsQ0FBQzthQUFNLENBQUM7WUFDTix1QkFBdUI7WUFDdkIsSUFBSSxTQUFTLENBQUMsUUFBUSxLQUFLLE1BQU0sSUFBSSxTQUFTLENBQUMsUUFBUSxLQUFLLE9BQU8sRUFBRSxDQUFDO2dCQUNwRSxRQUFRLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQztZQUNoQyxDQUFDO1lBRUQsVUFBVTtZQUNWLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztZQUNoRCxPQUFPO1FBQ1QsQ0FBQztRQUVELGVBQWU7UUFDZixJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc2NyaXB0cy9jb21wb25lbnRzL2NoYXJhY3Rlck1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDop5LoibLnrqHnkIblmajnu4Tku7ZcbiAqIOi0n+i0o+euoeeQhua4uOaIj+S4reeahOinkuiJsueri+e7mOaYvuekulxuICovXG5cbmltcG9ydCB7IENoYXJhY3RlclJlc291cmNlLCBDaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2UsIEVtb3Rpb25UeXBlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvY2hhcmFjdGVyLXJlc291cmNlLnNlcnZpY2UnO1xuXG5leHBvcnQgY2xhc3MgQ2hhcmFjdGVyTWFuYWdlciB7XG4gIC8vIOinkuiJsui1hOa6kOacjeWKoVxuICBwcml2YXRlIGNoYXJhY3RlclJlc291cmNlU2VydmljZTogQ2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlO1xuXG4gIC8vIOW9k+WJjeaYvuekuueahOinkuiJslxuICBwcml2YXRlIGN1cnJlbnRDaGFyYWN0ZXJzOiB7XG4gICAgbGVmdD86IHsgaWQ6IHN0cmluZzsgZW1vdGlvbjogRW1vdGlvblR5cGUgfTtcbiAgICByaWdodD86IHsgaWQ6IHN0cmluZzsgZW1vdGlvbjogRW1vdGlvblR5cGUgfTtcbiAgfSA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yKGNoYXJhY3RlclJlc291cmNlU2VydmljZTogQ2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlKSB7XG4gICAgdGhpcy5jaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2UgPSBjaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2U7XG4gICAgY29uc29sZS5sb2coJ+inkuiJsueuoeeQhuWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruinkuiJsueri+e7mFxuICAgKiBAcGFyYW0gY2hhcmFjdGVySWQg6KeS6ImySURcbiAgICogQHBhcmFtIGVtb3Rpb24g6KGo5oOF5beu5YiGXG4gICAqIEBwYXJhbSBwb3NpdGlvbiDkvY3nva4gKCdsZWZ0JyDmiJYgJ3JpZ2h0JylcbiAgICovXG4gIHB1YmxpYyBzZXRDaGFyYWN0ZXIoY2hhcmFjdGVySWQ6IHN0cmluZywgZW1vdGlvbjogRW1vdGlvblR5cGUgPSAnZGVmYXVsdCcsIHBvc2l0aW9uOiAnbGVmdCcgfCAncmlnaHQnKSB7XG4gICAgY29uc3QgJGVsZW1lbnQgPSAkKGAuY2hhcmFjdGVyLSR7cG9zaXRpb259YCk7XG5cbiAgICBpZiAoJGVsZW1lbnQubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDmnKrmib7liLAke3Bvc2l0aW9ufeS+p+inkuiJsuWuueWZqOWFg+e0oGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOiOt+WPluinkuiJsui1hOa6kFxuICAgIGNvbnN0IGNoYXJhY3RlciA9IHRoaXMuY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlLmdldENoYXJhY3RlcihjaGFyYWN0ZXJJZCk7XG5cbiAgICBpZiAoIWNoYXJhY3Rlcikge1xuICAgICAgY29uc29sZS5lcnJvcihg5pyq5om+5YiwSUTkuLoke2NoYXJhY3RlcklkfeeahOinkuiJsui1hOa6kGApO1xuICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKHBvc2l0aW9uKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDojrflj5blr7nlupTooajmg4XnmoTnq4vnu5hVUkxcbiAgICBjb25zdCBpbWFnZVVybCA9IHRoaXMuY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlLmdldENoYXJhY3RlckVtb3Rpb25VcmwoY2hhcmFjdGVySWQsIGVtb3Rpb24pO1xuXG4gICAgaWYgKCFpbWFnZVVybCkge1xuICAgICAgY29uc29sZS5lcnJvcihg6KeS6ImyJHtjaGFyYWN0ZXJJZH3msqHmnIkke2Vtb3Rpb2596KGo5oOF5beu5YiGYCk7XG4gICAgICAvLyDlsJ3or5Xkvb/nlKjpu5jorqTooajmg4VcbiAgICAgIGNvbnN0IGRlZmF1bHRJbWFnZVVybCA9IHRoaXMuY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlLmdldENoYXJhY3RlckVtb3Rpb25VcmwoY2hhcmFjdGVySWQpO1xuICAgICAgaWYgKCFkZWZhdWx0SW1hZ2VVcmwpIHtcbiAgICAgICAgdGhpcy5oaWRlQ2hhcmFjdGVyKHBvc2l0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8g5L2/55So6buY6K6k6KGo5oOFXG4gICAgICB0aGlzLnNldENoYXJhY3RlckltYWdlKCRlbGVtZW50LCBjaGFyYWN0ZXIsIGRlZmF1bHRJbWFnZVVybCwgcG9zaXRpb24sICdkZWZhdWx0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOS9v+eUqOaMh+WumuihqOaDhVxuICAgICAgdGhpcy5zZXRDaGFyYWN0ZXJJbWFnZSgkZWxlbWVudCwgY2hhcmFjdGVyLCBpbWFnZVVybCwgcG9zaXRpb24sIGVtb3Rpb24pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7op5LoibLlm77lg49cbiAgICovXG4gIHByaXZhdGUgc2V0Q2hhcmFjdGVySW1hZ2UoXG4gICAgJGVsZW1lbnQ6IEpRdWVyeSxcbiAgICBjaGFyYWN0ZXI6IENoYXJhY3RlclJlc291cmNlLFxuICAgIGltYWdlVXJsOiBzdHJpbmcsXG4gICAgcG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcsXG4gICAgZW1vdGlvbjogRW1vdGlvblR5cGUsXG4gICkge1xuICAgIC8vIOiuvue9ruinkuiJsueri+e7mFxuICAgICRlbGVtZW50XG4gICAgICAuY3NzKHtcbiAgICAgICAgYmFja2dyb3VuZEltYWdlOiBgdXJsKCcke2ltYWdlVXJsfScpYCxcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgIH0pXG4gICAgICAuZGF0YSh7XG4gICAgICAgIGNoYXJhY3RlcklkOiBjaGFyYWN0ZXIuaWQsXG4gICAgICAgIGNoYXJhY3Rlck5hbWU6IGNoYXJhY3Rlci5uYW1lLFxuICAgICAgfSk7XG5cbiAgICAvLyDlrZjlgqjlvZPliY3mmL7npLrnmoTop5LoibJcbiAgICB0aGlzLmN1cnJlbnRDaGFyYWN0ZXJzW3Bvc2l0aW9uXSA9IHtcbiAgICAgIGlkOiBjaGFyYWN0ZXIuaWQsXG4gICAgICBlbW90aW9uOiBlbW90aW9uLFxuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZyhg5bey6K6+572uJHtjaGFyYWN0ZXIubmFtZX3nmoQke2Vtb3Rpb2596KGo5oOF56uL57uY5ZyoJHtwb3NpdGlvbn3kvqdgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDop5LoibLooajmg4VcbiAgICogQHBhcmFtIGNoYXJhY3RlcklkIOinkuiJsklEXG4gICAqIEBwYXJhbSBlbW90aW9uIOihqOaDheW3ruWIhlxuICAgKi9cbiAgcHVibGljIHVwZGF0ZUVtb3Rpb24oY2hhcmFjdGVySWQ6IHN0cmluZywgZW1vdGlvbjogRW1vdGlvblR5cGUgPSAnZGVmYXVsdCcpIHtcbiAgICAvLyDmn6Xmib7op5LoibLlvZPliY3lnKjlk6rkuIDkvqdcbiAgICBsZXQgcG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcgfCBudWxsID0gbnVsbDtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRDaGFyYWN0ZXJzLmxlZnQ/LmlkID09PSBjaGFyYWN0ZXJJZCkge1xuICAgICAgcG9zaXRpb24gPSAnbGVmdCc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRDaGFyYWN0ZXJzLnJpZ2h0Py5pZCA9PT0gY2hhcmFjdGVySWQpIHtcbiAgICAgIHBvc2l0aW9uID0gJ3JpZ2h0JztcbiAgICB9XG5cbiAgICBpZiAoIXBvc2l0aW9uKSB7XG4gICAgICBjb25zb2xlLndhcm4oYOacquaJvuWIsElE5Li6JHtjaGFyYWN0ZXJJZH3nmoTop5LoibLlnKjlnLrmma/kuK1gKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDmm7TmlrDooajmg4VcbiAgICB0aGlzLnNldENoYXJhY3RlcihjaGFyYWN0ZXJJZCwgZW1vdGlvbiwgcG9zaXRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIOmakOiXj+inkuiJsueri+e7mFxuICAgKiBAcGFyYW0gcG9zaXRpb24g5L2N572uICgnbGVmdCcsICdyaWdodCcg5oiWICdhbGwnKVxuICAgKi9cbiAgcHVibGljIGhpZGVDaGFyYWN0ZXIocG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcgfCAnYWxsJykge1xuICAgIGlmIChwb3NpdGlvbiA9PT0gJ2xlZnQnIHx8IHBvc2l0aW9uID09PSAnYWxsJykge1xuICAgICAgJCgnLmNoYXJhY3Rlci1sZWZ0JykuY3NzKHtcbiAgICAgICAgYmFja2dyb3VuZEltYWdlOiAnbm9uZScsXG4gICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICB9KTtcbiAgICAgIGRlbGV0ZSB0aGlzLmN1cnJlbnRDaGFyYWN0ZXJzLmxlZnQ7XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uID09PSAncmlnaHQnIHx8IHBvc2l0aW9uID09PSAnYWxsJykge1xuICAgICAgJCgnLmNoYXJhY3Rlci1yaWdodCcpLmNzcyh7XG4gICAgICAgIGJhY2tncm91bmRJbWFnZTogJ25vbmUnLFxuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgfSk7XG4gICAgICBkZWxldGUgdGhpcy5jdXJyZW50Q2hhcmFjdGVycy5yaWdodDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6+572u6KeS6Imy56uL57uY54m55pWIXG4gICAqIEBwYXJhbSBwb3NpdGlvbiDkvY3nva4gKCdsZWZ0JyDmiJYgJ3JpZ2h0JylcbiAgICogQHBhcmFtIGVmZmVjdCDnibnmlYjlkI3np7AgKCdzaGFrZScsICdmb2N1cycsICdibHVyJywg562JKVxuICAgKi9cbiAgcHVibGljIHNldENoYXJhY3RlckVmZmVjdChwb3NpdGlvbjogJ2xlZnQnIHwgJ3JpZ2h0JywgZWZmZWN0OiBzdHJpbmcpIHtcbiAgICBjb25zdCAkZWxlbWVudCA9ICQoYC5jaGFyYWN0ZXItJHtwb3NpdGlvbn1gKTtcblxuICAgIGlmICgkZWxlbWVudC5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOacquaJvuWIsCR7cG9zaXRpb2595L6n6KeS6Imy5a655Zmo5YWD57SgYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g56e76Zmk5omA5pyJ5pWI5p6c57G7XG4gICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2VmZmVjdC1zaGFrZSBlZmZlY3QtZm9jdXMgZWZmZWN0LWJsdXInKTtcblxuICAgIC8vIOa3u+WKoOaMh+WumuaViOaenOexu1xuICAgIGlmIChlZmZlY3QpIHtcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKGBlZmZlY3QtJHtlZmZlY3R9YCk7XG5cbiAgICAgIC8vIOS9v+eUqGpRdWVyeSBVSeeahOaViOaenFxuICAgICAgc3dpdGNoIChlZmZlY3QpIHtcbiAgICAgICAgY2FzZSAnc2hha2UnOlxuICAgICAgICAgICRlbGVtZW50LmVmZmVjdCgnc2hha2UnLCB7IHRpbWVzOiAzLCBkaXN0YW5jZTogNSB9LCA1MDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmb2N1cyc6XG4gICAgICAgICAgJCgnLmNoYXJhY3RlcnMtY29udGFpbmVyIC5jaGFyYWN0ZXInKS5ub3QoJGVsZW1lbnQpLmFuaW1hdGUoeyBvcGFjaXR5OiAwLjUgfSwgNTAwKTtcbiAgICAgICAgICAkZWxlbWVudC5hbmltYXRlKHsgb3BhY2l0eTogMSB9LCA1MDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdibHVyJzpcbiAgICAgICAgICAkZWxlbWVudC5mYWRlT3V0KDI1MCkuZmFkZUluKDI1MCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS6pOaNouinkuiJsueri+e7mOS9jee9rlxuICAgKi9cbiAgcHVibGljIHN3YXBDaGFyYWN0ZXJzKCkge1xuICAgIGNvbnN0ICRsZWZ0Q2hhciA9ICQoJy5jaGFyYWN0ZXItbGVmdCcpO1xuICAgIGNvbnN0ICRyaWdodENoYXIgPSAkKCcuY2hhcmFjdGVyLXJpZ2h0Jyk7XG5cbiAgICBpZiAoJGxlZnRDaGFyLmxlbmd0aCA9PT0gMCB8fCAkcmlnaHRDaGFyLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgLy8g5L+d5a2Y5b2T5YmN6KeS6Imy54q25oCBXG4gICAgY29uc3QgbGVmdENoYXIgPSB0aGlzLmN1cnJlbnRDaGFyYWN0ZXJzLmxlZnQ7XG4gICAgY29uc3QgcmlnaHRDaGFyID0gdGhpcy5jdXJyZW50Q2hhcmFjdGVycy5yaWdodDtcblxuICAgIC8vIOWmguaenOS4pOi+uemDveacieinkuiJsu+8jOS6pOaNouWug+S7rFxuICAgIGlmIChsZWZ0Q2hhciAmJiByaWdodENoYXIpIHtcbiAgICAgIHRoaXMuc2V0Q2hhcmFjdGVyKHJpZ2h0Q2hhci5pZCwgcmlnaHRDaGFyLmVtb3Rpb24sICdsZWZ0Jyk7XG4gICAgICB0aGlzLnNldENoYXJhY3RlcihsZWZ0Q2hhci5pZCwgbGVmdENoYXIuZW1vdGlvbiwgJ3JpZ2h0Jyk7XG5cbiAgICAgIC8vIOa3u+WKoOi/h+a4oeWKqOeUu1xuICAgICAgJGxlZnRDaGFyLmFkZCgkcmlnaHRDaGFyKS5jc3MoJ3RyYW5zaXRpb24nLCAnYWxsIDAuNXMgZWFzZS1pbi1vdXQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5qC55o2u5a+56K+d5pu05paw6KeS6Imy5pi+56S6XG4gICAqIEBwYXJhbSBzcGVha2VySWQg5Y+R6KiA6KeS6ImySURcbiAgICogQHBhcmFtIGVtb3Rpb24g6KGo5oOF5beu5YiGXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlQ2hhcmFjdGVyc0J5RGlhbG9ndWUoc3BlYWtlcklkOiBzdHJpbmcsIGVtb3Rpb246IEVtb3Rpb25UeXBlID0gJ2RlZmF1bHQnKSB7XG4gICAgLy8g5aaC5p6c5piv5peB55m977yM5LiN5pu05paw6KeS6ImyXG4gICAgaWYgKHNwZWFrZXJJZCA9PT0gJ25hcnJhdG9yJykgcmV0dXJuO1xuXG4gICAgLy8g6I635Y+W6KeS6Imy6LWE5rqQXG4gICAgY29uc3QgY2hhcmFjdGVyID0gdGhpcy5jaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2UuZ2V0Q2hhcmFjdGVyKHNwZWFrZXJJZCk7XG4gICAgaWYgKCFjaGFyYWN0ZXIpIHtcbiAgICAgIC8vIOWvueS6juacqumihOWumuS5ieeahOinkuiJsu+8jOS4jeaJp+ihjOeri+e7mOabtOaWsFxuICAgICAgY29uc29sZS5sb2coYOacquaJvuWIsElE5Li6JHtzcGVha2VySWR955qE6KeS6Imy6LWE5rqQ77yM6Lez6L+H56uL57uY5pu05pawYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5qOA5p+l6KeS6Imy5piv5ZCm5bey5Zyo5Zy65pmv5LitXG4gICAgbGV0IHBvc2l0aW9uOiAnbGVmdCcgfCAncmlnaHQnID0gJ3JpZ2h0JzsgLy8g6buY6K6k5L2N572uXG5cbiAgICBpZiAodGhpcy5jdXJyZW50Q2hhcmFjdGVycy5sZWZ0Py5pZCA9PT0gc3BlYWtlcklkKSB7XG4gICAgICBwb3NpdGlvbiA9ICdsZWZ0JztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudENoYXJhY3RlcnMucmlnaHQ/LmlkID09PSBzcGVha2VySWQpIHtcbiAgICAgIHBvc2l0aW9uID0gJ3JpZ2h0JztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5aaC5p6c6KeS6Imy5LiN5Zyo5Zy65pmv5Lit77yM5qC55o2u6KeS6Imy6aKE6K6+5L2N572u5re75YqgXG4gICAgICBpZiAoY2hhcmFjdGVyLnBvc2l0aW9uID09PSAnbGVmdCcgfHwgY2hhcmFjdGVyLnBvc2l0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICAgIHBvc2l0aW9uID0gY2hhcmFjdGVyLnBvc2l0aW9uO1xuICAgICAgfVxuXG4gICAgICAvLyDmt7vliqDop5LoibLliLDlnLrmma9cbiAgICAgIHRoaXMuc2V0Q2hhcmFjdGVyKHNwZWFrZXJJZCwgZW1vdGlvbiwgcG9zaXRpb24pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOabtOaWsOW3suWcqOWcuuaZr+S4reeahOinkuiJsuihqOaDhVxuICAgIHRoaXMudXBkYXRlRW1vdGlvbihzcGVha2VySWQsIGVtb3Rpb24pO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/characterManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/choiceManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChoiceManager: () => (/* binding */ ChoiceManager)\n/* harmony export */ });\n/**\n * 选项管理器组件\n * 负责管理游戏中的选项显示和处理\n */\nclass ChoiceManager {\n    // 选项数据\n    choices = [];\n    // 记录选项是否已经显示过\n    choicesShown = false;\n    // 是否已隐藏选项\n    choicesHidden = false;\n    // 选项选择回调\n    onChoiceSelectedCallback = null;\n    constructor() {\n        // 绑定自定义选项按钮事件\n        $('#custom-choice-button').on('click', () => {\n            const customChoice = $('#custom-choice-input').val();\n            if (customChoice && customChoice.trim()) {\n                this.selectChoice(customChoice.trim());\n                $('#custom-choice-input').val('');\n            }\n        });\n        // 绑定自定义选项输入框回车事件\n        $('#custom-choice-input').on('keypress', e => {\n            if (e.key === 'Enter') {\n                const customChoice = $('#custom-choice-input').val();\n                if (customChoice && customChoice.trim()) {\n                    this.selectChoice(customChoice.trim());\n                    $('#custom-choice-input').val('');\n                }\n            }\n        });\n        // 绑定隐藏按钮事件\n        $(document).on('click', '#hide-choices-btn', e => {\n            e.stopPropagation(); // 防止触发其他点击事件\n            this.hideChoices();\n        });\n        console.log('选项管理器初始化完成');\n    }\n    /**\n     * 设置选项列表\n     */\n    setChoices(choices) {\n        this.choices = choices;\n        this.choicesShown = false;\n        this.choicesHidden = false;\n    }\n    /**\n     * 渲染选项\n     */\n    renderChoices() {\n        const $presetChoices = $('.preset-choices');\n        if ($presetChoices.length === 0)\n            return;\n        // 清空现有选项\n        $presetChoices.empty();\n        // 渲染每个选项按钮，添加索引数据属性以便于样式控制\n        _.forEach(this.choices, (choice, index) => {\n            $('<button>', {\n                class: 'choice-button',\n                text: choice,\n                'data-index': index,\n                'data-choice': choice,\n                click: () => this.selectChoice(choice),\n            }).appendTo($presetChoices);\n        });\n        // 根据选项数量设置容器宽度和样式\n        const $choicesContainer = $('.choices-container');\n        if (this.choices.length <= 2) {\n            $choicesContainer.addClass('compact-choices');\n        }\n        else {\n            $choicesContainer.removeClass('compact-choices');\n        }\n    }\n    /**\n     * 显示选项\n     */\n    showChoices() {\n        const $choicesContainer = $('.choices-container');\n        const $presetChoices = $('.preset-choices');\n        if ($choicesContainer.length === 0 || $presetChoices.length === 0)\n            return;\n        // 渲染选项\n        this.renderChoices();\n        // 显示选项容器并添加动画效果\n        $choicesContainer.removeClass('hidden').hide().fadeIn(300);\n        // 标记选项已显示\n        this.choicesShown = true;\n        this.choicesHidden = false;\n        // 聚焦自定义输入框\n        setTimeout(() => {\n            $('#custom-choice-input').focus();\n        }, 300);\n    }\n    /**\n     * 隐藏选项\n     */\n    hideChoices() {\n        const self = this;\n        $('.choices-container').fadeOut(300, function () {\n            $(this).addClass('hidden').show();\n            // 标记选项已隐藏\n            self.choicesHidden = true;\n        });\n    }\n    /**\n     * 检查是否可以重新显示选项\n     */\n    canReshowChoices() {\n        return this.choicesShown && this.choicesHidden && this.choices.length > 0;\n    }\n    /**\n     * 重新显示上次的选项\n     */\n    reshowChoices() {\n        if (this.canReshowChoices()) {\n            this.showChoices();\n        }\n    }\n    /**\n     * 选择选项\n     */\n    selectChoice(choice) {\n        // 调用选择回调\n        if (this.onChoiceSelectedCallback) {\n            this.onChoiceSelectedCallback(choice);\n        }\n        // 隐藏选项\n        this.hideChoices();\n    }\n    /**\n     * 设置选项选择回调\n     */\n    setOnChoiceSelected(callback) {\n        this.onChoiceSelectedCallback = callback;\n    }\n    /**\n     * 添加选项\n     */\n    addChoice(choice) {\n        if (!_.includes(this.choices, choice)) {\n            this.choices.push(choice);\n            // 如果选项容器已显示，更新选项\n            if (!$('.choices-container').hasClass('hidden')) {\n                this.renderChoices();\n            }\n        }\n    }\n    /**\n     * 移除选项\n     */\n    removeChoice(choice) {\n        _.pull(this.choices, choice);\n        // 如果选项容器已显示，更新选项\n        if (!$('.choices-container').hasClass('hidden')) {\n            this.renderChoices();\n        }\n    }\n    /**\n     * 清空所有选项\n     */\n    clearChoices() {\n        this.choices = [];\n        // 如果选项容器已显示，更新选项\n        if (!$('.choices-container').hasClass('hidden')) {\n            this.renderChoices();\n        }\n    }\n    /**\n     * 获取所有选项\n     */\n    getAllChoices() {\n        return _.clone(this.choices);\n    }\n    /**\n     * 检查选项当前是否可见\n     * @returns 选项是否可见\n     */\n    areChoicesVisible() {\n        // 如果选项已显示且未被隐藏，则认为选项当前可见\n        return this.choicesShown && !this.choicesHidden;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvY2hvaWNlTWFuYWdlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztHQUdHO0FBRUksTUFBTSxhQUFhO0lBQ3hCLE9BQU87SUFDQyxPQUFPLEdBQWEsRUFBRSxDQUFDO0lBRS9CLGNBQWM7SUFDTixZQUFZLEdBQVksS0FBSyxDQUFDO0lBRXRDLFVBQVU7SUFDRixhQUFhLEdBQVksS0FBSyxDQUFDO0lBRXZDLFNBQVM7SUFDRCx3QkFBd0IsR0FBc0MsSUFBSSxDQUFDO0lBRTNFO1FBQ0UsY0FBYztRQUNkLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1lBQzFDLE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLEdBQUcsRUFBWSxDQUFDO1lBQy9ELElBQUksWUFBWSxJQUFJLFlBQVksQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO2dCQUN4QyxJQUFJLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO2dCQUN2QyxDQUFDLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDcEMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsaUJBQWlCO1FBQ2pCLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLEVBQUU7WUFDM0MsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLE9BQU8sRUFBRSxDQUFDO2dCQUN0QixNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxHQUFHLEVBQVksQ0FBQztnQkFDL0QsSUFBSSxZQUFZLElBQUksWUFBWSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUM7b0JBQ3hDLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFD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QkFBaUI7WUFDakIsSUFBSSxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO2dCQUNoRCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDdkIsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsTUFBYztRQUNoQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFN0IsaUJBQWlCO1FBQ2pCLElBQUksQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUNoRCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDdkIsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLFlBQVk7UUFDakIsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFFbEIsaUJBQWlCO1FBQ2pCLElBQUksQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUNoRCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDdkIsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLGFBQWE7UUFDbEIsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksaUJBQWlCO1FBQ3RCLHlCQUF5QjtRQUN6QixPQUFPLElBQUksQ0FBQyxZQUFZLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQ2xELENBQUM7Q0FDRiIsInNvdXJjZXMiOlsic3JjOi8vdGF2ZXJuX2hlbHBlcl90ZW1wbGF0ZS9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvY2hvaWNlTWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIOmAiemhueeuoeeQhuWZqOe7hOS7tlxuICog6LSf6LSj566h55CG5ri45oiP5Lit55qE6YCJ6aG55pi+56S65ZKM5aSE55CGXG4gKi9cblxuZXhwb3J0IGNsYXNzIENob2ljZU1hbmFnZXIge1xuICAvLyDpgInpobnmlbDmja5cbiAgcHJpdmF0ZSBjaG9pY2VzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIC8vIOiusOW9lemAiemhueaYr+WQpuW3sue7j+aYvuekuui/h1xuICBwcml2YXRlIGNob2ljZXNTaG93bjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8vIOaYr+WQpuW3sumakOiXj+mAiemhuVxuICBwcml2YXRlIGNob2ljZXNIaWRkZW46IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvLyDpgInpobnpgInmi6nlm57osINcbiAgcHJpdmF0ZSBvbkNob2ljZVNlbGVjdGVkQ2FsbGJhY2s6ICgoY2hvaWNlOiBzdHJpbmcpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8g57uR5a6a6Ieq5a6a5LmJ6YCJ6aG55oyJ6ZKu5LqL5Lu2XG4gICAgJCgnI2N1c3RvbS1jaG9pY2UtYnV0dG9uJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgY3VzdG9tQ2hvaWNlID0gJCgnI2N1c3RvbS1jaG9pY2UtaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBpZiAoY3VzdG9tQ2hvaWNlICYmIGN1c3RvbUNob2ljZS50cmltKCkpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RDaG9pY2UoY3VzdG9tQ2hvaWNlLnRyaW0oKSk7XG4gICAgICAgICQoJyNjdXN0b20tY2hvaWNlLWlucHV0JykudmFsKCcnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIOe7keWumuiHquWumuS5iemAiemhuei+k+WFpeahhuWbnui9puS6i+S7tlxuICAgICQoJyNjdXN0b20tY2hvaWNlLWlucHV0Jykub24oJ2tleXByZXNzJywgZSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgY29uc3QgY3VzdG9tQ2hvaWNlID0gJCgnI2N1c3RvbS1jaG9pY2UtaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICAgIGlmIChjdXN0b21DaG9pY2UgJiYgY3VzdG9tQ2hvaWNlLnRyaW0oKSkge1xuICAgICAgICAgIHRoaXMuc2VsZWN0Q2hvaWNlKGN1c3RvbUNob2ljZS50cmltKCkpO1xuICAgICAgICAgICQoJyNjdXN0b20tY2hvaWNlLWlucHV0JykudmFsKCcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g57uR5a6a6ZqQ6JeP5oyJ6ZKu5LqL5Lu2XG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNoaWRlLWNob2ljZXMtYnRuJywgZSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOyAvLyDpmLLmraLop6blj5Hlhbbku5bngrnlh7vkuovku7ZcbiAgICAgIHRoaXMuaGlkZUNob2ljZXMoKTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCfpgInpobnnrqHnkIblmajliJ3lp4vljJblrozmiJAnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7pgInpobnliJfooahcbiAgICovXG4gIHB1YmxpYyBzZXRDaG9pY2VzKGNob2ljZXM6IHN0cmluZ1tdKSB7XG4gICAgdGhpcy5jaG9pY2VzID0gY2hvaWNlcztcbiAgICB0aGlzLmNob2ljZXNTaG93biA9IGZhbHNlO1xuICAgIHRoaXMuY2hvaWNlc0hpZGRlbiA9IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+mAiemhuVxuICAgKi9cbiAgcHVibGljIHJlbmRlckNob2ljZXMoKSB7XG4gICAgY29uc3QgJHByZXNldENob2ljZXMgPSAkKCcucHJlc2V0LWNob2ljZXMnKTtcbiAgICBpZiAoJHByZXNldENob2ljZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICAvLyDmuIXnqbrnjrDmnInpgInpoblcbiAgICAkcHJlc2V0Q2hvaWNlcy5lbXB0eSgpO1xuXG4gICAgLy8g5riy5p+T5q+P5Liq6YCJ6aG55oyJ6ZKu77yM5re75Yqg57Si5byV5pWw5o2u5bGe5oCn5Lul5L6/5LqO5qC35byP5o6n5Yi2XG4gICAgXy5mb3JFYWNoKHRoaXMuY2hvaWNlcywgKGNob2ljZSwgaW5kZXgpID0+IHtcbiAgICAgICQoJzxidXR0b24+Jywge1xuICAgICAgICBjbGFzczogJ2Nob2ljZS1idXR0b24nLFxuICAgICAgICB0ZXh0OiBjaG9pY2UsXG4gICAgICAgICdkYXRhLWluZGV4JzogaW5kZXgsXG4gICAgICAgICdkYXRhLWNob2ljZSc6IGNob2ljZSxcbiAgICAgICAgY2xpY2s6ICgpID0+IHRoaXMuc2VsZWN0Q2hvaWNlKGNob2ljZSksXG4gICAgICB9KS5hcHBlbmRUbygkcHJlc2V0Q2hvaWNlcyk7XG4gICAgfSk7XG5cbiAgICAvLyDmoLnmja7pgInpobnmlbDph4/orr7nva7lrrnlmajlrr3luqblkozmoLflvI9cbiAgICBjb25zdCAkY2hvaWNlc0NvbnRhaW5lciA9ICQoJy5jaG9pY2VzLWNvbnRhaW5lcicpO1xuICAgIGlmICh0aGlzLmNob2ljZXMubGVuZ3RoIDw9IDIpIHtcbiAgICAgICRjaG9pY2VzQ29udGFpbmVyLmFkZENsYXNzKCdjb21wYWN0LWNob2ljZXMnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGNob2ljZXNDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2NvbXBhY3QtY2hvaWNlcycpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrpgInpoblcbiAgICovXG4gIHB1YmxpYyBzaG93Q2hvaWNlcygpIHtcbiAgICBjb25zdCAkY2hvaWNlc0NvbnRhaW5lciA9ICQoJy5jaG9pY2VzLWNvbnRhaW5lcicpO1xuICAgIGNvbnN0ICRwcmVzZXRDaG9pY2VzID0gJCgnLnByZXNldC1jaG9pY2VzJyk7XG5cbiAgICBpZiAoJGNob2ljZXNDb250YWluZXIubGVuZ3RoID09PSAwIHx8ICRwcmVzZXRDaG9pY2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgLy8g5riy5p+T6YCJ6aG5XG4gICAgdGhpcy5yZW5kZXJDaG9pY2VzKCk7XG5cbiAgICAvLyDmmL7npLrpgInpobnlrrnlmajlubbmt7vliqDliqjnlLvmlYjmnpxcbiAgICAkY2hvaWNlc0NvbnRhaW5lci5yZW1vdmVDbGFzcygnaGlkZGVuJykuaGlkZSgpLmZhZGVJbigzMDApO1xuXG4gICAgLy8g5qCH6K6w6YCJ6aG55bey5pi+56S6XG4gICAgdGhpcy5jaG9pY2VzU2hvd24gPSB0cnVlO1xuICAgIHRoaXMuY2hvaWNlc0hpZGRlbiA9IGZhbHNlO1xuXG4gICAgLy8g6IGa54Sm6Ieq5a6a5LmJ6L6T5YWl5qGGXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAkKCcjY3VzdG9tLWNob2ljZS1pbnB1dCcpLmZvY3VzKCk7XG4gICAgfSwgMzAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpmpDol4/pgInpoblcbiAgICovXG4gIHB1YmxpYyBoaWRlQ2hvaWNlcygpIHtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAkKCcuY2hvaWNlcy1jb250YWluZXInKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlkZGVuJykuc2hvdygpO1xuICAgICAgLy8g5qCH6K6w6YCJ6aG55bey6ZqQ6JePXG4gICAgICBzZWxmLmNob2ljZXNIaWRkZW4gPSB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeaYr+WQpuWPr+S7pemHjeaWsOaYvuekuumAiemhuVxuICAgKi9cbiAgcHVibGljIGNhblJlc2hvd0Nob2ljZXMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY2hvaWNlc1Nob3duICYmIHRoaXMuY2hvaWNlc0hpZGRlbiAmJiB0aGlzLmNob2ljZXMubGVuZ3RoID4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiDph43mlrDmmL7npLrkuIrmrKHnmoTpgInpoblcbiAgICovXG4gIHB1YmxpYyByZXNob3dDaG9pY2VzKCkge1xuICAgIGlmICh0aGlzLmNhblJlc2hvd0Nob2ljZXMoKSkge1xuICAgICAgdGhpcy5zaG93Q2hvaWNlcygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDpgInmi6npgInpoblcbiAgICovXG4gIHByaXZhdGUgc2VsZWN0Q2hvaWNlKGNob2ljZTogc3RyaW5nKSB7XG4gICAgLy8g6LCD55So6YCJ5oup5Zue6LCDXG4gICAgaWYgKHRoaXMub25DaG9pY2VTZWxlY3RlZENhbGxiYWNrKSB7XG4gICAgICB0aGlzLm9uQ2hvaWNlU2VsZWN0ZWRDYWxsYmFjayhjaG9pY2UpO1xuICAgIH1cblxuICAgIC8vIOmakOiXj+mAiemhuVxuICAgIHRoaXMuaGlkZUNob2ljZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7pgInpobnpgInmi6nlm57osINcbiAgICovXG4gIHB1YmxpYyBzZXRPbkNob2ljZVNlbGVjdGVkKGNhbGxiYWNrOiAoY2hvaWNlOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICB0aGlzLm9uQ2hvaWNlU2VsZWN0ZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOmAiemhuVxuICAgKi9cbiAgcHVibGljIGFkZENob2ljZShjaG9pY2U6IHN0cmluZykge1xuICAgIGlmICghXy5pbmNsdWRlcyh0aGlzLmNob2ljZXMsIGNob2ljZSkpIHtcbiAgICAgIHRoaXMuY2hvaWNlcy5wdXNoKGNob2ljZSk7XG5cbiAgICAgIC8vIOWmguaenOmAiemhueWuueWZqOW3suaYvuekuu+8jOabtOaWsOmAiemhuVxuICAgICAgaWYgKCEkKCcuY2hvaWNlcy1jb250YWluZXInKS5oYXNDbGFzcygnaGlkZGVuJykpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJDaG9pY2VzKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOenu+mZpOmAiemhuVxuICAgKi9cbiAgcHVibGljIHJlbW92ZUNob2ljZShjaG9pY2U6IHN0cmluZykge1xuICAgIF8ucHVsbCh0aGlzLmNob2ljZXMsIGNob2ljZSk7XG5cbiAgICAvLyDlpoLmnpzpgInpobnlrrnlmajlt7LmmL7npLrvvIzmm7TmlrDpgInpoblcbiAgICBpZiAoISQoJy5jaG9pY2VzLWNvbnRhaW5lcicpLmhhc0NsYXNzKCdoaWRkZW4nKSkge1xuICAgICAgdGhpcy5yZW5kZXJDaG9pY2VzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4heepuuaJgOaciemAiemhuVxuICAgKi9cbiAgcHVibGljIGNsZWFyQ2hvaWNlcygpIHtcbiAgICB0aGlzLmNob2ljZXMgPSBbXTtcblxuICAgIC8vIOWmguaenOmAiemhueWuueWZqOW3suaYvuekuu+8jOabtOaWsOmAiemhuVxuICAgIGlmICghJCgnLmNob2ljZXMtY29udGFpbmVyJykuaGFzQ2xhc3MoJ2hpZGRlbicpKSB7XG4gICAgICB0aGlzLnJlbmRlckNob2ljZXMoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ6YCJ6aG5XG4gICAqL1xuICBwdWJsaWMgZ2V0QWxsQ2hvaWNlcygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIF8uY2xvbmUodGhpcy5jaG9pY2VzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6XpgInpobnlvZPliY3mmK/lkKblj6/op4FcbiAgICogQHJldHVybnMg6YCJ6aG55piv5ZCm5Y+v6KeBXG4gICAqL1xuICBwdWJsaWMgYXJlQ2hvaWNlc1Zpc2libGUoKTogYm9vbGVhbiB7XG4gICAgLy8g5aaC5p6c6YCJ6aG55bey5pi+56S65LiU5pyq6KKr6ZqQ6JeP77yM5YiZ6K6k5Li66YCJ6aG55b2T5YmN5Y+v6KeBXG4gICAgcmV0dXJuIHRoaXMuY2hvaWNlc1Nob3duICYmICF0aGlzLmNob2ljZXNIaWRkZW47XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/choiceManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/dialogueManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DialogueManager: () => (/* binding */ DialogueManager)\n/* harmony export */ });\n/**\n * 对话管理器组件\n * 负责管理游戏中的对话显示、控制和效果\n */\nclass DialogueManager {\n    // 对话数据\n    dialogues = [];\n    currentDialogueIndex = 0;\n    // 服务引用\n    characterResourceService;\n    characterManager;\n    backgroundManager;\n    // 自动播放设置\n    isAutoPlaying = false;\n    autoPlayInterval = null;\n    autoPlaySpeed = 3000; // 毫秒\n    constructor(characterResourceService, characterManager, backgroundManager) {\n        this.characterResourceService = characterResourceService;\n        this.characterManager = characterManager;\n        this.backgroundManager = backgroundManager;\n        // 绑定自动播放按钮\n        $('#auto-play').on('click', () => {\n            this.toggleAutoPlay();\n        });\n        // 不再需要绑定下一步按钮，改为在GameController中绑定对话框点击\n        // $('.dialogue-next-button').on('click', () => {\n        //   this.showNextDialogue();\n        // });\n        console.log('对话管理器初始化完成');\n    }\n    /**\n     * 设置对话列表\n     */\n    setDialogues(dialogues) {\n        this.dialogues = dialogues;\n        this.currentDialogueIndex = 0;\n    }\n    /**\n     * 显示特定索引的对话\n     */\n    showDialogue(index) {\n        if (index < 0 || index >= this.dialogues.length) {\n            console.error('无效的对话索引');\n            return;\n        }\n        // 更新当前索引\n        this.currentDialogueIndex = index;\n        const dialogue = this.dialogues[index];\n        // 更新发言人名称 - 直接使用speaker属性，不做处理\n        const speakerName = dialogue.speaker;\n        $('.speaker-name').text(speakerName);\n        // 创建新对话文本元素\n        const $dialogueText = $('<div>', {\n            class: `dialogue-text style-${dialogue.style || 'normal'}`,\n            text: dialogue.content,\n        });\n        // 清空并添加新内容\n        $('.dialogue-content').empty().append($dialogueText);\n        // 滚动到底部\n        $('.dialogue-content').scrollTop($('.dialogue-content')[0].scrollHeight);\n        // 更新角色立绘\n        this.updateCharacterDisplay(dialogue);\n        // 更新背景（如果有指定）\n        this.updateBackground(dialogue);\n    }\n    /**\n     * 更新角色立绘显示\n     */\n    updateCharacterDisplay(dialogue) {\n        // 如果对话没有指定portrait，尝试使用默认规则\n        if (!dialogue.portrait) {\n            // 判断角色是否在预设名单中\n            const character = this.characterResourceService.getCharacter(dialogue.speaker);\n            if (character) {\n                // 如果是预设角色，按原有逻辑显示\n                this.characterManager.updateCharactersByDialogue(dialogue.speaker, 'default');\n            }\n            else {\n                // 如果不是预设角色，只显示名字，不显示立绘\n                this.characterManager.hideCharacter('all');\n            }\n            return;\n        }\n        // 如果有指定portrait，使用指定的角色和表情\n        const { character, emotion } = dialogue.portrait;\n        // 判断这个角色在左边还是右边\n        let position = 'right'; // 默认右侧\n        // 尝试获取角色资源来确定位置\n        const characterResource = this.characterResourceService.getCharacter(character);\n        if (characterResource && characterResource.position) {\n            position = characterResource.position;\n        }\n        // 设置角色立绘\n        this.characterManager.setCharacter(character, emotion, position);\n    }\n    /**\n     * 更新背景显示\n     */\n    updateBackground(dialogue) {\n        // 如果对话指定了背景，则更新背景\n        if (dialogue.background) {\n            const { location, scene } = dialogue.background;\n            this.backgroundManager.setBackground(location, scene);\n        }\n    }\n    /**\n     * 显示下一条对话\n     */\n    showNextDialogue() {\n        if (this.currentDialogueIndex < this.dialogues.length - 1) {\n            this.showDialogue(this.currentDialogueIndex + 1);\n            return true;\n        }\n        return false; // 没有更多对话了\n    }\n    /**\n     * 显示上一条对话\n     */\n    showPreviousDialogue() {\n        if (this.currentDialogueIndex > 0) {\n            this.showDialogue(this.currentDialogueIndex - 1);\n            return true;\n        }\n        return false; // 已经是第一条对话\n    }\n    /**\n     * 渲染对话内容\n     * 用于初始化或重新渲染对话界面\n     */\n    renderDialogue(index = this.currentDialogueIndex) {\n        this.showDialogue(index);\n    }\n    /**\n     * 添加新对话\n     */\n    addDialogue(dialogue) {\n        this.dialogues.push(dialogue);\n        // 如果添加的是第一条对话，则显示它\n        if (this.dialogues.length === 1) {\n            this.renderDialogue(0);\n        }\n    }\n    /**\n     * 清空所有对话\n     */\n    clearDialogues() {\n        this.dialogues = [];\n        this.currentDialogueIndex = 0;\n        // 清空对话内容\n        $('.dialogue-content').empty();\n        $('.speaker-name').text('');\n        // 清空角色显示\n        this.characterManager.hideCharacter('all');\n    }\n    /**\n     * 切换自动播放\n     */\n    toggleAutoPlay() {\n        this.isAutoPlaying = !this.isAutoPlaying;\n        // 获取自动播放按钮\n        const $autoPlayButton = $('#auto-play');\n        if (this.isAutoPlaying) {\n            // 启动自动播放\n            this.autoPlayInterval = window.setInterval(() => {\n                const hasMoreDialogue = this.showNextDialogue();\n                if (!hasMoreDialogue) {\n                    // 没有更多对话了，停止自动播放\n                    this.stopAutoPlay();\n                }\n            }, this.autoPlaySpeed);\n            // 更新按钮样式\n            $autoPlayButton.addClass('active').html('<i class=\"fas fa-pause\"></i>');\n        }\n        else {\n            // 停止自动播放\n            this.stopAutoPlay();\n            // 更新按钮样式\n            $autoPlayButton.removeClass('active').html('<i class=\"fas fa-play\"></i>');\n        }\n    }\n    /**\n     * 停止自动播放\n     */\n    stopAutoPlay() {\n        if (this.autoPlayInterval !== null) {\n            clearInterval(this.autoPlayInterval);\n            this.autoPlayInterval = null;\n        }\n        this.isAutoPlaying = false;\n        // 更新按钮样式\n        $('#auto-play').removeClass('active').html('<i class=\"fas fa-play\"></i>');\n    }\n    /**\n     * 设置自动播放速度\n     */\n    setAutoPlaySpeed(speed) {\n        this.autoPlaySpeed = speed;\n        // 如果自动播放正在进行，重启它以应用新速度\n        if (this.isAutoPlaying) {\n            this.stopAutoPlay();\n            this.toggleAutoPlay();\n        }\n    }\n    /**\n     * 获取当前对话\n     */\n    getCurrentDialogue() {\n        if (this.currentDialogueIndex >= 0 && this.currentDialogueIndex < this.dialogues.length) {\n            return this.dialogues[this.currentDialogueIndex];\n        }\n        return null;\n    }\n    /**\n     * 获取所有对话\n     */\n    getAllDialogues() {\n        return _.cloneDeep(this.dialogues);\n    }\n    /**\n     * 显示对话历史记录\n     * @param externalDialogues 可选的外部对话历史数据\n     */\n    showDialogueHistory(externalDialogues) {\n        // 保存当前索引\n        const currentIndex = this.currentDialogueIndex;\n        // 显示所有对话\n        const $dialogueContent = $('.dialogue-content');\n        $dialogueContent.empty();\n        // 决定使用哪个对话历史数据源\n        const dialoguesToShow = externalDialogues || this.dialogues;\n        // 使用lodash遍历对话\n        _.forEach(dialoguesToShow, (dialogue, index) => {\n            // 创建对话项容器\n            const $dialogueItem = $('<div>', {\n                class: 'dialogue-history-item',\n                'data-index': index,\n            });\n            // 创建发言人元素\n            const $speakerName = $('<div>', {\n                class: 'speaker-name-history',\n                text: dialogue.speaker,\n            });\n            // 创建对话内容元素\n            const $dialogueText = $('<div>', {\n                class: `dialogue-text-history style-${dialogue.style || 'normal'}`,\n                text: dialogue.content,\n            });\n            // 添加到容器\n            $dialogueItem.append($speakerName).append($dialogueText);\n            // 添加到对话内容区域\n            $dialogueContent.append($dialogueItem);\n        });\n        // 显示历史记录模式通知\n        $('#dialogue-history-notice').show();\n        // 添加\"返回\"按钮\n        const $returnButton = $('<button>', {\n            id: 'return-from-history',\n            class: 'btn btn-primary',\n            text: '返回对话',\n            click: () => {\n                // 隐藏通知\n                $('#dialogue-history-notice').hide();\n                // 移除历史记录样式\n                $dialogueContent.removeClass('history-mode');\n                // 渲染当前对话\n                this.renderDialogue(currentIndex);\n            },\n        });\n        // 添加返回按钮\n        $dialogueContent.append($returnButton);\n        // 添加历史记录样式\n        $dialogueContent.addClass('history-mode');\n    }\n    /**\n     * 获取当前对话索引\n     */\n    getCurrentDialogueIndex() {\n        return this.currentDialogueIndex;\n    }\n    /**\n     * 对话是否已结束\n     */\n    isDialogueFinished() {\n        return this.currentDialogueIndex >= this.dialogues.length - 1;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvZGlhbG9ndWVNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0dBR0c7QUF5QkksTUFBTSxlQUFlO0lBQzFCLE9BQU87SUFDQyxTQUFTLEdBQWUsRUFBRSxDQUFDO0lBQzNCLG9CQUFvQixHQUFXLENBQUMsQ0FBQztJQUV6QyxPQUFPO0lBQ0Msd0JBQXdCLENBQTJCO0lBQ25ELGdCQUFnQixDQUFtQjtJQUNuQyxpQkFBaUIsQ0FBb0I7SUFFN0MsU0FBUztJQUNELGFBQWEsR0FBWSxLQUFLLENBQUM7SUFDL0IsZ0JBQWdCLEdBQWtCLElBQUksQ0FBQztJQUN2QyxhQUFhLEdBQVcsSUFBSSxDQUFDLENBQUMsS0FBSztJQUUzQyxZQUNFLHdCQUFrRCxFQUNsRCxnQkFBa0MsRUFDbEMsaUJBQW9DO1FBRXBDLElBQUksQ0FBQyx3QkFBd0IsR0FBRyx3QkFBd0IsQ0FBQztRQUN6RCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7UUFDekMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDO1FBRTNDLFdBQVc7UUFDWCxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDL0IsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3hCLENBQUMsQ0FBQyxDQUFDO1FBRUgsd0NBQXdDO1FBQ3hDLGlEQUFpRDtRQUNqRCw2QkFBNkI7UUFDN0IsTUFBTTtRQUVOLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVEOztPQUVHO0lBQ0ksWUFBWSxDQUFDLFNBQXFCO1FBQ3ZDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksWUFBWSxDQUFD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LEtBQUssRUFBRSxHQUFHLEVBQUU7Z0JBQ1YsT0FBTztnQkFDUCxDQUFDLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQkFDckMsV0FBVztnQkFDWCxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQzdDLFNBQVM7Z0JBQ1QsSUFBSSxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNwQyxDQUFDO1NBQ0YsQ0FBQyxDQUFDO1FBRUgsU0FBUztRQUNULGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUV2QyxXQUFXO1FBQ1gsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7T0FFRztJQUNJLHVCQUF1QjtRQUM1QixPQUFPLElBQUksQ0FBQyxvQkFBb0IsQ0FBQztJQUNuQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxrQkFBa0I7UUFDdkIsT0FBTyxJQUFJLENBQUMsb0JBQW9CLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsic3JjOi8vdGF2ZXJuX2hlbHBlcl90ZW1wbGF0ZS9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvZGlhbG9ndWVNYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5a+56K+d566h55CG5Zmo57uE5Lu2XG4gKiDotJ/otKPnrqHnkIbmuLjmiI/kuK3nmoTlr7nor53mmL7npLrjgIHmjqfliLblkozmlYjmnpxcbiAqL1xuXG5pbXBvcnQgeyBDaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jaGFyYWN0ZXItcmVzb3VyY2Uuc2VydmljZSc7XG5pbXBvcnQgeyBEaWFsb2d1ZSwgRW1vdGlvblR5cGUgfSBmcm9tICcuLi9tb2RlbHMvZ2FtZURhdGEnO1xuaW1wb3J0IHsgQmFja2dyb3VuZE1hbmFnZXIgfSBmcm9tICcuL2JhY2tncm91bmRNYW5hZ2VyJztcbmltcG9ydCB7IENoYXJhY3Rlck1hbmFnZXIgfSBmcm9tICcuL2NoYXJhY3Rlck1hbmFnZXInO1xuXG4vKipcbiAqIOWvueivneWOhuWPsuadoeebruaOpeWPo1xuICog55So5LqO5aSW6YOo5Lyg5YWl55qE5a+56K+d5Y6G5Y+y6K6w5b2VXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGlhbG9ndWVIaXN0b3J5SXRlbSB7XG4gIHNwZWFrZXI6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBzdHlsZT86IHN0cmluZztcbiAgcG9ydHJhaXQ/OiB7XG4gICAgY2hhcmFjdGVyOiBzdHJpbmc7XG4gICAgZW1vdGlvbjogRW1vdGlvblR5cGU7XG4gIH07XG4gIGJhY2tncm91bmQ/OiB7XG4gICAgbG9jYXRpb246IHN0cmluZztcbiAgICBzY2VuZTogc3RyaW5nO1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgRGlhbG9ndWVNYW5hZ2VyIHtcbiAgLy8g5a+56K+d5pWw5o2uXG4gIHByaXZhdGUgZGlhbG9ndWVzOiBEaWFsb2d1ZVtdID0gW107XG4gIHByaXZhdGUgY3VycmVudERpYWxvZ3VlSW5kZXg6IG51bWJlciA9IDA7XG5cbiAgLy8g5pyN5Yqh5byV55SoXG4gIHByaXZhdGUgY2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlOiBDaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2U7XG4gIHByaXZhdGUgY2hhcmFjdGVyTWFuYWdlcjogQ2hhcmFjdGVyTWFuYWdlcjtcbiAgcHJpdmF0ZSBiYWNrZ3JvdW5kTWFuYWdlcjogQmFja2dyb3VuZE1hbmFnZXI7XG5cbiAgLy8g6Ieq5Yqo5pKt5pS+6K6+572uXG4gIHByaXZhdGUgaXNBdXRvUGxheWluZzogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIGF1dG9QbGF5SW50ZXJ2YWw6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGF1dG9QbGF5U3BlZWQ6IG51bWJlciA9IDMwMDA7IC8vIOavq+enklxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGNoYXJhY3RlclJlc291cmNlU2VydmljZTogQ2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlLFxuICAgIGNoYXJhY3Rlck1hbmFnZXI6IENoYXJhY3Rlck1hbmFnZXIsXG4gICAgYmFja2dyb3VuZE1hbmFnZXI6IEJhY2tncm91bmRNYW5hZ2VyLFxuICApIHtcbiAgICB0aGlzLmNoYXJhY3RlclJlc291cmNlU2VydmljZSA9IGNoYXJhY3RlclJlc291cmNlU2VydmljZTtcbiAgICB0aGlzLmNoYXJhY3Rlck1hbmFnZXIgPSBjaGFyYWN0ZXJNYW5hZ2VyO1xuICAgIHRoaXMuYmFja2dyb3VuZE1hbmFnZXIgPSBiYWNrZ3JvdW5kTWFuYWdlcjtcblxuICAgIC8vIOe7keWumuiHquWKqOaSreaUvuaMiemSrlxuICAgICQoJyNhdXRvLXBsYXknKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZUF1dG9QbGF5KCk7XG4gICAgfSk7XG5cbiAgICAvLyDkuI3lho3pnIDopoHnu5HlrprkuIvkuIDmraXmjInpkq7vvIzmlLnkuLrlnKhHYW1lQ29udHJvbGxlcuS4ree7keWumuWvueivneahhueCueWHu1xuICAgIC8vICQoJy5kaWFsb2d1ZS1uZXh0LWJ1dHRvbicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAvLyAgIHRoaXMuc2hvd05leHREaWFsb2d1ZSgpO1xuICAgIC8vIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ+WvueivneeuoeeQhuWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruWvueivneWIl+ihqFxuICAgKi9cbiAgcHVibGljIHNldERpYWxvZ3VlcyhkaWFsb2d1ZXM6IERpYWxvZ3VlW10pIHtcbiAgICB0aGlzLmRpYWxvZ3VlcyA9IGRpYWxvZ3VlcztcbiAgICB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4ID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrnibnlrprntKLlvJXnmoTlr7nor51cbiAgICovXG4gIHB1YmxpYyBzaG93RGlhbG9ndWUoaW5kZXg6IG51bWJlcikge1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5kaWFsb2d1ZXMubGVuZ3RoKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfml6DmlYjnmoTlr7nor53ntKLlvJUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDmm7TmlrDlvZPliY3ntKLlvJVcbiAgICB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4ID0gaW5kZXg7XG4gICAgY29uc3QgZGlhbG9ndWUgPSB0aGlzLmRpYWxvZ3Vlc1tpbmRleF07XG5cbiAgICAvLyDmm7TmlrDlj5HoqIDkurrlkI3np7AgLSDnm7TmjqXkvb/nlKhzcGVha2Vy5bGe5oCn77yM5LiN5YGa5aSE55CGXG4gICAgY29uc3Qgc3BlYWtlck5hbWUgPSBkaWFsb2d1ZS5zcGVha2VyO1xuICAgICQoJy5zcGVha2VyLW5hbWUnKS50ZXh0KHNwZWFrZXJOYW1lKTtcblxuICAgIC8vIOWIm+W7uuaWsOWvueivneaWh+acrOWFg+e0oFxuICAgIGNvbnN0ICRkaWFsb2d1ZVRleHQgPSAkKCc8ZGl2PicsIHtcbiAgICAgIGNsYXNzOiBgZGlhbG9ndWUtdGV4dCBzdHlsZS0ke2RpYWxvZ3VlLnN0eWxlIHx8ICdub3JtYWwnfWAsXG4gICAgICB0ZXh0OiBkaWFsb2d1ZS5jb250ZW50LFxuICAgIH0pO1xuXG4gICAgLy8g5riF56m65bm25re75Yqg5paw5YaF5a65XG4gICAgJCgnLmRpYWxvZ3VlLWNvbnRlbnQnKS5lbXB0eSgpLmFwcGVuZCgkZGlhbG9ndWVUZXh0KTtcblxuICAgIC8vIOa7muWKqOWIsOW6lemDqFxuICAgICQoJy5kaWFsb2d1ZS1jb250ZW50Jykuc2Nyb2xsVG9wKCQoJy5kaWFsb2d1ZS1jb250ZW50JylbMF0uc2Nyb2xsSGVpZ2h0KTtcblxuICAgIC8vIOabtOaWsOinkuiJsueri+e7mFxuICAgIHRoaXMudXBkYXRlQ2hhcmFjdGVyRGlzcGxheShkaWFsb2d1ZSk7XG5cbiAgICAvLyDmm7TmlrDog4zmma/vvIjlpoLmnpzmnInmjIflrprvvIlcbiAgICB0aGlzLnVwZGF0ZUJhY2tncm91bmQoZGlhbG9ndWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOinkuiJsueri+e7mOaYvuekulxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVDaGFyYWN0ZXJEaXNwbGF5KGRpYWxvZ3VlOiBEaWFsb2d1ZSkge1xuICAgIC8vIOWmguaenOWvueivneayoeacieaMh+WumnBvcnRyYWl077yM5bCd6K+V5L2/55So6buY6K6k6KeE5YiZXG4gICAgaWYgKCFkaWFsb2d1ZS5wb3J0cmFpdCkge1xuICAgICAgLy8g5Yik5pat6KeS6Imy5piv5ZCm5Zyo6aKE6K6+5ZCN5Y2V5LitXG4gICAgICBjb25zdCBjaGFyYWN0ZXIgPSB0aGlzLmNoYXJhY3RlclJlc291cmNlU2VydmljZS5nZXRDaGFyYWN0ZXIoZGlhbG9ndWUuc3BlYWtlcik7XG4gICAgICBpZiAoY2hhcmFjdGVyKSB7XG4gICAgICAgIC8vIOWmguaenOaYr+mihOiuvuinkuiJsu+8jOaMieWOn+aciemAu+i+keaYvuekulxuICAgICAgICB0aGlzLmNoYXJhY3Rlck1hbmFnZXIudXBkYXRlQ2hhcmFjdGVyc0J5RGlhbG9ndWUoZGlhbG9ndWUuc3BlYWtlciwgJ2RlZmF1bHQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWmguaenOS4jeaYr+mihOiuvuinkuiJsu+8jOWPquaYvuekuuWQjeWtl++8jOS4jeaYvuekuueri+e7mFxuICAgICAgICB0aGlzLmNoYXJhY3Rlck1hbmFnZXIuaGlkZUNoYXJhY3RlcignYWxsJyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5aaC5p6c5pyJ5oyH5a6acG9ydHJhaXTvvIzkvb/nlKjmjIflrprnmoTop5LoibLlkozooajmg4VcbiAgICBjb25zdCB7IGNoYXJhY3RlciwgZW1vdGlvbiB9ID0gZGlhbG9ndWUucG9ydHJhaXQ7XG5cbiAgICAvLyDliKTmlq3ov5nkuKrop5LoibLlnKjlt6bovrnov5jmmK/lj7PovrlcbiAgICBsZXQgcG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcgPSAncmlnaHQnOyAvLyDpu5jorqTlj7PkvqdcblxuICAgIC8vIOWwneivleiOt+WPluinkuiJsui1hOa6kOadpeehruWumuS9jee9rlxuICAgIGNvbnN0IGNoYXJhY3RlclJlc291cmNlID0gdGhpcy5jaGFyYWN0ZXJSZXNvdXJjZVNlcnZpY2UuZ2V0Q2hhcmFjdGVyKGNoYXJhY3Rlcik7XG4gICAgaWYgKGNoYXJhY3RlclJlc291cmNlICYmIGNoYXJhY3RlclJlc291cmNlLnBvc2l0aW9uKSB7XG4gICAgICBwb3NpdGlvbiA9IGNoYXJhY3RlclJlc291cmNlLnBvc2l0aW9uIGFzICdsZWZ0JyB8ICdyaWdodCc7XG4gICAgfVxuXG4gICAgLy8g6K6+572u6KeS6Imy56uL57uYXG4gICAgdGhpcy5jaGFyYWN0ZXJNYW5hZ2VyLnNldENoYXJhY3RlcihjaGFyYWN0ZXIsIGVtb3Rpb24sIHBvc2l0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDog4zmma/mmL7npLpcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQmFja2dyb3VuZChkaWFsb2d1ZTogRGlhbG9ndWUpIHtcbiAgICAvLyDlpoLmnpzlr7nor53mjIflrprkuobog4zmma/vvIzliJnmm7TmlrDog4zmma9cbiAgICBpZiAoZGlhbG9ndWUuYmFja2dyb3VuZCkge1xuICAgICAgY29uc3QgeyBsb2NhdGlvbiwgc2NlbmUgfSA9IGRpYWxvZ3VlLmJhY2tncm91bmQ7XG4gICAgICB0aGlzLmJhY2tncm91bmRNYW5hZ2VyLnNldEJhY2tncm91bmQobG9jYXRpb24sIHNjZW5lKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65LiL5LiA5p2h5a+56K+dXG4gICAqL1xuICBwdWJsaWMgc2hvd05leHREaWFsb2d1ZSgpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50RGlhbG9ndWVJbmRleCA8IHRoaXMuZGlhbG9ndWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgIHRoaXMuc2hvd0RpYWxvZ3VlKHRoaXMuY3VycmVudERpYWxvZ3VlSW5kZXggKyAxKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7IC8vIOayoeacieabtOWkmuWvueivneS6hlxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuS4iuS4gOadoeWvueivnVxuICAgKi9cbiAgcHVibGljIHNob3dQcmV2aW91c0RpYWxvZ3VlKCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4ID4gMCkge1xuICAgICAgdGhpcy5zaG93RGlhbG9ndWUodGhpcy5jdXJyZW50RGlhbG9ndWVJbmRleCAtIDEpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTsgLy8g5bey57uP5piv56ys5LiA5p2h5a+56K+dXG4gIH1cblxuICAvKipcbiAgICog5riy5p+T5a+56K+d5YaF5a65XG4gICAqIOeUqOS6juWIneWni+WMluaIlumHjeaWsOa4suafk+WvueivneeVjOmdolxuICAgKi9cbiAgcHVibGljIHJlbmRlckRpYWxvZ3VlKGluZGV4OiBudW1iZXIgPSB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4KSB7XG4gICAgdGhpcy5zaG93RGlhbG9ndWUoaW5kZXgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOaWsOWvueivnVxuICAgKi9cbiAgcHVibGljIGFkZERpYWxvZ3VlKGRpYWxvZ3VlOiBEaWFsb2d1ZSkge1xuICAgIHRoaXMuZGlhbG9ndWVzLnB1c2goZGlhbG9ndWUpO1xuXG4gICAgLy8g5aaC5p6c5re75Yqg55qE5piv56ys5LiA5p2h5a+56K+d77yM5YiZ5pi+56S65a6DXG4gICAgaWYgKHRoaXMuZGlhbG9ndWVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdGhpcy5yZW5kZXJEaWFsb2d1ZSgwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF56m65omA5pyJ5a+56K+dXG4gICAqL1xuICBwdWJsaWMgY2xlYXJEaWFsb2d1ZXMoKSB7XG4gICAgdGhpcy5kaWFsb2d1ZXMgPSBbXTtcbiAgICB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4ID0gMDtcblxuICAgIC8vIOa4heepuuWvueivneWGheWuuVxuICAgICQoJy5kaWFsb2d1ZS1jb250ZW50JykuZW1wdHkoKTtcbiAgICAkKCcuc3BlYWtlci1uYW1lJykudGV4dCgnJyk7XG5cbiAgICAvLyDmuIXnqbrop5LoibLmmL7npLpcbiAgICB0aGlzLmNoYXJhY3Rlck1hbmFnZXIuaGlkZUNoYXJhY3RlcignYWxsJyk7XG4gIH1cblxuICAvKipcbiAgICog5YiH5o2i6Ieq5Yqo5pKt5pS+XG4gICAqL1xuICBwdWJsaWMgdG9nZ2xlQXV0b1BsYXkoKSB7XG4gICAgdGhpcy5pc0F1dG9QbGF5aW5nID0gIXRoaXMuaXNBdXRvUGxheWluZztcblxuICAgIC8vIOiOt+WPluiHquWKqOaSreaUvuaMiemSrlxuICAgIGNvbnN0ICRhdXRvUGxheUJ1dHRvbiA9ICQoJyNhdXRvLXBsYXknKTtcblxuICAgIGlmICh0aGlzLmlzQXV0b1BsYXlpbmcpIHtcbiAgICAgIC8vIOWQr+WKqOiHquWKqOaSreaUvlxuICAgICAgdGhpcy5hdXRvUGxheUludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgY29uc3QgaGFzTW9yZURpYWxvZ3VlID0gdGhpcy5zaG93TmV4dERpYWxvZ3VlKCk7XG4gICAgICAgIGlmICghaGFzTW9yZURpYWxvZ3VlKSB7XG4gICAgICAgICAgLy8g5rKh5pyJ5pu05aSa5a+56K+d5LqG77yM5YGc5q2i6Ieq5Yqo5pKt5pS+XG4gICAgICAgICAgdGhpcy5zdG9wQXV0b1BsYXkoKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcy5hdXRvUGxheVNwZWVkKTtcblxuICAgICAgLy8g5pu05paw5oyJ6ZKu5qC35byPXG4gICAgICAkYXV0b1BsYXlCdXR0b24uYWRkQ2xhc3MoJ2FjdGl2ZScpLmh0bWwoJzxpIGNsYXNzPVwiZmFzIGZhLXBhdXNlXCI+PC9pPicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlgZzmraLoh6rliqjmkq3mlL5cbiAgICAgIHRoaXMuc3RvcEF1dG9QbGF5KCk7XG5cbiAgICAgIC8vIOabtOaWsOaMiemSruagt+W8j1xuICAgICAgJGF1dG9QbGF5QnV0dG9uLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5odG1sKCc8aSBjbGFzcz1cImZhcyBmYS1wbGF5XCI+PC9pPicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlgZzmraLoh6rliqjmkq3mlL5cbiAgICovXG4gIHByaXZhdGUgc3RvcEF1dG9QbGF5KCkge1xuICAgIGlmICh0aGlzLmF1dG9QbGF5SW50ZXJ2YWwgIT09IG51bGwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5hdXRvUGxheUludGVydmFsKTtcbiAgICAgIHRoaXMuYXV0b1BsYXlJbnRlcnZhbCA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuaXNBdXRvUGxheWluZyA9IGZhbHNlO1xuXG4gICAgLy8g5pu05paw5oyJ6ZKu5qC35byPXG4gICAgJCgnI2F1dG8tcGxheScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5odG1sKCc8aSBjbGFzcz1cImZhcyBmYS1wbGF5XCI+PC9pPicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruiHquWKqOaSreaUvumAn+W6plxuICAgKi9cbiAgcHVibGljIHNldEF1dG9QbGF5U3BlZWQoc3BlZWQ6IG51bWJlcikge1xuICAgIHRoaXMuYXV0b1BsYXlTcGVlZCA9IHNwZWVkO1xuXG4gICAgLy8g5aaC5p6c6Ieq5Yqo5pKt5pS+5q2j5Zyo6L+b6KGM77yM6YeN5ZCv5a6D5Lul5bqU55So5paw6YCf5bqmXG4gICAgaWYgKHRoaXMuaXNBdXRvUGxheWluZykge1xuICAgICAgdGhpcy5zdG9wQXV0b1BsYXkoKTtcbiAgICAgIHRoaXMudG9nZ2xlQXV0b1BsYXkoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN5a+56K+dXG4gICAqL1xuICBwdWJsaWMgZ2V0Q3VycmVudERpYWxvZ3VlKCk6IERpYWxvZ3VlIHwgbnVsbCB7XG4gICAgaWYgKHRoaXMuY3VycmVudERpYWxvZ3VlSW5kZXggPj0gMCAmJiB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4IDwgdGhpcy5kaWFsb2d1ZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGhpcy5kaWFsb2d1ZXNbdGhpcy5jdXJyZW50RGlhbG9ndWVJbmRleF07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieWvueivnVxuICAgKi9cbiAgcHVibGljIGdldEFsbERpYWxvZ3VlcygpOiBEaWFsb2d1ZVtdIHtcbiAgICByZXR1cm4gXy5jbG9uZURlZXAodGhpcy5kaWFsb2d1ZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuWvueivneWOhuWPsuiusOW9lVxuICAgKiBAcGFyYW0gZXh0ZXJuYWxEaWFsb2d1ZXMg5Y+v6YCJ55qE5aSW6YOo5a+56K+d5Y6G5Y+y5pWw5o2uXG4gICAqL1xuICBwdWJsaWMgc2hvd0RpYWxvZ3VlSGlzdG9yeShleHRlcm5hbERpYWxvZ3Vlcz86IERpYWxvZ3VlSGlzdG9yeUl0ZW1bXSkge1xuICAgIC8vIOS/neWtmOW9k+WJjee0ouW8lVxuICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IHRoaXMuY3VycmVudERpYWxvZ3VlSW5kZXg7XG5cbiAgICAvLyDmmL7npLrmiYDmnInlr7nor51cbiAgICBjb25zdCAkZGlhbG9ndWVDb250ZW50ID0gJCgnLmRpYWxvZ3VlLWNvbnRlbnQnKTtcbiAgICAkZGlhbG9ndWVDb250ZW50LmVtcHR5KCk7XG5cbiAgICAvLyDlhrPlrprkvb/nlKjlk6rkuKrlr7nor53ljoblj7LmlbDmja7mupBcbiAgICBjb25zdCBkaWFsb2d1ZXNUb1Nob3cgPSBleHRlcm5hbERpYWxvZ3VlcyB8fCB0aGlzLmRpYWxvZ3VlcztcblxuICAgIC8vIOS9v+eUqGxvZGFzaOmBjeWOhuWvueivnVxuICAgIF8uZm9yRWFjaChkaWFsb2d1ZXNUb1Nob3csIChkaWFsb2d1ZSwgaW5kZXgpID0+IHtcbiAgICAgIC8vIOWIm+W7uuWvueivnemhueWuueWZqFxuICAgICAgY29uc3QgJGRpYWxvZ3VlSXRlbSA9ICQoJzxkaXY+Jywge1xuICAgICAgICBjbGFzczogJ2RpYWxvZ3VlLWhpc3RvcnktaXRlbScsXG4gICAgICAgICdkYXRhLWluZGV4JzogaW5kZXgsXG4gICAgICB9KTtcblxuICAgICAgLy8g5Yib5bu65Y+R6KiA5Lq65YWD57SgXG4gICAgICBjb25zdCAkc3BlYWtlck5hbWUgPSAkKCc8ZGl2PicsIHtcbiAgICAgICAgY2xhc3M6ICdzcGVha2VyLW5hbWUtaGlzdG9yeScsXG4gICAgICAgIHRleHQ6IGRpYWxvZ3VlLnNwZWFrZXIsXG4gICAgICB9KTtcblxuICAgICAgLy8g5Yib5bu65a+56K+d5YaF5a655YWD57SgXG4gICAgICBjb25zdCAkZGlhbG9ndWVUZXh0ID0gJCgnPGRpdj4nLCB7XG4gICAgICAgIGNsYXNzOiBgZGlhbG9ndWUtdGV4dC1oaXN0b3J5IHN0eWxlLSR7ZGlhbG9ndWUuc3R5bGUgfHwgJ25vcm1hbCd9YCxcbiAgICAgICAgdGV4dDogZGlhbG9ndWUuY29udGVudCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyDmt7vliqDliLDlrrnlmahcbiAgICAgICRkaWFsb2d1ZUl0ZW0uYXBwZW5kKCRzcGVha2VyTmFtZSkuYXBwZW5kKCRkaWFsb2d1ZVRleHQpO1xuXG4gICAgICAvLyDmt7vliqDliLDlr7nor53lhoXlrrnljLrln59cbiAgICAgICRkaWFsb2d1ZUNvbnRlbnQuYXBwZW5kKCRkaWFsb2d1ZUl0ZW0pO1xuICAgIH0pO1xuXG4gICAgLy8g5pi+56S65Y6G5Y+y6K6w5b2V5qih5byP6YCa55+lXG4gICAgJCgnI2RpYWxvZ3VlLWhpc3Rvcnktbm90aWNlJykuc2hvdygpO1xuXG4gICAgLy8g5re75YqgXCLov5Tlm55cIuaMiemSrlxuICAgIGNvbnN0ICRyZXR1cm5CdXR0b24gPSAkKCc8YnV0dG9uPicsIHtcbiAgICAgIGlkOiAncmV0dXJuLWZyb20taGlzdG9yeScsXG4gICAgICBjbGFzczogJ2J0biBidG4tcHJpbWFyeScsXG4gICAgICB0ZXh0OiAn6L+U5Zue5a+56K+dJyxcbiAgICAgIGNsaWNrOiAoKSA9PiB7XG4gICAgICAgIC8vIOmakOiXj+mAmuefpVxuICAgICAgICAkKCcjZGlhbG9ndWUtaGlzdG9yeS1ub3RpY2UnKS5oaWRlKCk7XG4gICAgICAgIC8vIOenu+mZpOWOhuWPsuiusOW9leagt+W8j1xuICAgICAgICAkZGlhbG9ndWVDb250ZW50LnJlbW92ZUNsYXNzKCdoaXN0b3J5LW1vZGUnKTtcbiAgICAgICAgLy8g5riy5p+T5b2T5YmN5a+56K+dXG4gICAgICAgIHRoaXMucmVuZGVyRGlhbG9ndWUoY3VycmVudEluZGV4KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyDmt7vliqDov5Tlm57mjInpkq5cbiAgICAkZGlhbG9ndWVDb250ZW50LmFwcGVuZCgkcmV0dXJuQnV0dG9uKTtcblxuICAgIC8vIOa3u+WKoOWOhuWPsuiusOW9leagt+W8j1xuICAgICRkaWFsb2d1ZUNvbnRlbnQuYWRkQ2xhc3MoJ2hpc3RvcnktbW9kZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluW9k+WJjeWvueivnee0ouW8lVxuICAgKi9cbiAgcHVibGljIGdldEN1cnJlbnREaWFsb2d1ZUluZGV4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudERpYWxvZ3VlSW5kZXg7XG4gIH1cblxuICAvKipcbiAgICog5a+56K+d5piv5ZCm5bey57uT5p2fXG4gICAqL1xuICBwdWJsaWMgaXNEaWFsb2d1ZUZpbmlzaGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREaWFsb2d1ZUluZGV4ID49IHRoaXMuZGlhbG9ndWVzLmxlbmd0aCAtIDE7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/dialogueManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/journalManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JournalManager: () => (/* binding */ JournalManager)\n/* harmony export */ });\n/**\n * 日记管理器\n * 负责处理游戏中的日记功能，仅显示空白占位页\n */\nclass JournalManager {\n    // 游戏数据引用\n    gameData = null;\n    constructor() {\n        console.log('日记管理器初始化完成');\n    }\n    /**\n     * 设置游戏数据\n     * @param gameData 游戏数据\n     */\n    setGameData(gameData) {\n        this.gameData = gameData;\n    }\n    /**\n     * 切换日记部分\n     */\n    switchJournalSection(sectionId) {\n        // 移除所有导航项的激活状态\n        $('.journal-nav-item').removeClass('active');\n        // 移除所有内容区域的激活状态\n        $('.journal-section').removeClass('active');\n        // 激活选中的导航项和内容区域\n        $(`[data-section=\"${sectionId}\"]`).addClass('active');\n        $(`#${sectionId}-section`).addClass('active');\n        // 显示所有部分的空白占位页\n        this.showPlaceholder(sectionId);\n    }\n    /**\n     * 刷新日记内容\n     */\n    refreshJournalContent() {\n        // 默认显示角色信息部分\n        this.showPlaceholder('characters');\n    }\n    /**\n     * 显示对应区域的空白占位页\n     * @param sectionId 区域ID\n     */\n    showPlaceholder(sectionId) {\n        const $container = $(`#${sectionId}-section`);\n        if (!$container.length)\n            return;\n        // 清空现有内容\n        $container.empty();\n        // 获取显示标题\n        let title = '日记';\n        switch (sectionId) {\n            case 'characters':\n                title = '角色信息';\n                break;\n            case 'monastery':\n                title = '修道院';\n                break;\n            case 'knowledge':\n                title = '知识库';\n                break;\n        }\n        // 添加空白页占位内容\n        $('<div>', {\n            class: 'journal-placeholder',\n            css: {\n                padding: '20px',\n                textAlign: 'center',\n            },\n        })\n            .append($('<h3>', {\n            text: title,\n            css: { marginBottom: '15px' },\n        }))\n            .append($('<p>', {\n            text: '内容暂未实现',\n            css: {\n                color: '#888',\n                fontStyle: 'italic',\n            },\n        }))\n            .appendTo($container);\n        console.log(`日记${title}部分已清空，仅保留占位符`);\n    }\n    /**\n     * 选择角色\n     * 保留方法签名但简化实现\n     */\n    selectCharacter(characterId) {\n        // 仅记录交互，不执行实际操作\n        console.log(`尝试选择角色: ${characterId}，但该功能已简化为占位符`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvam91cm5hbE1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7R0FHRztBQUlJLE1BQU0sY0FBYztJQUN6QixTQUFTO0lBQ0QsUUFBUSxHQUFvQixJQUFJLENBQUM7SUFFekM7UUFDRSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxXQUFXLENBQUMsUUFBeUI7UUFDMUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksb0JBQW9CLENBQUMsU0FBaUI7UUFDM0MsZUFBZTtRQUNmLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUU3QyxnQkFBZ0I7UUFDaEIsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTVDLGdCQUFnQjtRQUNoQixDQUFDLENBQUMsa0JBQWtCLFNBQVMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxJQUFJLFNBQVMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTlDLGVBQWU7UUFDZixJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRDs7T0FFRztJQUNJLHFCQUFxQjtRQUMxQixhQUFhO1FBQ2IsSUFBSSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ssZUFBZSxDQUFDLFNBQWlCO1FBQ3ZDLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQyxJQUFJLFNBQVMsVUFBVSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNO1lBQUUsT0FBTztRQUUvQixTQUFTO1FBQ1QsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRW5CLFNBQVM7UUFDVCxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDakIsUUFBUSxTQUFTLEVBQUUsQ0FBQztZQUNsQixLQUFLLFlBQVk7Z0JBQ2YsS0FBSyxHQUFHLE1BQU0sQ0FBQztnQkFDZixNQUFNO1lBQ1IsS0FBSyxXQUFXO2dCQUNkLEtBQUssR0FBRyxLQUFLLENBQUM7Z0JBQ2QsTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxLQUFLLEdBQUcsS0FBSyxDQUFDO2dCQUNkLE1BQU07UUFDVixDQUFDO1FBRUQsWUFBWTtRQUNaLENBQUMsQ0FBQyxPQUFPLEVBQUU7WUFDVCxLQUFLLEVBQUUscUJBQXFCO1lBQzVCLEdBQUcsRUFBRTtnQkFDSCxPQUFPLEVBQUUsTUFBTTtnQkFDZixTQUFTLEVBQUUsUUFBUTthQUNwQjtTQUNGLENBQUM7YUFDQyxNQUFNLENBQ0wsQ0FBQyxDQUFDLE1BQU0sRUFBRTtZQUNSLElBQUksRUFBRSxLQUFLO1lBQ1gsR0FBRyxFQUFFLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRTtTQUM5QixDQUFDLENBQ0g7YUFDQSxNQUFNLENBQ0wsQ0FBQyxDQUFDLEtBQUssRUFBRTtZQUNQLElBQUksRUFBRSxRQUFRO1lBQ2QsR0FBRyxFQUFFO2dCQUNILEtBQUssRUFBRSxNQUFNO2dCQUNiLFNBQVMsRUFBRSxRQUFRO2FBQ3BCO1NBQ0YsQ0FBQyxDQUNIO2FBQ0EsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRXhCLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxLQUFLLGNBQWMsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxlQUFlLENBQUMsV0FBbUI7UUFDeEMsZ0JBQWdCO1FBQ2hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxXQUFXLGNBQWMsQ0FBQyxDQUFDO0lBQ3BELENBQUM7Q0FDRiIsInNvdXJjZXMiOlsic3JjOi8vdGF2ZXJuX2hlbHBlcl90ZW1wbGF0ZS9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvam91cm5hbE1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDml6XorrDnrqHnkIblmahcbiAqIOi0n+i0o+WkhOeQhua4uOaIj+S4reeahOaXpeiusOWKn+iDve+8jOS7heaYvuekuuepuueZveWNoOS9jemhtVxuICovXG5cbmltcG9ydCB7IEdhbWVEYXRhIH0gZnJvbSAnLi4vbW9kZWxzL2dhbWVEYXRhJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxNYW5hZ2VyIHtcbiAgLy8g5ri45oiP5pWw5o2u5byV55SoXG4gIHByaXZhdGUgZ2FtZURhdGE6IEdhbWVEYXRhIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc29sZS5sb2coJ+aXpeiusOeuoeeQhuWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9rua4uOaIj+aVsOaNrlxuICAgKiBAcGFyYW0gZ2FtZURhdGEg5ri45oiP5pWw5o2uXG4gICAqL1xuICBwdWJsaWMgc2V0R2FtZURhdGEoZ2FtZURhdGE6IEdhbWVEYXRhIHwgbnVsbCkge1xuICAgIHRoaXMuZ2FtZURhdGEgPSBnYW1lRGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliIfmjaLml6XorrDpg6jliIZcbiAgICovXG4gIHB1YmxpYyBzd2l0Y2hKb3VybmFsU2VjdGlvbihzZWN0aW9uSWQ6IHN0cmluZykge1xuICAgIC8vIOenu+mZpOaJgOacieWvvOiIqumhueeahOa/gOa0u+eKtuaAgVxuICAgICQoJy5qb3VybmFsLW5hdi1pdGVtJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g56e76Zmk5omA5pyJ5YaF5a655Yy65Z+f55qE5r+A5rS754q25oCBXG4gICAgJCgnLmpvdXJuYWwtc2VjdGlvbicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgIC8vIOa/gOa0u+mAieS4reeahOWvvOiIqumhueWSjOWGheWuueWMuuWfn1xuICAgICQoYFtkYXRhLXNlY3Rpb249XCIke3NlY3Rpb25JZH1cIl1gKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgJChgIyR7c2VjdGlvbklkfS1zZWN0aW9uYCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g5pi+56S65omA5pyJ6YOo5YiG55qE56m655m95Y2g5L2N6aG1XG4gICAgdGhpcy5zaG93UGxhY2Vob2xkZXIoc2VjdGlvbklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDml6XorrDlhoXlrrlcbiAgICovXG4gIHB1YmxpYyByZWZyZXNoSm91cm5hbENvbnRlbnQoKSB7XG4gICAgLy8g6buY6K6k5pi+56S66KeS6Imy5L+h5oGv6YOo5YiGXG4gICAgdGhpcy5zaG93UGxhY2Vob2xkZXIoJ2NoYXJhY3RlcnMnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrlr7nlupTljLrln5/nmoTnqbrnmb3ljaDkvY3pobVcbiAgICogQHBhcmFtIHNlY3Rpb25JZCDljLrln59JRFxuICAgKi9cbiAgcHJpdmF0ZSBzaG93UGxhY2Vob2xkZXIoc2VjdGlvbklkOiBzdHJpbmcpIHtcbiAgICBjb25zdCAkY29udGFpbmVyID0gJChgIyR7c2VjdGlvbklkfS1zZWN0aW9uYCk7XG4gICAgaWYgKCEkY29udGFpbmVyLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgLy8g5riF56m6546w5pyJ5YaF5a65XG4gICAgJGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgLy8g6I635Y+W5pi+56S65qCH6aKYXG4gICAgbGV0IHRpdGxlID0gJ+aXpeiusCc7XG4gICAgc3dpdGNoIChzZWN0aW9uSWQpIHtcbiAgICAgIGNhc2UgJ2NoYXJhY3RlcnMnOlxuICAgICAgICB0aXRsZSA9ICfop5LoibLkv6Hmga8nO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ21vbmFzdGVyeSc6XG4gICAgICAgIHRpdGxlID0gJ+S/rumBk+mZoic7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAna25vd2xlZGdlJzpcbiAgICAgICAgdGl0bGUgPSAn55+l6K+G5bqTJztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8g5re75Yqg56m655m96aG15Y2g5L2N5YaF5a65XG4gICAgJCgnPGRpdj4nLCB7XG4gICAgICBjbGFzczogJ2pvdXJuYWwtcGxhY2Vob2xkZXInLFxuICAgICAgY3NzOiB7XG4gICAgICAgIHBhZGRpbmc6ICcyMHB4JyxcbiAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJyxcbiAgICAgIH0sXG4gICAgfSlcbiAgICAgIC5hcHBlbmQoXG4gICAgICAgICQoJzxoMz4nLCB7XG4gICAgICAgICAgdGV4dDogdGl0bGUsXG4gICAgICAgICAgY3NzOiB7IG1hcmdpbkJvdHRvbTogJzE1cHgnIH0sXG4gICAgICAgIH0pLFxuICAgICAgKVxuICAgICAgLmFwcGVuZChcbiAgICAgICAgJCgnPHA+Jywge1xuICAgICAgICAgIHRleHQ6ICflhoXlrrnmmoLmnKrlrp7njrAnLFxuICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgY29sb3I6ICcjODg4JyxcbiAgICAgICAgICAgIGZvbnRTdHlsZTogJ2l0YWxpYycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICApXG4gICAgICAuYXBwZW5kVG8oJGNvbnRhaW5lcik7XG5cbiAgICBjb25zb2xlLmxvZyhg5pel6K6wJHt0aXRsZX3pg6jliIblt7LmuIXnqbrvvIzku4Xkv53nlZnljaDkvY3nrKZgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpgInmi6nop5LoibJcbiAgICog5L+d55WZ5pa55rOV562+5ZCN5L2G566A5YyW5a6e546wXG4gICAqL1xuICBwdWJsaWMgc2VsZWN0Q2hhcmFjdGVyKGNoYXJhY3RlcklkOiBzdHJpbmcpIHtcbiAgICAvLyDku4XorrDlvZXkuqTkupLvvIzkuI3miafooYzlrp7pmYXmk43kvZxcbiAgICBjb25zb2xlLmxvZyhg5bCd6K+V6YCJ5oup6KeS6ImyOiAke2NoYXJhY3Rlcklkfe+8jOS9huivpeWKn+iDveW3sueugOWMluS4uuWNoOS9jeespmApO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/journalManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/memoryManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MemoryManager: () => (/* binding */ MemoryManager)\n/* harmony export */ });\n/**\n * 记忆管理器组件\n * 负责管理游戏中的记忆系统和时间旅行机制\n */\nclass MemoryManager {\n    // 记忆数据\n    memories = [];\n    selectedMemoryId = null;\n    // 使用会话存储跟踪是否已经保存过场景\n    hasCreatedMemory = false;\n    alreadySavedKey = 'memory_already_saved';\n    // 标记是否正在处理切换标签的操作\n    isTabSwitching = false;\n    // 记忆选择回调\n    onMemorySelectedCallback = null;\n    onMemorySavedCallback = null;\n    onMemoryTravelCallback = null;\n    constructor() {\n        // 绑定穿越按钮事件\n        $('#travel-to-memory').on('click', () => {\n            this.travelToSelectedMemory();\n        });\n        // 检查是否已保存过场景\n        this.checkIfAlreadySaved();\n        // 设置标签切换事件监听，确保只在需要时刷新\n        $('a[data-bs-toggle=\"tab\"]').on('hide.bs.tab', e => {\n            if ($(e.target).attr('href') === '#memory-tab') {\n                this.isTabSwitching = true;\n            }\n        });\n        $('a[data-bs-toggle=\"tab\"]').on('shown.bs.tab', e => {\n            if ($(e.target).attr('href') === '#memory-tab') {\n                // 在切换回记忆标签时，确保正确刷新数据而不是UI\n                // 重要：使用setTimeout是为了让DOM完全更新\n                setTimeout(() => {\n                    // 先清空时间轴，防止重复\n                    $('#memory-timeline').empty();\n                    this.renderMemories();\n                    this.isTabSwitching = false;\n                }, 50);\n            }\n        });\n        console.log('记忆管理器初始化完成');\n    }\n    /**\n     * 检查是否已经保存过场景\n     */\n    checkIfAlreadySaved() {\n        const saved = sessionStorage.getItem(this.alreadySavedKey);\n        if (saved === 'true') {\n            this.hasCreatedMemory = true;\n            // 更新UI状态\n            this.updateSaveButtonState();\n        }\n    }\n    /**\n     * 更新保存按钮状态\n     */\n    updateSaveButtonState() {\n        if (this.hasCreatedMemory) {\n            $('.memory-button')\n                .prop('disabled', true)\n                .css('opacity', '0.5')\n                .attr('title', '此场景已保存，每个场景只能保存一次')\n                .text('已保存');\n        }\n    }\n    /**\n     * 设置记忆列表\n     */\n    setMemories(memories) {\n        // 去重处理，确保每个ID只存在一次\n        const uniqueMemories = {};\n        // 使用对象键值对去重\n        memories.forEach(memory => {\n            uniqueMemories[memory.id] = memory;\n        });\n        // 转换回数组\n        this.memories = Object.values(uniqueMemories);\n        console.log(`设置了${this.memories.length}个记忆点（去重后）`);\n    }\n    /**\n     * 渲染记忆时间轴\n     */\n    renderMemories() {\n        const $timeline = $('#memory-timeline');\n        if ($timeline.length === 0)\n            return;\n        // 如果正在切换标签，不立即渲染\n        if (this.isTabSwitching) {\n            return;\n        }\n        // 清空现有时间轴\n        $timeline.empty();\n        // 去重并按时间轴顺序排序记忆（按ID递增）\n        const uniqueMemories = {};\n        this.memories.forEach(memory => {\n            uniqueMemories[memory.id] = memory;\n        });\n        const sortedMemories = _.sortBy(Object.values(uniqueMemories), 'id');\n        // 确保内存中的记忆也是去重的\n        this.memories = sortedMemories;\n        // 没有记忆点时显示提示\n        if (sortedMemories.length === 0) {\n            $timeline.html('<div class=\"memory-empty-timeline\">尚未创建记忆点。保存当前场景来创建一个新的记忆点。</div>');\n            return;\n        }\n        // 创建记忆节点 - 简化为纯圆点设计\n        _.forEach(sortedMemories, (memory, index) => {\n            // 创建简单的记忆节点\n            const $node = $('<div>', {\n                class: `memory-node-simple ${this.selectedMemoryId === memory.id ? 'selected' : ''}`,\n                'data-id': memory.id,\n                title: this.formatTimestamp(memory.timestamp || ''),\n                click: () => this.selectMemory(memory.id),\n            }).appendTo($timeline);\n        });\n        console.log(`已渲染${sortedMemories.length}个记忆点`);\n        // 更新保存按钮状态\n        this.updateSaveButtonState();\n    }\n    /**\n     * 格式化时间戳为更简短的格式\n     */\n    formatTimestamp(timestamp) {\n        // 提取日期和时间的关键部分\n        try {\n            const date = new Date(timestamp);\n            if (isNaN(date.getTime())) {\n                // 如果不是标准日期格式，直接返回原始字符串\n                return timestamp;\n            }\n            // 返回简短格式：月/日 时:分\n            return `${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${date\n                .getMinutes()\n                .toString()\n                .padStart(2, '0')}`;\n        }\n        catch (e) {\n            // 如果解析失败，返回原始时间戳\n            return timestamp;\n        }\n    }\n    /**\n     * 选择记忆\n     */\n    selectMemory(memoryId) {\n        // 查找记忆\n        const memory = _.find(this.memories, { id: memoryId });\n        if (!memory) {\n            console.error(`未找到ID为${memoryId}的记忆`);\n            return;\n        }\n        this.selectedMemoryId = memoryId;\n        // 更新记忆内容\n        const $content = $('#memory-content');\n        if ($content.length > 0) {\n            $content.empty();\n            // 如果有图片，显示图片\n            if (memory.image) {\n                $('<div>', {\n                    class: 'memory-content-image',\n                    css: { backgroundImage: `url('${memory.image}')` },\n                }).appendTo($content);\n            }\n            // 创建记忆内容元素\n            $('<div>', {\n                class: 'memory-content-text',\n                text: memory.content,\n            }).appendTo($content);\n            // 如果有时间戳，显示时间戳\n            if (memory.timestamp) {\n                $('<div>', {\n                    class: 'memory-timestamp',\n                    text: memory.timestamp,\n                }).appendTo($content);\n            }\n        }\n        // 更新记忆节点样式\n        $('.memory-node-simple').removeClass('selected');\n        $(`.memory-node-simple[data-id=\"${memoryId}\"]`).addClass('selected');\n        // 启用穿越按钮\n        $('#travel-to-memory').prop('disabled', false);\n        // 调用选择回调\n        if (this.onMemorySelectedCallback) {\n            this.onMemorySelectedCallback(memoryId);\n        }\n    }\n    /**\n     * 穿越到选中的记忆\n     */\n    travelToSelectedMemory() {\n        if (this.selectedMemoryId === null) {\n            console.error('没有选中的记忆点');\n            return;\n        }\n        // 调用穿越回调\n        if (this.onMemoryTravelCallback) {\n            this.onMemoryTravelCallback(this.selectedMemoryId);\n        }\n    }\n    /**\n     * 添加新记忆\n     */\n    addMemory(content, image) {\n        // 检查是否已经保存过\n        if (this.hasCreatedMemory) {\n            console.warn('此场景已保存过，每个场景只能保存一次');\n            this.showOneTimeOnlyMessage();\n            return null;\n        }\n        // 生成新ID（通常应使用游戏状态数据中的下一个ID）\n        const memoryIds = _.map(this.memories, 'id');\n        const newId = this.memories.length > 0 ? (_.max(memoryIds) || 0) + 1 : 1;\n        // 创建新记忆\n        const newMemory = {\n            id: newId,\n            content,\n            timestamp: new Date().toLocaleString(),\n            image,\n        };\n        // 添加到记忆列表\n        this.memories.push(newMemory);\n        // 标记为已保存并存储到会话\n        this.hasCreatedMemory = true;\n        sessionStorage.setItem(this.alreadySavedKey, 'true');\n        // 重新渲染时间轴\n        this.renderMemories();\n        // 选中新记忆\n        this.selectMemory(newId);\n        // 调用保存回调\n        if (this.onMemorySavedCallback) {\n            this.onMemorySavedCallback(newMemory);\n        }\n        return newMemory;\n    }\n    /**\n     * 显示只能保存一次的提示\n     */\n    showOneTimeOnlyMessage() {\n        // 显示一个临时提示信息\n        const $notification = $('<div>', {\n            class: 'notification notification-warning',\n            text: '此场景已保存过，每个场景只能保存一次',\n        }).appendTo('#notification-container');\n        // 添加显示类\n        setTimeout(() => {\n            $notification.addClass('notification-show');\n        }, 10);\n        // 一段时间后隐藏和移除\n        setTimeout(() => {\n            $notification.addClass('notification-hide').removeClass('notification-show');\n            setTimeout(() => {\n                $notification.remove();\n            }, 300);\n        }, 3000);\n    }\n    /**\n     * 删除记忆\n     */\n    deleteMemory(memoryId) {\n        // 查找记忆索引\n        const index = _.findIndex(this.memories, { id: memoryId });\n        if (index === -1) {\n            console.error(`未找到ID为${memoryId}的记忆`);\n            return;\n        }\n        // 删除记忆\n        this.memories.splice(index, 1);\n        // 重新渲染时间轴\n        this.renderMemories();\n        // 如果删除的是当前选中的记忆，清除选择\n        if (this.selectedMemoryId === memoryId) {\n            this.selectedMemoryId = null;\n            this.setEmptyMemoryContent();\n            // 禁用穿越按钮\n            $('#travel-to-memory').prop('disabled', true);\n        }\n    }\n    /**\n     * 获取当前选中的记忆\n     */\n    getSelectedMemory() {\n        if (this.selectedMemoryId === null)\n            return null;\n        return _.find(this.memories, { id: this.selectedMemoryId }) || null;\n    }\n    /**\n     * 获取所有记忆\n     */\n    getAllMemories() {\n        // 确保返回的数据是去重的\n        const uniqueMemories = {};\n        this.memories.forEach(memory => {\n            uniqueMemories[memory.id] = memory;\n        });\n        return _.cloneDeep(Object.values(uniqueMemories));\n    }\n    /**\n     * 设置空记忆内容\n     */\n    setEmptyMemoryContent(message = '选择一个记忆点或保存当前场景') {\n        $('#memory-content').html(`<div class=\"memory-empty-message\">${message}</div>`);\n        // 禁用穿越按钮\n        $('#travel-to-memory').prop('disabled', true);\n    }\n    /**\n     * 设置记忆选择回调\n     */\n    setOnMemorySelected(callback) {\n        this.onMemorySelectedCallback = callback;\n    }\n    /**\n     * 设置记忆保存回调\n     */\n    setOnMemorySaved(callback) {\n        this.onMemorySavedCallback = callback;\n    }\n    /**\n     * 设置记忆穿越回调\n     */\n    setOnMemoryTravel(callback) {\n        this.onMemoryTravelCallback = callback;\n    }\n    /**\n     * 清空记忆列表\n     */\n    clearMemories() {\n        this.memories = [];\n        this.selectedMemoryId = null;\n        // 重置保存状态\n        this.hasCreatedMemory = false;\n        sessionStorage.removeItem(this.alreadySavedKey);\n        this.renderMemories();\n        this.setEmptyMemoryContent();\n    }\n    /**\n     * 初始化显示\n     */\n    initializeDisplay() {\n        // 去重处理\n        const uniqueMemories = {};\n        this.memories.forEach(memory => {\n            uniqueMemories[memory.id] = memory;\n        });\n        this.memories = Object.values(uniqueMemories);\n        if (this.memories.length > 0) {\n            this.renderMemories();\n        }\n        else {\n            this.setEmptyMemoryContent();\n        }\n        // 检查是否已保存\n        this.checkIfAlreadySaved();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvbWVtb3J5TWFuYWdlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztHQUdHO0FBSUksTUFBTSxhQUFhO0lBQ3hCLE9BQU87SUFDQyxRQUFRLEdBQWtCLEVBQUUsQ0FBQztJQUM3QixnQkFBZ0IsR0FBa0IsSUFBSSxDQUFDO0lBRS9DLG9CQUFvQjtJQUNaLGdCQUFnQixHQUFZLEtBQUssQ0FBQztJQUNsQyxlQUFlLEdBQVcsc0JBQXNCLENBQUM7SUFFekQsa0JBQWtCO0lBQ1YsY0FBYyxHQUFZLEtBQUssQ0FBQztJQUV4QyxTQUFTO0lBQ0Qsd0JBQXdCLEdBQXdDLElBQUksQ0FBQztJQUNyRSxxQkFBcUIsR0FBMkMsSUFBSSxDQUFDO0lBQ3JFLHNCQUFzQixHQUF3QyxJQUFJLENBQUM7SUFFM0U7UUFDRSxXQUFXO1FBQ1gsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDdEMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDaEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxhQUFhO1FBQ2IsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFFM0IsdUJBQXVCO1FBQ3ZCLENBQUMsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDLEVBQUU7WUFDakQsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxhQUFhLEVBQUUsQ0FBQztnQkFDL0MsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7WUFDN0IsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsQ0FBQyxDQUFDLHlCQUF5QixDQUFDLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsRUFBRTtZQUNsRCxJQUFJLENBQUMsQ0FB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QUVELFVBQVU7UUFDVixJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztJQUM3QixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc2NyaXB0cy9jb21wb25lbnRzL21lbW9yeU1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDorrDlv4bnrqHnkIblmajnu4Tku7ZcbiAqIOi0n+i0o+euoeeQhua4uOaIj+S4reeahOiusOW/huezu+e7n+WSjOaXtumXtOaXheihjOacuuWItlxuICovXG5cbmltcG9ydCB7IFN0b3J5TWVtb3J5IH0gZnJvbSAnLi4vbW9kZWxzL2dhbWVEYXRhJztcblxuZXhwb3J0IGNsYXNzIE1lbW9yeU1hbmFnZXIge1xuICAvLyDorrDlv4bmlbDmja5cbiAgcHJpdmF0ZSBtZW1vcmllczogU3RvcnlNZW1vcnlbXSA9IFtdO1xuICBwcml2YXRlIHNlbGVjdGVkTWVtb3J5SWQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gIC8vIOS9v+eUqOS8muivneWtmOWCqOi3n+i4quaYr+WQpuW3sue7j+S/neWtmOi/h+WcuuaZr1xuICBwcml2YXRlIGhhc0NyZWF0ZWRNZW1vcnk6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBhbHJlYWR5U2F2ZWRLZXk6IHN0cmluZyA9ICdtZW1vcnlfYWxyZWFkeV9zYXZlZCc7XG5cbiAgLy8g5qCH6K6w5piv5ZCm5q2j5Zyo5aSE55CG5YiH5o2i5qCH562+55qE5pON5L2cXG4gIHByaXZhdGUgaXNUYWJTd2l0Y2hpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvLyDorrDlv4bpgInmi6nlm57osINcbiAgcHJpdmF0ZSBvbk1lbW9yeVNlbGVjdGVkQ2FsbGJhY2s6ICgobWVtb3J5SWQ6IG51bWJlcikgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBvbk1lbW9yeVNhdmVkQ2FsbGJhY2s6ICgobWVtb3J5OiBTdG9yeU1lbW9yeSkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBvbk1lbW9yeVRyYXZlbENhbGxiYWNrOiAoKG1lbW9yeUlkOiBudW1iZXIpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8g57uR5a6a56m/6LaK5oyJ6ZKu5LqL5Lu2XG4gICAgJCgnI3RyYXZlbC10by1tZW1vcnknKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRyYXZlbFRvU2VsZWN0ZWRNZW1vcnkoKTtcbiAgICB9KTtcblxuICAgIC8vIOajgOafpeaYr+WQpuW3suS/neWtmOi/h+WcuuaZr1xuICAgIHRoaXMuY2hlY2tJZkFscmVhZHlTYXZlZCgpO1xuXG4gICAgLy8g6K6+572u5qCH562+5YiH5o2i5LqL5Lu255uR5ZCs77yM56Gu5L+d5Y+q5Zyo6ZyA6KaB5pe25Yi35pawXG4gICAgJCgnYVtkYXRhLWJzLXRvZ2dsZT1cInRhYlwiXScpLm9uKCdoaWRlLmJzLnRhYicsIGUgPT4ge1xuICAgICAgaWYgKCQoZS50YXJnZXQpLmF0dHIoJ2hyZWYnKSA9PT0gJyNtZW1vcnktdGFiJykge1xuICAgICAgICB0aGlzLmlzVGFiU3dpdGNoaW5nID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoJ2FbZGF0YS1icy10b2dnbGU9XCJ0YWJcIl0nKS5vbignc2hvd24uYnMudGFiJywgZSA9PiB7XG4gICAgICBpZiAoJChlLnRhcmdldCkuYXR0cignaHJlZicpID09PSAnI21lbW9yeS10YWInKSB7XG4gICAgICAgIC8vIOWcqOWIh+aNouWbnuiusOW/huagh+etvuaXtu+8jOehruS/neato+ehruWIt+aWsOaVsOaNruiAjOS4jeaYr1VJXG4gICAgICAgIC8vIOmHjeimge+8muS9v+eUqHNldFRpbWVvdXTmmK/kuLrkuoborqlET03lrozlhajmm7TmlrBcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgLy8g5YWI5riF56m65pe26Ze06L2077yM6Ziy5q2i6YeN5aSNXG4gICAgICAgICAgJCgnI21lbW9yeS10aW1lbGluZScpLmVtcHR5KCk7XG4gICAgICAgICAgdGhpcy5yZW5kZXJNZW1vcmllcygpO1xuICAgICAgICAgIHRoaXMuaXNUYWJTd2l0Y2hpbmcgPSBmYWxzZTtcbiAgICAgICAgfSwgNTApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ+iusOW/hueuoeeQhuWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeaYr+WQpuW3sue7j+S/neWtmOi/h+WcuuaZr1xuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0lmQWxyZWFkeVNhdmVkKCkge1xuICAgIGNvbnN0IHNhdmVkID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmFscmVhZHlTYXZlZEtleSk7XG4gICAgaWYgKHNhdmVkID09PSAndHJ1ZScpIHtcbiAgICAgIHRoaXMuaGFzQ3JlYXRlZE1lbW9yeSA9IHRydWU7XG4gICAgICAvLyDmm7TmlrBVSeeKtuaAgVxuICAgICAgdGhpcy51cGRhdGVTYXZlQnV0dG9uU3RhdGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5L+d5a2Y5oyJ6ZKu54q25oCBXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVNhdmVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5oYXNDcmVhdGVkTWVtb3J5KSB7XG4gICAgICAkKCcubWVtb3J5LWJ1dHRvbicpXG4gICAgICAgIC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpXG4gICAgICAgIC5jc3MoJ29wYWNpdHknLCAnMC41JylcbiAgICAgICAgLmF0dHIoJ3RpdGxlJywgJ+atpOWcuuaZr+W3suS/neWtmO+8jOavj+S4quWcuuaZr+WPquiDveS/neWtmOS4gOasoScpXG4gICAgICAgIC50ZXh0KCflt7Lkv53lrZgnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6+572u6K6w5b+G5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgc2V0TWVtb3JpZXMobWVtb3JpZXM6IFN0b3J5TWVtb3J5W10pIHtcbiAgICAvLyDljrvph43lpITnkIbvvIznoa7kv53mr4/kuKpJROWPquWtmOWcqOS4gOasoVxuICAgIGNvbnN0IHVuaXF1ZU1lbW9yaWVzOiB7IFtrZXk6IG51bWJlcl06IFN0b3J5TWVtb3J5IH0gPSB7fTtcblxuICAgIC8vIOS9v+eUqOWvueixoemUruWAvOWvueWOu+mHjVxuICAgIG1lbW9yaWVzLmZvckVhY2gobWVtb3J5ID0+IHtcbiAgICAgIHVuaXF1ZU1lbW9yaWVzW21lbW9yeS5pZF0gPSBtZW1vcnk7XG4gICAgfSk7XG5cbiAgICAvLyDovazmjaLlm57mlbDnu4RcbiAgICB0aGlzLm1lbW9yaWVzID0gT2JqZWN0LnZhbHVlcyh1bmlxdWVNZW1vcmllcyk7XG4gICAgY29uc29sZS5sb2coYOiuvue9ruS6hiR7dGhpcy5tZW1vcmllcy5sZW5ndGh95Liq6K6w5b+G54K577yI5Y676YeN5ZCO77yJYCk7XG4gIH1cblxuICAvKipcbiAgICog5riy5p+T6K6w5b+G5pe26Ze06L20XG4gICAqL1xuICBwdWJsaWMgcmVuZGVyTWVtb3JpZXMoKSB7XG4gICAgY29uc3QgJHRpbWVsaW5lID0gJCgnI21lbW9yeS10aW1lbGluZScpO1xuICAgIGlmICgkdGltZWxpbmUubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICAvLyDlpoLmnpzmraPlnKjliIfmjaLmoIfnrb7vvIzkuI3nq4vljbPmuLLmn5NcbiAgICBpZiAodGhpcy5pc1RhYlN3aXRjaGluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOa4heepuueOsOacieaXtumXtOi9tFxuICAgICR0aW1lbGluZS5lbXB0eSgpO1xuXG4gICAgLy8g5Y676YeN5bm25oyJ5pe26Ze06L206aG65bqP5o6S5bqP6K6w5b+G77yI5oyJSUTpgJLlop7vvIlcbiAgICBjb25zdCB1bmlxdWVNZW1vcmllczogeyBba2V5OiBudW1iZXJdOiBTdG9yeU1lbW9yeSB9ID0ge307XG4gICAgdGhpcy5tZW1vcmllcy5mb3JFYWNoKG1lbW9yeSA9PiB7XG4gICAgICB1bmlxdWVNZW1vcmllc1ttZW1vcnkuaWRdID0gbWVtb3J5O1xuICAgIH0pO1xuICAgIGNvbnN0IHNvcnRlZE1lbW9yaWVzID0gXy5zb3J0QnkoT2JqZWN0LnZhbHVlcyh1bmlxdWVNZW1vcmllcyksICdpZCcpO1xuXG4gICAgLy8g56Gu5L+d5YaF5a2Y5Lit55qE6K6w5b+G5Lmf5piv5Y676YeN55qEXG4gICAgdGhpcy5tZW1vcmllcyA9IHNvcnRlZE1lbW9yaWVzO1xuXG4gICAgLy8g5rKh5pyJ6K6w5b+G54K55pe25pi+56S65o+Q56S6XG4gICAgaWYgKHNvcnRlZE1lbW9yaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJHRpbWVsaW5lLmh0bWwoJzxkaXYgY2xhc3M9XCJtZW1vcnktZW1wdHktdGltZWxpbmVcIj7lsJrmnKrliJvlu7rorrDlv4bngrnjgILkv53lrZjlvZPliY3lnLrmma/mnaXliJvlu7rkuIDkuKrmlrDnmoTorrDlv4bngrnjgII8L2Rpdj4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDliJvlu7rorrDlv4boioLngrkgLSDnroDljJbkuLrnuq/lnIbngrnorr7orqFcbiAgICBfLmZvckVhY2goc29ydGVkTWVtb3JpZXMsIChtZW1vcnksIGluZGV4KSA9PiB7XG4gICAgICAvLyDliJvlu7rnroDljZXnmoTorrDlv4boioLngrlcbiAgICAgIGNvbnN0ICRub2RlID0gJCgnPGRpdj4nLCB7XG4gICAgICAgIGNsYXNzOiBgbWVtb3J5LW5vZGUtc2ltcGxlICR7dGhpcy5zZWxlY3RlZE1lbW9yeUlkID09PSBtZW1vcnkuaWQgPyAnc2VsZWN0ZWQnIDogJyd9YCxcbiAgICAgICAgJ2RhdGEtaWQnOiBtZW1vcnkuaWQsXG4gICAgICAgIHRpdGxlOiB0aGlzLmZvcm1hdFRpbWVzdGFtcChtZW1vcnkudGltZXN0YW1wIHx8ICcnKSxcbiAgICAgICAgY2xpY2s6ICgpID0+IHRoaXMuc2VsZWN0TWVtb3J5KG1lbW9yeS5pZCksXG4gICAgICB9KS5hcHBlbmRUbygkdGltZWxpbmUpO1xuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYOW3sua4suafkyR7c29ydGVkTWVtb3JpZXMubGVuZ3RofeS4quiusOW/hueCuWApO1xuXG4gICAgLy8g5pu05paw5L+d5a2Y5oyJ6ZKu54q25oCBXG4gICAgdGhpcy51cGRhdGVTYXZlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmoLzlvI/ljJbml7bpl7TmiLPkuLrmm7TnroDnn63nmoTmoLzlvI9cbiAgICovXG4gIHByaXZhdGUgZm9ybWF0VGltZXN0YW1wKHRpbWVzdGFtcDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyDmj5Dlj5bml6XmnJ/lkozml7bpl7TnmoTlhbPplK7pg6jliIZcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7XG4gICAgICBpZiAoaXNOYU4oZGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAgIC8vIOWmguaenOS4jeaYr+agh+WHhuaXpeacn+agvOW8j++8jOebtOaOpei/lOWbnuWOn+Wni+Wtl+espuS4slxuICAgICAgICByZXR1cm4gdGltZXN0YW1wO1xuICAgICAgfVxuXG4gICAgICAvLyDov5Tlm57nroDnn63moLzlvI/vvJrmnIgv5pelIOaXtjrliIZcbiAgICAgIHJldHVybiBgJHtkYXRlLmdldE1vbnRoKCkgKyAxfS8ke2RhdGUuZ2V0RGF0ZSgpfSAke2RhdGUuZ2V0SG91cnMoKX06JHtkYXRlXG4gICAgICAgIC5nZXRNaW51dGVzKClcbiAgICAgICAgLnRvU3RyaW5nKClcbiAgICAgICAgLnBhZFN0YXJ0KDIsICcwJyl9YDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyDlpoLmnpzop6PmnpDlpLHotKXvvIzov5Tlm57ljp/lp4vml7bpl7TmiLNcbiAgICAgIHJldHVybiB0aW1lc3RhbXA7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOmAieaLqeiusOW/hlxuICAgKi9cbiAgcHVibGljIHNlbGVjdE1lbW9yeShtZW1vcnlJZDogbnVtYmVyKSB7XG4gICAgLy8g5p+l5om+6K6w5b+GXG4gICAgY29uc3QgbWVtb3J5ID0gXy5maW5kKHRoaXMubWVtb3JpZXMsIHsgaWQ6IG1lbW9yeUlkIH0pO1xuICAgIGlmICghbWVtb3J5KSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDmnKrmib7liLBJROS4uiR7bWVtb3J5SWR955qE6K6w5b+GYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZWxlY3RlZE1lbW9yeUlkID0gbWVtb3J5SWQ7XG5cbiAgICAvLyDmm7TmlrDorrDlv4blhoXlrrlcbiAgICBjb25zdCAkY29udGVudCA9ICQoJyNtZW1vcnktY29udGVudCcpO1xuICAgIGlmICgkY29udGVudC5sZW5ndGggPiAwKSB7XG4gICAgICAkY29udGVudC5lbXB0eSgpO1xuXG4gICAgICAvLyDlpoLmnpzmnInlm77niYfvvIzmmL7npLrlm77niYdcbiAgICAgIGlmIChtZW1vcnkuaW1hZ2UpIHtcbiAgICAgICAgJCgnPGRpdj4nLCB7XG4gICAgICAgICAgY2xhc3M6ICdtZW1vcnktY29udGVudC1pbWFnZScsXG4gICAgICAgICAgY3NzOiB7IGJhY2tncm91bmRJbWFnZTogYHVybCgnJHttZW1vcnkuaW1hZ2V9JylgIH0sXG4gICAgICAgIH0pLmFwcGVuZFRvKCRjb250ZW50KTtcbiAgICAgIH1cblxuICAgICAgLy8g5Yib5bu66K6w5b+G5YaF5a655YWD57SgXG4gICAgICAkKCc8ZGl2PicsIHtcbiAgICAgICAgY2xhc3M6ICdtZW1vcnktY29udGVudC10ZXh0JyxcbiAgICAgICAgdGV4dDogbWVtb3J5LmNvbnRlbnQsXG4gICAgICB9KS5hcHBlbmRUbygkY29udGVudCk7XG5cbiAgICAgIC8vIOWmguaenOacieaXtumXtOaIs++8jOaYvuekuuaXtumXtOaIs1xuICAgICAgaWYgKG1lbW9yeS50aW1lc3RhbXApIHtcbiAgICAgICAgJCgnPGRpdj4nLCB7XG4gICAgICAgICAgY2xhc3M6ICdtZW1vcnktdGltZXN0YW1wJyxcbiAgICAgICAgICB0ZXh0OiBtZW1vcnkudGltZXN0YW1wLFxuICAgICAgICB9KS5hcHBlbmRUbygkY29udGVudCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g5pu05paw6K6w5b+G6IqC54K55qC35byPXG4gICAgJCgnLm1lbW9yeS1ub2RlLXNpbXBsZScpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuICAgICQoYC5tZW1vcnktbm9kZS1zaW1wbGVbZGF0YS1pZD1cIiR7bWVtb3J5SWR9XCJdYCkuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cbiAgICAvLyDlkK/nlKjnqb/otormjInpkq5cbiAgICAkKCcjdHJhdmVsLXRvLW1lbW9yeScpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuXG4gICAgLy8g6LCD55So6YCJ5oup5Zue6LCDXG4gICAgaWYgKHRoaXMub25NZW1vcnlTZWxlY3RlZENhbGxiYWNrKSB7XG4gICAgICB0aGlzLm9uTWVtb3J5U2VsZWN0ZWRDYWxsYmFjayhtZW1vcnlJZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOepv+i2iuWIsOmAieS4reeahOiusOW/hlxuICAgKi9cbiAgcHJpdmF0ZSB0cmF2ZWxUb1NlbGVjdGVkTWVtb3J5KCkge1xuICAgIGlmICh0aGlzLnNlbGVjdGVkTWVtb3J5SWQgPT09IG51bGwpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+ayoeaciemAieS4reeahOiusOW/hueCuScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOiwg+eUqOepv+i2iuWbnuiwg1xuICAgIGlmICh0aGlzLm9uTWVtb3J5VHJhdmVsQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMub25NZW1vcnlUcmF2ZWxDYWxsYmFjayh0aGlzLnNlbGVjdGVkTWVtb3J5SWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDmlrDorrDlv4ZcbiAgICovXG4gIHB1YmxpYyBhZGRNZW1vcnkoY29udGVudDogc3RyaW5nLCBpbWFnZT86IHN0cmluZyk6IFN0b3J5TWVtb3J5IHwgbnVsbCB7XG4gICAgLy8g5qOA5p+l5piv5ZCm5bey57uP5L+d5a2Y6L+HXG4gICAgaWYgKHRoaXMuaGFzQ3JlYXRlZE1lbW9yeSkge1xuICAgICAgY29uc29sZS53YXJuKCfmraTlnLrmma/lt7Lkv53lrZjov4fvvIzmr4/kuKrlnLrmma/lj6rog73kv53lrZjkuIDmrKEnKTtcbiAgICAgIHRoaXMuc2hvd09uZVRpbWVPbmx5TWVzc2FnZSgpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8g55Sf5oiQ5pawSUTvvIjpgJrluLjlupTkvb/nlKjmuLjmiI/nirbmgIHmlbDmja7kuK3nmoTkuIvkuIDkuKpJRO+8iVxuICAgIGNvbnN0IG1lbW9yeUlkcyA9IF8ubWFwKHRoaXMubWVtb3JpZXMsICdpZCcpO1xuICAgIGNvbnN0IG5ld0lkID0gdGhpcy5tZW1vcmllcy5sZW5ndGggPiAwID8gKF8ubWF4KG1lbW9yeUlkcykgfHwgMCkgKyAxIDogMTtcblxuICAgIC8vIOWIm+W7uuaWsOiusOW/hlxuICAgIGNvbnN0IG5ld01lbW9yeTogU3RvcnlNZW1vcnkgPSB7XG4gICAgICBpZDogbmV3SWQsXG4gICAgICBjb250ZW50LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCksXG4gICAgICBpbWFnZSxcbiAgICB9O1xuXG4gICAgLy8g5re75Yqg5Yiw6K6w5b+G5YiX6KGoXG4gICAgdGhpcy5tZW1vcmllcy5wdXNoKG5ld01lbW9yeSk7XG5cbiAgICAvLyDmoIforrDkuLrlt7Lkv53lrZjlubblrZjlgqjliLDkvJror51cbiAgICB0aGlzLmhhc0NyZWF0ZWRNZW1vcnkgPSB0cnVlO1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5hbHJlYWR5U2F2ZWRLZXksICd0cnVlJyk7XG5cbiAgICAvLyDph43mlrDmuLLmn5Pml7bpl7TovbRcbiAgICB0aGlzLnJlbmRlck1lbW9yaWVzKCk7XG5cbiAgICAvLyDpgInkuK3mlrDorrDlv4ZcbiAgICB0aGlzLnNlbGVjdE1lbW9yeShuZXdJZCk7XG5cbiAgICAvLyDosIPnlKjkv53lrZjlm57osINcbiAgICBpZiAodGhpcy5vbk1lbW9yeVNhdmVkQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMub25NZW1vcnlTYXZlZENhbGxiYWNrKG5ld01lbW9yeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ld01lbW9yeTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrlj6rog73kv53lrZjkuIDmrKHnmoTmj5DnpLpcbiAgICovXG4gIHByaXZhdGUgc2hvd09uZVRpbWVPbmx5TWVzc2FnZSgpIHtcbiAgICAvLyDmmL7npLrkuIDkuKrkuLTml7bmj5DnpLrkv6Hmga9cbiAgICBjb25zdCAkbm90aWZpY2F0aW9uID0gJCgnPGRpdj4nLCB7XG4gICAgICBjbGFzczogJ25vdGlmaWNhdGlvbiBub3RpZmljYXRpb24td2FybmluZycsXG4gICAgICB0ZXh0OiAn5q2k5Zy65pmv5bey5L+d5a2Y6L+H77yM5q+P5Liq5Zy65pmv5Y+q6IO95L+d5a2Y5LiA5qyhJyxcbiAgICB9KS5hcHBlbmRUbygnI25vdGlmaWNhdGlvbi1jb250YWluZXInKTtcblxuICAgIC8vIOa3u+WKoOaYvuekuuexu1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgJG5vdGlmaWNhdGlvbi5hZGRDbGFzcygnbm90aWZpY2F0aW9uLXNob3cnKTtcbiAgICB9LCAxMCk7XG5cbiAgICAvLyDkuIDmrrXml7bpl7TlkI7pmpDol4/lkoznp7vpmaRcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICRub3RpZmljYXRpb24uYWRkQ2xhc3MoJ25vdGlmaWNhdGlvbi1oaWRlJykucmVtb3ZlQ2xhc3MoJ25vdGlmaWNhdGlvbi1zaG93Jyk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgJG5vdGlmaWNhdGlvbi5yZW1vdmUoKTtcbiAgICAgIH0sIDMwMCk7XG4gICAgfSwgMzAwMCk7XG4gIH1cblxuICAvKipcbiAgICog5Yig6Zmk6K6w5b+GXG4gICAqL1xuICBwdWJsaWMgZGVsZXRlTWVtb3J5KG1lbW9yeUlkOiBudW1iZXIpIHtcbiAgICAvLyDmn6Xmib7orrDlv4bntKLlvJVcbiAgICBjb25zdCBpbmRleCA9IF8uZmluZEluZGV4KHRoaXMubWVtb3JpZXMsIHsgaWQ6IG1lbW9yeUlkIH0pO1xuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOacquaJvuWIsElE5Li6JHttZW1vcnlJZH3nmoTorrDlv4ZgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDliKDpmaTorrDlv4ZcbiAgICB0aGlzLm1lbW9yaWVzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAvLyDph43mlrDmuLLmn5Pml7bpl7TovbRcbiAgICB0aGlzLnJlbmRlck1lbW9yaWVzKCk7XG5cbiAgICAvLyDlpoLmnpzliKDpmaTnmoTmmK/lvZPliY3pgInkuK3nmoTorrDlv4bvvIzmuIXpmaTpgInmi6lcbiAgICBpZiAodGhpcy5zZWxlY3RlZE1lbW9yeUlkID09PSBtZW1vcnlJZCkge1xuICAgICAgdGhpcy5zZWxlY3RlZE1lbW9yeUlkID0gbnVsbDtcbiAgICAgIHRoaXMuc2V0RW1wdHlNZW1vcnlDb250ZW50KCk7XG5cbiAgICAgIC8vIOemgeeUqOepv+i2iuaMiemSrlxuICAgICAgJCgnI3RyYXZlbC10by1tZW1vcnknKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3pgInkuK3nmoTorrDlv4ZcbiAgICovXG4gIHB1YmxpYyBnZXRTZWxlY3RlZE1lbW9yeSgpOiBTdG9yeU1lbW9yeSB8IG51bGwge1xuICAgIGlmICh0aGlzLnNlbGVjdGVkTWVtb3J5SWQgPT09IG51bGwpIHJldHVybiBudWxsO1xuXG4gICAgcmV0dXJuIF8uZmluZCh0aGlzLm1lbW9yaWVzLCB7IGlkOiB0aGlzLnNlbGVjdGVkTWVtb3J5SWQgfSkgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmiYDmnInorrDlv4ZcbiAgICovXG4gIHB1YmxpYyBnZXRBbGxNZW1vcmllcygpOiBTdG9yeU1lbW9yeVtdIHtcbiAgICAvLyDnoa7kv53ov5Tlm57nmoTmlbDmja7mmK/ljrvph43nmoRcbiAgICBjb25zdCB1bmlxdWVNZW1vcmllczogeyBba2V5OiBudW1iZXJdOiBTdG9yeU1lbW9yeSB9ID0ge307XG4gICAgdGhpcy5tZW1vcmllcy5mb3JFYWNoKG1lbW9yeSA9PiB7XG4gICAgICB1bmlxdWVNZW1vcmllc1ttZW1vcnkuaWRdID0gbWVtb3J5O1xuICAgIH0pO1xuICAgIHJldHVybiBfLmNsb25lRGVlcChPYmplY3QudmFsdWVzKHVuaXF1ZU1lbW9yaWVzKSk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u56m66K6w5b+G5YaF5a65XG4gICAqL1xuICBwdWJsaWMgc2V0RW1wdHlNZW1vcnlDb250ZW50KG1lc3NhZ2U6IHN0cmluZyA9ICfpgInmi6nkuIDkuKrorrDlv4bngrnmiJbkv53lrZjlvZPliY3lnLrmma8nKSB7XG4gICAgJCgnI21lbW9yeS1jb250ZW50JykuaHRtbChgPGRpdiBjbGFzcz1cIm1lbW9yeS1lbXB0eS1tZXNzYWdlXCI+JHttZXNzYWdlfTwvZGl2PmApO1xuXG4gICAgLy8g56aB55So56m/6LaK5oyJ6ZKuXG4gICAgJCgnI3RyYXZlbC10by1tZW1vcnknKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruiusOW/humAieaLqeWbnuiwg1xuICAgKi9cbiAgcHVibGljIHNldE9uTWVtb3J5U2VsZWN0ZWQoY2FsbGJhY2s6IChtZW1vcnlJZDogbnVtYmVyKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5vbk1lbW9yeVNlbGVjdGVkQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7orrDlv4bkv53lrZjlm57osINcbiAgICovXG4gIHB1YmxpYyBzZXRPbk1lbW9yeVNhdmVkKGNhbGxiYWNrOiAobWVtb3J5OiBTdG9yeU1lbW9yeSkgPT4gdm9pZCkge1xuICAgIHRoaXMub25NZW1vcnlTYXZlZENhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u6K6w5b+G56m/6LaK5Zue6LCDXG4gICAqL1xuICBwdWJsaWMgc2V0T25NZW1vcnlUcmF2ZWwoY2FsbGJhY2s6IChtZW1vcnlJZDogbnVtYmVyKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5vbk1lbW9yeVRyYXZlbENhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICAvKipcbiAgICog5riF56m66K6w5b+G5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgY2xlYXJNZW1vcmllcygpIHtcbiAgICB0aGlzLm1lbW9yaWVzID0gW107XG4gICAgdGhpcy5zZWxlY3RlZE1lbW9yeUlkID0gbnVsbDtcblxuICAgIC8vIOmHjee9ruS/neWtmOeKtuaAgVxuICAgIHRoaXMuaGFzQ3JlYXRlZE1lbW9yeSA9IGZhbHNlO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5hbHJlYWR5U2F2ZWRLZXkpO1xuXG4gICAgdGhpcy5yZW5kZXJNZW1vcmllcygpO1xuICAgIHRoaXMuc2V0RW1wdHlNZW1vcnlDb250ZW50KCk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5pi+56S6XG4gICAqL1xuICBwdWJsaWMgaW5pdGlhbGl6ZURpc3BsYXkoKSB7XG4gICAgLy8g5Y676YeN5aSE55CGXG4gICAgY29uc3QgdW5pcXVlTWVtb3JpZXM6IHsgW2tleTogbnVtYmVyXTogU3RvcnlNZW1vcnkgfSA9IHt9O1xuICAgIHRoaXMubWVtb3JpZXMuZm9yRWFjaChtZW1vcnkgPT4ge1xuICAgICAgdW5pcXVlTWVtb3JpZXNbbWVtb3J5LmlkXSA9IG1lbW9yeTtcbiAgICB9KTtcbiAgICB0aGlzLm1lbW9yaWVzID0gT2JqZWN0LnZhbHVlcyh1bmlxdWVNZW1vcmllcyk7XG5cbiAgICBpZiAodGhpcy5tZW1vcmllcy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLnJlbmRlck1lbW9yaWVzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0RW1wdHlNZW1vcnlDb250ZW50KCk7XG4gICAgfVxuXG4gICAgLy8g5qOA5p+l5piv5ZCm5bey5L+d5a2YXG4gICAgdGhpcy5jaGVja0lmQWxyZWFkeVNhdmVkKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/memoryManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/memoryUIManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MemoryUIManager: () => (/* binding */ MemoryUIManager)\n/* harmony export */ });\n/**\n * 记忆UI管理器\n * 负责处理游戏中的记忆功能UI部分\n */\nclass MemoryUIManager {\n    // 游戏数据引用\n    gameData = null;\n    // 依赖的其他管理器\n    memoryManager;\n    saveManager;\n    uiManager;\n    gameStateGenerationService;\n    constructor(memoryManager, saveManager, uiManager, gameStateGenerationService) {\n        this.memoryManager = memoryManager;\n        this.saveManager = saveManager;\n        this.uiManager = uiManager;\n        this.gameStateGenerationService = gameStateGenerationService;\n        console.log('记忆UI管理器初始化完成');\n    }\n    /**\n     * 设置游戏数据\n     * @param gameData 游戏数据\n     */\n    setGameData(gameData) {\n        this.gameData = gameData;\n    }\n    /**\n     * 刷新记忆时间轴\n     */\n    refreshMemoryTimeline() {\n        if (!this.gameData)\n            return;\n        this.memoryManager.setMemories(this.gameData.storySummary);\n        this.memoryManager.renderMemories();\n    }\n    /**\n     * 保存记忆\n     * @returns 新创建的记忆点\n     */\n    saveMemory() {\n        if (!this.gameData)\n            return null;\n        const newMemory = this.memoryManager.addMemory(`${this.gameData.story.currentChapter} - 在${this.gameData.story.location}`);\n        // 提示用户\n        this.uiManager.showNotification('记忆点已保存', 'success');\n        return newMemory;\n    }\n    /**\n     * 穿越到记忆点\n     * @param onSuccess 成功穿越后的回调函数\n     */\n    async travelToMemory(onSuccess) {\n        const selectedMemory = this.memoryManager.getSelectedMemory();\n        if (!selectedMemory) {\n            this.uiManager.showNotification('请先选择一个记忆点', 'warning');\n            return;\n        }\n        // 显示确认对话框\n        this.uiManager.showConfirmDialog(`确定要穿越到\"${selectedMemory.content}\"吗？`, async () => {\n            this.uiManager.showLoading('正在穿越时间...');\n            try {\n                let newState = null;\n                // 先尝试从世界书中加载游戏状态\n                const loadedState = await this.saveManager.loadGameStateByID(selectedMemory.id);\n                if (loadedState) {\n                    // 如果成功加载到，更新游戏状态\n                    newState = loadedState;\n                    console.log('从世界书中加载了游戏状态');\n                }\n                else {\n                    // 如果没有找到保存的状态，使用记忆点生成服务生成\n                    const generatedState = await this.gameStateGenerationService.generateMemoryState(selectedMemory);\n                    if (generatedState) {\n                        newState = generatedState;\n                        console.log('生成了新的记忆点游戏状态');\n                    }\n                    else {\n                        throw new Error('无法生成记忆点游戏状态');\n                    }\n                }\n                // 设置新的游戏状态\n                this.gameData = newState;\n                // 调用成功回调\n                onSuccess();\n                this.uiManager.showNotification('时间旅行成功', 'success');\n            }\n            catch (error) {\n                console.error('穿越时间失败:', error);\n                this.uiManager.showNotification('穿越失败: ' + (error instanceof Error ? error.message : '未知错误'), 'error');\n            }\n            finally {\n                this.uiManager.hideLoading();\n            }\n        });\n    }\n    /**\n     * 获取当前游戏数据\n     */\n    getGameData() {\n        return this.gameData;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvbWVtb3J5VUlNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0dBR0c7QUFRSSxNQUFNLGVBQWU7SUFDMUIsU0FBUztJQUNELFFBQVEsR0FBb0IsSUFBSSxDQUFDO0lBRXpDLFdBQVc7SUFDSCxhQUFhLENBQWdCO0lBQzdCLFdBQVcsQ0FBYztJQUN6QixTQUFTLENBQVk7SUFDckIsMEJBQTBCLENBQTZCO0lBRS9ELFlBQ0UsYUFBNEIsRUFDNUIsV0FBd0IsRUFDeEIsU0FBb0IsRUFDcEIsMEJBQXNEO1FBRXRELElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1FBQ25DLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQy9CLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQywwQkFBMEIsR0FBRywwQkFBMEIsQ0FBQztRQUU3RCxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxXQUFXLENBQUMsUUFBeUI7UUFDMUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVEOztPQUVHO0lBQ0kscUJBQXFCO1FBQzFCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUTtZQUFFLE9BQU87UUFFM0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsYUFBYSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3RDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxVQUFVO1FBQ2YsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFFaEMsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQzVDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsY0FBYyxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUUzRSxDQUFDO1FBRUYsT0FBTztRQUNQLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBRXJELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsY0FBYyxDQUFDLFNBQXFCO1FBQy9DLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUM5RCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDcEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDeEQsT0FBTztRQUNULENBQUM7UUFFRCxVQUFVO1FBQ1YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLGNBQWMsQ0FBQyxPQUFPLEtBQUssRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRixJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUV4QyxJQUFJLENBQUM7Z0JBQ0gsSUFBSSxRQUFRLEdBQW9CLElBQUksQ0FBQztnQkFFckMsaUJBQWlCO2dCQUNqQixNQUFNLFdBQVcsR0FBRyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUVoRixJQUFJLFdBQVcsRUFBRSxDQUFDO29CQUNoQixpQkFBaUI7b0JBQ2pCLFFBQVEsR0FBRyxXQUFXLENBQUM7b0JBQ3ZCLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQzlCLENBQUM7cUJBQU0sQ0FBQztvQkFDTiwwQkFBMEI7b0JBQzFCLE1BQU0sY0FBYyxHQUFHLE1BQU0sSUFBSSxDQUFDLDBCQUEwQixDQUFDLG1CQUFtQixDQUFDLGNBQWMsQ0FBQyxDQUFDO29CQUVqRyxJQUFJLGNBQWMsRUFBRSxDQUFDO3dCQUNuQixRQUFRLEdBQUcsY0FBYyxDQUFDO3dCQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO29CQUM5QixDQUFDO3lCQUFNLENBQUM7d0JBQ04sTUFBTSxJQUFJLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztvQkFDakMsQ0FBQztnQkFDSCxDQUFDO2dCQUVELFdBQVc7Z0JBQ1gsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7Z0JBRXpCLFNBQVM7Z0JBQ1QsU0FBUyxFQUFFLENBQUM7Z0JBRVosSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDdkQsQ0FBQztZQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7Z0JBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ2hDLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxHQUFHLENBQUMsS0FBSyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDekcsQ0FBQztvQkFBUyxDQUFDO2dCQUNULElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0IsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOztPQUVHO0lBQ0ksV0FBVztRQUNoQixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztDQUNGIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gv5ri45oiP55WM6Z2iL3NjcmlwdHMvY29tcG9uZW50cy9tZW1vcnlVSU1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDorrDlv4ZVSeeuoeeQhuWZqFxuICog6LSf6LSj5aSE55CG5ri45oiP5Lit55qE6K6w5b+G5Yqf6IO9VUnpg6jliIZcbiAqL1xuXG5pbXBvcnQgeyBHYW1lRGF0YSB9IGZyb20gJy4uL21vZGVscy9nYW1lRGF0YSc7XG5pbXBvcnQgeyBNZW1vcnlNYW5hZ2VyIH0gZnJvbSAnLi9tZW1vcnlNYW5hZ2VyJztcbmltcG9ydCB7IFNhdmVNYW5hZ2VyIH0gZnJvbSAnLi9zYXZlTWFuYWdlcic7XG5pbXBvcnQgeyBVSU1hbmFnZXIgfSBmcm9tICcuL3VpTWFuYWdlcic7XG5pbXBvcnQgeyBHYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2dhbWUtc3RhdGUtZ2VuZXJhdGlvbi5zZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIE1lbW9yeVVJTWFuYWdlciB7XG4gIC8vIOa4uOaIj+aVsOaNruW8leeUqFxuICBwcml2YXRlIGdhbWVEYXRhOiBHYW1lRGF0YSB8IG51bGwgPSBudWxsO1xuICBcbiAgLy8g5L6d6LWW55qE5YW25LuW566h55CG5ZmoXG4gIHByaXZhdGUgbWVtb3J5TWFuYWdlcjogTWVtb3J5TWFuYWdlcjtcbiAgcHJpdmF0ZSBzYXZlTWFuYWdlcjogU2F2ZU1hbmFnZXI7XG4gIHByaXZhdGUgdWlNYW5hZ2VyOiBVSU1hbmFnZXI7XG4gIHByaXZhdGUgZ2FtZVN0YXRlR2VuZXJhdGlvblNlcnZpY2U6IEdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lbW9yeU1hbmFnZXI6IE1lbW9yeU1hbmFnZXIsIFxuICAgIHNhdmVNYW5hZ2VyOiBTYXZlTWFuYWdlciwgXG4gICAgdWlNYW5hZ2VyOiBVSU1hbmFnZXIsXG4gICAgZ2FtZVN0YXRlR2VuZXJhdGlvblNlcnZpY2U6IEdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlXG4gICkge1xuICAgIHRoaXMubWVtb3J5TWFuYWdlciA9IG1lbW9yeU1hbmFnZXI7XG4gICAgdGhpcy5zYXZlTWFuYWdlciA9IHNhdmVNYW5hZ2VyO1xuICAgIHRoaXMudWlNYW5hZ2VyID0gdWlNYW5hZ2VyO1xuICAgIHRoaXMuZ2FtZVN0YXRlR2VuZXJhdGlvblNlcnZpY2UgPSBnYW1lU3RhdGVHZW5lcmF0aW9uU2VydmljZTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn6K6w5b+GVUnnrqHnkIblmajliJ3lp4vljJblrozmiJAnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7muLjmiI/mlbDmja5cbiAgICogQHBhcmFtIGdhbWVEYXRhIOa4uOaIj+aVsOaNrlxuICAgKi9cbiAgcHVibGljIHNldEdhbWVEYXRhKGdhbWVEYXRhOiBHYW1lRGF0YSB8IG51bGwpIHtcbiAgICB0aGlzLmdhbWVEYXRhID0gZ2FtZURhdGE7XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6K6w5b+G5pe26Ze06L20XG4gICAqL1xuICBwdWJsaWMgcmVmcmVzaE1lbW9yeVRpbWVsaW5lKCkge1xuICAgIGlmICghdGhpcy5nYW1lRGF0YSkgcmV0dXJuO1xuXG4gICAgdGhpcy5tZW1vcnlNYW5hZ2VyLnNldE1lbW9yaWVzKHRoaXMuZ2FtZURhdGEuc3RvcnlTdW1tYXJ5KTtcbiAgICB0aGlzLm1lbW9yeU1hbmFnZXIucmVuZGVyTWVtb3JpZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjorrDlv4ZcbiAgICogQHJldHVybnMg5paw5Yib5bu655qE6K6w5b+G54K5XG4gICAqL1xuICBwdWJsaWMgc2F2ZU1lbW9yeSgpOiBhbnkge1xuICAgIGlmICghdGhpcy5nYW1lRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBuZXdNZW1vcnkgPSB0aGlzLm1lbW9yeU1hbmFnZXIuYWRkTWVtb3J5KFxuICAgICAgYCR7dGhpcy5nYW1lRGF0YS5zdG9yeS5jdXJyZW50Q2hhcHRlcn0gLSDlnKgke3RoaXMuZ2FtZURhdGEuc3RvcnkubG9jYXRpb259YCxcbiAgICAgIC8vIOWPr+S7peiAg+iZkeS/neWtmOW9k+WJjeWcuuaZr+eahOaIquWbvlxuICAgICk7XG5cbiAgICAvLyDmj5DnpLrnlKjmiLdcbiAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCforrDlv4bngrnlt7Lkv53lrZgnLCAnc3VjY2VzcycpO1xuICAgIFxuICAgIHJldHVybiBuZXdNZW1vcnk7XG4gIH1cblxuICAvKipcbiAgICog56m/6LaK5Yiw6K6w5b+G54K5XG4gICAqIEBwYXJhbSBvblN1Y2Nlc3Mg5oiQ5Yqf56m/6LaK5ZCO55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdHJhdmVsVG9NZW1vcnkob25TdWNjZXNzOiAoKSA9PiB2b2lkKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRNZW1vcnkgPSB0aGlzLm1lbW9yeU1hbmFnZXIuZ2V0U2VsZWN0ZWRNZW1vcnkoKTtcbiAgICBpZiAoIXNlbGVjdGVkTWVtb3J5KSB7XG4gICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfor7flhYjpgInmi6nkuIDkuKrorrDlv4bngrknLCAnd2FybmluZycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOaYvuekuuehruiupOWvueivneahhlxuICAgIHRoaXMudWlNYW5hZ2VyLnNob3dDb25maXJtRGlhbG9nKGDnoa7lrpropoHnqb/otorliLBcIiR7c2VsZWN0ZWRNZW1vcnkuY29udGVudH1cIuWQl++8n2AsIGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dMb2FkaW5nKCfmraPlnKjnqb/otorml7bpl7QuLi4nKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IG5ld1N0YXRlOiBHYW1lRGF0YSB8IG51bGwgPSBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8g5YWI5bCd6K+V5LuO5LiW55WM5Lmm5Lit5Yqg6L295ri45oiP54q25oCBXG4gICAgICAgIGNvbnN0IGxvYWRlZFN0YXRlID0gYXdhaXQgdGhpcy5zYXZlTWFuYWdlci5sb2FkR2FtZVN0YXRlQnlJRChzZWxlY3RlZE1lbW9yeS5pZCk7XG5cbiAgICAgICAgaWYgKGxvYWRlZFN0YXRlKSB7XG4gICAgICAgICAgLy8g5aaC5p6c5oiQ5Yqf5Yqg6L295Yiw77yM5pu05paw5ri45oiP54q25oCBXG4gICAgICAgICAgbmV3U3RhdGUgPSBsb2FkZWRTdGF0ZTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn5LuO5LiW55WM5Lmm5Lit5Yqg6L295LqG5ri45oiP54q25oCBJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5aaC5p6c5rKh5pyJ5om+5Yiw5L+d5a2Y55qE54q25oCB77yM5L2/55So6K6w5b+G54K555Sf5oiQ5pyN5Yqh55Sf5oiQXG4gICAgICAgICAgY29uc3QgZ2VuZXJhdGVkU3RhdGUgPSBhd2FpdCB0aGlzLmdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlLmdlbmVyYXRlTWVtb3J5U3RhdGUoc2VsZWN0ZWRNZW1vcnkpO1xuXG4gICAgICAgICAgaWYgKGdlbmVyYXRlZFN0YXRlKSB7XG4gICAgICAgICAgICBuZXdTdGF0ZSA9IGdlbmVyYXRlZFN0YXRlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+eUn+aIkOS6huaWsOeahOiusOW/hueCuea4uOaIj+eKtuaAgScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOazleeUn+aIkOiusOW/hueCuea4uOaIj+eKtuaAgScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8g6K6+572u5paw55qE5ri45oiP54q25oCBXG4gICAgICAgIHRoaXMuZ2FtZURhdGEgPSBuZXdTdGF0ZTtcbiAgICAgICAgXG4gICAgICAgIC8vIOiwg+eUqOaIkOWKn+Wbnuiwg1xuICAgICAgICBvblN1Y2Nlc3MoKTtcblxuICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfml7bpl7Tml4XooYzmiJDlip8nLCAnc3VjY2VzcycpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign56m/6LaK5pe26Ze05aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign56m/6LaK5aSx6LSlOiAnICsgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+acquefpemUmeivrycpLCAnZXJyb3InKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRoaXMudWlNYW5hZ2VyLmhpZGVMb2FkaW5nKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3muLjmiI/mlbDmja5cbiAgICovXG4gIHB1YmxpYyBnZXRHYW1lRGF0YSgpOiBHYW1lRGF0YSB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmdhbWVEYXRhO1xuICB9XG59ICJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/memoryUIManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/saveManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SaveManager: () => (/* binding */ SaveManager)\n/* harmony export */ });\nclass SaveManager {\n    uiManager;\n    worldBookName = '修女的追忆记录'; // 使用固定名称\n    modalId = 'load-game-modal';\n    // 对话历史记录键名\n    DIALOGUE_HISTORY_KEY = 'persistent_dialogue_history';\n    // 完整历史记录键名\n    COMPLETE_HISTORY_KEY = 'complete_game_history';\n    // 存档类型\n    SAVE_TYPE = {\n        AUTO: 'auto_save_',\n        MANUAL: 'save_',\n    };\n    // 当前最大存档ID\n    currentMaxSaveId = {\n        auto: 0,\n        manual: 0,\n    };\n    // 缓存完整历史记录\n    cachedCompleteHistory = null;\n    constructor(uiManager) {\n        this.uiManager = uiManager;\n        this.initializeLoadGameModal();\n        this.initializeChatLorebook();\n        // 确保jQuery和Bootstrap正确加载\n        this.ensureBootstrapLoaded();\n        // 初始化时加载历史记录\n        this.loadCompleteHistory();\n    }\n    /**\n     * 确保Bootstrap正确加载\n     */\n    ensureBootstrapLoaded() {\n        // 检查jQuery是否已加载\n        if (typeof $ === 'undefined') {\n            console.error('jQuery未加载，这可能导致modal功能失效');\n            return;\n        }\n        // 检查Bootstrap的modal功能是否可用\n        if (typeof $.fn.modal !== 'function') {\n            console.warn('Bootstrap modal未检测到，尝试加载');\n            // 尝试动态添加Bootstrap的CSS和JS\n            if (!document.getElementById('bootstrap-css')) {\n                const bootstrapCss = document.createElement('link');\n                bootstrapCss.id = 'bootstrap-css';\n                bootstrapCss.rel = 'stylesheet';\n                bootstrapCss.href = 'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css';\n                document.head.appendChild(bootstrapCss);\n            }\n            if (!document.getElementById('bootstrap-js')) {\n                const bootstrapJs = document.createElement('script');\n                bootstrapJs.id = 'bootstrap-js';\n                bootstrapJs.src = 'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js';\n                bootstrapJs.onload = () => {\n                    console.log('Bootstrap已成功加载');\n                    // 重新初始化modal\n                    this.initializeLoadGameModal();\n                };\n                document.body.appendChild(bootstrapJs);\n            }\n        }\n    }\n    /**\n     * 初始化聊天世界书\n     */\n    async initializeChatLorebook() {\n        try {\n            console.log(`正在初始化固定世界书: ${this.worldBookName}`);\n            // 检查API可用性\n            if (typeof window.getLorebooks !== 'function' || typeof window.createLorebook !== 'function') {\n                console.error('世界书API不可用，无法初始化聊天世界书');\n                return;\n            }\n            // 获取所有世界书\n            const lorebooks = await window.getLorebooks();\n            // 检查我们的固定世界书是否存在\n            const worldBookExists = lorebooks.includes(this.worldBookName);\n            if (!worldBookExists) {\n                // 创建新的世界书\n                console.log(`创建新的固定世界书: ${this.worldBookName}`);\n                await window.createLorebook(this.worldBookName);\n                // 设置为当前聊天的世界书\n                if (typeof window.setChatLorebook === 'function') {\n                    await window.setChatLorebook(this.worldBookName);\n                }\n            }\n            else {\n                console.log(`找到现有的固定世界书: ${this.worldBookName}`);\n                // 确保设置为当前聊天的世界书\n                if (typeof window.setChatLorebook === 'function') {\n                    await window.setChatLorebook(this.worldBookName);\n                }\n            }\n            // 初始化当前最大存档ID\n            await this.initializeMaxSaveIds();\n        }\n        catch (error) {\n            console.error('初始化聊天世界书失败:', error);\n        }\n    }\n    /**\n     * 初始化最大存档ID\n     */\n    async initializeMaxSaveIds() {\n        try {\n            // 获取所有世界书条目\n            const allEntries = await this.getAllWorldBookEntries();\n            if (!allEntries || !allEntries.length)\n                return;\n            // 找出自动存档最大ID\n            const autoSaves = allEntries.filter(entry => this.checkEntryKeyStartsWith(entry, this.SAVE_TYPE.AUTO));\n            if (autoSaves.length > 0) {\n                this.currentMaxSaveId.auto = Math.max(...autoSaves.map(entry => {\n                    const idMatch = this.getEntryKey(entry).match(/(\\d+)$/);\n                    return idMatch ? parseInt(idMatch[1], 10) : 0;\n                }));\n            }\n            // 找出手动存档最大ID\n            const manualSaves = allEntries.filter(entry => this.checkEntryKeyStartsWith(entry, this.SAVE_TYPE.MANUAL));\n            if (manualSaves.length > 0) {\n                this.currentMaxSaveId.manual = Math.max(...manualSaves.map(entry => {\n                    const idMatch = this.getEntryKey(entry).match(/(\\d+)$/);\n                    return idMatch ? parseInt(idMatch[1], 10) : 0;\n                }));\n            }\n            console.log(`初始化存档ID: 自动存档=${this.currentMaxSaveId.auto}, 手动存档=${this.currentMaxSaveId.manual}`);\n        }\n        catch (error) {\n            console.error('初始化最大存档ID失败:', error);\n        }\n    }\n    /**\n     * 辅助函数：获取实际使用的键值\n     */\n    getEntryKey(entry) {\n        if (Array.isArray(entry.key) && entry.key.length > 0) {\n            return entry.key[0];\n        }\n        else if (typeof entry.key === 'string') {\n            return entry.key;\n        }\n        return '';\n    }\n    /**\n     * 获取所有世界书条目\n     */\n    async getAllWorldBookEntries() {\n        try {\n            if (!this.worldBookName) {\n                console.warn('无法获取世界书条目：世界书名为空');\n                // 尝试重新初始化世界书\n                await this.initializeChatLorebook();\n                if (!this.worldBookName) {\n                    return [];\n                }\n            }\n            // 检查API可用性\n            if (typeof window.getLorebookEntries !== 'function') {\n                console.error('世界书API不可用：getLorebookEntries函数未定义');\n                return [];\n            }\n            console.log(`正在获取世界书 ${this.worldBookName} 的所有条目...`);\n            // 尝试获取世界书条目\n            let entries;\n            try {\n                entries = await window.getLorebookEntries(this.worldBookName);\n            }\n            catch (apiError) {\n                console.error(`调用getLorebookEntries API出错:`, apiError);\n                // 如果失败，尝试使用triggerSlash作为后备方案\n                if (typeof window.triggerSlash === 'function') {\n                    try {\n                        console.log('尝试使用triggerSlash作为后备方案获取条目');\n                        const entriesJson = await window.triggerSlash(`/getlbentries ${this.worldBookName}`);\n                        if (entriesJson) {\n                            try {\n                                entries = JSON.parse(entriesJson);\n                            }\n                            catch (parseError) {\n                                console.error('解析triggerSlash返回结果失败:', parseError);\n                            }\n                        }\n                    }\n                    catch (slashError) {\n                        console.error('使用triggerSlash获取条目失败:', slashError);\n                    }\n                }\n            }\n            // 检查获取到的条目\n            if (!entries) {\n                console.log(`没有从世界书 ${this.worldBookName} 获取到条目`);\n                return [];\n            }\n            if (!Array.isArray(entries)) {\n                console.error('获取的条目不是数组类型:', entries);\n                return [];\n            }\n            console.log(`成功获取世界书条目，共 ${entries.length} 个`);\n            // 检查每个条目是否有效\n            if (entries.length > 0) {\n                const invalidEntries = entries.filter(entry => !entry || !entry.uid || typeof entry.uid !== 'number');\n                if (invalidEntries.length > 0) {\n                    console.warn(`发现 ${invalidEntries.length} 个无效条目（缺少UID或UID类型错误）`);\n                }\n            }\n            else {\n                console.log('世界书条目为空，可能是新创建的世界书');\n            }\n            return entries;\n        }\n        catch (error) {\n            console.error('获取世界书条目失败:', error);\n            return [];\n        }\n    }\n    /**\n     * 检查条目键是否以指定前缀开头\n     */\n    checkEntryKeyStartsWith(entry, prefix) {\n        if (!entry || !entry.key)\n            return false;\n        if (Array.isArray(entry.key)) {\n            // 对于数组类型的key，检查是否有任意元素以prefix开头\n            return entry.key.some((k) => k && typeof k === 'string' && k.startsWith(prefix));\n        }\n        else if (typeof entry.key === 'string') {\n            // 对于字符串类型的key，直接检查\n            return entry.key.startsWith(prefix);\n        }\n        return false;\n    }\n    /**\n     * 根据键名查找条目\n     */\n    findEntryByKey(entries, exactKey) {\n        if (!entries || !Array.isArray(entries)) {\n            console.warn('查找条目时传入的条目列表无效');\n            return null;\n        }\n        if (!exactKey) {\n            console.warn('查找条目时传入的键名为空');\n            return null;\n        }\n        const foundEntry = entries.find(entry => {\n            if (!entry)\n                return false;\n            if (Array.isArray(entry.key)) {\n                return entry.key.includes(exactKey);\n            }\n            return entry.key === exactKey;\n        });\n        if (foundEntry) {\n            if (!foundEntry.uid || typeof foundEntry.uid !== 'number' || isNaN(foundEntry.uid)) {\n                console.warn(`找到键名为 ${exactKey} 的条目，但其UID无效: ${foundEntry.uid}`);\n            }\n            else {\n                console.log(`找到键名为 ${exactKey} 的条目，UID: ${foundEntry.uid}`);\n            }\n        }\n        else {\n            console.log(`未找到键名为 ${exactKey} 的条目`);\n        }\n        return foundEntry;\n    }\n    /**\n     * 初始化加载游戏弹窗\n     */\n    initializeLoadGameModal() {\n        // 检查是否已存在弹窗\n        if ($(`#${this.modalId}`).length === 0) {\n            // 创建弹窗\n            const modalHtml = `\n      <div id=\"${this.modalId}\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"loadGameModalTitle\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-lg\" role=\"document\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\" id=\"loadGameModalTitle\"><i class=\"fas fa-book-open\"></i> 修道院典籍记录</h5>\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                <span aria-hidden=\"true\">&times;</span>\n              </button>\n            </div>\n            <div class=\"modal-body\">\n              <div class=\"save-tabs\">\n                <button class=\"save-tab-btn active\" data-tab=\"auto\"><i class=\"fas fa-clock\"></i> 时间记忆</button>\n                <button class=\"save-tab-btn\" data-tab=\"manual\"><i class=\"fas fa-bookmark\"></i> 永久典籍</button>\n              </div>\n              <div class=\"save-tab-content\">\n                <div id=\"auto-saves-container\" class=\"save-tab-pane active\">\n                  <ul id=\"auto-save-list\" class=\"save-list\">\n                    <li class=\"save-item empty\">暂无自动记录点</li>\n                  </ul>\n                </div>\n                <div id=\"manual-saves-container\" class=\"save-tab-pane\">\n                  <ul id=\"manual-save-list\" class=\"save-list\">\n                    <li class=\"save-item empty\">暂无手动保存的典籍</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button type=\"button\" class=\"btn btn-primary\" id=\"btn-create-manual-save\">\n                <i class=\"fas fa-feather-alt\"></i> 记录当前典籍\n              </button>\n              <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">关闭</button>\n            </div>\n          </div>\n        </div>\n      </div>`;\n            // 添加到页面\n            $('body').append(modalHtml);\n            // 确保模态框样式正确\n            const modalStyles = `\n        <style>\n          #${this.modalId} {\n            background-color: rgba(0, 0, 0, 0.5);\n          }\n          #${this.modalId}.show {\n            display: block !important;\n          }\n          .save-tabs {\n            display: flex;\n            border-bottom: 1px solid #dee2e6;\n            margin-bottom: 15px;\n          }\n          .save-tab-btn {\n            background: none;\n            border: none;\n            padding: 10px 15px;\n            cursor: pointer;\n            outline: none;\n          }\n          .save-tab-btn.active {\n            border-bottom: 2px solid #5d6e41;\n          }\n          .save-tab-pane {\n            display: none;\n          }\n          .save-tab-pane.active {\n            display: block;\n          }\n          .save-list {\n            list-style: none;\n            padding: 0;\n          }\n          .save-item {\n            margin-bottom: 10px;\n            border: 1px solid #dee2e6;\n            border-radius: 4px;\n            padding: 10px;\n            display: flex;\n            flex-direction: column;\n            cursor: pointer;\n            transition: box-shadow 0.3s;\n          }\n          .save-item:hover {\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n          }\n          .save-item.empty {\n            color: #6c757d;\n            cursor: default;\n            text-align: center;\n          }\n          .save-item-thumbnail {\n            height: 120px;\n            background-size: cover;\n            background-position: center;\n            border-radius: 4px;\n          }\n          .save-item-header {\n            display: flex;\n            justify-content: space-between;\n            margin: 10px 0 5px;\n          }\n          .save-item-title {\n            font-weight: bold;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n          }\n          .save-item-date {\n            font-size: 0.8em;\n            color: #6c757d;\n          }\n          .save-item-content {\n            font-size: 0.9em;\n            color: #333;\n            margin-bottom: 10px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n          }\n          .save-item-actions {\n            display: flex;\n            justify-content: space-between;\n          }\n          .btn-load, .btn-delete {\n            border: none;\n            padding: 5px 10px;\n            border-radius: 4px;\n            cursor: pointer;\n          }\n          .btn-load {\n            background-color: #5d6e41;\n            color: white;\n          }\n          .btn-delete {\n            background-color: #dc3545;\n            color: white;\n          }\n        </style>\n      `;\n            $('head').append(modalStyles);\n            // 移除原有事件绑定，防止重复绑定\n            $(document).off('click', `#${this.modalId} .save-tab-btn`);\n            $(document).off('click', '#btn-create-manual-save');\n            // 重新绑定标签切换事件\n            $(document).on('click', `#${this.modalId} .save-tab-btn`, e => {\n                const tabId = $(e.currentTarget).data('tab');\n                $(`#${this.modalId} .save-tab-btn`).removeClass('active');\n                $(`#${this.modalId} .save-tab-pane`).removeClass('active');\n                $(e.currentTarget).addClass('active');\n                if (tabId === 'auto') {\n                    $(`#auto-saves-container`).addClass('active');\n                }\n                else {\n                    $(`#manual-saves-container`).addClass('active');\n                }\n            });\n            // 绑定创建手动存档按钮事件\n            $(document).on('click', '#btn-create-manual-save', () => {\n                console.log('创建手动存档按钮被点击');\n                this.createManualSave();\n            });\n            // 绑定关闭按钮事件\n            $(document).on('click', `#${this.modalId} .close, #${this.modalId} .btn-secondary`, () => {\n                this.closeLoadGameModal();\n            });\n            // 如果点击模态框外部，关闭模态框\n            $(document).on('click', `#${this.modalId}`, e => {\n                if ($(e.target).attr('id') === this.modalId) {\n                    this.closeLoadGameModal();\n                }\n            });\n            console.log(`加载游戏弹窗已初始化，ID: ${this.modalId}`);\n        }\n    }\n    /**\n     * 关闭加载游戏弹窗\n     */\n    closeLoadGameModal() {\n        if (typeof $.fn.modal === 'function') {\n            $(`#${this.modalId}`).modal('hide');\n        }\n        else {\n            $(`#${this.modalId}`).css('display', 'none').removeClass('show');\n        }\n    }\n    /**\n     * 创建手动存档\n     */\n    async createManualSave() {\n        try {\n            console.log('开始创建手动存档流程');\n            // 显示确认对话框，让用户填写存档名称\n            this.uiManager.showInputDialog('请输入典籍标题', '手动存档', async (saveName) => {\n                console.log('用户输入的存档名称:', saveName);\n                if (!saveName) {\n                    saveName = '手动存档';\n                    console.log('使用默认存档名称:', saveName);\n                }\n                this.uiManager.showLoading('正在记录典籍...');\n                try {\n                    // 获取当前游戏状态\n                    console.log('获取当前游戏状态');\n                    const gameData = await this.getCurrentGameData();\n                    if (!gameData) {\n                        console.error('无法获取当前游戏状态');\n                        this.uiManager.showNotification('无法获取当前游戏状态', 'error');\n                        return;\n                    }\n                    console.log('成功获取当前游戏状态，准备保存');\n                    // 保存游戏状态\n                    const saveResult = await this.saveGameState(gameData, true, saveName);\n                    if (saveResult) {\n                        console.log('手动存档成功保存');\n                        this.uiManager.showNotification(`典籍\"${saveName}\"已成功记录`, 'success');\n                        // 重新加载存档列表\n                        console.log('刷新存档列表');\n                        this.refreshSaveList();\n                    }\n                    else {\n                        console.error('保存游戏状态失败');\n                        this.uiManager.showNotification('记录典籍失败', 'error');\n                    }\n                }\n                catch (error) {\n                    console.error('创建手动存档失败:', error);\n                    this.uiManager.showNotification('记录典籍失败', 'error');\n                }\n                finally {\n                    this.uiManager.hideLoading();\n                }\n            });\n        }\n        catch (error) {\n            console.error('创建手动存档流程出错:', error);\n            this.uiManager.showNotification('记录典籍失败', 'error');\n        }\n    }\n    /**\n     * 获取当前游戏数据\n     */\n    async getCurrentGameData() {\n        // 这里需要从游戏控制器中获取当前游戏数据\n        // 为简化实现，暂时通过自定义事件获取\n        return new Promise(resolve => {\n            // 创建自定义事件，请求当前游戏数据\n            const requestEvent = new CustomEvent('request_game_data', {\n                detail: { callback: (gameData) => resolve(gameData) },\n            });\n            window.dispatchEvent(requestEvent);\n            // 如果5秒内没有响应，返回null\n            setTimeout(() => resolve(null), 5000);\n        });\n    }\n    /**\n     * 显示加载游戏弹窗\n     */\n    async showLoadGameModal() {\n        try {\n            this.uiManager.showLoading('正在获取存档列表...');\n            // 先刷新存档列表\n            await this.refreshSaveList();\n            // 确保jQuery和Bootstrap正确加载\n            this.ensureBootstrapLoaded();\n            // 检查modal方法是否可用\n            if (typeof $.fn.modal !== 'function') {\n                console.log('Bootstrap modal方法不可用，使用替代方法显示弹窗');\n                // 替代方法：直接显示元素\n                const modalElement = $(`#${this.modalId}`);\n                modalElement\n                    .css({\n                    display: 'block',\n                    'padding-right': '17px',\n                })\n                    .addClass('show');\n                // 添加overflow样式到body\n                $('body').addClass('modal-open').css('overflow', 'hidden');\n            }\n            else {\n                console.log('使用Bootstrap modal方法显示弹窗');\n                // 使用Bootstrap的modal方法\n                try {\n                    $(`#${this.modalId}`).modal('show');\n                }\n                catch (modalError) {\n                    console.error('显示modal出错:', modalError);\n                    // 后备方案：直接显示元素\n                    $(`#${this.modalId}`)\n                        .css({\n                        display: 'block',\n                        'padding-right': '17px',\n                    })\n                        .addClass('show');\n                    // 添加overflow样式到body\n                    $('body').addClass('modal-open').css('overflow', 'hidden');\n                }\n            }\n            this.uiManager.hideLoading();\n        }\n        catch (error) {\n            console.error('显示加载游戏弹窗失败:', error);\n            this.uiManager.showNotification('获取存档列表失败', 'error');\n            this.uiManager.hideLoading();\n        }\n    }\n    /**\n     * 刷新存档列表\n     */\n    async refreshSaveList() {\n        try {\n            // 获取所有存档\n            const { autoSaves, manualSaves } = await this.getAllSaves();\n            // 更新自动存档列表\n            const $autoSaveList = $('#auto-save-list');\n            $autoSaveList.empty();\n            if (autoSaves.length === 0) {\n                $autoSaveList.append('<li class=\"save-item empty\">暂无自动存档</li>');\n            }\n            else {\n                // 按ID倒序排列，最新的存档在最前面\n                const sortedAutoSaves = autoSaves.sort((a, b) => b.saveId - a.saveId);\n                for (const save of sortedAutoSaves) {\n                    this.appendSaveItem($autoSaveList, save);\n                }\n            }\n            // 更新手动存档列表\n            const $manualSaveList = $('#manual-save-list');\n            $manualSaveList.empty();\n            if (manualSaves.length === 0) {\n                $manualSaveList.append('<li class=\"save-item empty\">暂无手动存档</li>');\n            }\n            else {\n                // 按ID倒序排列，最新的存档在最前面\n                const sortedManualSaves = manualSaves.sort((a, b) => b.saveId - a.saveId);\n                for (const save of sortedManualSaves) {\n                    this.appendSaveItem($manualSaveList, save);\n                }\n            }\n        }\n        catch (error) {\n            console.error('刷新存档列表失败:', error);\n            throw error;\n        }\n    }\n    /**\n     * 添加存档项到列表\n     */\n    appendSaveItem($list, save) {\n        // 生成缩略图URL\n        let thumbnailUrl = '';\n        if (save.thumbnail) {\n            thumbnailUrl = save.thumbnail;\n        }\n        else {\n            // 使用默认图片，根据存档类型选择不同的默认图片\n            thumbnailUrl = save.isAuto\n                ? 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E4%B9%A6%E5%BA%97%E5%86%85/%E4%B9%A6%E5%BA%97.jpg?ref_type=heads'\n                : 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%83%8C%E6%99%AF/%E5%85%AC%E5%9B%AD/%E7%99%BD%E5%A4%A9.jpg?ref_type=heads';\n        }\n        const $saveItem = $('<li>', {\n            class: 'save-item',\n            'data-key': save.key,\n        });\n        // 添加缩略图\n        $('<div>', {\n            class: 'save-item-thumbnail',\n            style: `background-image: url(${thumbnailUrl})`,\n        }).appendTo($saveItem);\n        // 添加标题和日期\n        const $header = $('<div>', { class: 'save-item-header' });\n        $('<div>', {\n            class: 'save-item-title',\n            text: save.title,\n        }).appendTo($header);\n        $('<div>', {\n            class: 'save-item-date',\n            text: save.date,\n        }).appendTo($header);\n        $header.appendTo($saveItem);\n        // 添加内容摘要\n        $('<div>', {\n            class: 'save-item-content',\n            text: save.content || '无可用内容',\n        }).appendTo($saveItem);\n        // 添加操作按钮\n        const $actions = $('<div>', { class: 'save-item-actions' });\n        // 创建加载按钮\n        const $loadBtn = $('<button>', {\n            class: 'btn-load',\n            html: '<i class=\"fas fa-book-reader\"></i> 阅读',\n            'data-key': save.key,\n        });\n        // 创建删除按钮\n        const $deleteBtn = $('<button>', {\n            class: 'btn-delete',\n            html: '<i class=\"fas fa-trash-alt\"></i> 销毁',\n            'data-key': save.key,\n            'data-title': save.title,\n        });\n        // 将按钮添加到操作区域\n        $actions.append($loadBtn).append($deleteBtn);\n        $actions.appendTo($saveItem);\n        // 将整个存档项添加到列表\n        $list.append($saveItem);\n        // 使用直接事件绑定，避免使用on代理导致的问题\n        $loadBtn.on('click', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            console.log('点击加载按钮，key:', save.key);\n            this.loadGameFromKey(save.key);\n            return false;\n        });\n        $deleteBtn.on('click', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            console.log('点击删除按钮，key:', save.key, 'title:', save.title);\n            this.deleteSave(save.key, save.title);\n            return false;\n        });\n        // 为整个存档项添加点击事件\n        $saveItem.on('click', e => {\n            // 如果点击的是操作按钮，不进行处理\n            if ($(e.target).closest('.save-item-actions').length > 0) {\n                return;\n            }\n            // 否则触发加载存档\n            console.log('点击存档项，key:', save.key);\n            this.loadGameFromKey(save.key);\n        });\n    }\n    /**\n     * 删除存档\n     */\n    async deleteSave(saveKey, saveTitle) {\n        try {\n            console.log('准备删除存档，key:', saveKey, 'title:', saveTitle);\n            // 确认删除\n            this.uiManager.showConfirmDialog(`确定要销毁典籍\"${saveTitle}\"吗？此操作不可逆。`, async () => {\n                console.log('用户确认删除存档，开始删除过程');\n                this.uiManager.showLoading('正在销毁典籍...');\n                try {\n                    const allEntries = await window.getLorebookEntries(this.worldBookName);\n                    const saveEntry = this.findEntryByKey(allEntries, saveKey);\n                    if (saveEntry && saveEntry.uid) {\n                        console.log(`找到存档条目，准备删除 UID=${saveEntry.uid}`);\n                        await window.deleteLorebookEntry(this.worldBookName, saveEntry.uid);\n                        // 刷新存档列表\n                        await this.refreshSaveList();\n                        this.uiManager.showNotification(`典籍\"${saveTitle}\"已成功销毁`, 'success');\n                    }\n                    else {\n                        console.error('找不到要删除的存档条目');\n                        this.uiManager.showNotification('找不到指定的典籍记录', 'error');\n                    }\n                }\n                catch (error) {\n                    console.error('删除存档过程中出错:', error);\n                    this.uiManager.showNotification('销毁典籍失败: ' + (error instanceof Error ? error.message : '未知错误'), 'error');\n                }\n                finally {\n                    this.uiManager.hideLoading();\n                }\n            });\n        }\n        catch (error) {\n            console.error('删除存档过程出错:', error);\n            this.uiManager.showNotification('销毁典籍失败', 'error');\n        }\n    }\n    /**\n     * 获取所有游戏存档\n     */\n    async getAllSaves() {\n        try {\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                await this.initializeChatLorebook();\n            }\n            // 检查API是否可用\n            if (!this.worldBookName || typeof window.getLorebookEntries !== 'function') {\n                console.warn('世界书API不可用，无法获取存档');\n                return { autoSaves: [], manualSaves: [] };\n            }\n            // 获取所有世界书条目\n            const allEntries = await this.getAllWorldBookEntries();\n            if (!allEntries || !Array.isArray(allEntries) || allEntries.length === 0) {\n                return { autoSaves: [], manualSaves: [] };\n            }\n            // 筛选出自动存档条目\n            const autoSaveEntries = allEntries.filter(entry => this.checkEntryKeyStartsWith(entry, this.SAVE_TYPE.AUTO));\n            // 筛选出手动存档条目\n            const manualSaveEntries = allEntries.filter(entry => this.checkEntryKeyStartsWith(entry, this.SAVE_TYPE.MANUAL));\n            console.log(`找到 ${autoSaveEntries.length} 个自动存档和 ${manualSaveEntries.length} 个手动存档`);\n            // 处理自动存档数据\n            const autoSaves = await Promise.all(autoSaveEntries.map(entry => this.processSaveEntry(entry, true)));\n            // 处理手动存档数据\n            const manualSaves = await Promise.all(manualSaveEntries.map(entry => this.processSaveEntry(entry, false)));\n            // 过滤掉处理失败的存档并按ID排序\n            return {\n                autoSaves: autoSaves.filter(save => save !== null).sort((a, b) => b.saveId - a.saveId),\n                manualSaves: manualSaves.filter(save => save !== null).sort((a, b) => b.saveId - a.saveId),\n            };\n        }\n        catch (error) {\n            console.error('获取存档列表失败:', error);\n            return { autoSaves: [], manualSaves: [] };\n        }\n    }\n    /**\n     * 处理存档条目\n     */\n    async processSaveEntry(entry, isAuto) {\n        try {\n            if (!entry || !entry.key) {\n                console.warn('无效的存档条目:', entry);\n                return null;\n            }\n            // 获取键值（可能是字符串或数组）\n            let entryKey = '';\n            if (Array.isArray(entry.key) && entry.key.length > 0) {\n                // 查找符合条件的键\n                const prefix = isAuto ? this.SAVE_TYPE.AUTO : this.SAVE_TYPE.MANUAL;\n                const matchingKey = entry.key.find((k) => k && typeof k === 'string' && k.startsWith(prefix));\n                if (matchingKey) {\n                    entryKey = matchingKey;\n                }\n                else {\n                    entryKey = entry.key[0]; // 默认使用第一个键\n                }\n            }\n            else if (typeof entry.key === 'string') {\n                entryKey = entry.key;\n            }\n            else {\n                console.warn('无效的键值类型:', entry.key);\n                return null;\n            }\n            // 从键中提取存档ID\n            const idMatch = entryKey.match(/(\\d+)$/);\n            const saveId = idMatch ? parseInt(idMatch[1], 10) : 0;\n            // 获取简要内容用于显示\n            const savePreview = {\n                key: entryKey,\n                uid: entry.uid, // 保存UID用于后续操作\n                title: entry.comment || (isAuto ? `自动记录点 #${saveId}` : `永久典籍 #${saveId}`),\n                saveId: saveId,\n                date: new Date(entry.created_at || Date.now()).toLocaleString(),\n                content: '',\n                thumbnail: '',\n                isAuto: isAuto,\n            };\n            // 尝试获取存档内容的摘要和缩略图\n            try {\n                // 优先使用条目的直接内容\n                let content = '';\n                if (entry.content) {\n                    content = entry.content;\n                }\n                else if (typeof window.triggerSlash === 'function') {\n                    content = await window.triggerSlash(`/getentryfield file=${this.worldBookName} field=content ${entryKey}`);\n                }\n                if (content) {\n                    try {\n                        const gameData = JSON.parse(content);\n                        if (gameData.storySummary && gameData.storySummary.length > 0) {\n                            const latestSummary = gameData.storySummary[gameData.storySummary.length - 1];\n                            savePreview.content = latestSummary.content;\n                            // 如果有图片，则使用该图片作为缩略图\n                            if (latestSummary.image) {\n                                savePreview.thumbnail = latestSummary.image;\n                            }\n                        }\n                    }\n                    catch (jsonError) {\n                        console.warn('解析存档内容失败:', jsonError);\n                    }\n                }\n            }\n            catch (error) {\n                console.warn('无法获取存档内容摘要:', error);\n            }\n            return savePreview;\n        }\n        catch (error) {\n            console.error('处理存档数据出错:', error);\n            return null;\n        }\n    }\n    /**\n     * 从存档键加载游戏\n     */\n    async loadGameFromKey(saveKey) {\n        try {\n            console.log('准备加载存档，key:', saveKey);\n            // 确认加载\n            this.uiManager.showConfirmDialog('确定要加载此存档吗？当前游戏进度将丢失。', async () => {\n                console.log('用户确认加载存档，开始加载过程');\n                this.uiManager.showLoading('正在加载存档...');\n                try {\n                    // 加载游戏状态\n                    const gameData = await this.loadGameState(saveKey);\n                    if (gameData) {\n                        console.log('存档加载成功，准备关闭弹窗并更新游戏状态');\n                        // 关闭弹窗\n                        this.closeLoadGameModal();\n                        // 触发加载完成事件，传递游戏数据给游戏控制器\n                        console.log('触发gameloaded事件');\n                        const loadEvent = new CustomEvent('gameloaded', {\n                            detail: { gameData },\n                        });\n                        window.dispatchEvent(loadEvent);\n                        this.uiManager.showNotification('加载存档成功', 'success');\n                    }\n                    else {\n                        console.error('加载游戏状态失败，gameData为null');\n                        this.uiManager.showNotification('加载存档失败', 'error');\n                    }\n                }\n                catch (error) {\n                    console.error('加载存档处理过程中出错:', error);\n                    this.uiManager.showNotification('加载存档失败: ' + (error instanceof Error ? error.message : '未知错误'), 'error');\n                }\n                finally {\n                    this.uiManager.hideLoading();\n                }\n            });\n        }\n        catch (error) {\n            console.error('加载存档过程出错:', error);\n            this.uiManager.showNotification('加载存档失败', 'error');\n        }\n    }\n    /**\n     * 将当前游戏状态保存到世界书\n     * @param gameData 游戏数据\n     * @param isManual 是否为手动存档\n     * @param customName 自定义存档名称（仅用于手动存档）\n     */\n    async saveGameState(gameData, isManual = false, customName) {\n        if (!gameData || !gameData.storySummary || gameData.storySummary.length === 0) {\n            console.warn('没有可保存的游戏状态');\n            return false;\n        }\n        try {\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                console.log('世界书名称为空，重新初始化');\n                await this.initializeChatLorebook();\n                if (!this.worldBookName) {\n                    console.error('初始化世界书失败，无法保存游戏状态');\n                    this.uiManager.showNotification('无法初始化世界书，保存失败', 'error');\n                    return false;\n                }\n            }\n            // 检查世界书API是否可用\n            if (typeof window.getLorebookEntries !== 'function') {\n                console.error('世界书API不可用');\n                this.uiManager.showNotification('世界书API不可用，无法保存游戏状态', 'error');\n                return false;\n            }\n            // 根据保存类型确定存档ID和键名前缀\n            const saveType = isManual ? this.SAVE_TYPE.MANUAL : this.SAVE_TYPE.AUTO;\n            const nextId = isManual ? ++this.currentMaxSaveId.manual : ++this.currentMaxSaveId.auto;\n            const saveKey = `${saveType}${nextId}`;\n            // 创建存档名称\n            let saveName = '';\n            let dialogueCount = gameData.story.dialogue.length;\n            let memoriesCount = gameData.storySummary.length;\n            if (isManual && customName) {\n                saveName = `${customName} #${nextId} [对话:${dialogueCount}条|记忆:${memoriesCount}条]`;\n            }\n            else if (isManual) {\n                saveName = `手动存档 #${nextId} [对话:${dialogueCount}条|记忆:${memoriesCount}条]`;\n            }\n            else {\n                // 自动存档名称，格式为\"自动存档#ID-记忆描述\"\n                const latestSummary = gameData.storySummary[gameData.storySummary.length - 1];\n                const shortDescription = latestSummary.content.substring(0, 30) + (latestSummary.content.length > 30 ? '...' : '');\n                saveName = `自动存档 #${nextId}-${shortDescription} [对话:${dialogueCount}条|记忆:${memoriesCount}条]`;\n            }\n            // 先保存完整历史记录，确保对话历史和游戏状态同步\n            await this.saveDialogueHistory(gameData);\n            // 准备保存数据\n            const saveData = JSON.stringify(gameData);\n            // 记录开始保存时间，用于超时判断\n            const startTime = Date.now();\n            const MAX_RETRY = 3;\n            const TIMEOUT_MS = 10000; // 10秒超时\n            for (let retry = 0; retry < MAX_RETRY; retry++) {\n                try {\n                    // 获取所有条目，检查是否已存在相同key的条目\n                    console.log(`获取世界书条目，尝试 ${retry + 1}/${MAX_RETRY}`);\n                    const allEntries = await window.getLorebookEntries(this.worldBookName);\n                    const saveEntry = this.findEntryByKey(allEntries, saveKey);\n                    // 设定一个Promise，当超时时拒绝\n                    const saveWithTimeout = async (promise) => {\n                        const timeout = new Promise((_, reject) => {\n                            setTimeout(() => reject(new Error('操作超时')), TIMEOUT_MS);\n                        });\n                        return Promise.race([promise, timeout]);\n                    };\n                    // 如果存在相同key的条目，更新而不是创建新条目\n                    if (saveEntry) {\n                        console.log(`存档 ${saveKey} 已存在，将更新条目 uid=${saveEntry.uid}`);\n                        if (typeof saveEntry.uid !== 'number' || isNaN(saveEntry.uid)) {\n                            throw new Error(`无效的UID: ${saveEntry.uid}`);\n                        }\n                        // 创建需要更新的条目对象\n                        const updateEntry = {\n                            uid: saveEntry.uid,\n                            comment: saveName,\n                            content: saveData,\n                        };\n                        try {\n                            if (typeof window.setLorebookEntries === 'function') {\n                                await saveWithTimeout(window.setLorebookEntries(this.worldBookName, [updateEntry]));\n                                console.log(`成功更新条目 UID=${saveEntry.uid}`);\n                                // 更新成功，跳出重试循环\n                                break;\n                            }\n                            else if (typeof window.editLorebookEntry === 'function') {\n                                await saveWithTimeout(window.editLorebookEntry(this.worldBookName, saveEntry.uid, {\n                                    comment: saveName,\n                                    content: saveData,\n                                }));\n                                console.log(`成功更新条目 UID=${saveEntry.uid} (使用editLorebookEntry)`);\n                                break;\n                            }\n                            else {\n                                // 如果没有更新API，则删除后重建\n                                await saveWithTimeout(window.deleteLorebookEntry(this.worldBookName, saveEntry.uid));\n                                const newUid = await saveWithTimeout(window.createLorebookEntry(this.worldBookName, {\n                                    key: [saveKey],\n                                    comment: saveName,\n                                    content: saveData,\n                                }));\n                                if (newUid > 0) {\n                                    console.log(`成功删除旧条目并创建新条目 UID=${newUid}`);\n                                    break;\n                                }\n                                else {\n                                    throw new Error(`创建新条目失败，返回的UID无效: ${newUid}`);\n                                }\n                            }\n                        }\n                        catch (updateError) {\n                            console.error(`更新条目尝试 ${retry + 1} 失败:`, updateError);\n                            // 如果不是最后一次尝试，等待后重试\n                            if (retry < MAX_RETRY - 1) {\n                                console.log(`等待500ms后重试...`);\n                                await new Promise(resolve => setTimeout(resolve, 500));\n                            }\n                            else {\n                                throw updateError; // 最后一次尝试失败，向上抛出错误\n                            }\n                        }\n                    }\n                    else {\n                        // 创建新条目\n                        console.log(`存档 ${saveKey} 不存在，将创建新条目`);\n                        // 准备创建的条目对象\n                        const newEntry = {\n                            key: [saveKey],\n                            comment: saveName,\n                            content: saveData,\n                        };\n                        try {\n                            let success = false;\n                            // 尝试使用新API创建条目\n                            if (typeof window.createLorebookEntries === 'function') {\n                                const result = await saveWithTimeout(window.createLorebookEntries(this.worldBookName, [newEntry]));\n                                if (result && result.new_uids && result.new_uids.length > 0) {\n                                    console.log(`成功创建新条目，UID=${result.new_uids[0]}`);\n                                    success = true;\n                                }\n                                else {\n                                    console.warn('createLorebookEntries返回结果无效，将尝试旧API');\n                                }\n                            }\n                            // 如果新API失败或不可用，尝试旧API\n                            if (!success && typeof window.createLorebookEntry === 'function') {\n                                const uid = await saveWithTimeout(window.createLorebookEntry(this.worldBookName, newEntry));\n                                if (uid > 0) {\n                                    console.log(`成功创建新条目，UID=${uid}`);\n                                    success = true;\n                                }\n                                else {\n                                    throw new Error(`创建条目失败，返回的UID无效: ${uid}`);\n                                }\n                            }\n                            if (success) {\n                                break; // 创建成功，跳出重试循环\n                            }\n                            else {\n                                throw new Error('没有可用的API创建条目');\n                            }\n                        }\n                        catch (createError) {\n                            console.error(`创建条目尝试 ${retry + 1} 失败:`, createError);\n                            // 如果不是最后一次尝试，等待后重试\n                            if (retry < MAX_RETRY - 1) {\n                                console.log(`等待500ms后重试...`);\n                                await new Promise(resolve => setTimeout(resolve, 500));\n                            }\n                            else {\n                                throw createError; // 最后一次尝试失败，向上抛出错误\n                            }\n                        }\n                    }\n                }\n                catch (error) {\n                    // 处理最后一次失败的情况\n                    if (retry === MAX_RETRY - 1) {\n                        throw error;\n                    }\n                }\n            }\n            // 保存成功，记录当前ID\n            if (isManual) {\n                this.currentMaxSaveId.manual = nextId;\n            }\n            else {\n                this.currentMaxSaveId.auto = nextId;\n            }\n            console.log(`已成功保存游戏状态到世界书，包含 ${dialogueCount} 条对话和 ${memoriesCount} 条记忆`);\n            return true;\n        }\n        catch (error) {\n            console.error('保存游戏状态到世界书失败:', error);\n            this.uiManager.showNotification('保存游戏状态失败: ' + (error instanceof Error ? error.message : '未知错误'), 'error');\n            return false;\n        }\n    }\n    /**\n     * 加载完整历史记录\n     */\n    async loadCompleteHistory() {\n        try {\n            // 如果已有缓存记录，直接返回\n            if (this.cachedCompleteHistory) {\n                return this.cachedCompleteHistory;\n            }\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                await this.initializeChatLorebook();\n            }\n            // 检查API是否可用\n            if (typeof window.getLorebookEntries !== 'function') {\n                console.warn('世界书API不可用，无法加载完整历史记录');\n                return null;\n            }\n            // 获取所有世界书条目\n            const allEntries = await window.getLorebookEntries(this.worldBookName);\n            if (!allEntries || !Array.isArray(allEntries)) {\n                console.warn('未找到世界书条目');\n                return null;\n            }\n            // 查找完整历史记录条目\n            const historyEntry = this.findEntryByKey(allEntries, this.COMPLETE_HISTORY_KEY);\n            if (!historyEntry) {\n                console.log('未找到完整历史记录条目，将创建新记录');\n                // 创建新的完整历史记录\n                const newHistory = {\n                    id: `history_${Date.now()}`,\n                    dialogues: [],\n                    memories: [],\n                };\n                this.cachedCompleteHistory = newHistory;\n                return newHistory;\n            }\n            // 获取条目内容\n            let historyContent = '';\n            // 尝试获取条目内容\n            if (historyEntry.content) {\n                historyContent = historyEntry.content;\n            }\n            else if (typeof window.triggerSlash === 'function') {\n                // 使用triggerSlash获取\n                historyContent = await window.triggerSlash(`/getentryfield file=${this.worldBookName} field=content ${this.COMPLETE_HISTORY_KEY}`);\n            }\n            if (!historyContent) {\n                console.log('完整历史记录内容为空，将创建新记录');\n                // 创建新的完整历史记录\n                const newHistory = {\n                    id: `history_${Date.now()}`,\n                    dialogues: [],\n                    memories: [],\n                };\n                this.cachedCompleteHistory = newHistory;\n                return newHistory;\n            }\n            try {\n                // 解析JSON内容\n                const history = JSON.parse(historyContent);\n                if (!history.id || !Array.isArray(history.dialogues) || !Array.isArray(history.memories)) {\n                    throw new Error('历史记录格式不正确');\n                }\n                console.log(`成功加载完整历史记录，包含 ${history.dialogues.length} 条对话和 ${history.memories.length} 条记忆`);\n                this.cachedCompleteHistory = history;\n                return history;\n            }\n            catch (parseError) {\n                console.error('解析完整历史记录失败:', parseError);\n                // 创建新的完整历史记录\n                const newHistory = {\n                    id: `history_${Date.now()}`,\n                    dialogues: [],\n                    memories: [],\n                };\n                this.cachedCompleteHistory = newHistory;\n                return newHistory;\n            }\n        }\n        catch (error) {\n            console.error('加载完整历史记录失败:', error);\n            return null;\n        }\n    }\n    /**\n     * 保存完整历史记录\n     */\n    async saveCompleteHistory(history) {\n        try {\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                await this.initializeChatLorebook();\n            }\n            // 检查API是否可用\n            if (!this.worldBookName || typeof window.getLorebookEntries !== 'function') {\n                console.warn('世界书API不可用，无法保存完整历史记录');\n                return false;\n            }\n            // 获取所有世界书条目\n            const allEntries = await window.getLorebookEntries(this.worldBookName);\n            // 查找完整历史记录条目\n            const historyEntry = this.findEntryByKey(allEntries, this.COMPLETE_HISTORY_KEY);\n            // 历史记录标题\n            const historyTitle = `完整游戏历史记录 - 最后更新: ${new Date().toLocaleString()}`;\n            // 转换为JSON字符串\n            const historyContent = JSON.stringify(history);\n            if (historyEntry) {\n                // 更新现有条目\n                if (typeof window.editLorebookEntry === 'function') {\n                    await window.editLorebookEntry(this.worldBookName, historyEntry.uid, {\n                        comment: historyTitle,\n                        content: historyContent,\n                    });\n                }\n                else {\n                    // 回退到旧API：删除并重建\n                    await window.deleteLorebookEntry(this.worldBookName, historyEntry.uid);\n                    await window.createLorebookEntry(this.worldBookName, {\n                        keys: [this.COMPLETE_HISTORY_KEY],\n                        comment: historyTitle,\n                        content: historyContent,\n                    });\n                }\n                console.log('更新了完整历史记录');\n            }\n            else {\n                // 创建新条目\n                await window.createLorebookEntry(this.worldBookName, {\n                    keys: [this.COMPLETE_HISTORY_KEY],\n                    comment: historyTitle,\n                    content: historyContent,\n                });\n                console.log('创建了新的完整历史记录条目');\n            }\n            // 更新缓存\n            this.cachedCompleteHistory = history;\n            return true;\n        }\n        catch (error) {\n            console.error('保存完整历史记录失败:', error);\n            return false;\n        }\n    }\n    /**\n     * 保存对话历史到世界书\n     * 使用完整历史记录存储所有对话和记忆\n     */\n    async saveDialogueHistory(gameData) {\n        if (!gameData.story || !gameData.story.dialogue) {\n            console.warn('没有可保存的对话历史');\n            return false;\n        }\n        try {\n            // 加载当前的完整历史记录\n            let completeHistory = await this.loadCompleteHistory();\n            if (!completeHistory) {\n                // 创建新的完整历史记录\n                completeHistory = {\n                    id: `history_${Date.now()}`,\n                    dialogues: [],\n                    memories: [],\n                };\n            }\n            // 添加所有对话到历史记录（避免重复）\n            const existingDialogueCount = completeHistory.dialogues.length;\n            // 转换所有对话为简化格式\n            const allDialogues = gameData.story.dialogue.map(dialogue => ({\n                speaker: dialogue.speaker,\n                content: dialogue.content,\n                style: dialogue.style,\n            }));\n            // 避免重复添加对话，只添加新的对话\n            if (existingDialogueCount < allDialogues.length) {\n                completeHistory.dialogues = allDialogues;\n                console.log(`更新对话历史：从 ${existingDialogueCount} 条增加到 ${allDialogues.length} 条`);\n            }\n            // 添加所有记忆点到历史记录（避免重复）\n            if (gameData.storySummary && gameData.storySummary.length > 0) {\n                // 映射现有记忆点的ID\n                const existingMemoryIds = new Set(completeHistory.memories.map(m => m.id));\n                // 添加不存在的新记忆点\n                for (const memory of gameData.storySummary) {\n                    if (!existingMemoryIds.has(memory.id)) {\n                        completeHistory.memories.push({\n                            id: memory.id,\n                            content: memory.content,\n                        });\n                        existingMemoryIds.add(memory.id);\n                    }\n                }\n                console.log(`更新记忆历史：当前共有 ${completeHistory.memories.length} 条记忆`);\n            }\n            // 保存完整历史记录\n            const saveResult = await this.saveCompleteHistory(completeHistory);\n            // 同时更新旧版对话历史记录格式（向后兼容）\n            await this.saveLegacyDialogueHistory(gameData, completeHistory);\n            return saveResult;\n        }\n        catch (error) {\n            console.error('保存对话历史到世界书失败:', error);\n            return false;\n        }\n    }\n    /**\n     * 保存旧版格式的对话历史（向后兼容）\n     */\n    async saveLegacyDialogueHistory(gameData, completeHistory) {\n        try {\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                await this.initializeChatLorebook();\n            }\n            // 检查API是否可用\n            if (!this.worldBookName || typeof window.getLorebookEntries !== 'function') {\n                console.warn('世界书API不可用，无法保存旧版对话历史');\n                return false;\n            }\n            // 获取所有世界书条目\n            const allEntries = await window.getLorebookEntries(this.worldBookName);\n            // 查找对话历史条目\n            const dialogueHistoryEntry = this.findEntryByKey(allEntries, this.DIALOGUE_HISTORY_KEY);\n            // 构建旧版日志格式\n            let logContent = '';\n            for (const dialogue of completeHistory.dialogues) {\n                if (dialogue.speaker === '玩家') {\n                    logContent += `选择:${dialogue.content};`;\n                }\n                else {\n                    logContent += `${dialogue.speaker}:${dialogue.content};`;\n                }\n            }\n            // 添加记忆穿越点\n            for (const memory of completeHistory.memories) {\n                if (memory.content.includes('穿越') || memory.content.includes('回到')) {\n                    logContent += `回到过去:${memory.content};`;\n                }\n            }\n            // 对话历史标题\n            const dialogueTitle = `对话历史记录 - ${new Date().toLocaleString()}`;\n            // 包装为旧版格式\n            const updatedContent = `<log>${logContent}</log>`;\n            // 更新或创建条目\n            try {\n                if (dialogueHistoryEntry) {\n                    // 更新现有条目\n                    if (typeof window.editLorebookEntry === 'function') {\n                        await window.editLorebookEntry(this.worldBookName, dialogueHistoryEntry.uid, {\n                            comment: dialogueTitle,\n                            content: updatedContent,\n                        });\n                    }\n                    else {\n                        // 回退到旧API：删除并重建\n                        await window.deleteLorebookEntry(this.worldBookName, dialogueHistoryEntry.uid);\n                        await window.createLorebookEntry(this.worldBookName, {\n                            keys: [this.DIALOGUE_HISTORY_KEY],\n                            comment: dialogueTitle,\n                            content: updatedContent,\n                        });\n                    }\n                    console.log('更新了旧版对话历史记录');\n                }\n                else {\n                    // 创建新条目\n                    await window.createLorebookEntry(this.worldBookName, {\n                        keys: [this.DIALOGUE_HISTORY_KEY],\n                        comment: dialogueTitle,\n                        content: updatedContent,\n                    });\n                    console.log('创建了新的旧版对话历史记录条目');\n                }\n                return true;\n            }\n            catch (error) {\n                console.error('保存旧版对话历史失败:', error);\n                return false;\n            }\n        }\n        catch (error) {\n            console.error('保存旧版对话历史到世界书失败:', error);\n            return false;\n        }\n    }\n    /**\n     * 从世界书获取对话历史\n     * 优先使用新的完整历史记录格式\n     */\n    async getDialogueHistory() {\n        try {\n            // 先尝试获取完整历史记录\n            const completeHistory = await this.loadCompleteHistory();\n            if (completeHistory && completeHistory.dialogues && completeHistory.dialogues.length > 0) {\n                console.log(`从完整历史记录中获取 ${completeHistory.dialogues.length} 条对话历史`);\n                // 转换为DialogueHistoryItem格式\n                const dialogueHistoryItems = completeHistory.dialogues.map(d => ({\n                    speaker: d.speaker,\n                    content: d.content,\n                    style: d.style || 'normal',\n                }));\n                return dialogueHistoryItems;\n            }\n            // 如果没有完整历史记录，回退到旧版记录格式\n            console.log('未找到完整历史记录，尝试旧版格式');\n            // 确保聊天世界书已初始化\n            if (!this.worldBookName) {\n                await this.initializeChatLorebook();\n            }\n            // 检查API是否可用\n            if (typeof window.getLorebookEntries !== 'function') {\n                console.warn('世界书API不可用，无法获取对话历史');\n                return null;\n            }\n            // 获取所有世界书条目\n            const allEntries = await window.getLorebookEntries(this.worldBookName);\n            if (!allEntries || !Array.isArray(allEntries) || allEntries.length === 0) {\n                console.warn('没有找到世界书条目');\n                return null;\n            }\n            // 查找持久化对话历史条目\n            const dialogueEntry = this.findEntryByKey(allEntries, this.DIALOGUE_HISTORY_KEY);\n            if (!dialogueEntry) {\n                console.warn('没有找到对话历史条目');\n                return null;\n            }\n            // 获取条目内容\n            let dialogueContent = '';\n            // 尝试直接从条目获取内容\n            if (dialogueEntry.content) {\n                dialogueContent = dialogueEntry.content;\n            }\n            // 如果没有直接内容，使用triggerSlash获取\n            else if (typeof window.triggerSlash === 'function') {\n                // 获取实际键值（可能是数组中的第一个元素）\n                let actualKey = this.DIALOGUE_HISTORY_KEY;\n                if (Array.isArray(dialogueEntry.key) && dialogueEntry.key.length > 0) {\n                    actualKey = dialogueEntry.key[0];\n                }\n                else if (typeof dialogueEntry.key === 'string') {\n                    actualKey = dialogueEntry.key;\n                }\n                dialogueContent = await window.triggerSlash(`/getentryfield file=${this.worldBookName} field=content ${actualKey}`);\n            }\n            if (!dialogueContent) {\n                console.warn('对话历史内容为空');\n                return null;\n            }\n            try {\n                // 尝试解析对话历史内容\n                // 首先检查是否有<log>标签\n                if (dialogueContent.includes('<log>') && dialogueContent.includes('</log>')) {\n                    const logMatch = dialogueContent.match(/<log>([\\s\\S]*?)<\\/log>/);\n                    if (logMatch && logMatch[1]) {\n                        // 解析日志内容\n                        const logContent = logMatch[1];\n                        // 分割成独立的对话条目\n                        const dialogueEntries = logContent.split(';').filter(entry => entry.trim().length > 0);\n                        // 转换为DialogueHistoryItem格式\n                        const dialogueHistoryItems = [];\n                        for (const entry of dialogueEntries) {\n                            if (entry.includes(':')) {\n                                const [type, content] = entry.split(':', 2);\n                                if (type === '选择') {\n                                    dialogueHistoryItems.push({\n                                        speaker: '玩家',\n                                        content: content,\n                                        style: 'normal',\n                                    });\n                                }\n                                else if (type === '回到过去') {\n                                    dialogueHistoryItems.push({\n                                        speaker: '旁白',\n                                        content: `【时间穿越：${content}】`,\n                                        style: 'special',\n                                    });\n                                }\n                                else {\n                                    // 普通对话\n                                    dialogueHistoryItems.push({\n                                        speaker: type,\n                                        content: content,\n                                        style: 'normal',\n                                    });\n                                }\n                            }\n                        }\n                        console.log(`从旧版格式读取了 ${dialogueHistoryItems.length} 条对话历史`);\n                        return dialogueHistoryItems;\n                    }\n                }\n                else {\n                    // 尝试作为JSON解析\n                    try {\n                        const dialogues = JSON.parse(dialogueContent);\n                        if (Array.isArray(dialogues)) {\n                            console.log(`从JSON格式读取了 ${dialogues.length} 条对话历史`);\n                            return dialogues;\n                        }\n                    }\n                    catch (jsonError) {\n                        console.warn('无法解析对话历史为JSON格式:', jsonError);\n                    }\n                }\n            }\n            catch (parseError) {\n                console.error('解析对话历史内容失败:', parseError);\n            }\n            return null;\n        }\n        catch (error) {\n            console.error('获取对话历史失败:', error);\n            return null;\n        }\n    }\n    /**\n     * 从键名加载游戏状态\n     */\n    async loadGameState(saveKey) {\n        const MAX_RETRY = 3;\n        for (let retry = 0; retry < MAX_RETRY; retry++) {\n            try {\n                // 确保聊天世界书已初始化\n                if (!this.worldBookName) {\n                    console.log('世界书名称为空，重新初始化');\n                    await this.initializeChatLorebook();\n                    if (!this.worldBookName) {\n                        console.error('初始化世界书失败，无法加载游戏状态');\n                        this.uiManager.showNotification('无法初始化世界书，加载失败', 'error');\n                        return null;\n                    }\n                }\n                // 检查API函数是否可用\n                if (typeof window.getLorebookEntries !== 'function') {\n                    console.error('世界书读取API不可用');\n                    this.uiManager.showNotification('世界书API不可用，无法加载存档', 'error');\n                    return null;\n                }\n                // 获取所有世界书条目\n                console.log(`获取世界书条目，尝试 ${retry + 1}/${MAX_RETRY}`);\n                const allEntries = await window.getLorebookEntries(this.worldBookName);\n                // 尝试查找对应的存档条目\n                const saveEntry = this.findEntryByKey(allEntries, saveKey);\n                if (!saveEntry) {\n                    console.warn(`找不到存档键 ${saveKey}`);\n                    // 如果不是最后一次尝试，等待后重试\n                    if (retry < MAX_RETRY - 1) {\n                        console.log(`等待500ms后重试...`);\n                        await new Promise(resolve => setTimeout(resolve, 500));\n                        continue; // 继续下一次重试\n                    }\n                    else {\n                        this.uiManager.showNotification(`找不到指定存档`, 'warning');\n                        return null;\n                    }\n                }\n                // 获取条目内容\n                let entryContent = '';\n                try {\n                    // 尝试直接从条目获取内容\n                    if (saveEntry.content) {\n                        entryContent = saveEntry.content;\n                        console.log('直接从条目获取到内容');\n                    }\n                    // 如果没有直接内容，使用triggerSlash获取\n                    else if (typeof window.triggerSlash === 'function') {\n                        // 获取实际键值（可能是数组中的第一个元素）\n                        let actualKey = saveKey;\n                        if (Array.isArray(saveEntry.key) && saveEntry.key.length > 0) {\n                            actualKey = saveEntry.key[0];\n                        }\n                        else if (typeof saveEntry.key === 'string') {\n                            actualKey = saveEntry.key;\n                        }\n                        console.log(`通过triggerSlash获取条目内容，key=${actualKey}`);\n                        entryContent = await window.triggerSlash(`/getentryfield file=${this.worldBookName} field=content ${actualKey}`);\n                        if (entryContent) {\n                            console.log('通过triggerSlash成功获取内容');\n                        }\n                    }\n                    if (!entryContent) {\n                        console.warn(`存档键 ${saveKey} 对应的内容为空`);\n                        // 如果不是最后一次尝试，等待后重试\n                        if (retry < MAX_RETRY - 1) {\n                            console.log(`等待500ms后重试...`);\n                            await new Promise(resolve => setTimeout(resolve, 500));\n                            continue; // 继续下一次重试\n                        }\n                        else {\n                            this.uiManager.showNotification(`存档内容为空`, 'warning');\n                            return null;\n                        }\n                    }\n                    // 解析保存的状态\n                    try {\n                        console.log('解析存档内容...');\n                        const savedState = JSON.parse(entryContent);\n                        // 确保对话索引设置为0\n                        if (savedState && savedState.story) {\n                            savedState.story.currentDialogueIndex = 0;\n                            console.log('成功解析存档内容，重置对话索引');\n                            return savedState;\n                        }\n                        else {\n                            console.warn('解析的存档缺少必要数据');\n                            // 如果不是最后一次尝试并且是格式问题，可能是加载不完整，重试\n                            if (retry < MAX_RETRY - 1) {\n                                console.log(`等待500ms后重试...`);\n                                await new Promise(resolve => setTimeout(resolve, 500));\n                                continue; // 继续下一次重试\n                            }\n                            else {\n                                this.uiManager.showNotification('存档数据不完整或格式错误', 'error');\n                                return null;\n                            }\n                        }\n                    }\n                    catch (parseError) {\n                        console.error('解析存档内容失败:', parseError);\n                        // 如果不是最后一次尝试，等待后重试\n                        if (retry < MAX_RETRY - 1) {\n                            console.log(`等待500ms后重试...`);\n                            await new Promise(resolve => setTimeout(resolve, 500));\n                            continue; // 继续下一次重试\n                        }\n                        else {\n                            this.uiManager.showNotification('存档内容格式错误', 'error');\n                            return null;\n                        }\n                    }\n                }\n                catch (contentError) {\n                    console.error(`获取存档 ${saveKey} 内容失败:`, contentError);\n                    // 如果不是最后一次尝试，等待后重试\n                    if (retry < MAX_RETRY - 1) {\n                        console.log(`等待500ms后重试...`);\n                        await new Promise(resolve => setTimeout(resolve, 500));\n                        continue; // 继续下一次重试\n                    }\n                    else {\n                        this.uiManager.showNotification('获取存档内容失败', 'error');\n                        return null;\n                    }\n                }\n            }\n            catch (retryError) {\n                console.error(`加载游戏存档尝试 ${retry + 1} 失败:`, retryError);\n                // 如果不是最后一次尝试，等待后重试\n                if (retry < MAX_RETRY - 1) {\n                    console.log(`等待500ms后重试...`);\n                    await new Promise(resolve => setTimeout(resolve, 500));\n                }\n                else {\n                    this.uiManager.showNotification('加载存档失败: ' + (retryError instanceof Error ? retryError.message : '未知错误'), 'error');\n                    return null;\n                }\n            }\n        }\n        return null; // 如果所有重试都失败，返回null\n    }\n    /**\n     * 根据ID加载游戏状态\n     */\n    async loadGameStateByID(summaryId, isManual = false) {\n        const saveKey = isManual ? `${this.SAVE_TYPE.MANUAL}${summaryId}` : `${this.SAVE_TYPE.AUTO}${summaryId}`;\n        return this.loadGameState(saveKey);\n    }\n    /**\n     * 获取完整历史记录\n     * 包含所有对话和记忆点\n     */\n    async getCompleteHistory() {\n        return this.loadCompleteHistory();\n    }\n    /**\n     * 加载游戏\n     */\n    loadGame() {\n        // 显示加载游戏弹窗\n        this.showLoadGameModal();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvc2F2ZU1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQTZCTyxNQUFNLFdBQVc7SUFDZCxTQUFTLENBQVk7SUFDckIsYUFBYSxHQUFXLFNBQVMsQ0FBQyxDQUFDLFNBQVM7SUFDNUMsT0FBTyxHQUFXLGlCQUFpQixDQUFDO0lBQzVDLFdBQVc7SUFDSCxvQkFBb0IsR0FBVyw2QkFBNkIsQ0FBQztJQUNyRSxXQUFXO0lBQ0gsb0JBQW9CLEdBQVcsdUJBQXVCLENBQUM7SUFDL0QsT0FBTztJQUNDLFNBQVMsR0FBRztRQUNsQixJQUFJLEVBQUUsWUFBWTtRQUNsQixNQUFNLEVBQUUsT0FBTztLQUNoQixDQUFDO0lBQ0YsV0FBVztJQUNILGdCQUFnQixHQUFHO1FBQ3pCLElBQUksRUFBRSxDQUFDO1FBQ1AsTUFBTSxFQUFFLENBQUM7S0FDVixDQUFDO0lBQ0YsV0FBVztJQUNILHFCQUFxQixHQUFpQyxJQUFJLENBQUM7SUFFbkUsWUFBWSxTQUFvQjtRQUM5QixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztRQUMvQixJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUU5Qix5QkFBeUI7UUFDekIsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFFN0IsYUFBYTtRQUNiLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRDs7T0FFRztJQUNLLHFCQUFxQjtRQUMzQixnQkFBZ0I7UUFDaEIsSUFBSSxPQUFPLENBQUMsS0FBSyxXQUFXLEVBQUUsQ0FBQztZQUM3QixPQUFPLENBQUMsS0FBSyxDQUFDLDBCQUEwQixDQUFDLENBQUM7WUFDMUMsT0FBTztRQUNULENBQUM7UUFFRCwwQkFBMEI7UUFDMUIsSUFBSSxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxLQUFLLFVBQVUs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QWtCO1FBQzdCLE9BQU8sSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDcEMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksUUFBUTtRQUNiLFdBQVc7UUFDWCxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUMzQixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc2NyaXB0cy9jb21wb25lbnRzL3NhdmVNYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5a2Y5qGj566h55CG5Zmo57uE5Lu2XG4gKiDotJ/otKPmuLjmiI/lrZjmoaPlkozor7vlj5blip/og71cbiAqL1xuaW1wb3J0IHsgR2FtZURhdGEgfSBmcm9tICcuLi9tb2RlbHMvZ2FtZURhdGEnO1xuaW1wb3J0IHsgRGlhbG9ndWVIaXN0b3J5SXRlbSB9IGZyb20gJy4vZGlhbG9ndWVNYW5hZ2VyJztcbmltcG9ydCB7IFVJTWFuYWdlciB9IGZyb20gJy4vdWlNYW5hZ2VyJztcblxuLy8g5aOw5piOalF1ZXJ555qEbW9kYWzmlrnms5VcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEpRdWVyeSB7XG4gICAgbW9kYWwoYWN0aW9uPzogc3RyaW5nKTogSlF1ZXJ5O1xuICB9XG59XG5cbi8vIOWumuS5ieWujOaVtOWOhuWPsuiusOW9leaOpeWPo1xuZXhwb3J0IGludGVyZmFjZSBDb21wbGV0ZUhpc3RvcnlSZWNvcmQge1xuICBpZDogc3RyaW5nOyAvLyDllK/kuIDmoIfor4bnrKZcbiAgZGlhbG9ndWVzOiBBcnJheTx7XG4gICAgc3BlYWtlcjogc3RyaW5nO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBzdHlsZT86IHN0cmluZztcbiAgfT47XG4gIG1lbW9yaWVzOiBBcnJheTx7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gIH0+O1xufVxuXG5leHBvcnQgY2xhc3MgU2F2ZU1hbmFnZXIge1xuICBwcml2YXRlIHVpTWFuYWdlcjogVUlNYW5hZ2VyO1xuICBwcml2YXRlIHdvcmxkQm9va05hbWU6IHN0cmluZyA9ICfkv67lpbPnmoTov73lv4borrDlvZUnOyAvLyDkvb/nlKjlm7rlrprlkI3np7BcbiAgcHJpdmF0ZSBtb2RhbElkOiBzdHJpbmcgPSAnbG9hZC1nYW1lLW1vZGFsJztcbiAgLy8g5a+56K+d5Y6G5Y+y6K6w5b2V6ZSu5ZCNXG4gIHByaXZhdGUgRElBTE9HVUVfSElTVE9SWV9LRVk6IHN0cmluZyA9ICdwZXJzaXN0ZW50X2RpYWxvZ3VlX2hpc3RvcnknO1xuICAvLyDlrozmlbTljoblj7LorrDlvZXplK7lkI1cbiAgcHJpdmF0ZSBDT01QTEVURV9ISVNUT1JZX0tFWTogc3RyaW5nID0gJ2NvbXBsZXRlX2dhbWVfaGlzdG9yeSc7XG4gIC8vIOWtmOaho+exu+Wei1xuICBwcml2YXRlIFNBVkVfVFlQRSA9IHtcbiAgICBBVVRPOiAnYXV0b19zYXZlXycsXG4gICAgTUFOVUFMOiAnc2F2ZV8nLFxuICB9O1xuICAvLyDlvZPliY3mnIDlpKflrZjmoaNJRFxuICBwcml2YXRlIGN1cnJlbnRNYXhTYXZlSWQgPSB7XG4gICAgYXV0bzogMCxcbiAgICBtYW51YWw6IDAsXG4gIH07XG4gIC8vIOe8k+WtmOWujOaVtOWOhuWPsuiusOW9lVxuICBwcml2YXRlIGNhY2hlZENvbXBsZXRlSGlzdG9yeTogQ29tcGxldGVIaXN0b3J5UmVjb3JkIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IodWlNYW5hZ2VyOiBVSU1hbmFnZXIpIHtcbiAgICB0aGlzLnVpTWFuYWdlciA9IHVpTWFuYWdlcjtcbiAgICB0aGlzLmluaXRpYWxpemVMb2FkR2FtZU1vZGFsKCk7XG4gICAgdGhpcy5pbml0aWFsaXplQ2hhdExvcmVib29rKCk7XG5cbiAgICAvLyDnoa7kv51qUXVlcnnlkoxCb290c3RyYXDmraPnoa7liqDovb1cbiAgICB0aGlzLmVuc3VyZUJvb3RzdHJhcExvYWRlZCgpO1xuXG4gICAgLy8g5Yid5aeL5YyW5pe25Yqg6L295Y6G5Y+y6K6w5b2VXG4gICAgdGhpcy5sb2FkQ29tcGxldGVIaXN0b3J5KCk7XG4gIH1cblxuICAvKipcbiAgICog56Gu5L+dQm9vdHN0cmFw5q2j56Gu5Yqg6L29XG4gICAqL1xuICBwcml2YXRlIGVuc3VyZUJvb3RzdHJhcExvYWRlZCgpOiB2b2lkIHtcbiAgICAvLyDmo4Dmn6VqUXVlcnnmmK/lkKblt7LliqDovb1cbiAgICBpZiAodHlwZW9mICQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdqUXVlcnnmnKrliqDovb3vvIzov5nlj6/og73lr7zoh7Rtb2RhbOWKn+iDveWkseaViCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOajgOafpUJvb3RzdHJhcOeahG1vZGFs5Yqf6IO95piv5ZCm5Y+v55SoXG4gICAgaWYgKHR5cGVvZiAkLmZuLm1vZGFsICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0Jvb3RzdHJhcCBtb2RhbOacquajgOa1i+WIsO+8jOWwneivleWKoOi9vScpO1xuXG4gICAgICAvLyDlsJ3or5XliqjmgIHmt7vliqBCb290c3RyYXDnmoRDU1PlkoxKU1xuICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9vdHN0cmFwLWNzcycpKSB7XG4gICAgICAgIGNvbnN0IGJvb3RzdHJhcENzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgYm9vdHN0cmFwQ3NzLmlkID0gJ2Jvb3RzdHJhcC1jc3MnO1xuICAgICAgICBib290c3RyYXBDc3MucmVsID0gJ3N0eWxlc2hlZXQnO1xuICAgICAgICBib290c3RyYXBDc3MuaHJlZiA9ICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2Jvb3RzdHJhcEA0LjYuMC9kaXN0L2Nzcy9ib290c3RyYXAubWluLmNzcyc7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoYm9vdHN0cmFwQ3NzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9vdHN0cmFwLWpzJykpIHtcbiAgICAgICAgY29uc3QgYm9vdHN0cmFwSnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgYm9vdHN0cmFwSnMuaWQgPSAnYm9vdHN0cmFwLWpzJztcbiAgICAgICAgYm9vdHN0cmFwSnMuc3JjID0gJ2h0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vYm9vdHN0cmFwQDQuNi4wL2Rpc3QvanMvYm9vdHN0cmFwLmJ1bmRsZS5taW4uanMnO1xuICAgICAgICBib290c3RyYXBKcy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Jvb3RzdHJhcOW3suaIkOWKn+WKoOi9vScpO1xuICAgICAgICAgIC8vIOmHjeaWsOWIneWni+WMlm1vZGFsXG4gICAgICAgICAgdGhpcy5pbml0aWFsaXplTG9hZEdhbWVNb2RhbCgpO1xuICAgICAgICB9O1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJvb3RzdHJhcEpzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW6IGK5aSp5LiW55WM5LmmXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVDaGF0TG9yZWJvb2soKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKGDmraPlnKjliJ3lp4vljJblm7rlrprkuJbnlYzkuaY6ICR7dGhpcy53b3JsZEJvb2tOYW1lfWApO1xuXG4gICAgICAvLyDmo4Dmn6VBUEnlj6/nlKjmgKdcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93LmdldExvcmVib29rcyAhPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2Ygd2luZG93LmNyZWF0ZUxvcmVib29rICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8jOaXoOazleWIneWni+WMluiBiuWkqeS4lueVjOS5picpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5plxuICAgICAgY29uc3QgbG9yZWJvb2tzID0gYXdhaXQgd2luZG93LmdldExvcmVib29rcygpO1xuXG4gICAgICAvLyDmo4Dmn6XmiJHku6znmoTlm7rlrprkuJbnlYzkuabmmK/lkKblrZjlnKhcbiAgICAgIGNvbnN0IHdvcmxkQm9va0V4aXN0cyA9IGxvcmVib29rcy5pbmNsdWRlcyh0aGlzLndvcmxkQm9va05hbWUpO1xuXG4gICAgICBpZiAoIXdvcmxkQm9va0V4aXN0cykge1xuICAgICAgICAvLyDliJvlu7rmlrDnmoTkuJbnlYzkuaZcbiAgICAgICAgY29uc29sZS5sb2coYOWIm+W7uuaWsOeahOWbuuWumuS4lueVjOS5pjogJHt0aGlzLndvcmxkQm9va05hbWV9YCk7XG4gICAgICAgIGF3YWl0IHdpbmRvdy5jcmVhdGVMb3JlYm9vayh0aGlzLndvcmxkQm9va05hbWUpO1xuXG4gICAgICAgIC8vIOiuvue9ruS4uuW9k+WJjeiBiuWkqeeahOS4lueVjOS5plxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5zZXRDaGF0TG9yZWJvb2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhd2FpdCB3aW5kb3cuc2V0Q2hhdExvcmVib29rKHRoaXMud29ybGRCb29rTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDmib7liLDnjrDmnInnmoTlm7rlrprkuJbnlYzkuaY6ICR7dGhpcy53b3JsZEJvb2tOYW1lfWApO1xuXG4gICAgICAgIC8vIOehruS/neiuvue9ruS4uuW9k+WJjeiBiuWkqeeahOS4lueVjOS5plxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5zZXRDaGF0TG9yZWJvb2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhd2FpdCB3aW5kb3cuc2V0Q2hhdExvcmVib29rKHRoaXMud29ybGRCb29rTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g5Yid5aeL5YyW5b2T5YmN5pyA5aSn5a2Y5qGjSURcbiAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZU1heFNhdmVJZHMoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5Yid5aeL5YyW6IGK5aSp5LiW55WM5Lmm5aSx6LSlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5pyA5aSn5a2Y5qGjSURcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZU1heFNhdmVJZHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5puadoeebrlxuICAgICAgY29uc3QgYWxsRW50cmllcyA9IGF3YWl0IHRoaXMuZ2V0QWxsV29ybGRCb29rRW50cmllcygpO1xuICAgICAgaWYgKCFhbGxFbnRyaWVzIHx8ICFhbGxFbnRyaWVzLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAvLyDmib7lh7roh6rliqjlrZjmoaPmnIDlpKdJRFxuICAgICAgY29uc3QgYXV0b1NhdmVzID0gYWxsRW50cmllcy5maWx0ZXIoZW50cnkgPT4gdGhpcy5jaGVja0VudHJ5S2V5U3RhcnRzV2l0aChlbnRyeSwgdGhpcy5TQVZFX1RZUEUuQVVUTykpO1xuICAgICAgaWYgKGF1dG9TYXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudE1heFNhdmVJZC5hdXRvID0gTWF0aC5tYXgoXG4gICAgICAgICAgLi4uYXV0b1NhdmVzLm1hcChlbnRyeSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpZE1hdGNoID0gdGhpcy5nZXRFbnRyeUtleShlbnRyeSkubWF0Y2goLyhcXGQrKSQvKTtcbiAgICAgICAgICAgIHJldHVybiBpZE1hdGNoID8gcGFyc2VJbnQoaWRNYXRjaFsxXSwgMTApIDogMDtcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8g5om+5Ye65omL5Yqo5a2Y5qGj5pyA5aSnSURcbiAgICAgIGNvbnN0IG1hbnVhbFNhdmVzID0gYWxsRW50cmllcy5maWx0ZXIoZW50cnkgPT4gdGhpcy5jaGVja0VudHJ5S2V5U3RhcnRzV2l0aChlbnRyeSwgdGhpcy5TQVZFX1RZUEUuTUFOVUFMKSk7XG4gICAgICBpZiAobWFudWFsU2F2ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRNYXhTYXZlSWQubWFudWFsID0gTWF0aC5tYXgoXG4gICAgICAgICAgLi4ubWFudWFsU2F2ZXMubWFwKGVudHJ5ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkTWF0Y2ggPSB0aGlzLmdldEVudHJ5S2V5KGVudHJ5KS5tYXRjaCgvKFxcZCspJC8pO1xuICAgICAgICAgICAgcmV0dXJuIGlkTWF0Y2ggPyBwYXJzZUludChpZE1hdGNoWzFdLCAxMCkgOiAwO1xuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhg5Yid5aeL5YyW5a2Y5qGjSUQ6IOiHquWKqOWtmOahoz0ke3RoaXMuY3VycmVudE1heFNhdmVJZC5hdXRvfSwg5omL5Yqo5a2Y5qGjPSR7dGhpcy5jdXJyZW50TWF4U2F2ZUlkLm1hbnVhbH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5Yid5aeL5YyW5pyA5aSn5a2Y5qGjSUTlpLHotKU6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDovoXliqnlh73mlbDvvJrojrflj5blrp7pmYXkvb/nlKjnmoTplK7lgLxcbiAgICovXG4gIHByaXZhdGUgZ2V0RW50cnlLZXkoZW50cnk6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnkua2V5KSAmJiBlbnRyeS5rZXkubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGVudHJ5LmtleVswXTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbnRyeS5rZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gZW50cnkua2V5O1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ5LiW55WM5Lmm5p2h55uuXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldEFsbFdvcmxkQm9va0VudHJpZXMoKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+aXoOazleiOt+WPluS4lueVjOS5puadoeebru+8muS4lueVjOS5puWQjeS4uuepuicpO1xuICAgICAgICAvLyDlsJ3or5Xph43mlrDliJ3lp4vljJbkuJbnlYzkuaZcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplQ2hhdExvcmVib29rKCk7XG4gICAgICAgIGlmICghdGhpcy53b3JsZEJvb2tOYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOajgOafpUFQSeWPr+eUqOaAp1xuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZ2V0TG9yZWJvb2tFbnRyaWVzICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8mmdldExvcmVib29rRW50cmllc+WHveaVsOacquWumuS5iScpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKGDmraPlnKjojrflj5bkuJbnlYzkuaYgJHt0aGlzLndvcmxkQm9va05hbWV9IOeahOaJgOacieadoeebri4uLmApO1xuXG4gICAgICAvLyDlsJ3or5Xojrflj5bkuJbnlYzkuabmnaHnm65cbiAgICAgIGxldCBlbnRyaWVzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZW50cmllcyA9IGF3YWl0IHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lKTtcbiAgICAgIH0gY2F0Y2ggKGFwaUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOiwg+eUqGdldExvcmVib29rRW50cmllcyBBUEnlh7rplJk6YCwgYXBpRXJyb3IpO1xuXG4gICAgICAgIC8vIOWmguaenOWksei0pe+8jOWwneivleS9v+eUqHRyaWdnZXJTbGFzaOS9nOS4uuWQjuWkh+aWueahiFxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy50cmlnZ2VyU2xhc2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+WwneivleS9v+eUqHRyaWdnZXJTbGFzaOS9nOS4uuWQjuWkh+aWueahiOiOt+WPluadoeebricpO1xuICAgICAgICAgICAgY29uc3QgZW50cmllc0pzb24gPSBhd2FpdCB3aW5kb3cudHJpZ2dlclNsYXNoKGAvZ2V0bGJlbnRyaWVzICR7dGhpcy53b3JsZEJvb2tOYW1lfWApO1xuICAgICAgICAgICAgaWYgKGVudHJpZXNKc29uKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZW50cmllcyA9IEpTT04ucGFyc2UoZW50cmllc0pzb24pO1xuICAgICAgICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6QdHJpZ2dlclNsYXNo6L+U5Zue57uT5p6c5aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoc2xhc2hFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign5L2/55SodHJpZ2dlclNsYXNo6I635Y+W5p2h55uu5aSx6LSlOicsIHNsYXNoRXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDmo4Dmn6Xojrflj5bliLDnmoTmnaHnm65cbiAgICAgIGlmICghZW50cmllcykge1xuICAgICAgICBjb25zb2xlLmxvZyhg5rKh5pyJ5LuO5LiW55WM5LmmICR7dGhpcy53b3JsZEJvb2tOYW1lfSDojrflj5bliLDmnaHnm65gKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZW50cmllcykpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W55qE5p2h55uu5LiN5piv5pWw57uE57G75Z6LOicsIGVudHJpZXMpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKGDmiJDlip/ojrflj5bkuJbnlYzkuabmnaHnm67vvIzlhbEgJHtlbnRyaWVzLmxlbmd0aH0g5LiqYCk7XG5cbiAgICAgIC8vIOajgOafpeavj+S4quadoeebruaYr+WQpuacieaViFxuICAgICAgaWYgKGVudHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBpbnZhbGlkRW50cmllcyA9IGVudHJpZXMuZmlsdGVyKGVudHJ5ID0+ICFlbnRyeSB8fCAhZW50cnkudWlkIHx8IHR5cGVvZiBlbnRyeS51aWQgIT09ICdudW1iZXInKTtcbiAgICAgICAgaWYgKGludmFsaWRFbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oYOWPkeeOsCAke2ludmFsaWRFbnRyaWVzLmxlbmd0aH0g5Liq5peg5pWI5p2h55uu77yI57y65bCRVUlE5oiWVUlE57G75Z6L6ZSZ6K+v77yJYCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfkuJbnlYzkuabmnaHnm67kuLrnqbrvvIzlj6/og73mmK/mlrDliJvlu7rnmoTkuJbnlYzkuaYnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGVudHJpZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluS4lueVjOS5puadoeebruWksei0pTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeadoeebrumUruaYr+WQpuS7peaMh+WumuWJjee8gOW8gOWktFxuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0VudHJ5S2V5U3RhcnRzV2l0aChlbnRyeTogYW55LCBwcmVmaXg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghZW50cnkgfHwgIWVudHJ5LmtleSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnkua2V5KSkge1xuICAgICAgLy8g5a+55LqO5pWw57uE57G75Z6L55qEa2V577yM5qOA5p+l5piv5ZCm5pyJ5Lu75oSP5YWD57Sg5LulcHJlZml45byA5aS0XG4gICAgICByZXR1cm4gZW50cnkua2V5LnNvbWUoKGs6IHN0cmluZykgPT4gayAmJiB0eXBlb2YgayA9PT0gJ3N0cmluZycgJiYgay5zdGFydHNXaXRoKHByZWZpeCkpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGVudHJ5LmtleSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIOWvueS6juWtl+espuS4suexu+Wei+eahGtlee+8jOebtOaOpeajgOafpVxuICAgICAgcmV0dXJuIGVudHJ5LmtleS5zdGFydHNXaXRoKHByZWZpeCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOagueaNrumUruWQjeafpeaJvuadoeebrlxuICAgKi9cbiAgcHJpdmF0ZSBmaW5kRW50cnlCeUtleShlbnRyaWVzOiBhbnlbXSwgZXhhY3RLZXk6IHN0cmluZyk6IGFueSB7XG4gICAgaWYgKCFlbnRyaWVzIHx8ICFBcnJheS5pc0FycmF5KGVudHJpZXMpKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+afpeaJvuadoeebruaXtuS8oOWFpeeahOadoeebruWIl+ihqOaXoOaViCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKCFleGFjdEtleSkge1xuICAgICAgY29uc29sZS53YXJuKCfmn6Xmib7mnaHnm67ml7bkvKDlhaXnmoTplK7lkI3kuLrnqbonKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGZvdW5kRW50cnkgPSBlbnRyaWVzLmZpbmQoZW50cnkgPT4ge1xuICAgICAgaWYgKCFlbnRyeSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyeS5rZXkpKSB7XG4gICAgICAgIHJldHVybiBlbnRyeS5rZXkuaW5jbHVkZXMoZXhhY3RLZXkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVudHJ5LmtleSA9PT0gZXhhY3RLZXk7XG4gICAgfSk7XG5cbiAgICBpZiAoZm91bmRFbnRyeSkge1xuICAgICAgaWYgKCFmb3VuZEVudHJ5LnVpZCB8fCB0eXBlb2YgZm91bmRFbnRyeS51aWQgIT09ICdudW1iZXInIHx8IGlzTmFOKGZvdW5kRW50cnkudWlkKSkge1xuICAgICAgICBjb25zb2xlLndhcm4oYOaJvuWIsOmUruWQjeS4uiAke2V4YWN0S2V5fSDnmoTmnaHnm67vvIzkvYblhbZVSUTml6DmlYg6ICR7Zm91bmRFbnRyeS51aWR9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhg5om+5Yiw6ZSu5ZCN5Li6ICR7ZXhhY3RLZXl9IOeahOadoeebru+8jFVJRDogJHtmb3VuZEVudHJ5LnVpZH1gKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYOacquaJvuWIsOmUruWQjeS4uiAke2V4YWN0S2V5fSDnmoTmnaHnm65gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm91bmRFbnRyeTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbliqDovb3muLjmiI/lvLnnqpdcbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbGl6ZUxvYWRHYW1lTW9kYWwoKTogdm9pZCB7XG4gICAgLy8g5qOA5p+l5piv5ZCm5bey5a2Y5Zyo5by556qXXG4gICAgaWYgKCQoYCMke3RoaXMubW9kYWxJZH1gKS5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIOWIm+W7uuW8ueeql1xuICAgICAgY29uc3QgbW9kYWxIdG1sID0gYFxuICAgICAgPGRpdiBpZD1cIiR7dGhpcy5tb2RhbElkfVwiIGNsYXNzPVwibW9kYWwgZmFkZVwiIHRhYmluZGV4PVwiLTFcIiByb2xlPVwiZGlhbG9nXCIgYXJpYS1sYWJlbGxlZGJ5PVwibG9hZEdhbWVNb2RhbFRpdGxlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1kaWFsb2cgbW9kYWwtbGdcIiByb2xlPVwiZG9jdW1lbnRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuICAgICAgICAgICAgICA8aDUgY2xhc3M9XCJtb2RhbC10aXRsZVwiIGlkPVwibG9hZEdhbWVNb2RhbFRpdGxlXCI+PGkgY2xhc3M9XCJmYXMgZmEtYm9vay1vcGVuXCI+PC9pPiDkv67pgZPpmaLlhbjnsY3orrDlvZU8L2g1PlxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIj4mdGltZXM7PC9zcGFuPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNhdmUtdGFic1wiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJzYXZlLXRhYi1idG4gYWN0aXZlXCIgZGF0YS10YWI9XCJhdXRvXCI+PGkgY2xhc3M9XCJmYXMgZmEtY2xvY2tcIj48L2k+IOaXtumXtOiusOW/hjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJzYXZlLXRhYi1idG5cIiBkYXRhLXRhYj1cIm1hbnVhbFwiPjxpIGNsYXNzPVwiZmFzIGZhLWJvb2ttYXJrXCI+PC9pPiDmsLjkuYXlhbjnsY08L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzYXZlLXRhYi1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cImF1dG8tc2F2ZXMtY29udGFpbmVyXCIgY2xhc3M9XCJzYXZlLXRhYi1wYW5lIGFjdGl2ZVwiPlxuICAgICAgICAgICAgICAgICAgPHVsIGlkPVwiYXV0by1zYXZlLWxpc3RcIiBjbGFzcz1cInNhdmUtbGlzdFwiPlxuICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJzYXZlLWl0ZW0gZW1wdHlcIj7mmoLml6Doh6rliqjorrDlvZXngrk8L2xpPlxuICAgICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwibWFudWFsLXNhdmVzLWNvbnRhaW5lclwiIGNsYXNzPVwic2F2ZS10YWItcGFuZVwiPlxuICAgICAgICAgICAgICAgICAgPHVsIGlkPVwibWFudWFsLXNhdmUtbGlzdFwiIGNsYXNzPVwic2F2ZS1saXN0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cInNhdmUtaXRlbSBlbXB0eVwiPuaaguaXoOaJi+WKqOS/neWtmOeahOWFuOexjTwvbGk+XG4gICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIGlkPVwiYnRuLWNyZWF0ZS1tYW51YWwtc2F2ZVwiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLWZlYXRoZXItYWx0XCI+PC9pPiDorrDlvZXlvZPliY3lhbjnsY1cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiPuWFs+mXrTwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+YDtcblxuICAgICAgLy8g5re75Yqg5Yiw6aG16Z2iXG4gICAgICAkKCdib2R5JykuYXBwZW5kKG1vZGFsSHRtbCk7XG5cbiAgICAgIC8vIOehruS/neaooeaAgeahhuagt+W8j+ato+ehrlxuICAgICAgY29uc3QgbW9kYWxTdHlsZXMgPSBgXG4gICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAjJHt0aGlzLm1vZGFsSWR9IHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgIyR7dGhpcy5tb2RhbElkfS5zaG93IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5zYXZlLXRhYnMge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGVlMmU2O1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtdGFiLWJ0biB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBub25lO1xuICAgICAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogMTBweCAxNXB4O1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtdGFiLWJ0bi5hY3RpdmUge1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICM1ZDZlNDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5zYXZlLXRhYi1wYW5lIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5zYXZlLXRhYi1wYW5lLmFjdGl2ZSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtbGlzdCB7XG4gICAgICAgICAgICBsaXN0LXN0eWxlOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtaXRlbSB7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RlZTJlNjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4zcztcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtaXRlbTpob3ZlciB7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsMCwwLDAuMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5zYXZlLWl0ZW0uZW1wdHkge1xuICAgICAgICAgICAgY29sb3I6ICM2Yzc1N2Q7XG4gICAgICAgICAgICBjdXJzb3I6IGRlZmF1bHQ7XG4gICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5zYXZlLWl0ZW0tdGh1bWJuYWlsIHtcbiAgICAgICAgICAgIGhlaWdodDogMTIwcHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc2F2ZS1pdGVtLWhlYWRlciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDAgNXB4O1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc2F2ZS1pdGVtLXRpdGxlIHtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtaXRlbS1kYXRlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgICBjb2xvcjogIzZjNzU3ZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtaXRlbS1jb250ZW50IHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45ZW07XG4gICAgICAgICAgICBjb2xvcjogIzMzMztcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc2F2ZS1pdGVtLWFjdGlvbnMge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgLmJ0bi1sb2FkLCAuYnRuLWRlbGV0ZSB7XG4gICAgICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgICAgICBwYWRkaW5nOiA1cHggMTBweDtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICB9XG4gICAgICAgICAgLmJ0bi1sb2FkIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM1ZDZlNDE7XG4gICAgICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5idG4tZGVsZXRlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkYzM1NDU7XG4gICAgICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgICAgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgYDtcbiAgICAgICQoJ2hlYWQnKS5hcHBlbmQobW9kYWxTdHlsZXMpO1xuXG4gICAgICAvLyDnp7vpmaTljp/mnInkuovku7bnu5HlrprvvIzpmLLmraLph43lpI3nu5HlrppcbiAgICAgICQoZG9jdW1lbnQpLm9mZignY2xpY2snLCBgIyR7dGhpcy5tb2RhbElkfSAuc2F2ZS10YWItYnRuYCk7XG4gICAgICAkKGRvY3VtZW50KS5vZmYoJ2NsaWNrJywgJyNidG4tY3JlYXRlLW1hbnVhbC1zYXZlJyk7XG5cbiAgICAgIC8vIOmHjeaWsOe7keWumuagh+etvuWIh+aNouS6i+S7tlxuICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgYCMke3RoaXMubW9kYWxJZH0gLnNhdmUtdGFiLWJ0bmAsIGUgPT4ge1xuICAgICAgICBjb25zdCB0YWJJZCA9ICQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCd0YWInKTtcbiAgICAgICAgJChgIyR7dGhpcy5tb2RhbElkfSAuc2F2ZS10YWItYnRuYCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKGAjJHt0aGlzLm1vZGFsSWR9IC5zYXZlLXRhYi1wYW5lYCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIGlmICh0YWJJZCA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgJChgI2F1dG8tc2F2ZXMtY29udGFpbmVyYCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICQoYCNtYW51YWwtc2F2ZXMtY29udGFpbmVyYCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8g57uR5a6a5Yib5bu65omL5Yqo5a2Y5qGj5oyJ6ZKu5LqL5Lu2XG4gICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2J0bi1jcmVhdGUtbWFudWFsLXNhdmUnLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfliJvlu7rmiYvliqjlrZjmoaPmjInpkq7ooqvngrnlh7snKTtcbiAgICAgICAgdGhpcy5jcmVhdGVNYW51YWxTYXZlKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8g57uR5a6a5YWz6Zet5oyJ6ZKu5LqL5Lu2XG4gICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBgIyR7dGhpcy5tb2RhbElkfSAuY2xvc2UsICMke3RoaXMubW9kYWxJZH0gLmJ0bi1zZWNvbmRhcnlgLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2VMb2FkR2FtZU1vZGFsKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8g5aaC5p6c54K55Ye75qih5oCB5qGG5aSW6YOo77yM5YWz6Zet5qih5oCB5qGGXG4gICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBgIyR7dGhpcy5tb2RhbElkfWAsIGUgPT4ge1xuICAgICAgICBpZiAoJChlLnRhcmdldCkuYXR0cignaWQnKSA9PT0gdGhpcy5tb2RhbElkKSB7XG4gICAgICAgICAgdGhpcy5jbG9zZUxvYWRHYW1lTW9kYWwoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDliqDovb3muLjmiI/lvLnnqpflt7LliJ3lp4vljJbvvIxJRDogJHt0aGlzLm1vZGFsSWR9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWFs+mXreWKoOi9vea4uOaIj+W8ueeql1xuICAgKi9cbiAgcHJpdmF0ZSBjbG9zZUxvYWRHYW1lTW9kYWwoKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiAkLmZuLm1vZGFsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAkKGAjJHt0aGlzLm1vZGFsSWR9YCkubW9kYWwoJ2hpZGUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJChgIyR7dGhpcy5tb2RhbElkfWApLmNzcygnZGlzcGxheScsICdub25lJykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65omL5Yqo5a2Y5qGjXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNyZWF0ZU1hbnVhbFNhdmUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vliJvlu7rmiYvliqjlrZjmoaPmtYHnqIsnKTtcblxuICAgICAgLy8g5pi+56S656Gu6K6k5a+56K+d5qGG77yM6K6p55So5oi35aGr5YaZ5a2Y5qGj5ZCN56ewXG4gICAgICB0aGlzLnVpTWFuYWdlci5zaG93SW5wdXREaWFsb2coJ+ivt+i+k+WFpeWFuOexjeagh+mimCcsICfmiYvliqjlrZjmoaMnLCBhc3luYyBzYXZlTmFtZSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfnlKjmiLfovpPlhaXnmoTlrZjmoaPlkI3np7A6Jywgc2F2ZU5hbWUpO1xuXG4gICAgICAgIGlmICghc2F2ZU5hbWUpIHtcbiAgICAgICAgICBzYXZlTmFtZSA9ICfmiYvliqjlrZjmoaMnO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfkvb/nlKjpu5jorqTlrZjmoaPlkI3np7A6Jywgc2F2ZU5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd0xvYWRpbmcoJ+ato+WcqOiusOW9leWFuOexjS4uLicpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g6I635Y+W5b2T5YmN5ri45oiP54q25oCBXG4gICAgICAgICAgY29uc29sZS5sb2coJ+iOt+WPluW9k+WJjea4uOaIj+eKtuaAgScpO1xuICAgICAgICAgIGNvbnN0IGdhbWVEYXRhID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50R2FtZURhdGEoKTtcblxuICAgICAgICAgIGlmICghZ2FtZURhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aXoOazleiOt+WPluW9k+WJjea4uOaIj+eKtuaAgScpO1xuICAgICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign5peg5rOV6I635Y+W5b2T5YmN5ri45oiP54q25oCBJywgJ2Vycm9yJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc29sZS5sb2coJ+aIkOWKn+iOt+WPluW9k+WJjea4uOaIj+eKtuaAge+8jOWHhuWkh+S/neWtmCcpO1xuXG4gICAgICAgICAgLy8g5L+d5a2Y5ri45oiP54q25oCBXG4gICAgICAgICAgY29uc3Qgc2F2ZVJlc3VsdCA9IGF3YWl0IHRoaXMuc2F2ZUdhbWVTdGF0ZShnYW1lRGF0YSwgdHJ1ZSwgc2F2ZU5hbWUpO1xuXG4gICAgICAgICAgaWYgKHNhdmVSZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmiYvliqjlrZjmoaPmiJDlip/kv53lrZgnKTtcbiAgICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oYOWFuOexjVwiJHtzYXZlTmFtZX1cIuW3suaIkOWKn+iusOW9lWAsICdzdWNjZXNzJyk7XG5cbiAgICAgICAgICAgIC8vIOmHjeaWsOWKoOi9veWtmOaho+WIl+ihqFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+WIt+aWsOWtmOaho+WIl+ihqCcpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2F2ZUxpc3QoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign5L+d5a2Y5ri45oiP54q25oCB5aSx6LSlJyk7XG4gICAgICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCforrDlvZXlhbjnsY3lpLHotKUnLCAnZXJyb3InKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign5Yib5bu65omL5Yqo5a2Y5qGj5aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCforrDlvZXlhbjnsY3lpLHotKUnLCAnZXJyb3InKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICB0aGlzLnVpTWFuYWdlci5oaWRlTG9hZGluZygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5Yib5bu65omL5Yqo5a2Y5qGj5rWB56iL5Ye66ZSZOicsIGVycm9yKTtcbiAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+iusOW9leWFuOexjeWksei0pScsICdlcnJvcicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3muLjmiI/mlbDmja5cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0Q3VycmVudEdhbWVEYXRhKCk6IFByb21pc2U8R2FtZURhdGEgfCBudWxsPiB7XG4gICAgLy8g6L+Z6YeM6ZyA6KaB5LuO5ri45oiP5o6n5Yi25Zmo5Lit6I635Y+W5b2T5YmN5ri45oiP5pWw5o2uXG4gICAgLy8g5Li6566A5YyW5a6e546w77yM5pqC5pe26YCa6L+H6Ieq5a6a5LmJ5LqL5Lu26I635Y+WXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgLy8g5Yib5bu66Ieq5a6a5LmJ5LqL5Lu277yM6K+35rGC5b2T5YmN5ri45oiP5pWw5o2uXG4gICAgICBjb25zdCByZXF1ZXN0RXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3JlcXVlc3RfZ2FtZV9kYXRhJywge1xuICAgICAgICBkZXRhaWw6IHsgY2FsbGJhY2s6IChnYW1lRGF0YTogR2FtZURhdGEpID0+IHJlc29sdmUoZ2FtZURhdGEpIH0sXG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHJlcXVlc3RFdmVudCk7XG5cbiAgICAgIC8vIOWmguaenDXnp5LlhoXmsqHmnInlk43lupTvvIzov5Tlm55udWxsXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUobnVsbCksIDUwMDApO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuWKoOi9vea4uOaIj+W8ueeql1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dMb2FkR2FtZU1vZGFsKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnVpTWFuYWdlci5zaG93TG9hZGluZygn5q2j5Zyo6I635Y+W5a2Y5qGj5YiX6KGoLi4uJyk7XG5cbiAgICAgIC8vIOWFiOWIt+aWsOWtmOaho+WIl+ihqFxuICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU2F2ZUxpc3QoKTtcblxuICAgICAgLy8g56Gu5L+dalF1ZXJ55ZKMQm9vdHN0cmFw5q2j56Gu5Yqg6L29XG4gICAgICB0aGlzLmVuc3VyZUJvb3RzdHJhcExvYWRlZCgpO1xuXG4gICAgICAvLyDmo4Dmn6Vtb2RhbOaWueazleaYr+WQpuWPr+eUqFxuICAgICAgaWYgKHR5cGVvZiAkLmZuLm1vZGFsICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdCb290c3RyYXAgbW9kYWzmlrnms5XkuI3lj6/nlKjvvIzkvb/nlKjmm7/ku6Pmlrnms5XmmL7npLrlvLnnqpcnKTtcblxuICAgICAgICAvLyDmm7/ku6Pmlrnms5XvvJrnm7TmjqXmmL7npLrlhYPntKBcbiAgICAgICAgY29uc3QgbW9kYWxFbGVtZW50ID0gJChgIyR7dGhpcy5tb2RhbElkfWApO1xuICAgICAgICBtb2RhbEVsZW1lbnRcbiAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICAgICAgICAncGFkZGluZy1yaWdodCc6ICcxN3B4JyxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5hZGRDbGFzcygnc2hvdycpO1xuXG4gICAgICAgIC8vIOa3u+WKoG92ZXJmbG935qC35byP5YiwYm9keVxuICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ21vZGFsLW9wZW4nKS5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+S9v+eUqEJvb3RzdHJhcCBtb2RhbOaWueazleaYvuekuuW8ueeqlycpO1xuXG4gICAgICAgIC8vIOS9v+eUqEJvb3RzdHJhcOeahG1vZGFs5pa55rOVXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgJChgIyR7dGhpcy5tb2RhbElkfWApLm1vZGFsKCdzaG93Jyk7XG4gICAgICAgIH0gY2F0Y2ggKG1vZGFsRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfmmL7npLptb2RhbOWHuumUmTonLCBtb2RhbEVycm9yKTtcblxuICAgICAgICAgIC8vIOWQjuWkh+aWueahiO+8muebtOaOpeaYvuekuuWFg+e0oFxuICAgICAgICAgICQoYCMke3RoaXMubW9kYWxJZH1gKVxuICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICAgICAgICAgICdwYWRkaW5nLXJpZ2h0JzogJzE3cHgnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hZGRDbGFzcygnc2hvdycpO1xuXG4gICAgICAgICAgLy8g5re75Yqgb3ZlcmZsb3fmoLflvI/liLBib2R5XG4gICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdtb2RhbC1vcGVuJykuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnVpTWFuYWdlci5oaWRlTG9hZGluZygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfmmL7npLrliqDovb3muLjmiI/lvLnnqpflpLHotKU6JywgZXJyb3IpO1xuICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign6I635Y+W5a2Y5qGj5YiX6KGo5aSx6LSlJywgJ2Vycm9yJyk7XG4gICAgICB0aGlzLnVpTWFuYWdlci5oaWRlTG9hZGluZygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDlrZjmoaPliJfooahcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFNhdmVMaXN0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDojrflj5bmiYDmnInlrZjmoaNcbiAgICAgIGNvbnN0IHsgYXV0b1NhdmVzLCBtYW51YWxTYXZlcyB9ID0gYXdhaXQgdGhpcy5nZXRBbGxTYXZlcygpO1xuXG4gICAgICAvLyDmm7TmlrDoh6rliqjlrZjmoaPliJfooahcbiAgICAgIGNvbnN0ICRhdXRvU2F2ZUxpc3QgPSAkKCcjYXV0by1zYXZlLWxpc3QnKTtcbiAgICAgICRhdXRvU2F2ZUxpc3QuZW1wdHkoKTtcblxuICAgICAgaWYgKGF1dG9TYXZlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgJGF1dG9TYXZlTGlzdC5hcHBlbmQoJzxsaSBjbGFzcz1cInNhdmUtaXRlbSBlbXB0eVwiPuaaguaXoOiHquWKqOWtmOahozwvbGk+Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDmjIlJROWAkuW6j+aOkuWIl++8jOacgOaWsOeahOWtmOaho+WcqOacgOWJjemdolxuICAgICAgICBjb25zdCBzb3J0ZWRBdXRvU2F2ZXMgPSBhdXRvU2F2ZXMuc29ydCgoYSwgYikgPT4gYi5zYXZlSWQgLSBhLnNhdmVJZCk7XG5cbiAgICAgICAgZm9yIChjb25zdCBzYXZlIG9mIHNvcnRlZEF1dG9TYXZlcykge1xuICAgICAgICAgIHRoaXMuYXBwZW5kU2F2ZUl0ZW0oJGF1dG9TYXZlTGlzdCwgc2F2ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g5pu05paw5omL5Yqo5a2Y5qGj5YiX6KGoXG4gICAgICBjb25zdCAkbWFudWFsU2F2ZUxpc3QgPSAkKCcjbWFudWFsLXNhdmUtbGlzdCcpO1xuICAgICAgJG1hbnVhbFNhdmVMaXN0LmVtcHR5KCk7XG5cbiAgICAgIGlmIChtYW51YWxTYXZlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgJG1hbnVhbFNhdmVMaXN0LmFwcGVuZCgnPGxpIGNsYXNzPVwic2F2ZS1pdGVtIGVtcHR5XCI+5pqC5peg5omL5Yqo5a2Y5qGjPC9saT4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOaMiUlE5YCS5bqP5o6S5YiX77yM5pyA5paw55qE5a2Y5qGj5Zyo5pyA5YmN6Z2iXG4gICAgICAgIGNvbnN0IHNvcnRlZE1hbnVhbFNhdmVzID0gbWFudWFsU2F2ZXMuc29ydCgoYSwgYikgPT4gYi5zYXZlSWQgLSBhLnNhdmVJZCk7XG5cbiAgICAgICAgZm9yIChjb25zdCBzYXZlIG9mIHNvcnRlZE1hbnVhbFNhdmVzKSB7XG4gICAgICAgICAgdGhpcy5hcHBlbmRTYXZlSXRlbSgkbWFudWFsU2F2ZUxpc3QsIHNhdmUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIt+aWsOWtmOaho+WIl+ihqOWksei0pTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg5a2Y5qGj6aG55Yiw5YiX6KGoXG4gICAqL1xuICBwcml2YXRlIGFwcGVuZFNhdmVJdGVtKCRsaXN0OiBKUXVlcnksIHNhdmU6IGFueSk6IHZvaWQge1xuICAgIC8vIOeUn+aIkOe8qeeVpeWbvlVSTFxuICAgIGxldCB0aHVtYm5haWxVcmwgPSAnJztcbiAgICBpZiAoc2F2ZS50aHVtYm5haWwpIHtcbiAgICAgIHRodW1ibmFpbFVybCA9IHNhdmUudGh1bWJuYWlsO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyDkvb/nlKjpu5jorqTlm77niYfvvIzmoLnmja7lrZjmoaPnsbvlnovpgInmi6nkuI3lkIznmoTpu5jorqTlm77niYdcbiAgICAgIHRodW1ibmFpbFVybCA9IHNhdmUuaXNBdXRvXG4gICAgICAgID8gJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCU4MyU4QyVFNiU5OSVBRi8lRTQlQjklQTYlRTUlQkElOTclRTUlODYlODUvJUU0JUI5JUE2JUU1JUJBJTk3LmpwZz9yZWZfdHlwZT1oZWFkcydcbiAgICAgICAgOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JTgzJThDJUU2JTk5JUFGLyVFNSU4NSVBQyVFNSU5QiVBRC8lRTclOTklQkQlRTUlQTQlQTkuanBnP3JlZl90eXBlPWhlYWRzJztcbiAgICB9XG5cbiAgICBjb25zdCAkc2F2ZUl0ZW0gPSAkKCc8bGk+Jywge1xuICAgICAgY2xhc3M6ICdzYXZlLWl0ZW0nLFxuICAgICAgJ2RhdGEta2V5Jzogc2F2ZS5rZXksXG4gICAgfSk7XG5cbiAgICAvLyDmt7vliqDnvKnnlaXlm75cbiAgICAkKCc8ZGl2PicsIHtcbiAgICAgIGNsYXNzOiAnc2F2ZS1pdGVtLXRodW1ibmFpbCcsXG4gICAgICBzdHlsZTogYGJhY2tncm91bmQtaW1hZ2U6IHVybCgke3RodW1ibmFpbFVybH0pYCxcbiAgICB9KS5hcHBlbmRUbygkc2F2ZUl0ZW0pO1xuXG4gICAgLy8g5re75Yqg5qCH6aKY5ZKM5pel5pyfXG4gICAgY29uc3QgJGhlYWRlciA9ICQoJzxkaXY+JywgeyBjbGFzczogJ3NhdmUtaXRlbS1oZWFkZXInIH0pO1xuXG4gICAgJCgnPGRpdj4nLCB7XG4gICAgICBjbGFzczogJ3NhdmUtaXRlbS10aXRsZScsXG4gICAgICB0ZXh0OiBzYXZlLnRpdGxlLFxuICAgIH0pLmFwcGVuZFRvKCRoZWFkZXIpO1xuXG4gICAgJCgnPGRpdj4nLCB7XG4gICAgICBjbGFzczogJ3NhdmUtaXRlbS1kYXRlJyxcbiAgICAgIHRleHQ6IHNhdmUuZGF0ZSxcbiAgICB9KS5hcHBlbmRUbygkaGVhZGVyKTtcblxuICAgICRoZWFkZXIuYXBwZW5kVG8oJHNhdmVJdGVtKTtcblxuICAgIC8vIOa3u+WKoOWGheWuueaRmOimgVxuICAgICQoJzxkaXY+Jywge1xuICAgICAgY2xhc3M6ICdzYXZlLWl0ZW0tY29udGVudCcsXG4gICAgICB0ZXh0OiBzYXZlLmNvbnRlbnQgfHwgJ+aXoOWPr+eUqOWGheWuuScsXG4gICAgfSkuYXBwZW5kVG8oJHNhdmVJdGVtKTtcblxuICAgIC8vIOa3u+WKoOaTjeS9nOaMiemSrlxuICAgIGNvbnN0ICRhY3Rpb25zID0gJCgnPGRpdj4nLCB7IGNsYXNzOiAnc2F2ZS1pdGVtLWFjdGlvbnMnIH0pO1xuXG4gICAgLy8g5Yib5bu65Yqg6L295oyJ6ZKuXG4gICAgY29uc3QgJGxvYWRCdG4gPSAkKCc8YnV0dG9uPicsIHtcbiAgICAgIGNsYXNzOiAnYnRuLWxvYWQnLFxuICAgICAgaHRtbDogJzxpIGNsYXNzPVwiZmFzIGZhLWJvb2stcmVhZGVyXCI+PC9pPiDpmIXor7snLFxuICAgICAgJ2RhdGEta2V5Jzogc2F2ZS5rZXksXG4gICAgfSk7XG5cbiAgICAvLyDliJvlu7rliKDpmaTmjInpkq5cbiAgICBjb25zdCAkZGVsZXRlQnRuID0gJCgnPGJ1dHRvbj4nLCB7XG4gICAgICBjbGFzczogJ2J0bi1kZWxldGUnLFxuICAgICAgaHRtbDogJzxpIGNsYXNzPVwiZmFzIGZhLXRyYXNoLWFsdFwiPjwvaT4g6ZSA5q+BJyxcbiAgICAgICdkYXRhLWtleSc6IHNhdmUua2V5LFxuICAgICAgJ2RhdGEtdGl0bGUnOiBzYXZlLnRpdGxlLFxuICAgIH0pO1xuXG4gICAgLy8g5bCG5oyJ6ZKu5re75Yqg5Yiw5pON5L2c5Yy65Z+fXG4gICAgJGFjdGlvbnMuYXBwZW5kKCRsb2FkQnRuKS5hcHBlbmQoJGRlbGV0ZUJ0bik7XG4gICAgJGFjdGlvbnMuYXBwZW5kVG8oJHNhdmVJdGVtKTtcblxuICAgIC8vIOWwhuaVtOS4quWtmOaho+mhuea3u+WKoOWIsOWIl+ihqFxuICAgICRsaXN0LmFwcGVuZCgkc2F2ZUl0ZW0pO1xuXG4gICAgLy8g5L2/55So55u05o6l5LqL5Lu257uR5a6a77yM6YG/5YWN5L2/55Sob27ku6PnkIblr7zoh7TnmoTpl67pophcbiAgICAkbG9hZEJ0bi5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBjb25zb2xlLmxvZygn54K55Ye75Yqg6L295oyJ6ZKu77yMa2V5OicsIHNhdmUua2V5KTtcbiAgICAgIHRoaXMubG9hZEdhbWVGcm9tS2V5KHNhdmUua2V5KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgICRkZWxldGVCdG4ub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgY29uc29sZS5sb2coJ+eCueWHu+WIoOmZpOaMiemSru+8jGtleTonLCBzYXZlLmtleSwgJ3RpdGxlOicsIHNhdmUudGl0bGUpO1xuICAgICAgdGhpcy5kZWxldGVTYXZlKHNhdmUua2V5LCBzYXZlLnRpdGxlKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIC8vIOS4uuaVtOS4quWtmOaho+mhuea3u+WKoOeCueWHu+S6i+S7tlxuICAgICRzYXZlSXRlbS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIC8vIOWmguaenOeCueWHu+eahOaYr+aTjeS9nOaMiemSru+8jOS4jei/m+ihjOWkhOeQhlxuICAgICAgaWYgKCQoZS50YXJnZXQpLmNsb3Nlc3QoJy5zYXZlLWl0ZW0tYWN0aW9ucycpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDlkKbliJnop6blj5HliqDovb3lrZjmoaNcbiAgICAgIGNvbnNvbGUubG9nKCfngrnlh7vlrZjmoaPpobnvvIxrZXk6Jywgc2F2ZS5rZXkpO1xuICAgICAgdGhpcy5sb2FkR2FtZUZyb21LZXkoc2F2ZS5rZXkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOWtmOaho1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkZWxldGVTYXZlKHNhdmVLZXk6IHN0cmluZywgc2F2ZVRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ+WHhuWkh+WIoOmZpOWtmOaho++8jGtleTonLCBzYXZlS2V5LCAndGl0bGU6Jywgc2F2ZVRpdGxlKTtcblxuICAgICAgLy8g56Gu6K6k5Yig6ZmkXG4gICAgICB0aGlzLnVpTWFuYWdlci5zaG93Q29uZmlybURpYWxvZyhg56Gu5a6a6KaB6ZSA5q+B5YW457GNXCIke3NhdmVUaXRsZX1cIuWQl++8n+atpOaTjeS9nOS4jeWPr+mAhuOAgmAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ+eUqOaIt+ehruiupOWIoOmZpOWtmOaho++8jOW8gOWni+WIoOmZpOi/h+eoiycpO1xuICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93TG9hZGluZygn5q2j5Zyo6ZSA5q+B5YW457GNLi4uJyk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBhbGxFbnRyaWVzID0gYXdhaXQgd2luZG93LmdldExvcmVib29rRW50cmllcyh0aGlzLndvcmxkQm9va05hbWUpO1xuICAgICAgICAgIGNvbnN0IHNhdmVFbnRyeSA9IHRoaXMuZmluZEVudHJ5QnlLZXkoYWxsRW50cmllcywgc2F2ZUtleSk7XG5cbiAgICAgICAgICBpZiAoc2F2ZUVudHJ5ICYmIHNhdmVFbnRyeS51aWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDmib7liLDlrZjmoaPmnaHnm67vvIzlh4blpIfliKDpmaQgVUlEPSR7c2F2ZUVudHJ5LnVpZH1gKTtcbiAgICAgICAgICAgIGF3YWl0IHdpbmRvdy5kZWxldGVMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwgc2F2ZUVudHJ5LnVpZCk7XG5cbiAgICAgICAgICAgIC8vIOWIt+aWsOWtmOaho+WIl+ihqFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU2F2ZUxpc3QoKTtcblxuICAgICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbihg5YW457GNXCIke3NhdmVUaXRsZX1cIuW3suaIkOWKn+mUgOavgWAsICdzdWNjZXNzJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aJvuS4jeWIsOimgeWIoOmZpOeahOWtmOaho+adoeebricpO1xuICAgICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign5om+5LiN5Yiw5oyH5a6a55qE5YW457GN6K6w5b2VJywgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOWtmOaho+i/h+eoi+S4reWHuumUmTonLCBlcnJvcik7XG4gICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbihcbiAgICAgICAgICAgICfplIDmr4HlhbjnsY3lpLHotKU6ICcgKyAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn5pyq55+l6ZSZ6K+vJyksXG4gICAgICAgICAgICAnZXJyb3InLFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgdGhpcy51aU1hbmFnZXIuaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOWtmOaho+i/h+eoi+WHuumUmTonLCBlcnJvcik7XG4gICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfplIDmr4HlhbjnsY3lpLHotKUnLCAnZXJyb3InKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ5ri45oiP5a2Y5qGjXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0QWxsU2F2ZXMoKTogUHJvbWlzZTx7IGF1dG9TYXZlczogYW55W107IG1hbnVhbFNhdmVzOiBhbnlbXSB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOehruS/neiBiuWkqeS4lueVjOS5puW3suWIneWni+WMllxuICAgICAgaWYgKCF0aGlzLndvcmxkQm9va05hbWUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplQ2hhdExvcmVib29rKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIOajgOafpUFQSeaYr+WQpuWPr+eUqFxuICAgICAgaWYgKCF0aGlzLndvcmxkQm9va05hbWUgfHwgdHlwZW9mIHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXMgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfkuJbnlYzkuaZBUEnkuI3lj6/nlKjvvIzml6Dms5Xojrflj5blrZjmoaMnKTtcbiAgICAgICAgcmV0dXJuIHsgYXV0b1NhdmVzOiBbXSwgbWFudWFsU2F2ZXM6IFtdIH07XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5puadoeebrlxuICAgICAgY29uc3QgYWxsRW50cmllcyA9IGF3YWl0IHRoaXMuZ2V0QWxsV29ybGRCb29rRW50cmllcygpO1xuICAgICAgaWYgKCFhbGxFbnRyaWVzIHx8ICFBcnJheS5pc0FycmF5KGFsbEVudHJpZXMpIHx8IGFsbEVudHJpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiB7IGF1dG9TYXZlczogW10sIG1hbnVhbFNhdmVzOiBbXSB9O1xuICAgICAgfVxuXG4gICAgICAvLyDnrZvpgInlh7roh6rliqjlrZjmoaPmnaHnm65cbiAgICAgIGNvbnN0IGF1dG9TYXZlRW50cmllcyA9IGFsbEVudHJpZXMuZmlsdGVyKGVudHJ5ID0+IHRoaXMuY2hlY2tFbnRyeUtleVN0YXJ0c1dpdGgoZW50cnksIHRoaXMuU0FWRV9UWVBFLkFVVE8pKTtcblxuICAgICAgLy8g562b6YCJ5Ye65omL5Yqo5a2Y5qGj5p2h55uuXG4gICAgICBjb25zdCBtYW51YWxTYXZlRW50cmllcyA9IGFsbEVudHJpZXMuZmlsdGVyKGVudHJ5ID0+IHRoaXMuY2hlY2tFbnRyeUtleVN0YXJ0c1dpdGgoZW50cnksIHRoaXMuU0FWRV9UWVBFLk1BTlVBTCkpO1xuXG4gICAgICBjb25zb2xlLmxvZyhg5om+5YiwICR7YXV0b1NhdmVFbnRyaWVzLmxlbmd0aH0g5Liq6Ieq5Yqo5a2Y5qGj5ZKMICR7bWFudWFsU2F2ZUVudHJpZXMubGVuZ3RofSDkuKrmiYvliqjlrZjmoaNgKTtcblxuICAgICAgLy8g5aSE55CG6Ieq5Yqo5a2Y5qGj5pWw5o2uXG4gICAgICBjb25zdCBhdXRvU2F2ZXMgPSBhd2FpdCBQcm9taXNlLmFsbChhdXRvU2F2ZUVudHJpZXMubWFwKGVudHJ5ID0+IHRoaXMucHJvY2Vzc1NhdmVFbnRyeShlbnRyeSwgdHJ1ZSkpKTtcblxuICAgICAgLy8g5aSE55CG5omL5Yqo5a2Y5qGj5pWw5o2uXG4gICAgICBjb25zdCBtYW51YWxTYXZlcyA9IGF3YWl0IFByb21pc2UuYWxsKG1hbnVhbFNhdmVFbnRyaWVzLm1hcChlbnRyeSA9PiB0aGlzLnByb2Nlc3NTYXZlRW50cnkoZW50cnksIGZhbHNlKSkpO1xuXG4gICAgICAvLyDov4fmu6TmjonlpITnkIblpLHotKXnmoTlrZjmoaPlubbmjIlJROaOkuW6j1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXV0b1NhdmVzOiBhdXRvU2F2ZXMuZmlsdGVyKHNhdmUgPT4gc2F2ZSAhPT0gbnVsbCkuc29ydCgoYSwgYikgPT4gYi5zYXZlSWQgLSBhLnNhdmVJZCksXG4gICAgICAgIG1hbnVhbFNhdmVzOiBtYW51YWxTYXZlcy5maWx0ZXIoc2F2ZSA9PiBzYXZlICE9PSBudWxsKS5zb3J0KChhLCBiKSA9PiBiLnNhdmVJZCAtIGEuc2F2ZUlkKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluWtmOaho+WIl+ihqOWksei0pTonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBhdXRvU2F2ZXM6IFtdLCBtYW51YWxTYXZlczogW10gfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5a2Y5qGj5p2h55uuXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHByb2Nlc3NTYXZlRW50cnkoZW50cnk6IGFueSwgaXNBdXRvOiBib29sZWFuKTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFlbnRyeSB8fCAhZW50cnkua2V5KSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign5peg5pWI55qE5a2Y5qGj5p2h55uuOicsIGVudHJ5KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPlumUruWAvO+8iOWPr+iDveaYr+Wtl+espuS4suaIluaVsOe7hO+8iVxuICAgICAgbGV0IGVudHJ5S2V5ID0gJyc7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyeS5rZXkpICYmIGVudHJ5LmtleS5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIOafpeaJvuespuWQiOadoeS7tueahOmUrlxuICAgICAgICBjb25zdCBwcmVmaXggPSBpc0F1dG8gPyB0aGlzLlNBVkVfVFlQRS5BVVRPIDogdGhpcy5TQVZFX1RZUEUuTUFOVUFMO1xuICAgICAgICBjb25zdCBtYXRjaGluZ0tleSA9IGVudHJ5LmtleS5maW5kKChrOiBzdHJpbmcpID0+IGsgJiYgdHlwZW9mIGsgPT09ICdzdHJpbmcnICYmIGsuc3RhcnRzV2l0aChwcmVmaXgpKTtcbiAgICAgICAgaWYgKG1hdGNoaW5nS2V5KSB7XG4gICAgICAgICAgZW50cnlLZXkgPSBtYXRjaGluZ0tleTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbnRyeUtleSA9IGVudHJ5LmtleVswXTsgLy8g6buY6K6k5L2/55So56ys5LiA5Liq6ZSuXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVudHJ5LmtleSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgZW50cnlLZXkgPSBlbnRyeS5rZXk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+aXoOaViOeahOmUruWAvOexu+WeizonLCBlbnRyeS5rZXkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8g5LuO6ZSu5Lit5o+Q5Y+W5a2Y5qGjSURcbiAgICAgIGNvbnN0IGlkTWF0Y2ggPSBlbnRyeUtleS5tYXRjaCgvKFxcZCspJC8pO1xuICAgICAgY29uc3Qgc2F2ZUlkID0gaWRNYXRjaCA/IHBhcnNlSW50KGlkTWF0Y2hbMV0sIDEwKSA6IDA7XG5cbiAgICAgIC8vIOiOt+WPlueugOimgeWGheWuueeUqOS6juaYvuekulxuICAgICAgY29uc3Qgc2F2ZVByZXZpZXcgPSB7XG4gICAgICAgIGtleTogZW50cnlLZXksXG4gICAgICAgIHVpZDogZW50cnkudWlkLCAvLyDkv53lrZhVSUTnlKjkuo7lkI7nu63mk43kvZxcbiAgICAgICAgdGl0bGU6IGVudHJ5LmNvbW1lbnQgfHwgKGlzQXV0byA/IGDoh6rliqjorrDlvZXngrkgIyR7c2F2ZUlkfWAgOiBg5rC45LmF5YW457GNICMke3NhdmVJZH1gKSxcbiAgICAgICAgc2F2ZUlkOiBzYXZlSWQsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKGVudHJ5LmNyZWF0ZWRfYXQgfHwgRGF0ZS5ub3coKSkudG9Mb2NhbGVTdHJpbmcoKSxcbiAgICAgICAgY29udGVudDogJycsXG4gICAgICAgIHRodW1ibmFpbDogJycsXG4gICAgICAgIGlzQXV0bzogaXNBdXRvLFxuICAgICAgfTtcblxuICAgICAgLy8g5bCd6K+V6I635Y+W5a2Y5qGj5YaF5a6555qE5pGY6KaB5ZKM57yp55Wl5Zu+XG4gICAgICB0cnkge1xuICAgICAgICAvLyDkvJjlhYjkvb/nlKjmnaHnm67nmoTnm7TmjqXlhoXlrrlcbiAgICAgICAgbGV0IGNvbnRlbnQgPSAnJztcbiAgICAgICAgaWYgKGVudHJ5LmNvbnRlbnQpIHtcbiAgICAgICAgICBjb250ZW50ID0gZW50cnkuY29udGVudDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93LnRyaWdnZXJTbGFzaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB3aW5kb3cudHJpZ2dlclNsYXNoKGAvZ2V0ZW50cnlmaWVsZCBmaWxlPSR7dGhpcy53b3JsZEJvb2tOYW1lfSBmaWVsZD1jb250ZW50ICR7ZW50cnlLZXl9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBnYW1lRGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7XG4gICAgICAgICAgICBpZiAoZ2FtZURhdGEuc3RvcnlTdW1tYXJ5ICYmIGdhbWVEYXRhLnN0b3J5U3VtbWFyeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGxhdGVzdFN1bW1hcnkgPSBnYW1lRGF0YS5zdG9yeVN1bW1hcnlbZ2FtZURhdGEuc3RvcnlTdW1tYXJ5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICBzYXZlUHJldmlldy5jb250ZW50ID0gbGF0ZXN0U3VtbWFyeS5jb250ZW50O1xuXG4gICAgICAgICAgICAgIC8vIOWmguaenOacieWbvueJh++8jOWImeS9v+eUqOivpeWbvueJh+S9nOS4uue8qeeVpeWbvlxuICAgICAgICAgICAgICBpZiAobGF0ZXN0U3VtbWFyeS5pbWFnZSkge1xuICAgICAgICAgICAgICAgIHNhdmVQcmV2aWV3LnRodW1ibmFpbCA9IGxhdGVzdFN1bW1hcnkuaW1hZ2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChqc29uRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybign6Kej5p6Q5a2Y5qGj5YaF5a655aSx6LSlOicsIGpzb25FcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+aXoOazleiOt+WPluWtmOaho+WGheWuueaRmOimgTonLCBlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzYXZlUHJldmlldztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5aSE55CG5a2Y5qGj5pWw5o2u5Ye66ZSZOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDku47lrZjmoaPplK7liqDovb3muLjmiI9cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgbG9hZEdhbWVGcm9tS2V5KHNhdmVLZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn5YeG5aSH5Yqg6L295a2Y5qGj77yMa2V5OicsIHNhdmVLZXkpO1xuXG4gICAgICAvLyDnoa7orqTliqDovb1cbiAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dDb25maXJtRGlhbG9nKCfnoa7lrpropoHliqDovb3mraTlrZjmoaPlkJfvvJ/lvZPliY3muLjmiI/ov5vluqblsIbkuKLlpLHjgIInLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfnlKjmiLfnoa7orqTliqDovb3lrZjmoaPvvIzlvIDlp4vliqDovb3ov4fnqIsnKTtcbiAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd0xvYWRpbmcoJ+ato+WcqOWKoOi9veWtmOahoy4uLicpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g5Yqg6L295ri45oiP54q25oCBXG4gICAgICAgICAgY29uc3QgZ2FtZURhdGEgPSBhd2FpdCB0aGlzLmxvYWRHYW1lU3RhdGUoc2F2ZUtleSk7XG5cbiAgICAgICAgICBpZiAoZ2FtZURhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCflrZjmoaPliqDovb3miJDlip/vvIzlh4blpIflhbPpl63lvLnnqpflubbmm7TmlrDmuLjmiI/nirbmgIEnKTtcblxuICAgICAgICAgICAgLy8g5YWz6Zet5by556qXXG4gICAgICAgICAgICB0aGlzLmNsb3NlTG9hZEdhbWVNb2RhbCgpO1xuXG4gICAgICAgICAgICAvLyDop6blj5HliqDovb3lrozmiJDkuovku7bvvIzkvKDpgJLmuLjmiI/mlbDmja7nu5nmuLjmiI/mjqfliLblmahcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfop6blj5FnYW1lbG9hZGVk5LqL5Lu2Jyk7XG4gICAgICAgICAgICBjb25zdCBsb2FkRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2dhbWVsb2FkZWQnLCB7XG4gICAgICAgICAgICAgIGRldGFpbDogeyBnYW1lRGF0YSB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChsb2FkRXZlbnQpO1xuXG4gICAgICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfliqDovb3lrZjmoaPmiJDlip8nLCAnc3VjY2VzcycpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3muLjmiI/nirbmgIHlpLHotKXvvIxnYW1lRGF0YeS4um51bGwnKTtcbiAgICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+WKoOi9veWtmOaho+Wksei0pScsICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3lrZjmoaPlpITnkIbov4fnqIvkuK3lh7rplJk6JywgZXJyb3IpO1xuICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oXG4gICAgICAgICAgICAn5Yqg6L295a2Y5qGj5aSx6LSlOiAnICsgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+acquefpemUmeivrycpLFxuICAgICAgICAgICAgJ2Vycm9yJyxcbiAgICAgICAgICApO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLmhpZGVMb2FkaW5nKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfliqDovb3lrZjmoaPov4fnqIvlh7rplJk6JywgZXJyb3IpO1xuICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign5Yqg6L295a2Y5qGj5aSx6LSlJywgJ2Vycm9yJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwhuW9k+WJjea4uOaIj+eKtuaAgeS/neWtmOWIsOS4lueVjOS5plxuICAgKiBAcGFyYW0gZ2FtZURhdGEg5ri45oiP5pWw5o2uXG4gICAqIEBwYXJhbSBpc01hbnVhbCDmmK/lkKbkuLrmiYvliqjlrZjmoaNcbiAgICogQHBhcmFtIGN1c3RvbU5hbWUg6Ieq5a6a5LmJ5a2Y5qGj5ZCN56ew77yI5LuF55So5LqO5omL5Yqo5a2Y5qGj77yJXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZUdhbWVTdGF0ZShnYW1lRGF0YTogR2FtZURhdGEsIGlzTWFudWFsOiBib29sZWFuID0gZmFsc2UsIGN1c3RvbU5hbWU/OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoIWdhbWVEYXRhIHx8ICFnYW1lRGF0YS5zdG9yeVN1bW1hcnkgfHwgZ2FtZURhdGEuc3RvcnlTdW1tYXJ5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS53YXJuKCfmsqHmnInlj6/kv53lrZjnmoTmuLjmiI/nirbmgIEnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8g56Gu5L+d6IGK5aSp5LiW55WM5Lmm5bey5Yid5aeL5YyWXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICBjb25zb2xlLmxvZygn5LiW55WM5Lmm5ZCN56ew5Li656m677yM6YeN5paw5Yid5aeL5YyWJyk7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUNoYXRMb3JlYm9vaygpO1xuXG4gICAgICAgIGlmICghdGhpcy53b3JsZEJvb2tOYW1lKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign5Yid5aeL5YyW5LiW55WM5Lmm5aSx6LSl77yM5peg5rOV5L+d5a2Y5ri45oiP54q25oCBJyk7XG4gICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign5peg5rOV5Yid5aeL5YyW5LiW55WM5Lmm77yM5L+d5a2Y5aSx6LSlJywgJ2Vycm9yJyk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOajgOafpeS4lueVjOS5pkFQSeaYr+WQpuWPr+eUqFxuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZ2V0TG9yZWJvb2tFbnRyaWVzICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4lueVjOS5pkFQSeS4jeWPr+eUqCcpO1xuICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKCfkuJbnlYzkuaZBUEnkuI3lj6/nlKjvvIzml6Dms5Xkv53lrZjmuLjmiI/nirbmgIEnLCAnZXJyb3InKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyDmoLnmja7kv53lrZjnsbvlnovnoa7lrprlrZjmoaNJROWSjOmUruWQjeWJjee8gFxuICAgICAgY29uc3Qgc2F2ZVR5cGUgPSBpc01hbnVhbCA/IHRoaXMuU0FWRV9UWVBFLk1BTlVBTCA6IHRoaXMuU0FWRV9UWVBFLkFVVE87XG4gICAgICBjb25zdCBuZXh0SWQgPSBpc01hbnVhbCA/ICsrdGhpcy5jdXJyZW50TWF4U2F2ZUlkLm1hbnVhbCA6ICsrdGhpcy5jdXJyZW50TWF4U2F2ZUlkLmF1dG87XG4gICAgICBjb25zdCBzYXZlS2V5ID0gYCR7c2F2ZVR5cGV9JHtuZXh0SWR9YDtcblxuICAgICAgLy8g5Yib5bu65a2Y5qGj5ZCN56ewXG4gICAgICBsZXQgc2F2ZU5hbWUgPSAnJztcbiAgICAgIGxldCBkaWFsb2d1ZUNvdW50ID0gZ2FtZURhdGEuc3RvcnkuZGlhbG9ndWUubGVuZ3RoO1xuICAgICAgbGV0IG1lbW9yaWVzQ291bnQgPSBnYW1lRGF0YS5zdG9yeVN1bW1hcnkubGVuZ3RoO1xuXG4gICAgICBpZiAoaXNNYW51YWwgJiYgY3VzdG9tTmFtZSkge1xuICAgICAgICBzYXZlTmFtZSA9IGAke2N1c3RvbU5hbWV9ICMke25leHRJZH0gW+WvueivnToke2RpYWxvZ3VlQ291bnR95p2hfOiusOW/hjoke21lbW9yaWVzQ291bnR95p2hXWA7XG4gICAgICB9IGVsc2UgaWYgKGlzTWFudWFsKSB7XG4gICAgICAgIHNhdmVOYW1lID0gYOaJi+WKqOWtmOahoyAjJHtuZXh0SWR9IFvlr7nor506JHtkaWFsb2d1ZUNvdW50feadoXzorrDlv4Y6JHttZW1vcmllc0NvdW50feadoV1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g6Ieq5Yqo5a2Y5qGj5ZCN56ew77yM5qC85byP5Li6XCLoh6rliqjlrZjmoaMjSUQt6K6w5b+G5o+P6L+wXCJcbiAgICAgICAgY29uc3QgbGF0ZXN0U3VtbWFyeSA9IGdhbWVEYXRhLnN0b3J5U3VtbWFyeVtnYW1lRGF0YS5zdG9yeVN1bW1hcnkubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IHNob3J0RGVzY3JpcHRpb24gPVxuICAgICAgICAgIGxhdGVzdFN1bW1hcnkuY29udGVudC5zdWJzdHJpbmcoMCwgMzApICsgKGxhdGVzdFN1bW1hcnkuY29udGVudC5sZW5ndGggPiAzMCA/ICcuLi4nIDogJycpO1xuICAgICAgICBzYXZlTmFtZSA9IGDoh6rliqjlrZjmoaMgIyR7bmV4dElkfS0ke3Nob3J0RGVzY3JpcHRpb259IFvlr7nor506JHtkaWFsb2d1ZUNvdW50feadoXzorrDlv4Y6JHttZW1vcmllc0NvdW50feadoV1gO1xuICAgICAgfVxuXG4gICAgICAvLyDlhYjkv53lrZjlrozmlbTljoblj7LorrDlvZXvvIznoa7kv53lr7nor53ljoblj7LlkozmuLjmiI/nirbmgIHlkIzmraVcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZURpYWxvZ3VlSGlzdG9yeShnYW1lRGF0YSk7XG5cbiAgICAgIC8vIOWHhuWkh+S/neWtmOaVsOaNrlxuICAgICAgY29uc3Qgc2F2ZURhdGEgPSBKU09OLnN0cmluZ2lmeShnYW1lRGF0YSk7XG5cbiAgICAgIC8vIOiusOW9leW8gOWni+S/neWtmOaXtumXtO+8jOeUqOS6jui2heaXtuWIpOaWrVxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IE1BWF9SRVRSWSA9IDM7XG4gICAgICBjb25zdCBUSU1FT1VUX01TID0gMTAwMDA7IC8vIDEw56eS6LaF5pe2XG5cbiAgICAgIGZvciAobGV0IHJldHJ5ID0gMDsgcmV0cnkgPCBNQVhfUkVUUlk7IHJldHJ5KyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyDojrflj5bmiYDmnInmnaHnm67vvIzmo4Dmn6XmmK/lkKblt7LlrZjlnKjnm7jlkIxrZXnnmoTmnaHnm65cbiAgICAgICAgICBjb25zb2xlLmxvZyhg6I635Y+W5LiW55WM5Lmm5p2h55uu77yM5bCd6K+VICR7cmV0cnkgKyAxfS8ke01BWF9SRVRSWX1gKTtcbiAgICAgICAgICBjb25zdCBhbGxFbnRyaWVzID0gYXdhaXQgd2luZG93LmdldExvcmVib29rRW50cmllcyh0aGlzLndvcmxkQm9va05hbWUpO1xuICAgICAgICAgIGNvbnN0IHNhdmVFbnRyeSA9IHRoaXMuZmluZEVudHJ5QnlLZXkoYWxsRW50cmllcywgc2F2ZUtleSk7XG5cbiAgICAgICAgICAvLyDorr7lrprkuIDkuKpQcm9taXNl77yM5b2T6LaF5pe25pe25ouS57udXG4gICAgICAgICAgY29uc3Qgc2F2ZVdpdGhUaW1lb3V0ID0gYXN5bmMgPFQ+KHByb21pc2U6IFByb21pc2U8VD4pOiBQcm9taXNlPFQ+ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVvdXQgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ+aTjeS9nOi2heaXticpKSwgVElNRU9VVF9NUyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW3Byb21pc2UsIHRpbWVvdXRdKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo55u45ZCMa2V555qE5p2h55uu77yM5pu05paw6ICM5LiN5piv5Yib5bu65paw5p2h55uuXG4gICAgICAgICAgaWYgKHNhdmVFbnRyeSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYOWtmOahoyAke3NhdmVLZXl9IOW3suWtmOWcqO+8jOWwhuabtOaWsOadoeebriB1aWQ9JHtzYXZlRW50cnkudWlkfWApO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNhdmVFbnRyeS51aWQgIT09ICdudW1iZXInIHx8IGlzTmFOKHNhdmVFbnRyeS51aWQpKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihg5peg5pWI55qEVUlEOiAke3NhdmVFbnRyeS51aWR9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIOWIm+W7uumcgOimgeabtOaWsOeahOadoeebruWvueixoVxuICAgICAgICAgICAgY29uc3QgdXBkYXRlRW50cnkgPSB7XG4gICAgICAgICAgICAgIHVpZDogc2F2ZUVudHJ5LnVpZCxcbiAgICAgICAgICAgICAgY29tbWVudDogc2F2ZU5hbWUsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHNhdmVEYXRhLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuc2V0TG9yZWJvb2tFbnRyaWVzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgc2F2ZVdpdGhUaW1lb3V0KHdpbmRvdy5zZXRMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lLCBbdXBkYXRlRW50cnldKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOaIkOWKn+abtOaWsOadoeebriBVSUQ9JHtzYXZlRW50cnkudWlkfWApO1xuICAgICAgICAgICAgICAgIC8vIOabtOaWsOaIkOWKn++8jOi3s+WHuumHjeivleW+queOr1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cuZWRpdExvcmVib29rRW50cnkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBzYXZlV2l0aFRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICB3aW5kb3cuZWRpdExvcmVib29rRW50cnkodGhpcy53b3JsZEJvb2tOYW1lLCBzYXZlRW50cnkudWlkLCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IHNhdmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBzYXZlRGF0YSxcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOaIkOWKn+abtOaWsOadoeebriBVSUQ9JHtzYXZlRW50cnkudWlkfSAo5L2/55SoZWRpdExvcmVib29rRW50cnkpYCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c5rKh5pyJ5pu05pawQVBJ77yM5YiZ5Yig6Zmk5ZCO6YeN5bu6XG4gICAgICAgICAgICAgICAgYXdhaXQgc2F2ZVdpdGhUaW1lb3V0KHdpbmRvdy5kZWxldGVMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwgc2F2ZUVudHJ5LnVpZCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1VpZCA9IGF3YWl0IHNhdmVXaXRoVGltZW91dChcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5jcmVhdGVMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXk6IFtzYXZlS2V5XSxcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudDogc2F2ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHNhdmVEYXRhLFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmIChuZXdVaWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg5oiQ5Yqf5Yig6Zmk5pen5p2h55uu5bm25Yib5bu65paw5p2h55uuIFVJRD0ke25ld1VpZH1gKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOWIm+W7uuaWsOadoeebruWksei0pe+8jOi/lOWbnueahFVJROaXoOaViDogJHtuZXdVaWR9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoICh1cGRhdGVFcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGDmm7TmlrDmnaHnm67lsJ3or5UgJHtyZXRyeSArIDF9IOWksei0pTpgLCB1cGRhdGVFcnJvcik7XG5cbiAgICAgICAgICAgICAgLy8g5aaC5p6c5LiN5piv5pyA5ZCO5LiA5qyh5bCd6K+V77yM562J5b6F5ZCO6YeN6K+VXG4gICAgICAgICAgICAgIGlmIChyZXRyeSA8IE1BWF9SRVRSWSAtIDEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgdXBkYXRlRXJyb3I7IC8vIOacgOWQjuS4gOasoeWwneivleWksei0pe+8jOWQkeS4iuaKm+WHuumUmeivr1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIOWIm+W7uuaWsOadoeebrlxuICAgICAgICAgICAgY29uc29sZS5sb2coYOWtmOahoyAke3NhdmVLZXl9IOS4jeWtmOWcqO+8jOWwhuWIm+W7uuaWsOadoeebrmApO1xuXG4gICAgICAgICAgICAvLyDlh4blpIfliJvlu7rnmoTmnaHnm67lr7nosaFcbiAgICAgICAgICAgIGNvbnN0IG5ld0VudHJ5ID0ge1xuICAgICAgICAgICAgICBrZXk6IFtzYXZlS2V5XSxcbiAgICAgICAgICAgICAgY29tbWVudDogc2F2ZU5hbWUsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHNhdmVEYXRhLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAvLyDlsJ3or5Xkvb/nlKjmlrBBUEnliJvlu7rmnaHnm65cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuY3JlYXRlTG9yZWJvb2tFbnRyaWVzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2F2ZVdpdGhUaW1lb3V0KHdpbmRvdy5jcmVhdGVMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lLCBbbmV3RW50cnldKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5uZXdfdWlkcyAmJiByZXN1bHQubmV3X3VpZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOaIkOWKn+WIm+W7uuaWsOadoeebru+8jFVJRD0ke3Jlc3VsdC5uZXdfdWlkc1swXX1gKTtcbiAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ2NyZWF0ZUxvcmVib29rRW50cmllc+i/lOWbnue7k+aenOaXoOaViO+8jOWwhuWwneivleaXp0FQSScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8vIOWmguaenOaWsEFQSeWksei0peaIluS4jeWPr+eUqO+8jOWwneivleaXp0FQSVxuICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MgJiYgdHlwZW9mIHdpbmRvdy5jcmVhdGVMb3JlYm9va0VudHJ5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdWlkID0gYXdhaXQgc2F2ZVdpdGhUaW1lb3V0KHdpbmRvdy5jcmVhdGVMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwgbmV3RW50cnkpKTtcblxuICAgICAgICAgICAgICAgIGlmICh1aWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg5oiQ5Yqf5Yib5bu65paw5p2h55uu77yMVUlEPSR7dWlkfWApO1xuICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihg5Yib5bu65p2h55uu5aSx6LSl77yM6L+U5Zue55qEVUlE5peg5pWIOiAke3VpZH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGJyZWFrOyAvLyDliJvlu7rmiJDlip/vvIzot7Plh7rph43or5Xlvqrnjq9cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+ayoeacieWPr+eUqOeahEFQSeWIm+W7uuadoeebricpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChjcmVhdGVFcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGDliJvlu7rmnaHnm67lsJ3or5UgJHtyZXRyeSArIDF9IOWksei0pTpgLCBjcmVhdGVFcnJvcik7XG5cbiAgICAgICAgICAgICAgLy8g5aaC5p6c5LiN5piv5pyA5ZCO5LiA5qyh5bCd6K+V77yM562J5b6F5ZCO6YeN6K+VXG4gICAgICAgICAgICAgIGlmIChyZXRyeSA8IE1BWF9SRVRSWSAtIDEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3I7IC8vIOacgOWQjuS4gOasoeWwneivleWksei0pe+8jOWQkeS4iuaKm+WHuumUmeivr1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIC8vIOWkhOeQhuacgOWQjuS4gOasoeWksei0peeahOaDheWGtVxuICAgICAgICAgIGlmIChyZXRyeSA9PT0gTUFYX1JFVFJZIC0gMSkge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOS/neWtmOaIkOWKn++8jOiusOW9leW9k+WJjUlEXG4gICAgICBpZiAoaXNNYW51YWwpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50TWF4U2F2ZUlkLm1hbnVhbCA9IG5leHRJZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY3VycmVudE1heFNhdmVJZC5hdXRvID0gbmV4dElkO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhg5bey5oiQ5Yqf5L+d5a2Y5ri45oiP54q25oCB5Yiw5LiW55WM5Lmm77yM5YyF5ZCrICR7ZGlhbG9ndWVDb3VudH0g5p2h5a+56K+d5ZKMICR7bWVtb3JpZXNDb3VudH0g5p2h6K6w5b+GYCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5L+d5a2Y5ri45oiP54q25oCB5Yiw5LiW55WM5Lmm5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oXG4gICAgICAgICfkv53lrZjmuLjmiI/nirbmgIHlpLHotKU6ICcgKyAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn5pyq55+l6ZSZ6K+vJyksXG4gICAgICAgICdlcnJvcicsXG4gICAgICApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3lrozmlbTljoblj7LorrDlvZVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgbG9hZENvbXBsZXRlSGlzdG9yeSgpOiBQcm9taXNlPENvbXBsZXRlSGlzdG9yeVJlY29yZCB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgLy8g5aaC5p6c5bey5pyJ57yT5a2Y6K6w5b2V77yM55u05o6l6L+U5ZueXG4gICAgICBpZiAodGhpcy5jYWNoZWRDb21wbGV0ZUhpc3RvcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVkQ29tcGxldGVIaXN0b3J5O1xuICAgICAgfVxuXG4gICAgICAvLyDnoa7kv53ogYrlpKnkuJbnlYzkuablt7LliJ3lp4vljJZcbiAgICAgIGlmICghdGhpcy53b3JsZEJvb2tOYW1lKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUNoYXRMb3JlYm9vaygpO1xuICAgICAgfVxuXG4gICAgICAvLyDmo4Dmn6VBUEnmmK/lkKblj6/nlKhcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93LmdldExvcmVib29rRW50cmllcyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8jOaXoOazleWKoOi9veWujOaVtOWOhuWPsuiusOW9lScpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8g6I635Y+W5omA5pyJ5LiW55WM5Lmm5p2h55uuXG4gICAgICBjb25zdCBhbGxFbnRyaWVzID0gYXdhaXQgd2luZG93LmdldExvcmVib29rRW50cmllcyh0aGlzLndvcmxkQm9va05hbWUpO1xuICAgICAgaWYgKCFhbGxFbnRyaWVzIHx8ICFBcnJheS5pc0FycmF5KGFsbEVudHJpZXMpKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign5pyq5om+5Yiw5LiW55WM5Lmm5p2h55uuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyDmn6Xmib7lrozmlbTljoblj7LorrDlvZXmnaHnm65cbiAgICAgIGNvbnN0IGhpc3RvcnlFbnRyeSA9IHRoaXMuZmluZEVudHJ5QnlLZXkoYWxsRW50cmllcywgdGhpcy5DT01QTEVURV9ISVNUT1JZX0tFWSk7XG5cbiAgICAgIGlmICghaGlzdG9yeUVudHJ5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfmnKrmib7liLDlrozmlbTljoblj7LorrDlvZXmnaHnm67vvIzlsIbliJvlu7rmlrDorrDlvZUnKTtcbiAgICAgICAgLy8g5Yib5bu65paw55qE5a6M5pW05Y6G5Y+y6K6w5b2VXG4gICAgICAgIGNvbnN0IG5ld0hpc3Rvcnk6IENvbXBsZXRlSGlzdG9yeVJlY29yZCA9IHtcbiAgICAgICAgICBpZDogYGhpc3RvcnlfJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgZGlhbG9ndWVzOiBbXSxcbiAgICAgICAgICBtZW1vcmllczogW10sXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2FjaGVkQ29tcGxldGVIaXN0b3J5ID0gbmV3SGlzdG9yeTtcbiAgICAgICAgcmV0dXJuIG5ld0hpc3Rvcnk7XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluadoeebruWGheWuuVxuICAgICAgbGV0IGhpc3RvcnlDb250ZW50ID0gJyc7XG5cbiAgICAgIC8vIOWwneivleiOt+WPluadoeebruWGheWuuVxuICAgICAgaWYgKGhpc3RvcnlFbnRyeS5jb250ZW50KSB7XG4gICAgICAgIGhpc3RvcnlDb250ZW50ID0gaGlzdG9yeUVudHJ5LmNvbnRlbnQ7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cudHJpZ2dlclNsYXNoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIOS9v+eUqHRyaWdnZXJTbGFzaOiOt+WPllxuICAgICAgICBoaXN0b3J5Q29udGVudCA9IGF3YWl0IHdpbmRvdy50cmlnZ2VyU2xhc2goXG4gICAgICAgICAgYC9nZXRlbnRyeWZpZWxkIGZpbGU9JHt0aGlzLndvcmxkQm9va05hbWV9IGZpZWxkPWNvbnRlbnQgJHt0aGlzLkNPTVBMRVRFX0hJU1RPUllfS0VZfWAsXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmICghaGlzdG9yeUNvbnRlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+WujOaVtOWOhuWPsuiusOW9leWGheWuueS4uuepuu+8jOWwhuWIm+W7uuaWsOiusOW9lScpO1xuICAgICAgICAvLyDliJvlu7rmlrDnmoTlrozmlbTljoblj7LorrDlvZVcbiAgICAgICAgY29uc3QgbmV3SGlzdG9yeTogQ29tcGxldGVIaXN0b3J5UmVjb3JkID0ge1xuICAgICAgICAgIGlkOiBgaGlzdG9yeV8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICBkaWFsb2d1ZXM6IFtdLFxuICAgICAgICAgIG1lbW9yaWVzOiBbXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jYWNoZWRDb21wbGV0ZUhpc3RvcnkgPSBuZXdIaXN0b3J5O1xuICAgICAgICByZXR1cm4gbmV3SGlzdG9yeTtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8g6Kej5p6QSlNPTuWGheWuuVxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gSlNPTi5wYXJzZShoaXN0b3J5Q29udGVudCkgYXMgQ29tcGxldGVIaXN0b3J5UmVjb3JkO1xuICAgICAgICBpZiAoIWhpc3RvcnkuaWQgfHwgIUFycmF5LmlzQXJyYXkoaGlzdG9yeS5kaWFsb2d1ZXMpIHx8ICFBcnJheS5pc0FycmF5KGhpc3RvcnkubWVtb3JpZXMpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfljoblj7LorrDlvZXmoLzlvI/kuI3mraPnoa4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBg5oiQ5Yqf5Yqg6L295a6M5pW05Y6G5Y+y6K6w5b2V77yM5YyF5ZCrICR7aGlzdG9yeS5kaWFsb2d1ZXMubGVuZ3RofSDmnaHlr7nor53lkowgJHtoaXN0b3J5Lm1lbW9yaWVzLmxlbmd0aH0g5p2h6K6w5b+GYCxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5jYWNoZWRDb21wbGV0ZUhpc3RvcnkgPSBoaXN0b3J5O1xuICAgICAgICByZXR1cm4gaGlzdG9yeTtcbiAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q5a6M5pW05Y6G5Y+y6K6w5b2V5aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICAvLyDliJvlu7rmlrDnmoTlrozmlbTljoblj7LorrDlvZVcbiAgICAgICAgY29uc3QgbmV3SGlzdG9yeTogQ29tcGxldGVIaXN0b3J5UmVjb3JkID0ge1xuICAgICAgICAgIGlkOiBgaGlzdG9yeV8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICBkaWFsb2d1ZXM6IFtdLFxuICAgICAgICAgIG1lbW9yaWVzOiBbXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jYWNoZWRDb21wbGV0ZUhpc3RvcnkgPSBuZXdIaXN0b3J5O1xuICAgICAgICByZXR1cm4gbmV3SGlzdG9yeTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5Yqg6L295a6M5pW05Y6G5Y+y6K6w5b2V5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjlrozmlbTljoblj7LorrDlvZVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2F2ZUNvbXBsZXRlSGlzdG9yeShoaXN0b3J5OiBDb21wbGV0ZUhpc3RvcnlSZWNvcmQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8g56Gu5L+d6IGK5aSp5LiW55WM5Lmm5bey5Yid5aeL5YyWXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDaGF0TG9yZWJvb2soKTtcbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+lQVBJ5piv5ZCm5Y+v55SoXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSB8fCB0eXBlb2Ygd2luZG93LmdldExvcmVib29rRW50cmllcyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8jOaXoOazleS/neWtmOWujOaVtOWOhuWPsuiusOW9lScpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5puadoeebrlxuICAgICAgY29uc3QgYWxsRW50cmllcyA9IGF3YWl0IHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lKTtcblxuICAgICAgLy8g5p+l5om+5a6M5pW05Y6G5Y+y6K6w5b2V5p2h55uuXG4gICAgICBjb25zdCBoaXN0b3J5RW50cnkgPSB0aGlzLmZpbmRFbnRyeUJ5S2V5KGFsbEVudHJpZXMsIHRoaXMuQ09NUExFVEVfSElTVE9SWV9LRVkpO1xuXG4gICAgICAvLyDljoblj7LorrDlvZXmoIfpophcbiAgICAgIGNvbnN0IGhpc3RvcnlUaXRsZSA9IGDlrozmlbTmuLjmiI/ljoblj7LorrDlvZUgLSDmnIDlkI7mm7TmlrA6ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfWA7XG5cbiAgICAgIC8vIOi9rOaNouS4ukpTT07lrZfnrKbkuLJcbiAgICAgIGNvbnN0IGhpc3RvcnlDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoaGlzdG9yeSk7XG5cbiAgICAgIGlmIChoaXN0b3J5RW50cnkpIHtcbiAgICAgICAgLy8g5pu05paw546w5pyJ5p2h55uuXG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmVkaXRMb3JlYm9va0VudHJ5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgYXdhaXQgd2luZG93LmVkaXRMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwgaGlzdG9yeUVudHJ5LnVpZCwge1xuICAgICAgICAgICAgY29tbWVudDogaGlzdG9yeVRpdGxlLFxuICAgICAgICAgICAgY29udGVudDogaGlzdG9yeUNvbnRlbnQsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5Zue6YCA5Yiw5penQVBJ77ya5Yig6Zmk5bm26YeN5bu6XG4gICAgICAgICAgYXdhaXQgd2luZG93LmRlbGV0ZUxvcmVib29rRW50cnkodGhpcy53b3JsZEJvb2tOYW1lLCBoaXN0b3J5RW50cnkudWlkKTtcbiAgICAgICAgICBhd2FpdCB3aW5kb3cuY3JlYXRlTG9yZWJvb2tFbnRyeSh0aGlzLndvcmxkQm9va05hbWUsIHtcbiAgICAgICAgICAgIGtleXM6IFt0aGlzLkNPTVBMRVRFX0hJU1RPUllfS0VZXSxcbiAgICAgICAgICAgIGNvbW1lbnQ6IGhpc3RvcnlUaXRsZSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGhpc3RvcnlDb250ZW50LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCfmm7TmlrDkuoblrozmlbTljoblj7LorrDlvZUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWIm+W7uuaWsOadoeebrlxuICAgICAgICBhd2FpdCB3aW5kb3cuY3JlYXRlTG9yZWJvb2tFbnRyeSh0aGlzLndvcmxkQm9va05hbWUsIHtcbiAgICAgICAgICBrZXlzOiBbdGhpcy5DT01QTEVURV9ISVNUT1JZX0tFWV0sXG4gICAgICAgICAgY29tbWVudDogaGlzdG9yeVRpdGxlLFxuICAgICAgICAgIGNvbnRlbnQ6IGhpc3RvcnlDb250ZW50LFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coJ+WIm+W7uuS6huaWsOeahOWujOaVtOWOhuWPsuiusOW9leadoeebricpO1xuICAgICAgfVxuXG4gICAgICAvLyDmm7TmlrDnvJPlrZhcbiAgICAgIHRoaXMuY2FjaGVkQ29tcGxldGVIaXN0b3J5ID0gaGlzdG9yeTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfkv53lrZjlrozmlbTljoblj7LorrDlvZXlpLHotKU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjlr7nor53ljoblj7LliLDkuJbnlYzkuaZcbiAgICog5L2/55So5a6M5pW05Y6G5Y+y6K6w5b2V5a2Y5YKo5omA5pyJ5a+56K+d5ZKM6K6w5b+GXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNhdmVEaWFsb2d1ZUhpc3RvcnkoZ2FtZURhdGE6IEdhbWVEYXRhKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCFnYW1lRGF0YS5zdG9yeSB8fCAhZ2FtZURhdGEuc3RvcnkuZGlhbG9ndWUpIHtcbiAgICAgIGNvbnNvbGUud2Fybign5rKh5pyJ5Y+v5L+d5a2Y55qE5a+56K+d5Y6G5Y+yJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOWKoOi9veW9k+WJjeeahOWujOaVtOWOhuWPsuiusOW9lVxuICAgICAgbGV0IGNvbXBsZXRlSGlzdG9yeSA9IGF3YWl0IHRoaXMubG9hZENvbXBsZXRlSGlzdG9yeSgpO1xuXG4gICAgICBpZiAoIWNvbXBsZXRlSGlzdG9yeSkge1xuICAgICAgICAvLyDliJvlu7rmlrDnmoTlrozmlbTljoblj7LorrDlvZVcbiAgICAgICAgY29tcGxldGVIaXN0b3J5ID0ge1xuICAgICAgICAgIGlkOiBgaGlzdG9yeV8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICBkaWFsb2d1ZXM6IFtdLFxuICAgICAgICAgIG1lbW9yaWVzOiBbXSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8g5re75Yqg5omA5pyJ5a+56K+d5Yiw5Y6G5Y+y6K6w5b2V77yI6YG/5YWN6YeN5aSN77yJXG4gICAgICBjb25zdCBleGlzdGluZ0RpYWxvZ3VlQ291bnQgPSBjb21wbGV0ZUhpc3RvcnkuZGlhbG9ndWVzLmxlbmd0aDtcblxuICAgICAgLy8g6L2s5o2i5omA5pyJ5a+56K+d5Li6566A5YyW5qC85byPXG4gICAgICBjb25zdCBhbGxEaWFsb2d1ZXMgPSBnYW1lRGF0YS5zdG9yeS5kaWFsb2d1ZS5tYXAoZGlhbG9ndWUgPT4gKHtcbiAgICAgICAgc3BlYWtlcjogZGlhbG9ndWUuc3BlYWtlcixcbiAgICAgICAgY29udGVudDogZGlhbG9ndWUuY29udGVudCxcbiAgICAgICAgc3R5bGU6IGRpYWxvZ3VlLnN0eWxlLFxuICAgICAgfSkpO1xuXG4gICAgICAvLyDpgb/lhY3ph43lpI3mt7vliqDlr7nor53vvIzlj6rmt7vliqDmlrDnmoTlr7nor51cbiAgICAgIGlmIChleGlzdGluZ0RpYWxvZ3VlQ291bnQgPCBhbGxEaWFsb2d1ZXMubGVuZ3RoKSB7XG4gICAgICAgIGNvbXBsZXRlSGlzdG9yeS5kaWFsb2d1ZXMgPSBhbGxEaWFsb2d1ZXM7XG4gICAgICAgIGNvbnNvbGUubG9nKGDmm7TmlrDlr7nor53ljoblj7LvvJrku44gJHtleGlzdGluZ0RpYWxvZ3VlQ291bnR9IOadoeWinuWKoOWIsCAke2FsbERpYWxvZ3Vlcy5sZW5ndGh9IOadoWApO1xuICAgICAgfVxuXG4gICAgICAvLyDmt7vliqDmiYDmnInorrDlv4bngrnliLDljoblj7LorrDlvZXvvIjpgb/lhY3ph43lpI3vvIlcbiAgICAgIGlmIChnYW1lRGF0YS5zdG9yeVN1bW1hcnkgJiYgZ2FtZURhdGEuc3RvcnlTdW1tYXJ5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8g5pig5bCE546w5pyJ6K6w5b+G54K555qESURcbiAgICAgICAgY29uc3QgZXhpc3RpbmdNZW1vcnlJZHMgPSBuZXcgU2V0KGNvbXBsZXRlSGlzdG9yeS5tZW1vcmllcy5tYXAobSA9PiBtLmlkKSk7XG5cbiAgICAgICAgLy8g5re75Yqg5LiN5a2Y5Zyo55qE5paw6K6w5b+G54K5XG4gICAgICAgIGZvciAoY29uc3QgbWVtb3J5IG9mIGdhbWVEYXRhLnN0b3J5U3VtbWFyeSkge1xuICAgICAgICAgIGlmICghZXhpc3RpbmdNZW1vcnlJZHMuaGFzKG1lbW9yeS5pZCkpIHtcbiAgICAgICAgICAgIGNvbXBsZXRlSGlzdG9yeS5tZW1vcmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IG1lbW9yeS5pZCxcbiAgICAgICAgICAgICAgY29udGVudDogbWVtb3J5LmNvbnRlbnQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV4aXN0aW5nTWVtb3J5SWRzLmFkZChtZW1vcnkuaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKGDmm7TmlrDorrDlv4bljoblj7LvvJrlvZPliY3lhbHmnIkgJHtjb21wbGV0ZUhpc3RvcnkubWVtb3JpZXMubGVuZ3RofSDmnaHorrDlv4ZgKTtcbiAgICAgIH1cblxuICAgICAgLy8g5L+d5a2Y5a6M5pW05Y6G5Y+y6K6w5b2VXG4gICAgICBjb25zdCBzYXZlUmVzdWx0ID0gYXdhaXQgdGhpcy5zYXZlQ29tcGxldGVIaXN0b3J5KGNvbXBsZXRlSGlzdG9yeSk7XG5cbiAgICAgIC8vIOWQjOaXtuabtOaWsOaXp+eJiOWvueivneWOhuWPsuiusOW9leagvOW8j++8iOWQkeWQjuWFvOWuue+8iVxuICAgICAgYXdhaXQgdGhpcy5zYXZlTGVnYWN5RGlhbG9ndWVIaXN0b3J5KGdhbWVEYXRhLCBjb21wbGV0ZUhpc3RvcnkpO1xuXG4gICAgICByZXR1cm4gc2F2ZVJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5L+d5a2Y5a+56K+d5Y6G5Y+y5Yiw5LiW55WM5Lmm5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y5pen54mI5qC85byP55qE5a+56K+d5Y6G5Y+y77yI5ZCR5ZCO5YW85a6577yJXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNhdmVMZWdhY3lEaWFsb2d1ZUhpc3RvcnkoXG4gICAgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgIGNvbXBsZXRlSGlzdG9yeTogQ29tcGxldGVIaXN0b3J5UmVjb3JkLFxuICApOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8g56Gu5L+d6IGK5aSp5LiW55WM5Lmm5bey5Yid5aeL5YyWXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDaGF0TG9yZWJvb2soKTtcbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+lQVBJ5piv5ZCm5Y+v55SoXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSB8fCB0eXBlb2Ygd2luZG93LmdldExvcmVib29rRW50cmllcyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8jOaXoOazleS/neWtmOaXp+eJiOWvueivneWOhuWPsicpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5puadoeebrlxuICAgICAgY29uc3QgYWxsRW50cmllcyA9IGF3YWl0IHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lKTtcblxuICAgICAgLy8g5p+l5om+5a+56K+d5Y6G5Y+y5p2h55uuXG4gICAgICBjb25zdCBkaWFsb2d1ZUhpc3RvcnlFbnRyeSA9IHRoaXMuZmluZEVudHJ5QnlLZXkoYWxsRW50cmllcywgdGhpcy5ESUFMT0dVRV9ISVNUT1JZX0tFWSk7XG5cbiAgICAgIC8vIOaehOW7uuaXp+eJiOaXpeW/l+agvOW8j1xuICAgICAgbGV0IGxvZ0NvbnRlbnQgPSAnJztcbiAgICAgIGZvciAoY29uc3QgZGlhbG9ndWUgb2YgY29tcGxldGVIaXN0b3J5LmRpYWxvZ3Vlcykge1xuICAgICAgICBpZiAoZGlhbG9ndWUuc3BlYWtlciA9PT0gJ+eOqeWuticpIHtcbiAgICAgICAgICBsb2dDb250ZW50ICs9IGDpgInmi6k6JHtkaWFsb2d1ZS5jb250ZW50fTtgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZ0NvbnRlbnQgKz0gYCR7ZGlhbG9ndWUuc3BlYWtlcn06JHtkaWFsb2d1ZS5jb250ZW50fTtgO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOa3u+WKoOiusOW/huepv+i2iueCuVxuICAgICAgZm9yIChjb25zdCBtZW1vcnkgb2YgY29tcGxldGVIaXN0b3J5Lm1lbW9yaWVzKSB7XG4gICAgICAgIGlmIChtZW1vcnkuY29udGVudC5pbmNsdWRlcygn56m/6LaKJykgfHwgbWVtb3J5LmNvbnRlbnQuaW5jbHVkZXMoJ+WbnuWIsCcpKSB7XG4gICAgICAgICAgbG9nQ29udGVudCArPSBg5Zue5Yiw6L+H5Y67OiR7bWVtb3J5LmNvbnRlbnR9O2A7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g5a+56K+d5Y6G5Y+y5qCH6aKYXG4gICAgICBjb25zdCBkaWFsb2d1ZVRpdGxlID0gYOWvueivneWOhuWPsuiusOW9lSAtICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfWA7XG5cbiAgICAgIC8vIOWMheijheS4uuaXp+eJiOagvOW8j1xuICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSBgPGxvZz4ke2xvZ0NvbnRlbnR9PC9sb2c+YDtcblxuICAgICAgLy8g5pu05paw5oiW5Yib5bu65p2h55uuXG4gICAgICB0cnkge1xuICAgICAgICBpZiAoZGlhbG9ndWVIaXN0b3J5RW50cnkpIHtcbiAgICAgICAgICAvLyDmm7TmlrDnjrDmnInmnaHnm65cbiAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5lZGl0TG9yZWJvb2tFbnRyeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgYXdhaXQgd2luZG93LmVkaXRMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwgZGlhbG9ndWVIaXN0b3J5RW50cnkudWlkLCB7XG4gICAgICAgICAgICAgIGNvbW1lbnQ6IGRpYWxvZ3VlVGl0bGUsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIOWbnumAgOWIsOaXp0FQSe+8muWIoOmZpOW5tumHjeW7ulxuICAgICAgICAgICAgYXdhaXQgd2luZG93LmRlbGV0ZUxvcmVib29rRW50cnkodGhpcy53b3JsZEJvb2tOYW1lLCBkaWFsb2d1ZUhpc3RvcnlFbnRyeS51aWQpO1xuICAgICAgICAgICAgYXdhaXQgd2luZG93LmNyZWF0ZUxvcmVib29rRW50cnkodGhpcy53b3JsZEJvb2tOYW1lLCB7XG4gICAgICAgICAgICAgIGtleXM6IFt0aGlzLkRJQUxPR1VFX0hJU1RPUllfS0VZXSxcbiAgICAgICAgICAgICAgY29tbWVudDogZGlhbG9ndWVUaXRsZSxcbiAgICAgICAgICAgICAgY29udGVudDogdXBkYXRlZENvbnRlbnQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc29sZS5sb2coJ+abtOaWsOS6huaXp+eJiOWvueivneWOhuWPsuiusOW9lScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIOWIm+W7uuaWsOadoeebrlxuICAgICAgICAgIGF3YWl0IHdpbmRvdy5jcmVhdGVMb3JlYm9va0VudHJ5KHRoaXMud29ybGRCb29rTmFtZSwge1xuICAgICAgICAgICAga2V5czogW3RoaXMuRElBTE9HVUVfSElTVE9SWV9LRVldLFxuICAgICAgICAgICAgY29tbWVudDogZGlhbG9ndWVUaXRsZSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfliJvlu7rkuobmlrDnmoTml6fniYjlr7nor53ljoblj7LorrDlvZXmnaHnm64nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOaXp+eJiOWvueivneWOhuWPsuWksei0pTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5L+d5a2Y5pen54mI5a+56K+d5Y6G5Y+y5Yiw5LiW55WM5Lmm5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5LuO5LiW55WM5Lmm6I635Y+W5a+56K+d5Y6G5Y+yXG4gICAqIOS8mOWFiOS9v+eUqOaWsOeahOWujOaVtOWOhuWPsuiusOW9leagvOW8j1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldERpYWxvZ3VlSGlzdG9yeSgpOiBQcm9taXNlPERpYWxvZ3VlSGlzdG9yeUl0ZW1bXSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgLy8g5YWI5bCd6K+V6I635Y+W5a6M5pW05Y6G5Y+y6K6w5b2VXG4gICAgICBjb25zdCBjb21wbGV0ZUhpc3RvcnkgPSBhd2FpdCB0aGlzLmxvYWRDb21wbGV0ZUhpc3RvcnkoKTtcblxuICAgICAgaWYgKGNvbXBsZXRlSGlzdG9yeSAmJiBjb21wbGV0ZUhpc3RvcnkuZGlhbG9ndWVzICYmIGNvbXBsZXRlSGlzdG9yeS5kaWFsb2d1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhg5LuO5a6M5pW05Y6G5Y+y6K6w5b2V5Lit6I635Y+WICR7Y29tcGxldGVIaXN0b3J5LmRpYWxvZ3Vlcy5sZW5ndGh9IOadoeWvueivneWOhuWPsmApO1xuXG4gICAgICAgIC8vIOi9rOaNouS4ukRpYWxvZ3VlSGlzdG9yeUl0ZW3moLzlvI9cbiAgICAgICAgY29uc3QgZGlhbG9ndWVIaXN0b3J5SXRlbXM6IERpYWxvZ3VlSGlzdG9yeUl0ZW1bXSA9IGNvbXBsZXRlSGlzdG9yeS5kaWFsb2d1ZXMubWFwKGQgPT4gKHtcbiAgICAgICAgICBzcGVha2VyOiBkLnNwZWFrZXIsXG4gICAgICAgICAgY29udGVudDogZC5jb250ZW50LFxuICAgICAgICAgIHN0eWxlOiBkLnN0eWxlIHx8ICdub3JtYWwnLFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmV0dXJuIGRpYWxvZ3VlSGlzdG9yeUl0ZW1zO1xuICAgICAgfVxuXG4gICAgICAvLyDlpoLmnpzmsqHmnInlrozmlbTljoblj7LorrDlvZXvvIzlm57pgIDliLDml6fniYjorrDlvZXmoLzlvI9cbiAgICAgIGNvbnNvbGUubG9nKCfmnKrmib7liLDlrozmlbTljoblj7LorrDlvZXvvIzlsJ3or5Xml6fniYjmoLzlvI8nKTtcblxuICAgICAgLy8g56Gu5L+d6IGK5aSp5LiW55WM5Lmm5bey5Yid5aeL5YyWXG4gICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDaGF0TG9yZWJvb2soKTtcbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+lQVBJ5piv5ZCm5Y+v55SoXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXMgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfkuJbnlYzkuaZBUEnkuI3lj6/nlKjvvIzml6Dms5Xojrflj5blr7nor53ljoblj7InKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIC8vIOiOt+WPluaJgOacieS4lueVjOS5puadoeebrlxuICAgICAgY29uc3QgYWxsRW50cmllcyA9IGF3YWl0IHdpbmRvdy5nZXRMb3JlYm9va0VudHJpZXModGhpcy53b3JsZEJvb2tOYW1lKTtcbiAgICAgIGlmICghYWxsRW50cmllcyB8fCAhQXJyYXkuaXNBcnJheShhbGxFbnRyaWVzKSB8fCBhbGxFbnRyaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+ayoeacieaJvuWIsOS4lueVjOS5puadoeebricpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8g5p+l5om+5oyB5LmF5YyW5a+56K+d5Y6G5Y+y5p2h55uuXG4gICAgICBjb25zdCBkaWFsb2d1ZUVudHJ5ID0gdGhpcy5maW5kRW50cnlCeUtleShhbGxFbnRyaWVzLCB0aGlzLkRJQUxPR1VFX0hJU1RPUllfS0VZKTtcblxuICAgICAgaWYgKCFkaWFsb2d1ZUVudHJ5KSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign5rKh5pyJ5om+5Yiw5a+56K+d5Y6G5Y+y5p2h55uuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyDojrflj5bmnaHnm67lhoXlrrlcbiAgICAgIGxldCBkaWFsb2d1ZUNvbnRlbnQgPSAnJztcblxuICAgICAgLy8g5bCd6K+V55u05o6l5LuO5p2h55uu6I635Y+W5YaF5a65XG4gICAgICBpZiAoZGlhbG9ndWVFbnRyeS5jb250ZW50KSB7XG4gICAgICAgIGRpYWxvZ3VlQ29udGVudCA9IGRpYWxvZ3VlRW50cnkuY29udGVudDtcbiAgICAgIH1cbiAgICAgIC8vIOWmguaenOayoeacieebtOaOpeWGheWuue+8jOS9v+eUqHRyaWdnZXJTbGFzaOiOt+WPllxuICAgICAgZWxzZSBpZiAodHlwZW9mIHdpbmRvdy50cmlnZ2VyU2xhc2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8g6I635Y+W5a6e6ZmF6ZSu5YC877yI5Y+v6IO95piv5pWw57uE5Lit55qE56ys5LiA5Liq5YWD57Sg77yJXG4gICAgICAgIGxldCBhY3R1YWxLZXkgPSB0aGlzLkRJQUxPR1VFX0hJU1RPUllfS0VZO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkaWFsb2d1ZUVudHJ5LmtleSkgJiYgZGlhbG9ndWVFbnRyeS5rZXkubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGFjdHVhbEtleSA9IGRpYWxvZ3VlRW50cnkua2V5WzBdO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkaWFsb2d1ZUVudHJ5LmtleSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICBhY3R1YWxLZXkgPSBkaWFsb2d1ZUVudHJ5LmtleTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRpYWxvZ3VlQ29udGVudCA9IGF3YWl0IHdpbmRvdy50cmlnZ2VyU2xhc2goXG4gICAgICAgICAgYC9nZXRlbnRyeWZpZWxkIGZpbGU9JHt0aGlzLndvcmxkQm9va05hbWV9IGZpZWxkPWNvbnRlbnQgJHthY3R1YWxLZXl9YCxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFkaWFsb2d1ZUNvbnRlbnQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCflr7nor53ljoblj7LlhoXlrrnkuLrnqbonKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIOWwneivleino+aekOWvueivneWOhuWPsuWGheWuuVxuICAgICAgICAvLyDpppblhYjmo4Dmn6XmmK/lkKbmnIk8bG9nPuagh+etvlxuICAgICAgICBpZiAoZGlhbG9ndWVDb250ZW50LmluY2x1ZGVzKCc8bG9nPicpICYmIGRpYWxvZ3VlQ29udGVudC5pbmNsdWRlcygnPC9sb2c+JykpIHtcbiAgICAgICAgICBjb25zdCBsb2dNYXRjaCA9IGRpYWxvZ3VlQ29udGVudC5tYXRjaCgvPGxvZz4oW1xcc1xcU10qPyk8XFwvbG9nPi8pO1xuXG4gICAgICAgICAgaWYgKGxvZ01hdGNoICYmIGxvZ01hdGNoWzFdKSB7XG4gICAgICAgICAgICAvLyDop6PmnpDml6Xlv5flhoXlrrlcbiAgICAgICAgICAgIGNvbnN0IGxvZ0NvbnRlbnQgPSBsb2dNYXRjaFsxXTtcbiAgICAgICAgICAgIC8vIOWIhuWJsuaIkOeLrOeri+eahOWvueivneadoeebrlxuICAgICAgICAgICAgY29uc3QgZGlhbG9ndWVFbnRyaWVzID0gbG9nQ29udGVudC5zcGxpdCgnOycpLmZpbHRlcihlbnRyeSA9PiBlbnRyeS50cmltKCkubGVuZ3RoID4gMCk7XG5cbiAgICAgICAgICAgIC8vIOi9rOaNouS4ukRpYWxvZ3VlSGlzdG9yeUl0ZW3moLzlvI9cbiAgICAgICAgICAgIGNvbnN0IGRpYWxvZ3VlSGlzdG9yeUl0ZW1zOiBEaWFsb2d1ZUhpc3RvcnlJdGVtW10gPSBbXTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBkaWFsb2d1ZUVudHJpZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGVudHJ5LmluY2x1ZGVzKCc6JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbdHlwZSwgY29udGVudF0gPSBlbnRyeS5zcGxpdCgnOicsIDIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICfpgInmi6knKSB7XG4gICAgICAgICAgICAgICAgICBkaWFsb2d1ZUhpc3RvcnlJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgc3BlYWtlcjogJ+eOqeWuticsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiAnbm9ybWFsJyxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ+WbnuWIsOi/h+WOuycpIHtcbiAgICAgICAgICAgICAgICAgIGRpYWxvZ3VlSGlzdG9yeUl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBzcGVha2VyOiAn5peB55m9JyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYOOAkOaXtumXtOepv+i2iu+8miR7Y29udGVudH3jgJFgLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3NwZWNpYWwnLFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIOaZrumAmuWvueivnVxuICAgICAgICAgICAgICAgICAgZGlhbG9ndWVIaXN0b3J5SXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHNwZWFrZXI6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiAnbm9ybWFsJyxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg5LuO5pen54mI5qC85byP6K+75Y+W5LqGICR7ZGlhbG9ndWVIaXN0b3J5SXRlbXMubGVuZ3RofSDmnaHlr7nor53ljoblj7JgKTtcbiAgICAgICAgICAgIHJldHVybiBkaWFsb2d1ZUhpc3RvcnlJdGVtcztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5bCd6K+V5L2c5Li6SlNPTuino+aekFxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkaWFsb2d1ZXMgPSBKU09OLnBhcnNlKGRpYWxvZ3VlQ29udGVudCkgYXMgRGlhbG9ndWVIaXN0b3J5SXRlbVtdO1xuXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkaWFsb2d1ZXMpKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDku45KU09O5qC85byP6K+75Y+W5LqGICR7ZGlhbG9ndWVzLmxlbmd0aH0g5p2h5a+56K+d5Y6G5Y+yYCk7XG4gICAgICAgICAgICAgIHJldHVybiBkaWFsb2d1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoanNvbkVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ+aXoOazleino+aekOWvueivneWOhuWPsuS4ukpTT07moLzlvI86JywganNvbkVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q5a+56K+d5Y6G5Y+y5YaF5a655aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5a+56K+d5Y6G5Y+y5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDku47plK7lkI3liqDovb3muLjmiI/nirbmgIFcbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkR2FtZVN0YXRlKHNhdmVLZXk6IHN0cmluZyk6IFByb21pc2U8R2FtZURhdGEgfCBudWxsPiB7XG4gICAgY29uc3QgTUFYX1JFVFJZID0gMztcblxuICAgIGZvciAobGV0IHJldHJ5ID0gMDsgcmV0cnkgPCBNQVhfUkVUUlk7IHJldHJ5KyspIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIOehruS/neiBiuWkqeS4lueVjOS5puW3suWIneWni+WMllxuICAgICAgICBpZiAoIXRoaXMud29ybGRCb29rTmFtZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfkuJbnlYzkuablkI3np7DkuLrnqbrvvIzph43mlrDliJ3lp4vljJYnKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDaGF0TG9yZWJvb2soKTtcblxuICAgICAgICAgIGlmICghdGhpcy53b3JsZEJvb2tOYW1lKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliJ3lp4vljJbkuJbnlYzkuablpLHotKXvvIzml6Dms5XliqDovb3muLjmiI/nirbmgIEnKTtcbiAgICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+aXoOazleWIneWni+WMluS4lueVjOS5pu+8jOWKoOi9veWksei0pScsICdlcnJvcicpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8g5qOA5p+lQVBJ5Ye95pWw5piv5ZCm5Y+v55SoXG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmdldExvcmVib29rRW50cmllcyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4lueVjOS5puivu+WPlkFQSeS4jeWPr+eUqCcpO1xuICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+S4lueVjOS5pkFQSeS4jeWPr+eUqO+8jOaXoOazleWKoOi9veWtmOahoycsICdlcnJvcicpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8g6I635Y+W5omA5pyJ5LiW55WM5Lmm5p2h55uuXG4gICAgICAgIGNvbnNvbGUubG9nKGDojrflj5bkuJbnlYzkuabmnaHnm67vvIzlsJ3or5UgJHtyZXRyeSArIDF9LyR7TUFYX1JFVFJZfWApO1xuICAgICAgICBjb25zdCBhbGxFbnRyaWVzID0gYXdhaXQgd2luZG93LmdldExvcmVib29rRW50cmllcyh0aGlzLndvcmxkQm9va05hbWUpO1xuXG4gICAgICAgIC8vIOWwneivleafpeaJvuWvueW6lOeahOWtmOaho+adoeebrlxuICAgICAgICBjb25zdCBzYXZlRW50cnkgPSB0aGlzLmZpbmRFbnRyeUJ5S2V5KGFsbEVudHJpZXMsIHNhdmVLZXkpO1xuXG4gICAgICAgIGlmICghc2F2ZUVudHJ5KSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGDmib7kuI3liLDlrZjmoaPplK4gJHtzYXZlS2V5fWApO1xuXG4gICAgICAgICAgLy8g5aaC5p6c5LiN5piv5pyA5ZCO5LiA5qyh5bCd6K+V77yM562J5b6F5ZCO6YeN6K+VXG4gICAgICAgICAgaWYgKHJldHJ5IDwgTUFYX1JFVFJZIC0gMSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYOetieW+hTUwMG1z5ZCO6YeN6K+VLi4uYCk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgICBjb250aW51ZTsgLy8g57un57ut5LiL5LiA5qyh6YeN6K+VXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oYOaJvuS4jeWIsOaMh+WumuWtmOaho2AsICd3YXJuaW5nJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyDojrflj5bmnaHnm67lhoXlrrlcbiAgICAgICAgbGV0IGVudHJ5Q29udGVudCA9ICcnO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g5bCd6K+V55u05o6l5LuO5p2h55uu6I635Y+W5YaF5a65XG4gICAgICAgICAgaWYgKHNhdmVFbnRyeS5jb250ZW50KSB7XG4gICAgICAgICAgICBlbnRyeUNvbnRlbnQgPSBzYXZlRW50cnkuY29udGVudDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfnm7TmjqXku47mnaHnm67ojrflj5bliLDlhoXlrrknKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8g5aaC5p6c5rKh5pyJ55u05o6l5YaF5a6577yM5L2/55SodHJpZ2dlclNsYXNo6I635Y+WXG4gICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHdpbmRvdy50cmlnZ2VyU2xhc2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIC8vIOiOt+WPluWunumZhemUruWAvO+8iOWPr+iDveaYr+aVsOe7hOS4reeahOesrOS4gOS4quWFg+e0oO+8iVxuICAgICAgICAgICAgbGV0IGFjdHVhbEtleSA9IHNhdmVLZXk7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzYXZlRW50cnkua2V5KSAmJiBzYXZlRW50cnkua2V5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgYWN0dWFsS2V5ID0gc2F2ZUVudHJ5LmtleVswXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNhdmVFbnRyeS5rZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGFjdHVhbEtleSA9IHNhdmVFbnRyeS5rZXk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDpgJrov4d0cmlnZ2VyU2xhc2jojrflj5bmnaHnm67lhoXlrrnvvIxrZXk9JHthY3R1YWxLZXl9YCk7XG4gICAgICAgICAgICBlbnRyeUNvbnRlbnQgPSBhd2FpdCB3aW5kb3cudHJpZ2dlclNsYXNoKFxuICAgICAgICAgICAgICBgL2dldGVudHJ5ZmllbGQgZmlsZT0ke3RoaXMud29ybGRCb29rTmFtZX0gZmllbGQ9Y29udGVudCAke2FjdHVhbEtleX1gLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKGVudHJ5Q29udGVudCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6YCa6L+HdHJpZ2dlclNsYXNo5oiQ5Yqf6I635Y+W5YaF5a65Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFlbnRyeUNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihg5a2Y5qGj6ZSuICR7c2F2ZUtleX0g5a+55bqU55qE5YaF5a655Li656m6YCk7XG5cbiAgICAgICAgICAgIC8vIOWmguaenOS4jeaYr+acgOWQjuS4gOasoeWwneivle+8jOetieW+heWQjumHjeivlVxuICAgICAgICAgICAgaWYgKHJldHJ5IDwgTUFYX1JFVFJZIC0gMSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpO1xuICAgICAgICAgICAgICBjb250aW51ZTsgLy8g57un57ut5LiL5LiA5qyh6YeN6K+VXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnVpTWFuYWdlci5zaG93Tm90aWZpY2F0aW9uKGDlrZjmoaPlhoXlrrnkuLrnqbpgLCAnd2FybmluZycpO1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyDop6PmnpDkv53lrZjnmoTnirbmgIFcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+ino+aekOWtmOaho+WGheWuuS4uLicpO1xuICAgICAgICAgICAgY29uc3Qgc2F2ZWRTdGF0ZSA9IEpTT04ucGFyc2UoZW50cnlDb250ZW50KTtcblxuICAgICAgICAgICAgLy8g56Gu5L+d5a+56K+d57Si5byV6K6+572u5Li6MFxuICAgICAgICAgICAgaWYgKHNhdmVkU3RhdGUgJiYgc2F2ZWRTdGF0ZS5zdG9yeSkge1xuICAgICAgICAgICAgICBzYXZlZFN0YXRlLnN0b3J5LmN1cnJlbnREaWFsb2d1ZUluZGV4ID0gMDtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aIkOWKn+ino+aekOWtmOaho+WGheWuue+8jOmHjee9ruWvueivnee0ouW8lScpO1xuICAgICAgICAgICAgICByZXR1cm4gc2F2ZWRTdGF0ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6Kej5p6Q55qE5a2Y5qGj57y65bCR5b+F6KaB5pWw5o2uJyk7XG5cbiAgICAgICAgICAgICAgLy8g5aaC5p6c5LiN5piv5pyA5ZCO5LiA5qyh5bCd6K+V5bm25LiU5piv5qC85byP6Zeu6aKY77yM5Y+v6IO95piv5Yqg6L295LiN5a6M5pW077yM6YeN6K+VXG4gICAgICAgICAgICAgIGlmIChyZXRyeSA8IE1BWF9SRVRSWSAtIDEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgICAgICAgY29udGludWU7IC8vIOe7p+e7reS4i+S4gOasoemHjeivlVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudWlNYW5hZ2VyLnNob3dOb3RpZmljYXRpb24oJ+WtmOaho+aVsOaNruS4jeWujOaVtOaIluagvOW8j+mUmeivrycsICdlcnJvcicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q5a2Y5qGj5YaF5a655aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuXG4gICAgICAgICAgICAvLyDlpoLmnpzkuI3mmK/mnIDlkI7kuIDmrKHlsJ3or5XvvIznrYnlvoXlkI7ph43or5VcbiAgICAgICAgICAgIGlmIChyZXRyeSA8IE1BWF9SRVRSWSAtIDEpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYOetieW+hTUwMG1z5ZCO6YeN6K+VLi4uYCk7XG4gICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgICAgY29udGludWU7IC8vIOe7p+e7reS4i+S4gOasoemHjeivlVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign5a2Y5qGj5YaF5a655qC85byP6ZSZ6K+vJywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoY29udGVudEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihg6I635Y+W5a2Y5qGjICR7c2F2ZUtleX0g5YaF5a655aSx6LSlOmAsIGNvbnRlbnRFcnJvcik7XG5cbiAgICAgICAgICAvLyDlpoLmnpzkuI3mmK/mnIDlkI7kuIDmrKHlsJ3or5XvvIznrYnlvoXlkI7ph43or5VcbiAgICAgICAgICBpZiAocmV0cnkgPCBNQVhfUkVUUlkgLSAxKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgIGNvbnRpbnVlOyAvLyDnu6fnu63kuIvkuIDmrKHph43or5VcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbign6I635Y+W5a2Y5qGj5YaF5a655aSx6LSlJywgJ2Vycm9yJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKHJldHJ5RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihg5Yqg6L295ri45oiP5a2Y5qGj5bCd6K+VICR7cmV0cnkgKyAxfSDlpLHotKU6YCwgcmV0cnlFcnJvcik7XG5cbiAgICAgICAgLy8g5aaC5p6c5LiN5piv5pyA5ZCO5LiA5qyh5bCd6K+V77yM562J5b6F5ZCO6YeN6K+VXG4gICAgICAgIGlmIChyZXRyeSA8IE1BWF9SRVRSWSAtIDEpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhg562J5b6FNTAwbXPlkI7ph43or5UuLi5gKTtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy51aU1hbmFnZXIuc2hvd05vdGlmaWNhdGlvbihcbiAgICAgICAgICAgICfliqDovb3lrZjmoaPlpLHotKU6ICcgKyAocmV0cnlFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gcmV0cnlFcnJvci5tZXNzYWdlIDogJ+acquefpemUmeivrycpLFxuICAgICAgICAgICAgJ2Vycm9yJyxcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7IC8vIOWmguaenOaJgOaciemHjeivlemDveWksei0pe+8jOi/lOWbnm51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiDmoLnmja5JROWKoOi9vea4uOaIj+eKtuaAgVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGxvYWRHYW1lU3RhdGVCeUlEKHN1bW1hcnlJZDogbnVtYmVyLCBpc01hbnVhbDogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxHYW1lRGF0YSB8IG51bGw+IHtcbiAgICBjb25zdCBzYXZlS2V5ID0gaXNNYW51YWwgPyBgJHt0aGlzLlNBVkVfVFlQRS5NQU5VQUx9JHtzdW1tYXJ5SWR9YCA6IGAke3RoaXMuU0FWRV9UWVBFLkFVVE99JHtzdW1tYXJ5SWR9YDtcbiAgICByZXR1cm4gdGhpcy5sb2FkR2FtZVN0YXRlKHNhdmVLZXkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWujOaVtOWOhuWPsuiusOW9lVxuICAgKiDljIXlkKvmiYDmnInlr7nor53lkozorrDlv4bngrlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRDb21wbGV0ZUhpc3RvcnkoKTogUHJvbWlzZTxDb21wbGV0ZUhpc3RvcnlSZWNvcmQgfCBudWxsPiB7XG4gICAgcmV0dXJuIHRoaXMubG9hZENvbXBsZXRlSGlzdG9yeSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9vea4uOaIj1xuICAgKi9cbiAgcHVibGljIGxvYWRHYW1lKCkge1xuICAgIC8vIOaYvuekuuWKoOi9vea4uOaIj+W8ueeql1xuICAgIHRoaXMuc2hvd0xvYWRHYW1lTW9kYWwoKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/saveManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/settingsManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SettingsManager: () => (/* binding */ SettingsManager)\n/* harmony export */ });\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/**\n * 设置管理器组件\n * 负责管理游戏的设置，如字体大小和界面类型\n */\n\nclass SettingsManager {\n    // 默认设置\n    defaultSettings = {\n        fontSize: 'medium',\n        uiMode: 'adaptive',\n        gameHeight: 'auto', // 默认为自动高度\n    };\n    // 当前设置\n    currentSettings;\n    // 设置变更回调\n    onSettingsChangedCallback = null;\n    // 本地存储键\n    SETTINGS_STORAGE_KEY = 'monastery_game_settings';\n    constructor() {\n        // 从本地存储加载设置或使用默认设置\n        this.currentSettings = this.loadSettings();\n        // 初始应用设置\n        this.applySettings();\n        console.log('设置管理器初始化完成');\n    }\n    /**\n     * 从本地存储加载设置\n     */\n    loadSettings() {\n        try {\n            const savedSettings = localStorage.getItem(this.SETTINGS_STORAGE_KEY);\n            if (savedSettings) {\n                const parsedSettings = JSON.parse(savedSettings);\n                // 处理从旧版本升级的情况\n                if (parsedSettings.hasOwnProperty('useMobileUI')) {\n                    // 从旧版本迁移\n                    parsedSettings.uiMode = parsedSettings.useMobileUI ? 'mobile' : 'desktop';\n                    delete parsedSettings.useMobileUI;\n                }\n                return {\n                    ...this.defaultSettings,\n                    ...parsedSettings,\n                };\n            }\n        }\n        catch (error) {\n            console.error('加载设置失败:', error);\n        }\n        return { ...this.defaultSettings };\n    }\n    /**\n     * 保存设置到本地存储\n     */\n    saveSettings() {\n        try {\n            localStorage.setItem(this.SETTINGS_STORAGE_KEY, JSON.stringify(this.currentSettings));\n        }\n        catch (error) {\n            console.error('保存设置失败:', error);\n        }\n    }\n    /**\n     * 应用当前设置到UI\n     */\n    applySettings() {\n        // 应用字体大小\n        document.documentElement.classList.remove('font-small', 'font-medium', 'font-large');\n        document.documentElement.classList.add(`font-${this.currentSettings.fontSize}`);\n        // 应用界面类型\n        document.documentElement.classList.remove('mobile-ui', 'desktop-ui');\n        // 根据 UI 模式应用相应的类\n        switch (this.currentSettings.uiMode) {\n            case 'mobile':\n                document.documentElement.classList.add('mobile-ui');\n                break;\n            case 'desktop':\n                document.documentElement.classList.add('desktop-ui');\n                break;\n            case 'adaptive':\n            default:\n                // 自适应模式不添加特殊类，依赖于CSS媒体查询\n                break;\n        }\n        // 应用游戏高度\n        const gameContainer = document.querySelector('.game-container');\n        if (gameContainer) {\n            if (this.currentSettings.gameHeight === 'auto') {\n                // 自动高度模式，移除设置的高度\n                gameContainer.style.height = '';\n            }\n            else {\n                // 固定高度模式\n                gameContainer.style.height = `${this.currentSettings.gameHeight}px`;\n            }\n        }\n        console.log('已应用设置:', this.currentSettings);\n    }\n    /**\n     * 更新设置\n     */\n    updateSettings(settings) {\n        // 更新当前设置\n        this.currentSettings = {\n            ...this.currentSettings,\n            ...settings,\n        };\n        // 保存设置\n        this.saveSettings();\n        // 应用设置\n        this.applySettings();\n        // 调用变更回调\n        if (this.onSettingsChangedCallback) {\n            this.onSettingsChangedCallback(this.currentSettings);\n        }\n    }\n    /**\n     * 设置字体大小\n     */\n    setFontSize(fontSize) {\n        this.updateSettings({ fontSize });\n    }\n    /**\n     * 设置界面模式\n     */\n    setUIMode(uiMode) {\n        this.updateSettings({ uiMode });\n    }\n    /**\n     * 设置游戏高度\n     */\n    setGameHeight(gameHeight) {\n        this.updateSettings({ gameHeight });\n    }\n    /**\n     * 获取当前设置\n     */\n    getSettings() {\n        return { ...this.currentSettings };\n    }\n    /**\n     * 重置为默认设置\n     */\n    resetSettings() {\n        this.currentSettings = { ...this.defaultSettings };\n        this.saveSettings();\n        this.applySettings();\n        // 调用变更回调\n        if (this.onSettingsChangedCallback) {\n            this.onSettingsChangedCallback(this.currentSettings);\n        }\n    }\n    /**\n     * 设置设置变更回调\n     */\n    setOnSettingsChanged(callback) {\n        this.onSettingsChangedCallback = callback;\n    }\n    /**\n     * 显示设置对话框\n     */\n    showSettingsDialog() {\n        // 创建设置对话框HTML\n        const dialogHtml = `\n      <div id=\"settings-dialog\" class=\"modal fade\">\n        <div class=\"modal-dialog modal-dialog-centered monastery-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\"><i class=\"fas fa-cog\"></i> 游戏设置</h5>\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n            </div>\n            <div class=\"modal-body\">\n              <div class=\"form-group monastery-form-group\">\n                <label for=\"font-size-select\" class=\"monastery-label\">\n                  <i class=\"fas fa-font\"></i> 字体大小\n                </label>\n                <select id=\"font-size-select\" class=\"form-control monastery-select\">\n                  <option value=\"small\" ${this.currentSettings.fontSize === 'small' ? 'selected' : ''}>小</option>\n                  <option value=\"medium\" ${this.currentSettings.fontSize === 'medium' ? 'selected' : ''}>中</option>\n                  <option value=\"large\" ${this.currentSettings.fontSize === 'large' ? 'selected' : ''}>大</option>\n                </select>\n              </div>\n              <div class=\"form-group monastery-form-group\">\n                <label for=\"ui-mode-select\" class=\"monastery-label\">\n                  <i class=\"fas fa-mobile-alt\"></i> 界面模式\n                </label>\n                <select id=\"ui-mode-select\" class=\"form-control monastery-select\">\n                  <option value=\"adaptive\" ${this.currentSettings.uiMode === 'adaptive' ? 'selected' : ''}>自适应</option>\n                  <option value=\"mobile\" ${this.currentSettings.uiMode === 'mobile' ? 'selected' : ''}>手机</option>\n                  <option value=\"desktop\" ${this.currentSettings.uiMode === 'desktop' ? 'selected' : ''}>电脑</option>\n                </select>\n                <small class=\"form-text text-muted monastery-help-text\">自适应: 根据屏幕大小自动调整; 手机/电脑: 强制使用对应界面</small>\n              </div>\n              <div class=\"form-group monastery-form-group\">\n                <label for=\"game-height-mode\" class=\"monastery-label\">\n                  <i class=\"fas fa-arrows-alt-v\"></i> 游戏界面高度\n                </label>\n                <div class=\"custom-control custom-switch mb-2\">\n                  <input type=\"checkbox\" class=\"custom-control-input\" id=\"height-custom-switch\" ${this.currentSettings.gameHeight !== 'auto' ? 'checked' : ''}>\n                  <label class=\"custom-control-label\" for=\"height-custom-switch\">自定义高度</label>\n                </div>\n                <div id=\"custom-height-container\" class=\"mt-2 ${this.currentSettings.gameHeight === 'auto' ? 'd-none' : ''}\">\n                  <div class=\"input-group\">\n                    <input \n                      type=\"number\" \n                      id=\"game-height-input\" \n                      class=\"form-control monastery-input\" \n                      value=\"${this.currentSettings.gameHeight === 'auto' ? 1000 : this.currentSettings.gameHeight}\" \n                      min=\"500\" \n                      max=\"2000\" \n                      step=\"50\" \n                    />\n                    <div class=\"input-group-append\">\n                      <span class=\"input-group-text\">px</span>\n                    </div>\n                  </div>\n                  <small class=\"form-text text-muted monastery-help-text\">推荐值: 1000px（可根据屏幕大小调整）</small>\n                </div>\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button type=\"button\" class=\"btn btn-secondary monastery-btn monastery-btn-secondary\" id=\"reset-settings-btn\">\n                <i class=\"fas fa-undo\"></i> 恢复默认\n              </button>\n              <button type=\"button\" class=\"btn btn-primary monastery-btn monastery-btn-primary\" id=\"save-settings-btn\">\n                <i class=\"fas fa-check\"></i> 保存设置\n              </button>\n              <button type=\"button\" class=\"btn btn-secondary monastery-btn monastery-btn-cancel\" data-dismiss=\"modal\">\n                <i class=\"fas fa-times\"></i> 取消\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n        // 添加到页面\n        $('body').append(dialogHtml);\n        // 绑定高度设置开关事件\n        $('#height-custom-switch').on('change', function () {\n            if ($(this).is(':checked')) {\n                $('#custom-height-container').removeClass('d-none');\n            }\n            else {\n                $('#custom-height-container').addClass('d-none');\n            }\n        });\n        // 绑定保存按钮事件\n        $('#save-settings-btn').on('click', () => {\n            const fontSize = $('#font-size-select').val();\n            const uiMode = $('#ui-mode-select').val();\n            const useCustomHeight = $('#height-custom-switch').is(':checked');\n            // 根据是否启用自定义高度决定使用auto还是自定义值\n            let gameHeight = 'auto';\n            if (useCustomHeight) {\n                const gameHeightInput = $('#game-height-input').val();\n                // 使用lodash验证并转换高度值，确保在有效范围内\n                gameHeight = lodash__WEBPACK_IMPORTED_MODULE_0__.clamp(lodash__WEBPACK_IMPORTED_MODULE_0__.parseInt(gameHeightInput) || 1000, 500, // 最小值\n                2000);\n            }\n            this.updateSettings({\n                fontSize,\n                uiMode,\n                gameHeight,\n            });\n            $('#settings-dialog').modal('hide');\n        });\n        $('#reset-settings-btn').on('click', () => {\n            if (confirm('确定要恢复默认设置吗？')) {\n                this.resetSettings();\n                // 更新对话框中的选项\n                $('#font-size-select').val(this.defaultSettings.fontSize);\n                $('#ui-mode-select').val(this.defaultSettings.uiMode);\n                // 更新自定义高度开关\n                $('#height-custom-switch').prop('checked', this.defaultSettings.gameHeight !== 'auto');\n                if (this.defaultSettings.gameHeight === 'auto') {\n                    $('#custom-height-container').addClass('d-none');\n                }\n                else {\n                    $('#custom-height-container').removeClass('d-none');\n                    $('#game-height-input').val(this.defaultSettings.gameHeight);\n                }\n            }\n        });\n        // 显示对话框\n        $('#settings-dialog').modal('show').data('backdrop', 'static').data('keyboard', false);\n        // 当对话框关闭时移除\n        $('#settings-dialog').on('hidden.bs.modal', function () {\n            $(this).remove();\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvc2V0dGluZ3NNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7R0FHRztBQUN5QjtBQVVyQixNQUFNLGVBQWU7SUFDMUIsT0FBTztJQUNDLGVBQWUsR0FBaUI7UUFDdEMsUUFBUSxFQUFFLFFBQVE7UUFDbEIsTUFBTSxFQUFFLFVBQVU7UUFDbEIsVUFBVSxFQUFFLE1BQU0sRUFBRSxVQUFVO0tBQy9CLENBQUM7SUFFRixPQUFPO0lBQ0MsZUFBZSxDQUFlO0lBRXRDLFNBQVM7SUFDRCx5QkFBeUIsR0FBOEMsSUFBSSxDQUFDO0lBRXBGLFFBQVE7SUFDUyxvQkFBb0IsR0FBRyx5QkFBeUIsQ0FBQztJQUVsRTtRQUNFLG1CQUFtQjtRQUNuQixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUUzQyxTQUFTO1FBQ1QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVEOztPQUVHO0lBQ0ssWUFBWTtRQUNsQixJQUFJLENBQUM7WUFDSCxNQUFNLGFBQWEsR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ3RFLElBQUksYUFBYSxFQUFFLENBQUM7Z0JBQ2xCLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7Z0JBRWpELGNBQWM7Z0JBQ2QsSUFBSSxjQUFjLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUM7b0JBQ2pELFNBQVM7b0JBQ1QsY0FBYyxDQUFDLE1BQU0sR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztvQkFDMUUsT0FBTyxjQUFjLENBQUMsV0FBVyxD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Q0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ25CLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gv5ri45oiP55WM6Z2iL3NjcmlwdHMvY29tcG9uZW50cy9zZXR0aW5nc01hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDorr7nva7nrqHnkIblmajnu4Tku7ZcbiAqIOi0n+i0o+euoeeQhua4uOaIj+eahOiuvue9ru+8jOWmguWtl+S9k+Wkp+Wwj+WSjOeVjOmdouexu+Wei1xuICovXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCB0eXBlIFVJTW9kZSA9ICdhZGFwdGl2ZScgfCAnbW9iaWxlJyB8ICdkZXNrdG9wJztcblxuZXhwb3J0IGludGVyZmFjZSBHYW1lU2V0dGluZ3Mge1xuICBmb250U2l6ZTogJ3NtYWxsJyB8ICdtZWRpdW0nIHwgJ2xhcmdlJzsgLy8g5a2X5L2T5aSn5bCPXG4gIHVpTW9kZTogVUlNb2RlOyAvLyDnlYzpnaLmqKHlvI/vvJroh6rpgILlupTjgIHmiYvmnLrjgIHnlLXohJFcbiAgZ2FtZUhlaWdodDogbnVtYmVyIHwgJ2F1dG8nOyAvLyDmuLjmiI/nlYzpnaLpq5jluqbvvIzljZXkvY1weOaIlmF1dG/oh6rliqjpgILlupRcbn1cblxuZXhwb3J0IGNsYXNzIFNldHRpbmdzTWFuYWdlciB7XG4gIC8vIOm7mOiupOiuvue9rlxuICBwcml2YXRlIGRlZmF1bHRTZXR0aW5nczogR2FtZVNldHRpbmdzID0ge1xuICAgIGZvbnRTaXplOiAnbWVkaXVtJyxcbiAgICB1aU1vZGU6ICdhZGFwdGl2ZScsXG4gICAgZ2FtZUhlaWdodDogJ2F1dG8nLCAvLyDpu5jorqTkuLroh6rliqjpq5jluqZcbiAgfTtcblxuICAvLyDlvZPliY3orr7nva5cbiAgcHJpdmF0ZSBjdXJyZW50U2V0dGluZ3M6IEdhbWVTZXR0aW5ncztcblxuICAvLyDorr7nva7lj5jmm7Tlm57osINcbiAgcHJpdmF0ZSBvblNldHRpbmdzQ2hhbmdlZENhbGxiYWNrOiAoKHNldHRpbmdzOiBHYW1lU2V0dGluZ3MpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5cbiAgLy8g5pys5Zyw5a2Y5YKo6ZSuXG4gIHByaXZhdGUgcmVhZG9ubHkgU0VUVElOR1NfU1RPUkFHRV9LRVkgPSAnbW9uYXN0ZXJ5X2dhbWVfc2V0dGluZ3MnO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIOS7juacrOWcsOWtmOWCqOWKoOi9veiuvue9ruaIluS9v+eUqOm7mOiupOiuvue9rlxuICAgIHRoaXMuY3VycmVudFNldHRpbmdzID0gdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgIC8vIOWIneWni+W6lOeUqOiuvue9rlxuICAgIHRoaXMuYXBwbHlTZXR0aW5ncygpO1xuXG4gICAgY29uc29sZS5sb2coJ+iuvue9rueuoeeQhuWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS7juacrOWcsOWtmOWCqOWKoOi9veiuvue9rlxuICAgKi9cbiAgcHJpdmF0ZSBsb2FkU2V0dGluZ3MoKTogR2FtZVNldHRpbmdzIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2F2ZWRTZXR0aW5ncyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuU0VUVElOR1NfU1RPUkFHRV9LRVkpO1xuICAgICAgaWYgKHNhdmVkU2V0dGluZ3MpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkU2V0dGluZ3MgPSBKU09OLnBhcnNlKHNhdmVkU2V0dGluZ3MpO1xuXG4gICAgICAgIC8vIOWkhOeQhuS7juaXp+eJiOacrOWNh+e6p+eahOaDheWGtVxuICAgICAgICBpZiAocGFyc2VkU2V0dGluZ3MuaGFzT3duUHJvcGVydHkoJ3VzZU1vYmlsZVVJJykpIHtcbiAgICAgICAgICAvLyDku47ml6fniYjmnKzov4Hnp7tcbiAgICAgICAgICBwYXJzZWRTZXR0aW5ncy51aU1vZGUgPSBwYXJzZWRTZXR0aW5ncy51c2VNb2JpbGVVSSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuICAgICAgICAgIGRlbGV0ZSBwYXJzZWRTZXR0aW5ncy51c2VNb2JpbGVVSTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4udGhpcy5kZWZhdWx0U2V0dGluZ3MsXG4gICAgICAgICAgLi4ucGFyc2VkU2V0dGluZ3MsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veiuvue9ruWksei0pTonLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgLi4udGhpcy5kZWZhdWx0U2V0dGluZ3MgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjorr7nva7liLDmnKzlnLDlrZjlgqhcbiAgICovXG4gIHByaXZhdGUgc2F2ZVNldHRpbmdzKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLlNFVFRJTkdTX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeSh0aGlzLmN1cnJlbnRTZXR0aW5ncykpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfkv53lrZjorr7nva7lpLHotKU6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlupTnlKjlvZPliY3orr7nva7liLBVSVxuICAgKi9cbiAgcHVibGljIGFwcGx5U2V0dGluZ3MoKTogdm9pZCB7XG4gICAgLy8g5bqU55So5a2X5L2T5aSn5bCPXG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2ZvbnQtc21hbGwnLCAnZm9udC1tZWRpdW0nLCAnZm9udC1sYXJnZScpO1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKGBmb250LSR7dGhpcy5jdXJyZW50U2V0dGluZ3MuZm9udFNpemV9YCk7XG5cbiAgICAvLyDlupTnlKjnlYzpnaLnsbvlnotcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnbW9iaWxlLXVpJywgJ2Rlc2t0b3AtdWknKTtcblxuICAgIC8vIOagueaNriBVSSDmqKHlvI/lupTnlKjnm7jlupTnmoTnsbtcbiAgICBzd2l0Y2ggKHRoaXMuY3VycmVudFNldHRpbmdzLnVpTW9kZSkge1xuICAgICAgY2FzZSAnbW9iaWxlJzpcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vYmlsZS11aScpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Rlc2t0b3AnOlxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZGVza3RvcC11aScpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2FkYXB0aXZlJzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIC8vIOiHqumAguW6lOaooeW8j+S4jea3u+WKoOeJueauiuexu++8jOS+nei1luS6jkNTU+WqkuS9k+afpeivolxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyDlupTnlKjmuLjmiI/pq5jluqZcbiAgICBjb25zdCBnYW1lQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWUtY29udGFpbmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgaWYgKGdhbWVDb250YWluZXIpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRTZXR0aW5ncy5nYW1lSGVpZ2h0ID09PSAnYXV0bycpIHtcbiAgICAgICAgLy8g6Ieq5Yqo6auY5bqm5qih5byP77yM56e76Zmk6K6+572u55qE6auY5bqmXG4gICAgICAgIGdhbWVDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDlm7rlrprpq5jluqbmqKHlvI9cbiAgICAgICAgZ2FtZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmN1cnJlbnRTZXR0aW5ncy5nYW1lSGVpZ2h0fXB4YDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn5bey5bqU55So6K6+572uOicsIHRoaXMuY3VycmVudFNldHRpbmdzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDorr7nva5cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogUGFydGlhbDxHYW1lU2V0dGluZ3M+KTogdm9pZCB7XG4gICAgLy8g5pu05paw5b2T5YmN6K6+572uXG4gICAgdGhpcy5jdXJyZW50U2V0dGluZ3MgPSB7XG4gICAgICAuLi50aGlzLmN1cnJlbnRTZXR0aW5ncyxcbiAgICAgIC4uLnNldHRpbmdzLFxuICAgIH07XG5cbiAgICAvLyDkv53lrZjorr7nva5cbiAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXG4gICAgLy8g5bqU55So6K6+572uXG4gICAgdGhpcy5hcHBseVNldHRpbmdzKCk7XG5cbiAgICAvLyDosIPnlKjlj5jmm7Tlm57osINcbiAgICBpZiAodGhpcy5vblNldHRpbmdzQ2hhbmdlZENhbGxiYWNrKSB7XG4gICAgICB0aGlzLm9uU2V0dGluZ3NDaGFuZ2VkQ2FsbGJhY2sodGhpcy5jdXJyZW50U2V0dGluZ3MpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7lrZfkvZPlpKflsI9cbiAgICovXG4gIHB1YmxpYyBzZXRGb250U2l6ZShmb250U2l6ZTogJ3NtYWxsJyB8ICdtZWRpdW0nIHwgJ2xhcmdlJyk6IHZvaWQge1xuICAgIHRoaXMudXBkYXRlU2V0dGluZ3MoeyBmb250U2l6ZSB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7nlYzpnaLmqKHlvI9cbiAgICovXG4gIHB1YmxpYyBzZXRVSU1vZGUodWlNb2RlOiBVSU1vZGUpOiB2b2lkIHtcbiAgICB0aGlzLnVwZGF0ZVNldHRpbmdzKHsgdWlNb2RlIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9rua4uOaIj+mrmOW6plxuICAgKi9cbiAgcHVibGljIHNldEdhbWVIZWlnaHQoZ2FtZUhlaWdodDogbnVtYmVyIHwgJ2F1dG8nKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVTZXR0aW5ncyh7IGdhbWVIZWlnaHQgfSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN6K6+572uXG4gICAqL1xuICBwdWJsaWMgZ2V0U2V0dGluZ3MoKTogR2FtZVNldHRpbmdzIHtcbiAgICByZXR1cm4geyAuLi50aGlzLmN1cnJlbnRTZXR0aW5ncyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIOmHjee9ruS4uum7mOiupOiuvue9rlxuICAgKi9cbiAgcHVibGljIHJlc2V0U2V0dGluZ3MoKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50U2V0dGluZ3MgPSB7IC4uLnRoaXMuZGVmYXVsdFNldHRpbmdzIH07XG4gICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICB0aGlzLmFwcGx5U2V0dGluZ3MoKTtcblxuICAgIC8vIOiwg+eUqOWPmOabtOWbnuiwg1xuICAgIGlmICh0aGlzLm9uU2V0dGluZ3NDaGFuZ2VkQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMub25TZXR0aW5nc0NoYW5nZWRDYWxsYmFjayh0aGlzLmN1cnJlbnRTZXR0aW5ncyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruiuvue9ruWPmOabtOWbnuiwg1xuICAgKi9cbiAgcHVibGljIHNldE9uU2V0dGluZ3NDaGFuZ2VkKGNhbGxiYWNrOiAoc2V0dGluZ3M6IEdhbWVTZXR0aW5ncykgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMub25TZXR0aW5nc0NoYW5nZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuiuvue9ruWvueivneahhlxuICAgKi9cbiAgcHVibGljIHNob3dTZXR0aW5nc0RpYWxvZygpOiB2b2lkIHtcbiAgICAvLyDliJvlu7rorr7nva7lr7nor53moYZIVE1MXG4gICAgY29uc3QgZGlhbG9nSHRtbCA9IGBcbiAgICAgIDxkaXYgaWQ9XCJzZXR0aW5ncy1kaWFsb2dcIiBjbGFzcz1cIm1vZGFsIGZhZGVcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWRpYWxvZyBtb2RhbC1kaWFsb2ctY2VudGVyZWQgbW9uYXN0ZXJ5LWRpYWxvZ1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG4gICAgICAgICAgICAgIDxoNSBjbGFzcz1cIm1vZGFsLXRpdGxlXCI+PGkgY2xhc3M9XCJmYXMgZmEtY29nXCI+PC9pPiDmuLjmiI/orr7nva48L2g1PlxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIj4mdGltZXM7PC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwIG1vbmFzdGVyeS1mb3JtLWdyb3VwXCI+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cImZvbnQtc2l6ZS1zZWxlY3RcIiBjbGFzcz1cIm1vbmFzdGVyeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtZm9udFwiPjwvaT4g5a2X5L2T5aSn5bCPXG4gICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVwiZm9udC1zaXplLXNlbGVjdFwiIGNsYXNzPVwiZm9ybS1jb250cm9sIG1vbmFzdGVyeS1zZWxlY3RcIj5cbiAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJzbWFsbFwiICR7dGhpcy5jdXJyZW50U2V0dGluZ3MuZm9udFNpemUgPT09ICdzbWFsbCcgPyAnc2VsZWN0ZWQnIDogJyd9PuWwjzwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIm1lZGl1bVwiICR7dGhpcy5jdXJyZW50U2V0dGluZ3MuZm9udFNpemUgPT09ICdtZWRpdW0nID8gJ3NlbGVjdGVkJyA6ICcnfT7kuK08L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJsYXJnZVwiICR7dGhpcy5jdXJyZW50U2V0dGluZ3MuZm9udFNpemUgPT09ICdsYXJnZScgPyAnc2VsZWN0ZWQnIDogJyd9PuWkpzwvb3B0aW9uPlxuICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXAgbW9uYXN0ZXJ5LWZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwidWktbW9kZS1zZWxlY3RcIiBjbGFzcz1cIm1vbmFzdGVyeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtbW9iaWxlLWFsdFwiPjwvaT4g55WM6Z2i5qih5byPXG4gICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVwidWktbW9kZS1zZWxlY3RcIiBjbGFzcz1cImZvcm0tY29udHJvbCBtb25hc3Rlcnktc2VsZWN0XCI+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiYWRhcHRpdmVcIiAke1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXR0aW5ncy51aU1vZGUgPT09ICdhZGFwdGl2ZScgPyAnc2VsZWN0ZWQnIDogJydcbiAgICAgICAgICAgICAgICAgIH0+6Ieq6YCC5bqUPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibW9iaWxlXCIgJHt0aGlzLmN1cnJlbnRTZXR0aW5ncy51aU1vZGUgPT09ICdtb2JpbGUnID8gJ3NlbGVjdGVkJyA6ICcnfT7miYvmnLo8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJkZXNrdG9wXCIgJHt0aGlzLmN1cnJlbnRTZXR0aW5ncy51aU1vZGUgPT09ICdkZXNrdG9wJyA/ICdzZWxlY3RlZCcgOiAnJ30+55S16ISRPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPVwiZm9ybS10ZXh0IHRleHQtbXV0ZWQgbW9uYXN0ZXJ5LWhlbHAtdGV4dFwiPuiHqumAguW6lDog5qC55o2u5bGP5bmV5aSn5bCP6Ieq5Yqo6LCD5pW0OyDmiYvmnLov55S16ISROiDlvLrliLbkvb/nlKjlr7nlupTnlYzpnaI8L3NtYWxsPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXAgbW9uYXN0ZXJ5LWZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwiZ2FtZS1oZWlnaHQtbW9kZVwiIGNsYXNzPVwibW9uYXN0ZXJ5LWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS1hcnJvd3MtYWx0LXZcIj48L2k+IOa4uOaIj+eVjOmdoumrmOW6plxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImN1c3RvbS1jb250cm9sIGN1c3RvbS1zd2l0Y2ggbWItMlwiPlxuICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiY3VzdG9tLWNvbnRyb2wtaW5wdXRcIiBpZD1cImhlaWdodC1jdXN0b20tc3dpdGNoXCIgJHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U2V0dGluZ3MuZ2FtZUhlaWdodCAhPT0gJ2F1dG8nID8gJ2NoZWNrZWQnIDogJydcbiAgICAgICAgICAgICAgICAgIH0+XG4gICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJjdXN0b20tY29udHJvbC1sYWJlbFwiIGZvcj1cImhlaWdodC1jdXN0b20tc3dpdGNoXCI+6Ieq5a6a5LmJ6auY5bqmPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiY3VzdG9tLWhlaWdodC1jb250YWluZXJcIiBjbGFzcz1cIm10LTIgJHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNldHRpbmdzLmdhbWVIZWlnaHQgPT09ICdhdXRvJyA/ICdkLW5vbmUnIDogJydcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIiBcbiAgICAgICAgICAgICAgICAgICAgICBpZD1cImdhbWUtaGVpZ2h0LWlucHV0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgbW9uYXN0ZXJ5LWlucHV0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgdmFsdWU9XCIke3RoaXMuY3VycmVudFNldHRpbmdzLmdhbWVIZWlnaHQgPT09ICdhdXRvJyA/IDEwMDAgOiB0aGlzLmN1cnJlbnRTZXR0aW5ncy5nYW1lSGVpZ2h0fVwiIFxuICAgICAgICAgICAgICAgICAgICAgIG1pbj1cIjUwMFwiIFxuICAgICAgICAgICAgICAgICAgICAgIG1heD1cIjIwMDBcIiBcbiAgICAgICAgICAgICAgICAgICAgICBzdGVwPVwiNTBcIiBcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwLWFwcGVuZFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiaW5wdXQtZ3JvdXAtdGV4dFwiPnB4PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPVwiZm9ybS10ZXh0IHRleHQtbXV0ZWQgbW9uYXN0ZXJ5LWhlbHAtdGV4dFwiPuaOqOiNkOWAvDogMTAwMHB477yI5Y+v5qC55o2u5bGP5bmV5aSn5bCP6LCD5pW077yJPC9zbWFsbD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXNlY29uZGFyeSBtb25hc3RlcnktYnRuIG1vbmFzdGVyeS1idG4tc2Vjb25kYXJ5XCIgaWQ9XCJyZXNldC1zZXR0aW5ncy1idG5cIj5cbiAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS11bmRvXCI+PC9pPiDmgaLlpI3pu5jorqRcbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IG1vbmFzdGVyeS1idG4gbW9uYXN0ZXJ5LWJ0bi1wcmltYXJ5XCIgaWQ9XCJzYXZlLXNldHRpbmdzLWJ0blwiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLWNoZWNrXCI+PC9pPiDkv53lrZjorr7nva5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnkgbW9uYXN0ZXJ5LWJ0biBtb25hc3RlcnktYnRuLWNhbmNlbFwiIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtdGltZXNcIj48L2k+IOWPlua2iFxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG5cbiAgICAvLyDmt7vliqDliLDpobXpnaJcbiAgICAkKCdib2R5JykuYXBwZW5kKGRpYWxvZ0h0bWwpO1xuXG4gICAgLy8g57uR5a6a6auY5bqm6K6+572u5byA5YWz5LqL5Lu2XG4gICAgJCgnI2hlaWdodC1jdXN0b20tc3dpdGNoJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICgkKHRoaXMpLmlzKCc6Y2hlY2tlZCcpKSB7XG4gICAgICAgICQoJyNjdXN0b20taGVpZ2h0LWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoJyNjdXN0b20taGVpZ2h0LWNvbnRhaW5lcicpLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIOe7keWumuS/neWtmOaMiemSruS6i+S7tlxuICAgICQoJyNzYXZlLXNldHRpbmdzLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZvbnRTaXplID0gJCgnI2ZvbnQtc2l6ZS1zZWxlY3QnKS52YWwoKSBhcyAnc21hbGwnIHwgJ21lZGl1bScgfCAnbGFyZ2UnO1xuICAgICAgY29uc3QgdWlNb2RlID0gJCgnI3VpLW1vZGUtc2VsZWN0JykudmFsKCkgYXMgVUlNb2RlO1xuICAgICAgY29uc3QgdXNlQ3VzdG9tSGVpZ2h0ID0gJCgnI2hlaWdodC1jdXN0b20tc3dpdGNoJykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAgIC8vIOagueaNruaYr+WQpuWQr+eUqOiHquWumuS5iemrmOW6puWGs+WumuS9v+eUqGF1dG/ov5jmmK/oh6rlrprkuYnlgLxcbiAgICAgIGxldCBnYW1lSGVpZ2h0OiBudW1iZXIgfCAnYXV0bycgPSAnYXV0byc7XG5cbiAgICAgIGlmICh1c2VDdXN0b21IZWlnaHQpIHtcbiAgICAgICAgY29uc3QgZ2FtZUhlaWdodElucHV0ID0gJCgnI2dhbWUtaGVpZ2h0LWlucHV0JykudmFsKCk7XG4gICAgICAgIC8vIOS9v+eUqGxvZGFzaOmqjOivgeW5tui9rOaNoumrmOW6puWAvO+8jOehruS/neWcqOacieaViOiMg+WbtOWGhVxuICAgICAgICBnYW1lSGVpZ2h0ID0gXy5jbGFtcChcbiAgICAgICAgICBfLnBhcnNlSW50KGdhbWVIZWlnaHRJbnB1dCBhcyBzdHJpbmcpIHx8IDEwMDAsXG4gICAgICAgICAgNTAwLCAvLyDmnIDlsI/lgLxcbiAgICAgICAgICAyMDAwLCAvLyDmnIDlpKflgLxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVTZXR0aW5ncyh7XG4gICAgICAgIGZvbnRTaXplLFxuICAgICAgICB1aU1vZGUsXG4gICAgICAgIGdhbWVIZWlnaHQsXG4gICAgICB9KTtcblxuICAgICAgJCgnI3NldHRpbmdzLWRpYWxvZycpLm1vZGFsKCdoaWRlJyk7XG4gICAgfSk7XG5cbiAgICAkKCcjcmVzZXQtc2V0dGluZ3MtYnRuJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgaWYgKGNvbmZpcm0oJ+ehruWumuimgeaBouWkjem7mOiupOiuvue9ruWQl++8nycpKSB7XG4gICAgICAgIHRoaXMucmVzZXRTZXR0aW5ncygpO1xuXG4gICAgICAgIC8vIOabtOaWsOWvueivneahhuS4reeahOmAiemhuVxuICAgICAgICAkKCcjZm9udC1zaXplLXNlbGVjdCcpLnZhbCh0aGlzLmRlZmF1bHRTZXR0aW5ncy5mb250U2l6ZSk7XG4gICAgICAgICQoJyN1aS1tb2RlLXNlbGVjdCcpLnZhbCh0aGlzLmRlZmF1bHRTZXR0aW5ncy51aU1vZGUpO1xuXG4gICAgICAgIC8vIOabtOaWsOiHquWumuS5iemrmOW6puW8gOWFs1xuICAgICAgICAkKCcjaGVpZ2h0LWN1c3RvbS1zd2l0Y2gnKS5wcm9wKCdjaGVja2VkJywgdGhpcy5kZWZhdWx0U2V0dGluZ3MuZ2FtZUhlaWdodCAhPT0gJ2F1dG8nKTtcbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFNldHRpbmdzLmdhbWVIZWlnaHQgPT09ICdhdXRvJykge1xuICAgICAgICAgICQoJyNjdXN0b20taGVpZ2h0LWNvbnRhaW5lcicpLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkKCcjY3VzdG9tLWhlaWdodC1jb250YWluZXInKS5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgICAgICAgJCgnI2dhbWUtaGVpZ2h0LWlucHV0JykudmFsKHRoaXMuZGVmYXVsdFNldHRpbmdzLmdhbWVIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDmmL7npLrlr7nor53moYZcbiAgICAkKCcjc2V0dGluZ3MtZGlhbG9nJykubW9kYWwoJ3Nob3cnKS5kYXRhKCdiYWNrZHJvcCcsICdzdGF0aWMnKS5kYXRhKCdrZXlib2FyZCcsIGZhbHNlKTtcblxuICAgIC8vIOW9k+WvueivneahhuWFs+mXreaXtuenu+mZpFxuICAgICQoJyNzZXR0aW5ncy1kaWFsb2cnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/settingsManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/scripts/components/uiManager.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UIManager: () => (/* binding */ UIManager)\n/* harmony export */ });\n/**\n * UI管理器组件\n * 负责管理游戏中的通用UI显示和交互\n */\nclass UIManager {\n    // 当前确认回调\n    currentConfirmCallback = null;\n    constructor() {\n        // 初始化Toastr配置\n        toastr.options = {\n            closeButton: true,\n            progressBar: true,\n            positionClass: 'toast-top-right',\n            preventDuplicates: false,\n            timeOut: 3000,\n        };\n        // 绑定确认对话框按钮事件 - 这里不需要预绑定，我们会在显示时动态绑定\n        console.log('UI管理器初始化完成');\n    }\n    /**\n     * 显示加载提示\n     */\n    showLoading(message = '加载中...') {\n        $('.loading-text').text(message);\n        $('.loading-indicator').removeClass('hidden');\n    }\n    /**\n     * 隐藏加载提示\n     */\n    hideLoading() {\n        $('.loading-indicator').addClass('hidden');\n    }\n    /**\n     * 显示确认对话框\n     */\n    showConfirmDialog(message, onConfirm) {\n        // 保存确认回调\n        this.currentConfirmCallback = onConfirm;\n        console.log('显示确认对话框:', message);\n        // 设置确认消息\n        $('#confirm-message').text(message);\n        // 显示对话框容器\n        $('#confirm-container').removeClass('hidden');\n        // 绑定按钮事件\n        $('#confirm-yes')\n            .off('click')\n            .on('click', () => this.handleConfirmYes());\n        $('#confirm-no')\n            .off('click')\n            .on('click', () => this.hideConfirmDialog());\n        // 点击对话框外部关闭\n        $(document).on('click.confirm-outside', e => {\n            if ($(e.target).closest('.confirm-dialog').length === 0 && !$('#confirm-container').hasClass('hidden')) {\n                this.hideConfirmDialog();\n            }\n        });\n    }\n    /**\n     * 隐藏确认对话框\n     */\n    hideConfirmDialog() {\n        // 隐藏对话框\n        $('#confirm-container').addClass('hidden');\n        // 移除外部点击事件处理器\n        $(document).off('click.confirm-outside');\n        // 重置回调\n        this.currentConfirmCallback = null;\n    }\n    /**\n     * 处理确认按钮点击\n     */\n    handleConfirmYes() {\n        // 调用确认回调\n        if (this.currentConfirmCallback) {\n            this.currentConfirmCallback();\n        }\n        // 隐藏对话框\n        this.hideConfirmDialog();\n    }\n    /**\n     * 显示通知\n     */\n    showNotification(message, type = 'info', duration = 3000) {\n        // 使用toastr库显示通知\n        toastr.options.timeOut = duration;\n        switch (type) {\n            case 'success':\n                toastr.success(message);\n                break;\n            case 'warning':\n                toastr.warning(message);\n                break;\n            case 'error':\n                toastr.error(message);\n                break;\n            default:\n                toastr.info(message);\n        }\n    }\n    /**\n     * 切换全屏显示\n     */\n    toggleFullscreen() {\n        if (!document.fullscreenElement) {\n            // 进入全屏\n            if (document.documentElement.requestFullscreen) {\n                document.documentElement.requestFullscreen();\n            }\n        }\n        else {\n            // 退出全屏\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            }\n        }\n    }\n    /**\n     * 显示文本提示\n     */\n    showTooltip(element, message) {\n        // 使用jQuery UI的tooltip\n        $(element)\n            .attr('title', message)\n            .tooltip({\n            content: message,\n            position: { my: 'center bottom', at: 'center top-5' },\n            show: { effect: 'fadeIn', duration: 200 },\n            hide: { effect: 'fadeOut', duration: 200 },\n        })\n            .tooltip('open');\n        // 自动关闭\n        setTimeout(() => {\n            $(element).tooltip('close');\n        }, 2000);\n    }\n    /**\n     * 显示输入对话框\n     * @param title 对话框标题\n     * @param defaultValue 默认值\n     * @param callback 输入完成回调函数\n     */\n    showInputDialog(title, defaultValue, callback) {\n        // 检查是否已存在对话框\n        if ($('#input-dialog').length > 0) {\n            $('#input-dialog').remove();\n        }\n        // 创建对话框\n        const dialogHtml = `\n      <div id=\"input-dialog\" class=\"modal fade\">\n        <div class=\"modal-dialog modal-dialog-centered monastery-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\"><i class=\"fas fa-feather-alt\"></i> ${title}</h5>\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n            </div>\n            <div class=\"modal-body\">\n              <div class=\"input-dialog-container\">\n                <label for=\"input-dialog-value\" class=\"monastery-label\">为您的记录命名：</label>\n                <input type=\"text\" id=\"input-dialog-value\" class=\"form-control monastery-input\" value=\"${defaultValue}\">\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button type=\"button\" class=\"btn btn-primary monastery-btn monastery-btn-primary\" id=\"input-dialog-confirm\">\n                <i class=\"fas fa-save\"></i> 确定\n              </button>\n              <button type=\"button\" class=\"btn btn-secondary monastery-btn monastery-btn-secondary\" data-dismiss=\"modal\">\n                <i class=\"fas fa-times\"></i> 取消\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n        // 添加到页面\n        $('body').append(dialogHtml);\n        // 绑定确认按钮事件\n        $('#input-dialog-confirm').on('click', () => {\n            const value = $('#input-dialog-value').val();\n            $('#input-dialog').modal('hide');\n            callback(value);\n        });\n        // 绑定回车键事件\n        $('#input-dialog-value').on('keypress', e => {\n            if (e.which === 13) {\n                // Enter键\n                $('#input-dialog-confirm').click();\n            }\n        });\n        // 显示对话框\n        $('#input-dialog').modal('show');\n        // 自动聚焦输入框\n        $('#input-dialog-value').focus();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvdWlNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0dBR0c7QUFFSSxNQUFNLFNBQVM7SUFDcEIsU0FBUztJQUNELHNCQUFzQixHQUF3QixJQUFJLENBQUM7SUFFM0Q7UUFDRSxjQUFjO1FBQ2QsTUFBTSxDQUFDLE9BQU8sR0FBRztZQUNmLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLGFBQWEsRUFBRSxpQkFBaUI7WUFDaEMsaUJBQWlCLEVBQUUsS0FBSztZQUN4QixPQUFPLEVBQUUsSUFBSTtTQUNkLENBQUM7UUFFRixxQ0FBcUM7UUFDckMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRUQ7O09BRUc7SUFDSSxXQUFXLENBQUMsVUFBa0IsUUFBUTtRQUMzQyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxXQUFXO1FBQ2hCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxpQkFBaUIsQ0FBQyxPQUFlLEVBQUUsU0FBcUI7UUFDN0QsU0FBUztRQUNULElBQUksQ0FBQyxzQkFBc0IsR0FBRyxTQUFTLENBQUM7UUFFeEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFakMsU0FBUztRQUNULENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVwQyxVQUFVO1FBQ1YsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMs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LGVBQWUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNqQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxVQUFVO1FBQ1YsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsRUFBRTtZQUMxQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEtBQUssRUFBRSxFQUFFLENBQUM7Z0JBQ25CLFNBQVM7Z0JBQ1QsQ0FBQyxDQUFDLHVCQUF1QixDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDckMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsUUFBUTtRQUNSLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFakMsVUFBVTtRQUNWLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ25DLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsic3JjOi8vdGF2ZXJuX2hlbHBlcl90ZW1wbGF0ZS9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zY3JpcHRzL2NvbXBvbmVudHMvdWlNYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVUnnrqHnkIblmajnu4Tku7ZcbiAqIOi0n+i0o+euoeeQhua4uOaIj+S4reeahOmAmueUqFVJ5pi+56S65ZKM5Lqk5LqSXG4gKi9cblxuZXhwb3J0IGNsYXNzIFVJTWFuYWdlciB7XG4gIC8vIOW9k+WJjeehruiupOWbnuiwg1xuICBwcml2YXRlIGN1cnJlbnRDb25maXJtQ2FsbGJhY2s6ICgoKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIOWIneWni+WMllRvYXN0cumFjee9rlxuICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgY2xvc2VCdXR0b246IHRydWUsXG4gICAgICBwcm9ncmVzc0JhcjogdHJ1ZSxcbiAgICAgIHBvc2l0aW9uQ2xhc3M6ICd0b2FzdC10b3AtcmlnaHQnLFxuICAgICAgcHJldmVudER1cGxpY2F0ZXM6IGZhbHNlLFxuICAgICAgdGltZU91dDogMzAwMCxcbiAgICB9O1xuXG4gICAgLy8g57uR5a6a56Gu6K6k5a+56K+d5qGG5oyJ6ZKu5LqL5Lu2IC0g6L+Z6YeM5LiN6ZyA6KaB6aKE57uR5a6a77yM5oiR5Lus5Lya5Zyo5pi+56S65pe25Yqo5oCB57uR5a6aXG4gICAgY29uc29sZS5sb2coJ1VJ566h55CG5Zmo5Yid5aeL5YyW5a6M5oiQJyk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65Yqg6L295o+Q56S6XG4gICAqL1xuICBwdWJsaWMgc2hvd0xvYWRpbmcobWVzc2FnZTogc3RyaW5nID0gJ+WKoOi9veS4rS4uLicpIHtcbiAgICAkKCcubG9hZGluZy10ZXh0JykudGV4dChtZXNzYWdlKTtcbiAgICAkKCcubG9hZGluZy1pbmRpY2F0b3InKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gIH1cblxuICAvKipcbiAgICog6ZqQ6JeP5Yqg6L295o+Q56S6XG4gICAqL1xuICBwdWJsaWMgaGlkZUxvYWRpbmcoKSB7XG4gICAgJCgnLmxvYWRpbmctaW5kaWNhdG9yJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuehruiupOWvueivneahhlxuICAgKi9cbiAgcHVibGljIHNob3dDb25maXJtRGlhbG9nKG1lc3NhZ2U6IHN0cmluZywgb25Db25maXJtOiAoKSA9PiB2b2lkKSB7XG4gICAgLy8g5L+d5a2Y56Gu6K6k5Zue6LCDXG4gICAgdGhpcy5jdXJyZW50Q29uZmlybUNhbGxiYWNrID0gb25Db25maXJtO1xuXG4gICAgY29uc29sZS5sb2coJ+aYvuekuuehruiupOWvueivneahhjonLCBtZXNzYWdlKTtcblxuICAgIC8vIOiuvue9ruehruiupOa2iOaBr1xuICAgICQoJyNjb25maXJtLW1lc3NhZ2UnKS50ZXh0KG1lc3NhZ2UpO1xuXG4gICAgLy8g5pi+56S65a+56K+d5qGG5a655ZmoXG4gICAgJCgnI2NvbmZpcm0tY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLy8g57uR5a6a5oyJ6ZKu5LqL5Lu2XG4gICAgJCgnI2NvbmZpcm0teWVzJylcbiAgICAgIC5vZmYoJ2NsaWNrJylcbiAgICAgIC5vbignY2xpY2snLCAoKSA9PiB0aGlzLmhhbmRsZUNvbmZpcm1ZZXMoKSk7XG5cbiAgICAkKCcjY29uZmlybS1ubycpXG4gICAgICAub2ZmKCdjbGljaycpXG4gICAgICAub24oJ2NsaWNrJywgKCkgPT4gdGhpcy5oaWRlQ29uZmlybURpYWxvZygpKTtcblxuICAgIC8vIOeCueWHu+WvueivneahhuWklumDqOWFs+mXrVxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljay5jb25maXJtLW91dHNpZGUnLCBlID0+IHtcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5jbG9zZXN0KCcuY29uZmlybS1kaWFsb2cnKS5sZW5ndGggPT09IDAgJiYgISQoJyNjb25maXJtLWNvbnRhaW5lcicpLmhhc0NsYXNzKCdoaWRkZW4nKSkge1xuICAgICAgICB0aGlzLmhpZGVDb25maXJtRGlhbG9nKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6ZqQ6JeP56Gu6K6k5a+56K+d5qGGXG4gICAqL1xuICBwdWJsaWMgaGlkZUNvbmZpcm1EaWFsb2coKSB7XG4gICAgLy8g6ZqQ6JeP5a+56K+d5qGGXG4gICAgJCgnI2NvbmZpcm0tY29udGFpbmVyJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLy8g56e76Zmk5aSW6YOo54K55Ye75LqL5Lu25aSE55CG5ZmoXG4gICAgJChkb2N1bWVudCkub2ZmKCdjbGljay5jb25maXJtLW91dHNpZGUnKTtcblxuICAgIC8vIOmHjee9ruWbnuiwg1xuICAgIHRoaXMuY3VycmVudENvbmZpcm1DYWxsYmFjayA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG56Gu6K6k5oyJ6ZKu54K55Ye7XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUNvbmZpcm1ZZXMoKSB7XG4gICAgLy8g6LCD55So56Gu6K6k5Zue6LCDXG4gICAgaWYgKHRoaXMuY3VycmVudENvbmZpcm1DYWxsYmFjaykge1xuICAgICAgdGhpcy5jdXJyZW50Q29uZmlybUNhbGxiYWNrKCk7XG4gICAgfVxuXG4gICAgLy8g6ZqQ6JeP5a+56K+d5qGGXG4gICAgdGhpcy5oaWRlQ29uZmlybURpYWxvZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuumAmuefpVxuICAgKi9cbiAgcHVibGljIHNob3dOb3RpZmljYXRpb24oXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHR5cGU6ICdpbmZvJyB8ICdzdWNjZXNzJyB8ICd3YXJuaW5nJyB8ICdlcnJvcicgPSAnaW5mbycsXG4gICAgZHVyYXRpb246IG51bWJlciA9IDMwMDAsXG4gICkge1xuICAgIC8vIOS9v+eUqHRvYXN0cuW6k+aYvuekuumAmuefpVxuICAgIHRvYXN0ci5vcHRpb25zLnRpbWVPdXQgPSBkdXJhdGlvbjtcblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnc3VjY2Vzcyc6XG4gICAgICAgIHRvYXN0ci5zdWNjZXNzKG1lc3NhZ2UpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3dhcm5pbmcnOlxuICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0b2FzdHIuaW5mbyhtZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YiH5o2i5YWo5bGP5pi+56S6XG4gICAqL1xuICBwdWJsaWMgdG9nZ2xlRnVsbHNjcmVlbigpIHtcbiAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSB7XG4gICAgICAvLyDov5vlhaXlhajlsY9cbiAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOmAgOWHuuWFqOWxj1xuICAgICAgaWYgKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSB7XG4gICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuaWh+acrOaPkOekulxuICAgKi9cbiAgcHVibGljIHNob3dUb29sdGlwKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAvLyDkvb/nlKhqUXVlcnkgVUnnmoR0b29sdGlwXG4gICAgJChlbGVtZW50KVxuICAgICAgLmF0dHIoJ3RpdGxlJywgbWVzc2FnZSlcbiAgICAgIC50b29sdGlwKHtcbiAgICAgICAgY29udGVudDogbWVzc2FnZSxcbiAgICAgICAgcG9zaXRpb246IHsgbXk6ICdjZW50ZXIgYm90dG9tJywgYXQ6ICdjZW50ZXIgdG9wLTUnIH0sXG4gICAgICAgIHNob3c6IHsgZWZmZWN0OiAnZmFkZUluJywgZHVyYXRpb246IDIwMCB9LFxuICAgICAgICBoaWRlOiB7IGVmZmVjdDogJ2ZhZGVPdXQnLCBkdXJhdGlvbjogMjAwIH0sXG4gICAgICB9KVxuICAgICAgLnRvb2x0aXAoJ29wZW4nKTtcblxuICAgIC8vIOiHquWKqOWFs+mXrVxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgJChlbGVtZW50KS50b29sdGlwKCdjbG9zZScpO1xuICAgIH0sIDIwMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuui+k+WFpeWvueivneahhlxuICAgKiBAcGFyYW0gdGl0bGUg5a+56K+d5qGG5qCH6aKYXG4gICAqIEBwYXJhbSBkZWZhdWx0VmFsdWUg6buY6K6k5YC8XG4gICAqIEBwYXJhbSBjYWxsYmFjayDovpPlhaXlrozmiJDlm57osIPlh73mlbBcbiAgICovXG4gIHB1YmxpYyBzaG93SW5wdXREaWFsb2codGl0bGU6IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcsIGNhbGxiYWNrOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCk6IHZvaWQge1xuICAgIC8vIOajgOafpeaYr+WQpuW3suWtmOWcqOWvueivneahhlxuICAgIGlmICgkKCcjaW5wdXQtZGlhbG9nJykubGVuZ3RoID4gMCkge1xuICAgICAgJCgnI2lucHV0LWRpYWxvZycpLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8vIOWIm+W7uuWvueivneahhlxuICAgIGNvbnN0IGRpYWxvZ0h0bWwgPSBgXG4gICAgICA8ZGl2IGlkPVwiaW5wdXQtZGlhbG9nXCIgY2xhc3M9XCJtb2RhbCBmYWRlXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1kaWFsb2cgbW9kYWwtZGlhbG9nLWNlbnRlcmVkIG1vbmFzdGVyeS1kaWFsb2dcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuICAgICAgICAgICAgICA8aDUgY2xhc3M9XCJtb2RhbC10aXRsZVwiPjxpIGNsYXNzPVwiZmFzIGZhLWZlYXRoZXItYWx0XCI+PC9pPiAke3RpdGxlfTwvaDU+XG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiPiZ0aW1lczs8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWRpYWxvZy1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwiaW5wdXQtZGlhbG9nLXZhbHVlXCIgY2xhc3M9XCJtb25hc3RlcnktbGFiZWxcIj7kuLrmgqjnmoTorrDlvZXlkb3lkI3vvJo8L2xhYmVsPlxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiaW5wdXQtZGlhbG9nLXZhbHVlXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2wgbW9uYXN0ZXJ5LWlucHV0XCIgdmFsdWU9XCIke2RlZmF1bHRWYWx1ZX1cIj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgbW9uYXN0ZXJ5LWJ0biBtb25hc3RlcnktYnRuLXByaW1hcnlcIiBpZD1cImlucHV0LWRpYWxvZy1jb25maXJtXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtc2F2ZVwiPjwvaT4g56Gu5a6aXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5IG1vbmFzdGVyeS1idG4gbW9uYXN0ZXJ5LWJ0bi1zZWNvbmRhcnlcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLXRpbWVzXCI+PC9pPiDlj5bmtohcbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuXG4gICAgLy8g5re75Yqg5Yiw6aG16Z2iXG4gICAgJCgnYm9keScpLmFwcGVuZChkaWFsb2dIdG1sKTtcblxuICAgIC8vIOe7keWumuehruiupOaMiemSruS6i+S7tlxuICAgICQoJyNpbnB1dC1kaWFsb2ctY29uZmlybScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gJCgnI2lucHV0LWRpYWxvZy12YWx1ZScpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgICQoJyNpbnB1dC1kaWFsb2cnKS5tb2RhbCgnaGlkZScpO1xuICAgICAgY2FsbGJhY2sodmFsdWUpO1xuICAgIH0pO1xuXG4gICAgLy8g57uR5a6a5Zue6L2m6ZSu5LqL5Lu2XG4gICAgJCgnI2lucHV0LWRpYWxvZy12YWx1ZScpLm9uKCdrZXlwcmVzcycsIGUgPT4ge1xuICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSB7XG4gICAgICAgIC8vIEVudGVy6ZSuXG4gICAgICAgICQoJyNpbnB1dC1kaWFsb2ctY29uZmlybScpLmNsaWNrKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDmmL7npLrlr7nor53moYZcbiAgICAkKCcjaW5wdXQtZGlhbG9nJykubW9kYWwoJ3Nob3cnKTtcblxuICAgIC8vIOiHquWKqOiBmueEpui+k+WFpeahhlxuICAgICQoJyNpbnB1dC1kaWFsb2ctdmFsdWUnKS5mb2N1cygpO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/scripts/components/uiManager.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/services/character-resource.service.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CharacterResourceService: () => (/* binding */ CharacterResourceService)\n/* harmony export */ });\n/**\n * 角色资源服务\n * 负责管理角色数据和立绘资源\n */\nclass CharacterResourceService {\n    // 角色资源映射表\n    characters = new Map();\n    constructor() {\n        console.log('角色资源服务已初始化');\n        // 初始化角色数据\n        this.initializeCharacters();\n    }\n    /**\n     * 初始化角色数据\n     */\n    initializeCharacters() {\n        // 修女Cecilia\n        this.characters.set('cecilia', {\n            id: 'cecilia',\n            name: 'Cecilia修女',\n            fullName: 'Sister Cecilia',\n            position: 'right',\n            emotions: {\n                default: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%BE%AE%E7%AC%91.png?ref_type=heads',\n                smile: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%BE%AE%E7%AC%91.png?ref_type=heads',\n                sad: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%93%AD%E6%B3%A3.png?ref_type=heads',\n                shocked: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E6%83%8A%E8%AE%B6.png?ref_type=heads',\n                blush: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%AE%B3%E7%BE%9E.png?ref_type=heads',\n            },\n            bio: '一位年轻的见习修女，专注于抄写工作，对草药学有浓厚兴趣。',\n        });\n        // 玩家角色\n        this.characters.set('player', {\n            id: 'player',\n            name: '{{user}}',\n            fullName: 'The Visitor',\n            position: 'left',\n            emotions: {\n                default: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E9%BB%98%E8%AE%A4.png?ref_type=heads',\n                smile: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%BE%AE%E7%AC%91.png?ref_type=heads',\n                sad: 'https://gitgud.io/lolodesu/lolobabytutorial/-/raw/master/lologame/%E8%A7%92%E8%89%B2/%E6%B0%B4%E6%89%8B%E6%9C%8D/%E5%93%AD%E6%B3%A3.png?ref_type=heads',\n            },\n            bio: '一位到访修道院的神秘人物，对修道院的历史和草药学表示了浓厚兴趣。',\n        });\n        // 可以根据需要添加更多角色...\n    }\n    /**\n     * 获取角色资源\n     * @param characterId 角色ID\n     * @returns 角色资源对象，不存在时返回undefined\n     */\n    getCharacter(characterId) {\n        return this.characters.get(characterId);\n    }\n    /**\n     * 获取所有角色ID列表\n     * @returns 角色ID数组\n     */\n    getAllCharacterIds() {\n        return Array.from(this.characters.keys());\n    }\n    /**\n     * 获取角色表情图片URL\n     * @param characterId 角色ID\n     * @param emotion 表情类型，默认为'default'\n     * @returns 表情图片URL，角色或表情不存在时返回undefined\n     */\n    getCharacterEmotionUrl(characterId, emotion = 'default') {\n        const character = this.characters.get(characterId);\n        if (!character)\n            return undefined;\n        // 如果请求的表情不存在，返回默认表情\n        return character.emotions[emotion] || character.emotions.default;\n    }\n    /**\n     * 获取角色名称\n     * @param characterId 角色ID\n     * @returns 角色名称，不存在时返回\"未知角色\"\n     */\n    getCharacterName(characterId) {\n        const character = this.characters.get(characterId);\n        return character ? character.name : '未知角色';\n    }\n    /**\n     * 添加一个新角色\n     * @param character 角色资源对象\n     * @returns 是否添加成功\n     */\n    addCharacter(character) {\n        if (this.characters.has(character.id)) {\n            console.warn(`角色ID: ${character.id} 已存在，无法添加`);\n            return false;\n        }\n        this.characters.set(character.id, character);\n        return true;\n    }\n    /**\n     * 更新角色信息\n     * @param characterId 角色ID\n     * @param updates 更新的字段\n     * @returns 是否更新成功\n     */\n    updateCharacter(characterId, updates) {\n        const character = this.characters.get(characterId);\n        if (!character) {\n            console.warn(`角色ID: ${characterId} 不存在，无法更新`);\n            return false;\n        }\n        // 使用lodash合并对象\n        const updatedCharacter = _.merge({}, character, updates);\n        this.characters.set(characterId, updatedCharacter);\n        return true;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zZXJ2aWNlcy9jaGFyYWN0ZXItcmVzb3VyY2Uuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztHQUdHO0FBcUJJLE1BQU0sd0JBQXdCO0lBQ25DLFVBQVU7SUFDRixVQUFVLEdBQW1DLElBQUksR0FBRyxFQUFFLENBQUM7SUFFL0Q7UUFDRSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzFCLFVBQVU7UUFDVixJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBRUQ7O09BRUc7SUFDSyxvQkFBb0I7UUFDMUIsWUFBWTtRQUNaLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRTtZQUM3QixFQUFFLEVBQUUsU0FBUztZQUNiLElBQUksRUFBRSxXQUFXO1lBQ2pCLFFBQVEsRUFBRSxnQkFBZ0I7WUFDMUIsUUFBUSxFQUFFLE9BQU87WUFDakIsUUFBUSxFQUFFO2dCQUNSLE9BQU8sRUFDTCx3SkFBd0o7Z0JBQzFKLEtBQUssRUFDSCx3SkFBd0o7Z0JBQzFKLEdBQUcsRUFBRSx3SkFBd0o7Z0JBQzdKLE9BQU8sRUFDTCx3SkFBd0o7Z0JBQzFKLEtBQUssRUFDSCx3SkFBd0o7YUFDM0o7WUFDRCxHQUFHLEVBQUUsOEJBQThCO1NBQ3BDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUU7WUFDNUIsRUFBRSxFQUFFLFFBQVE7WUFDWixJQUFJLEVBQUUsVUFBVTtZQUNoQixRQUFRLEVBQUUsYUFBYTtZQUN2QixRQUFRLEVBQUUsTUFBTTtZQUNoQixRQUFRLEVBQUU7Z0JBQ1IsT0FBTyxFQUNMLHdKQUF3SjtnQkFDMUosS0FBSyxFQUNILHdKQUF3SjtnQkFDMUosR0FBRyxFQUFFLHdKQUF3SjthQUM5SjtZQUNELEdBQUcsRUFBRSxrQ0FBa0M7U0FDeEMsQ0FBQyxDQUFDO1FBRUgsa0JBQWtCO0lBQ3BCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksWUFBWSxDQUFDLFdBQW1CO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVEOzs7T0FHRztJQUNJLGtCQUFrQjtRQUN2QixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLHNCQUFzQixDQUFDLFdBQW1CLEVBQUUsVUFBdUIsU0FBUztRQUNqRixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNuRCxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU8sU0FBUyxDQUFDO1FBRWpDLG9CQUFvQjtRQUNwQixPQUFPLFNBQVMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7SUFDbkUsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxnQkFBZ0IsQ0FBQyxXQUFtQjtRQUN6QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNuRCxPQUFPLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQzdDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksWUFBWSxDQUFDLFNBQTRCO1FBQzlDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7WUFDdEMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLFNBQVMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQy9DLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUVELElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDN0MsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxlQUFlLENBQUMsV0FBbUIsRUFBRSxPQUFtQztRQUM3RSxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNuRCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDZixPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsV0FBVyxXQUFXLENBQUMsQ0FBQztZQUM5QyxPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFFRCxlQUFlO1FBQ2YsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDekQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLGdCQUFnQixDQUFDLENBQUM7UUFFbkQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc2VydmljZXMvY2hhcmFjdGVyLXJlc291cmNlLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDop5LoibLotYTmupDmnI3liqFcbiAqIOi0n+i0o+euoeeQhuinkuiJsuaVsOaNruWSjOeri+e7mOi1hOa6kFxuICovXG5cbi8qKlxuICog6KeS6Imy6KGo5oOF5beu5YiG57G75Z6LXG4gKi9cbmV4cG9ydCB0eXBlIEVtb3Rpb25UeXBlID0gJ2RlZmF1bHQnIHwgJ3NtaWxlJyB8ICdzYWQnIHwgJ2FuZ3J5JyB8ICdzaG9ja2VkJyB8ICdibHVzaCcgfCAndGhvdWdodGZ1bCc7XG5cbi8qKlxuICog6KeS6Imy6LWE5rqQ5pWw5o2u5o6l5Y+jXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhcmFjdGVyUmVzb3VyY2Uge1xuICBpZDogc3RyaW5nOyAvLyDop5LoibLllK/kuIBJRFxuICBuYW1lOiBzdHJpbmc7IC8vIOinkuiJsuaYvuekuuWQjeensFxuICBmdWxsTmFtZTogc3RyaW5nOyAvLyDop5LoibLlhajlkI1cbiAgcG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcgfCAnY2VudGVyJzsgLy8g56uL57uY5pi+56S65L2N572uXG4gIGVtb3Rpb25zOiB7XG4gICAgW2tleSBpbiBFbW90aW9uVHlwZV0/OiBzdHJpbmc7IC8vIOihqOaDheW3ruWIhuWvueW6lOeahOWbvueJh1VSTFxuICB9O1xuICBiaW8/OiBzdHJpbmc7IC8vIOinkuiJsueugOS7i++8iOWPr+mAie+8iVxufVxuXG5leHBvcnQgY2xhc3MgQ2hhcmFjdGVyUmVzb3VyY2VTZXJ2aWNlIHtcbiAgLy8g6KeS6Imy6LWE5rqQ5pig5bCE6KGoXG4gIHByaXZhdGUgY2hhcmFjdGVyczogTWFwPHN0cmluZywgQ2hhcmFjdGVyUmVzb3VyY2U+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGNvbnNvbGUubG9nKCfop5LoibLotYTmupDmnI3liqHlt7LliJ3lp4vljJYnKTtcbiAgICAvLyDliJ3lp4vljJbop5LoibLmlbDmja5cbiAgICB0aGlzLmluaXRpYWxpemVDaGFyYWN0ZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW6KeS6Imy5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGluaXRpYWxpemVDaGFyYWN0ZXJzKCk6IHZvaWQge1xuICAgIC8vIOS/ruWls0NlY2lsaWFcbiAgICB0aGlzLmNoYXJhY3RlcnMuc2V0KCdjZWNpbGlhJywge1xuICAgICAgaWQ6ICdjZWNpbGlhJyxcbiAgICAgIG5hbWU6ICdDZWNpbGlh5L+u5aWzJyxcbiAgICAgIGZ1bGxOYW1lOiAnU2lzdGVyIENlY2lsaWEnLFxuICAgICAgcG9zaXRpb246ICdyaWdodCcsXG4gICAgICBlbW90aW9uczoge1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglQTclOTIlRTglODklQjIvJUU2JUIwJUI0JUU2JTg5JThCJUU2JTlDJThELyVFNSVCRSVBRSVFNyVBQyU5MS5wbmc/cmVmX3R5cGU9aGVhZHMnLFxuICAgICAgICBzbWlsZTpcbiAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTUlQkUlQUUlRTclQUMlOTEucG5nP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgICAgc2FkOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTUlOTMlQUQlRTYlQjMlQTMucG5nP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgICAgc2hvY2tlZDpcbiAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTYlODMlOEElRTglQUUlQjYucG5nP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgICAgYmx1c2g6XG4gICAgICAgICAgJ2h0dHBzOi8vZ2l0Z3VkLmlvL2xvbG9kZXN1L2xvbG9iYWJ5dHV0b3JpYWwvLS9yYXcvbWFzdGVyL2xvbG9nYW1lLyVFOCVBNyU5MiVFOCU4OSVCMi8lRTYlQjAlQjQlRTYlODklOEIlRTYlOUMlOEQvJUU1JUFFJUIzJUU3JUJFJTlFLnBuZz9yZWZfdHlwZT1oZWFkcycsXG4gICAgICB9LFxuICAgICAgYmlvOiAn5LiA5L2N5bm06L2755qE6KeB5Lmg5L+u5aWz77yM5LiT5rOo5LqO5oqE5YaZ5bel5L2c77yM5a+56I2J6I2v5a2m5pyJ5rWT5Y6a5YW06Laj44CCJyxcbiAgICB9KTtcblxuICAgIC8vIOeOqeWutuinkuiJslxuICAgIHRoaXMuY2hhcmFjdGVycy5zZXQoJ3BsYXllcicsIHtcbiAgICAgIGlkOiAncGxheWVyJyxcbiAgICAgIG5hbWU6ICd7e3VzZXJ9fScsXG4gICAgICBmdWxsTmFtZTogJ1RoZSBWaXNpdG9yJyxcbiAgICAgIHBvc2l0aW9uOiAnbGVmdCcsXG4gICAgICBlbW90aW9uczoge1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICdodHRwczovL2dpdGd1ZC5pby9sb2xvZGVzdS9sb2xvYmFieXR1dG9yaWFsLy0vcmF3L21hc3Rlci9sb2xvZ2FtZS8lRTglQTclOTIlRTglODklQjIvJUU2JUIwJUI0JUU2JTg5JThCJUU2JTlDJThELyVFOSVCQiU5OCVFOCVBRSVBNC5wbmc/cmVmX3R5cGU9aGVhZHMnLFxuICAgICAgICBzbWlsZTpcbiAgICAgICAgICAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTUlQkUlQUUlRTclQUMlOTEucG5nP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgICAgc2FkOiAnaHR0cHM6Ly9naXRndWQuaW8vbG9sb2Rlc3UvbG9sb2JhYnl0dXRvcmlhbC8tL3Jhdy9tYXN0ZXIvbG9sb2dhbWUvJUU4JUE3JTkyJUU4JTg5JUIyLyVFNiVCMCVCNCVFNiU4OSU4QiVFNiU5QyU4RC8lRTUlOTMlQUQlRTYlQjMlQTMucG5nP3JlZl90eXBlPWhlYWRzJyxcbiAgICAgIH0sXG4gICAgICBiaW86ICfkuIDkvY3liLDorr/kv67pgZPpmaLnmoTnpZ7np5jkurrnianvvIzlr7nkv67pgZPpmaLnmoTljoblj7LlkozojYnoja/lrabooajnpLrkuobmtZPljprlhbTotqPjgIInLFxuICAgIH0pO1xuXG4gICAgLy8g5Y+v5Lul5qC55o2u6ZyA6KaB5re75Yqg5pu05aSa6KeS6ImyLi4uXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6KeS6Imy6LWE5rqQXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJJZCDop5LoibJJRFxuICAgKiBAcmV0dXJucyDop5LoibLotYTmupDlr7nosaHvvIzkuI3lrZjlnKjml7bov5Tlm551bmRlZmluZWRcbiAgICovXG4gIHB1YmxpYyBnZXRDaGFyYWN0ZXIoY2hhcmFjdGVySWQ6IHN0cmluZyk6IENoYXJhY3RlclJlc291cmNlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJzLmdldChjaGFyYWN0ZXJJZCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ6KeS6ImySUTliJfooahcbiAgICogQHJldHVybnMg6KeS6ImySUTmlbDnu4RcbiAgICovXG4gIHB1YmxpYyBnZXRBbGxDaGFyYWN0ZXJJZHMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY2hhcmFjdGVycy5rZXlzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuihqOaDheWbvueJh1VSTFxuICAgKiBAcGFyYW0gY2hhcmFjdGVySWQg6KeS6ImySURcbiAgICogQHBhcmFtIGVtb3Rpb24g6KGo5oOF57G75Z6L77yM6buY6K6k5Li6J2RlZmF1bHQnXG4gICAqIEByZXR1cm5zIOihqOaDheWbvueJh1VSTO+8jOinkuiJsuaIluihqOaDheS4jeWtmOWcqOaXtui/lOWbnnVuZGVmaW5lZFxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlckVtb3Rpb25VcmwoY2hhcmFjdGVySWQ6IHN0cmluZywgZW1vdGlvbjogRW1vdGlvblR5cGUgPSAnZGVmYXVsdCcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IGNoYXJhY3RlciA9IHRoaXMuY2hhcmFjdGVycy5nZXQoY2hhcmFjdGVySWQpO1xuICAgIGlmICghY2hhcmFjdGVyKSByZXR1cm4gdW5kZWZpbmVkO1xuXG4gICAgLy8g5aaC5p6c6K+35rGC55qE6KGo5oOF5LiN5a2Y5Zyo77yM6L+U5Zue6buY6K6k6KGo5oOFXG4gICAgcmV0dXJuIGNoYXJhY3Rlci5lbW90aW9uc1tlbW90aW9uXSB8fCBjaGFyYWN0ZXIuZW1vdGlvbnMuZGVmYXVsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bop5LoibLlkI3np7BcbiAgICogQHBhcmFtIGNoYXJhY3RlcklkIOinkuiJsklEXG4gICAqIEByZXR1cm5zIOinkuiJsuWQjeensO+8jOS4jeWtmOWcqOaXtui/lOWbnlwi5pyq55+l6KeS6ImyXCJcbiAgICovXG4gIHB1YmxpYyBnZXRDaGFyYWN0ZXJOYW1lKGNoYXJhY3RlcklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNoYXJhY3RlciA9IHRoaXMuY2hhcmFjdGVycy5nZXQoY2hhcmFjdGVySWQpO1xuICAgIHJldHVybiBjaGFyYWN0ZXIgPyBjaGFyYWN0ZXIubmFtZSA6ICfmnKrnn6Xop5LoibInO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOS4gOS4quaWsOinkuiJslxuICAgKiBAcGFyYW0gY2hhcmFjdGVyIOinkuiJsui1hOa6kOWvueixoVxuICAgKiBAcmV0dXJucyDmmK/lkKbmt7vliqDmiJDlip9cbiAgICovXG4gIHB1YmxpYyBhZGRDaGFyYWN0ZXIoY2hhcmFjdGVyOiBDaGFyYWN0ZXJSZXNvdXJjZSk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmNoYXJhY3RlcnMuaGFzKGNoYXJhY3Rlci5pZCkpIHtcbiAgICAgIGNvbnNvbGUud2Fybihg6KeS6ImySUQ6ICR7Y2hhcmFjdGVyLmlkfSDlt7LlrZjlnKjvvIzml6Dms5Xmt7vliqBgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmNoYXJhY3RlcnMuc2V0KGNoYXJhY3Rlci5pZCwgY2hhcmFjdGVyKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDop5LoibLkv6Hmga9cbiAgICogQHBhcmFtIGNoYXJhY3RlcklkIOinkuiJsklEXG4gICAqIEBwYXJhbSB1cGRhdGVzIOabtOaWsOeahOWtl+autVxuICAgKiBAcmV0dXJucyDmmK/lkKbmm7TmlrDmiJDlip9cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVDaGFyYWN0ZXIoY2hhcmFjdGVySWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxDaGFyYWN0ZXJSZXNvdXJjZT4pOiBib29sZWFuIHtcbiAgICBjb25zdCBjaGFyYWN0ZXIgPSB0aGlzLmNoYXJhY3RlcnMuZ2V0KGNoYXJhY3RlcklkKTtcbiAgICBpZiAoIWNoYXJhY3Rlcikge1xuICAgICAgY29uc29sZS53YXJuKGDop5LoibJJRDogJHtjaGFyYWN0ZXJJZH0g5LiN5a2Y5Zyo77yM5peg5rOV5pu05pawYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8g5L2/55SobG9kYXNo5ZCI5bm25a+56LGhXG4gICAgY29uc3QgdXBkYXRlZENoYXJhY3RlciA9IF8ubWVyZ2Uoe30sIGNoYXJhY3RlciwgdXBkYXRlcyk7XG4gICAgdGhpcy5jaGFyYWN0ZXJzLnNldChjaGFyYWN0ZXJJZCwgdXBkYXRlZENoYXJhY3Rlcik7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/services/character-resource.service.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/services/game-data.service.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameDataService: () => (/* binding */ GameDataService)\n/* harmony export */ });\nclass GameDataService {\n    // 游戏默认数据\n    defaultGameData = {\n        story: {\n            date: '1243年 夏',\n            location: '修道院',\n            scene: '图书室',\n            dialogue: [\n                {\n                    speaker: 'Cecilia修女',\n                    content: '欢迎来到修道院，这里是我们的图书室。',\n                    style: 'normal',\n                    portrait: {\n                        character: 'cecilia',\n                        emotion: 'smile',\n                    },\n                    background: {\n                        location: '修道院',\n                        scene: '图书室',\n                    },\n                },\n                {\n                    speaker: '玩家',\n                    content: '谢谢你的接待，这里的藏书真是令人惊叹。',\n                    style: 'normal',\n                    portrait: {\n                        character: 'player',\n                        emotion: 'default',\n                    },\n                },\n                {\n                    speaker: '旁白',\n                    content: 'Cecilia修女微笑着拿起一本古老的书籍。',\n                    style: 'special',\n                },\n                {\n                    speaker: 'Cecilia修女',\n                    content: '这本是我们修道院最珍贵的草药学手稿，记载了很多珍贵的药方。',\n                    style: 'normal',\n                    portrait: {\n                        character: 'cecilia',\n                        emotion: 'thoughtful',\n                    },\n                },\n                {\n                    speaker: '图书管理员',\n                    content: '午餐时间到了，请各位移步餐厅。',\n                    style: 'normal',\n                    // 这是一个未预定义的角色，只显示名字，不显示立绘\n                },\n                {\n                    speaker: 'Cecilia修女',\n                    content: '不如我们去花园里继续聊吧？',\n                    style: 'normal',\n                    portrait: {\n                        character: 'cecilia',\n                        emotion: 'smile',\n                    },\n                    background: {\n                        location: '修道院',\n                        scene: '花园',\n                    },\n                },\n            ],\n            options: ['好的，我很乐意。', '我想先了解更多关于那本草药手稿的内容。', '我需要先休息一下，稍后再聊。'],\n            currentDialogueIndex: 0,\n            currentChapter: '第一章：修道院的秘密',\n            currentFunds: 50,\n        },\n        storySummary: [\n            {\n                id: 1,\n                content: '玩家来到修道院，与Cecilia修女在图书室相遇，得知了一本珍贵的草药学手稿。',\n                timestamp: new Date().toISOString(),\n            },\n        ],\n    };\n    constructor() {\n        console.log('游戏数据服务已初始化');\n    }\n    /**\n     * 加载游戏数据\n     * @returns 游戏数据\n     */\n    async loadGameData() {\n        // 在实际应用中，这里可能会从文件或API加载数据\n        // 现在我们使用默认数据\n        return this.defaultGameData;\n    }\n    /**\n     * 保存游戏数据\n     * @param gameData 游戏数据\n     */\n    async saveGameData(gameData) {\n        // 在实际应用中，这里可能会保存数据到文件或API\n        console.log('游戏数据已保存');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zZXJ2aWNlcy9nYW1lLWRhdGEuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBTU8sTUFBTSxlQUFlO0lBQzFCLFNBQVM7SUFDRCxlQUFlLEdBQWE7UUFDbEMsS0FBSyxFQUFFO1lBQ0wsSUFBSSxFQUFFLFNBQVM7WUFDZixRQUFRLEVBQUUsS0FBSztZQUNmLEtBQUssRUFBRSxLQUFLO1lBQ1osUUFBUSxFQUFFO2dCQUNSO29CQUNFLE9BQU8sRUFBRSxXQUFXO29CQUNwQixPQUFPLEVBQUUsb0JBQW9CO29CQUM3QixLQUFLLEVBQUUsUUFBeUI7b0JBQ2hDLFFBQVEsRUFBRTt3QkFDUixTQUFTLEVBQUUsU0FBUzt3QkFDcEIsT0FBTyxFQUFFLE9BQU87cUJBQ2pCO29CQUNELFVBQVUsRUFBRTt3QkFDVixRQUFRLEVBQUUsS0FBSzt3QkFDZixLQUFLLEVBQUUsS0FBSztxQkFDYjtpQkFDRjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsSUFBSTtvQkFDYixPQUFPLEVBQUUscUJBQXFCO29CQUM5QixLQUFLLEVBQUUsUUFBeUI7b0JBQ2hDLFFBQVEsRUFBRTt3QkFDUixTQUFTLEVBQUUsUUFBUTt3QkFDbkIsT0FBTyxFQUFFLFNBQVM7cUJBQ25CO2lCQUNGO2dCQUNEO29CQUNFLE9BQU8sRUFBRSxJQUFJO29CQUNiLE9BQU8sRUFBRSx3QkFBd0I7b0JBQ2pDLEtBQUssRUFBRSxTQUEwQjtpQkFDbEM7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLFdBQVc7b0JBQ3BCLE9BQU8sRUFBRSwrQkFBK0I7b0JBQ3hDLEtBQUssRUFBRSxRQUF5QjtvQkFDaEMsUUFBUSxFQUFFO3dCQUNSLFNBQVMsRUFBRSxTQUFTO3dCQUNwQixPQUFPLEVBQUUsWUFBWTtxQkFDdEI7aUJBQ0Y7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLE9BQU87b0JBQ2hCLE9BQU8sRUFBRSxpQkFBaUI7b0JBQzFCLEtBQUssRUFBRSxRQUF5QjtvQkFDaEMsMEJBQTBCO2lCQUMzQjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsV0FBVztvQkFDcEIsT0FBTyxFQUFFLGVBQWU7b0JBQ3hCLEtBQUssRUFBRSxRQUF5QjtvQkFDaEMsUUFBUSxFQUFFO3dCQUNSLFNBQVMsRUFBRSxTQUFTO3dCQUNwQixPQUFPLEVBQUUsT0FBTztxQkFDakI7b0JBQ0QsVUFBVSxFQUFFO3dCQUNWLFFBQVEsRUFBRSxLQUFLO3dCQUNmLEtBQUssRUFBRSxJQUFJO3FCQUNaO2lCQUNGO2FBQ0Y7WUFDRCxPQUFPLEVBQUUsQ0FBQyxVQUFVLEVBQUUscUJBQXFCLEVBQUUsZ0JBQWdCLENBQUM7WUFDOUQsb0JBQW9CLEVBQUUsQ0FBQztZQUN2QixjQUFjLEVBQUUsWUFBWTtZQUM1QixZQUFZLEVBQUUsRUFBRTtTQUNqQjtRQUNELFlBQVksRUFBRTtZQUNaO2dCQUNFLEVBQUUsRUFBRSxDQUFDO2dCQUNMLE9BQU8sRUFBRSx5Q0FBeUM7Z0JBQ2xELFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTthQUNwQztTQUNGO0tBQ0YsQ0FBQztJQUVGO1FBQ0UsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksS0FBSyxDQUFDLFlBQVk7UUFDdkIsMEJBQTBCO1FBQzFCLGFBQWE7UUFDYixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxZQUFZLENBQUMsUUFBa0I7UUFDMUMsMEJBQTBCO1FBQzFCLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDekIsQ0FBQztDQUNGIiwic291cmNlcyI6WyJzcmM6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlL3NyYy/lnKPnuqbkuI7pnZnpu5gv5ri45oiP55WM6Z2iL3NlcnZpY2VzL2dhbWUtZGF0YS5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5ri45oiP5pWw5o2u5pyN5YqhXG4gKiDotJ/otKPliqDovb3lkoznrqHnkIbmuLjmiI/mlbDmja5cbiAqL1xuaW1wb3J0IHsgRGlhbG9ndWVTdHlsZSwgR2FtZURhdGEgfSBmcm9tICcuLi9zY3JpcHRzL21vZGVscy9nYW1lRGF0YSc7XG5cbmV4cG9ydCBjbGFzcyBHYW1lRGF0YVNlcnZpY2Uge1xuICAvLyDmuLjmiI/pu5jorqTmlbDmja5cbiAgcHJpdmF0ZSBkZWZhdWx0R2FtZURhdGE6IEdhbWVEYXRhID0ge1xuICAgIHN0b3J5OiB7XG4gICAgICBkYXRlOiAnMTI0M+W5tCDlpI8nLFxuICAgICAgbG9jYXRpb246ICfkv67pgZPpmaInLFxuICAgICAgc2NlbmU6ICflm77kuablrqQnLFxuICAgICAgZGlhbG9ndWU6IFtcbiAgICAgICAge1xuICAgICAgICAgIHNwZWFrZXI6ICdDZWNpbGlh5L+u5aWzJyxcbiAgICAgICAgICBjb250ZW50OiAn5qyi6L+O5p2l5Yiw5L+u6YGT6Zmi77yM6L+Z6YeM5piv5oiR5Lus55qE5Zu+5Lmm5a6k44CCJyxcbiAgICAgICAgICBzdHlsZTogJ25vcm1hbCcgYXMgRGlhbG9ndWVTdHlsZSxcbiAgICAgICAgICBwb3J0cmFpdDoge1xuICAgICAgICAgICAgY2hhcmFjdGVyOiAnY2VjaWxpYScsXG4gICAgICAgICAgICBlbW90aW9uOiAnc21pbGUnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYmFja2dyb3VuZDoge1xuICAgICAgICAgICAgbG9jYXRpb246ICfkv67pgZPpmaInLFxuICAgICAgICAgICAgc2NlbmU6ICflm77kuablrqQnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBzcGVha2VyOiAn546p5a62JyxcbiAgICAgICAgICBjb250ZW50OiAn6LCi6LCi5L2g55qE5o6l5b6F77yM6L+Z6YeM55qE6JeP5Lmm55yf5piv5Luk5Lq65oOK5Y+544CCJyxcbiAgICAgICAgICBzdHlsZTogJ25vcm1hbCcgYXMgRGlhbG9ndWVTdHlsZSxcbiAgICAgICAgICBwb3J0cmFpdDoge1xuICAgICAgICAgICAgY2hhcmFjdGVyOiAncGxheWVyJyxcbiAgICAgICAgICAgIGVtb3Rpb246ICdkZWZhdWx0JyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgc3BlYWtlcjogJ+aXgeeZvScsXG4gICAgICAgICAgY29udGVudDogJ0NlY2lsaWHkv67lpbPlvq7nrJHnnYDmi7/otbfkuIDmnKzlj6TogIHnmoTkuabnsY3jgIInLFxuICAgICAgICAgIHN0eWxlOiAnc3BlY2lhbCcgYXMgRGlhbG9ndWVTdHlsZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHNwZWFrZXI6ICdDZWNpbGlh5L+u5aWzJyxcbiAgICAgICAgICBjb250ZW50OiAn6L+Z5pys5piv5oiR5Lus5L+u6YGT6Zmi5pyA54+N6LS155qE6I2J6I2v5a2m5omL56i/77yM6K6w6L295LqG5b6I5aSa54+N6LS155qE6I2v5pa544CCJyxcbiAgICAgICAgICBzdHlsZTogJ25vcm1hbCcgYXMgRGlhbG9ndWVTdHlsZSxcbiAgICAgICAgICBwb3J0cmFpdDoge1xuICAgICAgICAgICAgY2hhcmFjdGVyOiAnY2VjaWxpYScsXG4gICAgICAgICAgICBlbW90aW9uOiAndGhvdWdodGZ1bCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHNwZWFrZXI6ICflm77kuabnrqHnkIblkZgnLFxuICAgICAgICAgIGNvbnRlbnQ6ICfljYjppJDml7bpl7TliLDkuobvvIzor7flkITkvY3np7vmraXppJDljoXjgIInLFxuICAgICAgICAgIHN0eWxlOiAnbm9ybWFsJyBhcyBEaWFsb2d1ZVN0eWxlLFxuICAgICAgICAgIC8vIOi/meaYr+S4gOS4quacqumihOWumuS5ieeahOinkuiJsu+8jOWPquaYvuekuuWQjeWtl++8jOS4jeaYvuekuueri+e7mFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgc3BlYWtlcjogJ0NlY2lsaWHkv67lpbMnLFxuICAgICAgICAgIGNvbnRlbnQ6ICfkuI3lpoLmiJHku6zljrvoirHlm63ph4znu6fnu63ogYrlkKfvvJ8nLFxuICAgICAgICAgIHN0eWxlOiAnbm9ybWFsJyBhcyBEaWFsb2d1ZVN0eWxlLFxuICAgICAgICAgIHBvcnRyYWl0OiB7XG4gICAgICAgICAgICBjaGFyYWN0ZXI6ICdjZWNpbGlhJyxcbiAgICAgICAgICAgIGVtb3Rpb246ICdzbWlsZScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB7XG4gICAgICAgICAgICBsb2NhdGlvbjogJ+S/rumBk+mZoicsXG4gICAgICAgICAgICBzY2VuZTogJ+iKseWbrScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBvcHRpb25zOiBbJ+WlveeahO+8jOaIkeW+iOS5kOaEj+OAgicsICfmiJHmg7PlhYjkuobop6Pmm7TlpJrlhbPkuo7pgqPmnKzojYnoja/miYvnqL/nmoTlhoXlrrnjgIInLCAn5oiR6ZyA6KaB5YWI5LyR5oGv5LiA5LiL77yM56iN5ZCO5YaN6IGK44CCJ10sXG4gICAgICBjdXJyZW50RGlhbG9ndWVJbmRleDogMCxcbiAgICAgIGN1cnJlbnRDaGFwdGVyOiAn56ys5LiA56ug77ya5L+u6YGT6Zmi55qE56eY5a+GJyxcbiAgICAgIGN1cnJlbnRGdW5kczogNTAsXG4gICAgfSxcbiAgICBzdG9yeVN1bW1hcnk6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIGNvbnRlbnQ6ICfnjqnlrrbmnaXliLDkv67pgZPpmaLvvIzkuI5DZWNpbGlh5L+u5aWz5Zyo5Zu+5Lmm5a6k55u46YGH77yM5b6X55+l5LqG5LiA5pys54+N6LS155qE6I2J6I2v5a2m5omL56i/44CCJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIF0sXG4gIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc29sZS5sb2coJ+a4uOaIj+aVsOaNruacjeWKoeW3suWIneWni+WMlicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9vea4uOaIj+aVsOaNrlxuICAgKiBAcmV0dXJucyDmuLjmiI/mlbDmja5cbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkR2FtZURhdGEoKTogUHJvbWlzZTxHYW1lRGF0YT4ge1xuICAgIC8vIOWcqOWunumZheW6lOeUqOS4re+8jOi/memHjOWPr+iDveS8muS7juaWh+S7tuaIlkFQSeWKoOi9veaVsOaNrlxuICAgIC8vIOeOsOWcqOaIkeS7rOS9v+eUqOm7mOiupOaVsOaNrlxuICAgIHJldHVybiB0aGlzLmRlZmF1bHRHYW1lRGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjmuLjmiI/mlbDmja5cbiAgICogQHBhcmFtIGdhbWVEYXRhIOa4uOaIj+aVsOaNrlxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNhdmVHYW1lRGF0YShnYW1lRGF0YTogR2FtZURhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyDlnKjlrp7pmYXlupTnlKjkuK3vvIzov5nph4zlj6/og73kvJrkv53lrZjmlbDmja7liLDmlofku7bmiJZBUElcbiAgICBjb25zb2xlLmxvZygn5ri45oiP5pWw5o2u5bey5L+d5a2YJyk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/services/game-data.service.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/services/game-state-generation.service.ts"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameStateGenerationService: () => (/* binding */ GameStateGenerationService)\n/* harmony export */ });\nclass GameStateGenerationService {\n    // 添加属性保存原始响应\n    lastRawResponse = '';\n    constructor() {\n        console.log('游戏状态生成服务已初始化');\n    }\n    /**\n     * 获取最后一次LLM生成的原始响应\n     * @returns 最后一次LLM的原始响应\n     */\n    getLastRawResponse() {\n        return this.lastRawResponse;\n    }\n    /**\n     * 生成下一个游戏状态\n     * @param choice 玩家选择\n     */\n    async generateNextGameState(choice) {\n        // 检查API是否可用\n        if (typeof window.generate !== 'function') {\n            console.warn('generate API不可用');\n            return null;\n        }\n        try {\n            // 使用简单标签替代复杂提示词\n            const systemPrompt = `<选择>${choice}</选择>`;\n            // 使用简单的inject参数指示AI返回游戏状态JSON\n            const generateConfig = {\n                user_input: choice,\n                should_stream: false,\n                injects: [\n                    {\n                        role: 'system',\n                        content: systemPrompt,\n                        position: 'before_prompt',\n                        depth: 0,\n                        should_scan: false,\n                    },\n                ],\n            };\n            // 调用生成API\n            const result = await window.generate(generateConfig);\n            // 保存并打印完整的原始响应\n            this.lastRawResponse = result;\n            console.log('%c[LLM完整响应]', 'color: #ff5722; font-weight: bold;');\n            console.log(result);\n            // 解析结果\n            const regex = /<gametext>([\\s\\S]*?)<\\/gametext>/;\n            const match = result.match(regex);\n            if (match && match[1]) {\n                try {\n                    const jsonData = match[1].trim();\n                    console.log('%c[找到游戏状态JSON]', 'color: #4caf50; font-weight: bold;');\n                    console.log(jsonData);\n                    const gameData = JSON.parse(jsonData);\n                    return gameData;\n                }\n                catch (parseError) {\n                    console.error('解析游戏数据JSON失败:', parseError);\n                    const jsonData = match[1].trim();\n                    console.log('%c[解析JSON失败]', 'color: #f44336; font-weight: bold;', jsonData);\n                    return null;\n                }\n            }\n            else {\n                console.error('未找到<gametext>标签或内容为空');\n                return null;\n            }\n        }\n        catch (error) {\n            console.error('生成游戏状态失败:', error);\n            return null;\n        }\n    }\n    /**\n     * 生成记忆点游戏状态\n     * @param memory 记忆点对象\n     */\n    async generateMemoryState(memory) {\n        // 检查API是否可用\n        if (typeof window.generate !== 'function') {\n            console.warn('generate API不可用');\n            return null;\n        }\n        try {\n            // 使用简单标签替代复杂提示词\n            const systemPrompt = `<时间跳跃>${memory.content}</时间跳跃>`;\n            // 使用简单的inject参数指示AI根据记忆点生成游戏状态\n            const result = await window.generate({\n                user_input: `穿越到记忆点\"${memory.content}\"`,\n                should_stream: false,\n                injects: [\n                    {\n                        role: 'system',\n                        content: systemPrompt,\n                        position: 'before_prompt',\n                        depth: 0,\n                        should_scan: false,\n                    },\n                ],\n            });\n            // 保存并打印完整的原始响应\n            this.lastRawResponse = result;\n            console.log('%c[LLM记忆点响应]', 'color: #ff9800; font-weight: bold;');\n            console.log(result);\n            // 解析结果\n            const regex = /<gametext>([\\s\\S]*?)<\\/gametext>/;\n            const match = result.match(regex);\n            if (match && match[1]) {\n                try {\n                    const jsonData = match[1].trim();\n                    console.log('%c[找到记忆点游戏状态JSON]', 'color: #4caf50; font-weight: bold;');\n                    console.log(jsonData);\n                    const gameData = JSON.parse(jsonData);\n                    return gameData;\n                }\n                catch (parseError) {\n                    console.error('解析记忆点游戏数据JSON失败:', parseError);\n                    const jsonData = match[1].trim();\n                    console.log('%c[解析记忆点JSON失败]', 'color: #f44336; font-weight: bold;', jsonData);\n                    return null;\n                }\n            }\n        }\n        catch (error) {\n            console.error('生成记忆点游戏状态失败:', error);\n        }\n        return null;\n    }\n    /**\n     * 处理自定义行动\n     * @param action 玩家输入的自定义行动\n     */\n    async handleCustomAction(action) {\n        // 检查API是否可用\n        if (typeof window.generate !== 'function') {\n            console.warn('generate API不可用');\n            return null;\n        }\n        try {\n            // 使用简单标签替代复杂提示词\n            const systemPrompt = `<自定义行动>${action}</自定义行动>`;\n            // 使用inject参数指示AI处理自定义行动\n            const result = await window.generate({\n                user_input: action,\n                should_stream: false,\n                injects: [\n                    {\n                        role: 'system',\n                        content: systemPrompt,\n                        position: 'before_prompt',\n                        depth: 0,\n                        should_scan: false,\n                    },\n                ],\n            });\n            // 保存并打印完整的原始响应\n            this.lastRawResponse = result;\n            console.log('%c[LLM自定义行动响应]', 'color: #2196f3; font-weight: bold;');\n            console.log(result);\n            // 解析结果\n            const regex = /<gametext>([\\s\\S]*?)<\\/gametext>/;\n            const match = result.match(regex);\n            if (match && match[1]) {\n                try {\n                    const jsonData = match[1].trim();\n                    console.log('%c[找到自定义行动游戏状态JSON]', 'color: #4caf50; font-weight: bold;');\n                    console.log(jsonData);\n                    const gameData = JSON.parse(jsonData);\n                    return gameData;\n                }\n                catch (parseError) {\n                    console.error('解析自定义行动游戏数据JSON失败:', parseError);\n                    const jsonData = match[1].trim();\n                    console.log('%c[解析自定义行动JSON失败]', 'color: #f44336; font-weight: bold;', jsonData);\n                    return null;\n                }\n            }\n        }\n        catch (error) {\n            console.error('处理自定义行动失败:', error);\n        }\n        return null;\n    }\n    /**\n     * 添加一个辅助方法，可以通过控制台调用查看最后一次响应\n     * 用法: window.debugLLMResponse()\n     */\n    initDebugHelpers() {\n        window.debugLLMResponse = () => {\n            console.log('%c[Debug] 最后一次LLM响应', 'background: #222; color: #bada55');\n            console.log(this.lastRawResponse);\n            // 尝试提取gametext部分\n            const regex = /<gametext>([\\s\\S]*?)<\\/gametext>/;\n            const match = this.lastRawResponse.match(regex);\n            if (match && match[1]) {\n                console.log('%c[Debug] 提取的gametext内容', 'background: #222; color: #ffa500');\n                console.log(match[1]);\n                try {\n                    const parsed = JSON.parse(match[1]);\n                    console.log('%c[Debug] 解析后的JSON对象', 'background: #222; color: #4caf50');\n                    console.log(parsed);\n                }\n                catch (e) {\n                    console.log('%c[Debug] JSON解析失败', 'background: #222; color: #f44336');\n                    console.log(e);\n                }\n            }\n            else {\n                console.log('%c[Debug] 未找到gametext标签', 'background: #222; color: #f44336');\n            }\n            return '调试信息已输出到控制台';\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zZXJ2aWNlcy9nYW1lLXN0YXRlLWdlbmVyYXRpb24uc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBTU8sTUFBTSwwQkFBMEI7SUFDckMsYUFBYTtJQUNMLGVBQWUsR0FBVyxFQUFFLENBQUM7SUFFckM7UUFDRSxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxrQkFBa0I7UUFDdkIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQzlCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMscUJBQXFCLENBQUMsTUFBYztRQUMvQyxZQUFZO1FBQ1osSUFBSSxPQUFPLE1BQU0sQ0FBQyxRQUFRLEtBQUssVUFBVSxFQUFFLENBQUM7WUFDMUMsT0FBTyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQ2hDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELElBQUksQ0FBQztZQUNILGdCQUFnQjtZQUNoQixNQUFNLFlBQVksR0FBRyxPQUFPLE1BQU0sT0FBTyxDQUFDO1lBRTFDLDhCQUE4QjtZQUM5QixNQUFNLGNBQWMsR0FBRztnQkFDckIsVUFBVSxFQUFFLE1BQU07Z0JBQ2xCLGFBQWEsRUFBRSxLQUFLO2dCQUNwQixPQUFPLEVBQUU7b0JBQ1A7d0JBQ0UsSUFBSSxFQUFFLFFBQVE7d0JBQ2QsT0FBTyxFQUFFLFlBQVk7d0JBQ3JCLFFBQVEsRUFBRSxlQUFlO3dCQUN6QixLQUFLLEVBQUUsQ0FBQzt3QkFDUixXQUFXLEVBQUUsS0FBSztxQkFDbkI7aUJBQ0Y7YUFDRixDQUFDO1lBRUYsVUFBVTtZQUNWLE1BQU0sTUFBTSxHQUFHLE1BQU0sTUFBTSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUVyRCxlQUFlO1lBQ2YsSUFBSSxDQUFDLGVBQWUsR0FBRyxNQUFNLENBQUM7WUFDOUIsT0FBTyxDQUFD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Z0JBQ3RCLENBQUM7Z0JBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztvQkFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLGtDQUFrQyxDQUFDLENBQUM7b0JBQ3RFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pCLENBQUM7WUFDSCxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxrQ0FBa0MsQ0FBQyxDQUFDO1lBQzdFLENBQUM7WUFFRCxPQUFPLGFBQWEsQ0FBQztRQUN2QixDQUFDLENBQUM7SUFDSixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc2VydmljZXMvZ2FtZS1zdGF0ZS1nZW5lcmF0aW9uLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDmuLjmiI/nirbmgIHnlJ/miJDmnI3liqFcbiAqIOi0n+i0o+agueaNrueOqeWutumAieaLqeaIluiusOW/hueCueeUn+aIkOaWsOeahOa4uOaIj+eKtuaAgVxuICovXG5pbXBvcnQgeyBHYW1lRGF0YSB9IGZyb20gJy4uL3NjcmlwdHMvbW9kZWxzL2dhbWVEYXRhJztcblxuZXhwb3J0IGNsYXNzIEdhbWVTdGF0ZUdlbmVyYXRpb25TZXJ2aWNlIHtcbiAgLy8g5re75Yqg5bGe5oCn5L+d5a2Y5Y6f5aeL5ZON5bqUXG4gIHByaXZhdGUgbGFzdFJhd1Jlc3BvbnNlOiBzdHJpbmcgPSAnJztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBjb25zb2xlLmxvZygn5ri45oiP54q25oCB55Sf5oiQ5pyN5Yqh5bey5Yid5aeL5YyWJyk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5pyA5ZCO5LiA5qyhTExN55Sf5oiQ55qE5Y6f5aeL5ZON5bqUXG4gICAqIEByZXR1cm5zIOacgOWQjuS4gOasoUxMTeeahOWOn+Wni+WTjeW6lFxuICAgKi9cbiAgcHVibGljIGdldExhc3RSYXdSZXNwb25zZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmxhc3RSYXdSZXNwb25zZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnlJ/miJDkuIvkuIDkuKrmuLjmiI/nirbmgIFcbiAgICogQHBhcmFtIGNob2ljZSDnjqnlrrbpgInmi6lcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZW5lcmF0ZU5leHRHYW1lU3RhdGUoY2hvaWNlOiBzdHJpbmcpOiBQcm9taXNlPEdhbWVEYXRhIHwgbnVsbD4ge1xuICAgIC8vIOajgOafpUFQSeaYr+WQpuWPr+eUqFxuICAgIGlmICh0eXBlb2Ygd2luZG93LmdlbmVyYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ2dlbmVyYXRlIEFQSeS4jeWPr+eUqCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOS9v+eUqOeugOWNleagh+etvuabv+S7o+WkjeadguaPkOekuuivjVxuICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYDzpgInmi6k+JHtjaG9pY2V9PC/pgInmi6k+YDtcblxuICAgICAgLy8g5L2/55So566A5Y2V55qEaW5qZWN05Y+C5pWw5oyH56S6QUnov5Tlm57muLjmiI/nirbmgIFKU09OXG4gICAgICBjb25zdCBnZW5lcmF0ZUNvbmZpZyA9IHtcbiAgICAgICAgdXNlcl9pbnB1dDogY2hvaWNlLFxuICAgICAgICBzaG91bGRfc3RyZWFtOiBmYWxzZSxcbiAgICAgICAgaW5qZWN0czogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudDogc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgcG9zaXRpb246ICdiZWZvcmVfcHJvbXB0JyxcbiAgICAgICAgICAgIGRlcHRoOiAwLFxuICAgICAgICAgICAgc2hvdWxkX3NjYW46IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuXG4gICAgICAvLyDosIPnlKjnlJ/miJBBUElcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdpbmRvdy5nZW5lcmF0ZShnZW5lcmF0ZUNvbmZpZyk7XG5cbiAgICAgIC8vIOS/neWtmOW5tuaJk+WNsOWujOaVtOeahOWOn+Wni+WTjeW6lFxuICAgICAgdGhpcy5sYXN0UmF3UmVzcG9uc2UgPSByZXN1bHQ7XG4gICAgICBjb25zb2xlLmxvZygnJWNbTExN5a6M5pW05ZON5bqUXScsICdjb2xvcjogI2ZmNTcyMjsgZm9udC13ZWlnaHQ6IGJvbGQ7Jyk7XG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuXG4gICAgICAvLyDop6PmnpDnu5PmnpxcbiAgICAgIGNvbnN0IHJlZ2V4ID0gLzxnYW1ldGV4dD4oW1xcc1xcU10qPyk8XFwvZ2FtZXRleHQ+LztcbiAgICAgIGNvbnN0IG1hdGNoID0gcmVzdWx0Lm1hdGNoKHJlZ2V4KTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QganNvbkRhdGEgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coJyVjW+aJvuWIsOa4uOaIj+eKtuaAgUpTT05dJywgJ2NvbG9yOiAjNGNhZjUwOyBmb250LXdlaWdodDogYm9sZDsnKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhqc29uRGF0YSk7XG4gICAgICAgICAgY29uc3QgZ2FtZURhdGEgPSBKU09OLnBhcnNlKGpzb25EYXRhKTtcbiAgICAgICAgICByZXR1cm4gZ2FtZURhdGE7XG4gICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfop6PmnpDmuLjmiI/mlbDmja5KU09O5aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCclY1vop6PmnpBKU09O5aSx6LSlXScsICdjb2xvcjogI2Y0NDMzNjsgZm9udC13ZWlnaHQ6IGJvbGQ7JywganNvbkRhdGEpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfmnKrmib7liLA8Z2FtZXRleHQ+5qCH562+5oiW5YaF5a655Li656m6Jyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfnlJ/miJDmuLjmiI/nirbmgIHlpLHotKU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOeUn+aIkOiusOW/hueCuea4uOaIj+eKtuaAgVxuICAgKiBAcGFyYW0gbWVtb3J5IOiusOW/hueCueWvueixoVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdlbmVyYXRlTWVtb3J5U3RhdGUobWVtb3J5OiB7IGlkOiBudW1iZXI7IGNvbnRlbnQ6IHN0cmluZzsgaW1hZ2U/OiBzdHJpbmcgfSk6IFByb21pc2U8R2FtZURhdGEgfCBudWxsPiB7XG4gICAgLy8g5qOA5p+lQVBJ5piv5ZCm5Y+v55SoXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cuZ2VuZXJhdGUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNvbnNvbGUud2FybignZ2VuZXJhdGUgQVBJ5LiN5Y+v55SoJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8g5L2/55So566A5Y2V5qCH562+5pu/5Luj5aSN5p2C5o+Q56S66K+NXG4gICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgPOaXtumXtOi3s+i3gz4ke21lbW9yeS5jb250ZW50fTwv5pe26Ze06Lez6LeDPmA7XG5cbiAgICAgIC8vIOS9v+eUqOeugOWNleeahGluamVjdOWPguaVsOaMh+ekukFJ5qC55o2u6K6w5b+G54K555Sf5oiQ5ri45oiP54q25oCBXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3aW5kb3cuZ2VuZXJhdGUoe1xuICAgICAgICB1c2VyX2lucHV0OiBg56m/6LaK5Yiw6K6w5b+G54K5XCIke21lbW9yeS5jb250ZW50fVwiYCxcbiAgICAgICAgc2hvdWxkX3N0cmVhbTogZmFsc2UsXG4gICAgICAgIGluamVjdHM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYmVmb3JlX3Byb21wdCcsXG4gICAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICAgIHNob3VsZF9zY2FuOiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIOS/neWtmOW5tuaJk+WNsOWujOaVtOeahOWOn+Wni+WTjeW6lFxuICAgICAgdGhpcy5sYXN0UmF3UmVzcG9uc2UgPSByZXN1bHQ7XG4gICAgICBjb25zb2xlLmxvZygnJWNbTExN6K6w5b+G54K55ZON5bqUXScsICdjb2xvcjogI2ZmOTgwMDsgZm9udC13ZWlnaHQ6IGJvbGQ7Jyk7XG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuXG4gICAgICAvLyDop6PmnpDnu5PmnpxcbiAgICAgIGNvbnN0IHJlZ2V4ID0gLzxnYW1ldGV4dD4oW1xcc1xcU10qPyk8XFwvZ2FtZXRleHQ+LztcbiAgICAgIGNvbnN0IG1hdGNoID0gcmVzdWx0Lm1hdGNoKHJlZ2V4KTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QganNvbkRhdGEgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coJyVjW+aJvuWIsOiusOW/hueCuea4uOaIj+eKtuaAgUpTT05dJywgJ2NvbG9yOiAjNGNhZjUwOyBmb250LXdlaWdodDogYm9sZDsnKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhqc29uRGF0YSk7XG4gICAgICAgICAgY29uc3QgZ2FtZURhdGEgPSBKU09OLnBhcnNlKGpzb25EYXRhKTtcbiAgICAgICAgICByZXR1cm4gZ2FtZURhdGE7XG4gICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfop6PmnpDorrDlv4bngrnmuLjmiI/mlbDmja5KU09O5aSx6LSlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCclY1vop6PmnpDorrDlv4bngrlKU09O5aSx6LSlXScsICdjb2xvcjogI2Y0NDMzNjsgZm9udC13ZWlnaHQ6IGJvbGQ7JywganNvbkRhdGEpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+eUn+aIkOiusOW/hueCuea4uOaIj+eKtuaAgeWksei0pTonLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG6Ieq5a6a5LmJ6KGM5YqoXG4gICAqIEBwYXJhbSBhY3Rpb24g546p5a626L6T5YWl55qE6Ieq5a6a5LmJ6KGM5YqoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaGFuZGxlQ3VzdG9tQWN0aW9uKGFjdGlvbjogc3RyaW5nKTogUHJvbWlzZTxHYW1lRGF0YSB8IG51bGw+IHtcbiAgICAvLyDmo4Dmn6VBUEnmmK/lkKblj6/nlKhcbiAgICBpZiAodHlwZW9mIHdpbmRvdy5nZW5lcmF0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29uc29sZS53YXJuKCdnZW5lcmF0ZSBBUEnkuI3lj6/nlKgnKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyDkvb/nlKjnroDljZXmoIfnrb7mm7/ku6PlpI3mnYLmj5DnpLror41cbiAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGA86Ieq5a6a5LmJ6KGM5YqoPiR7YWN0aW9ufTwv6Ieq5a6a5LmJ6KGM5YqoPmA7XG5cbiAgICAgIC8vIOS9v+eUqGluamVjdOWPguaVsOaMh+ekukFJ5aSE55CG6Ieq5a6a5LmJ6KGM5YqoXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3aW5kb3cuZ2VuZXJhdGUoe1xuICAgICAgICB1c2VyX2lucHV0OiBhY3Rpb24sXG4gICAgICAgIHNob3VsZF9zdHJlYW06IGZhbHNlLFxuICAgICAgICBpbmplY3RzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50OiBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2JlZm9yZV9wcm9tcHQnLFxuICAgICAgICAgICAgZGVwdGg6IDAsXG4gICAgICAgICAgICBzaG91bGRfc2NhbjogZmFsc2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyDkv53lrZjlubbmiZPljbDlrozmlbTnmoTljp/lp4vlk43lupRcbiAgICAgIHRoaXMubGFzdFJhd1Jlc3BvbnNlID0gcmVzdWx0O1xuICAgICAgY29uc29sZS5sb2coJyVjW0xMTeiHquWumuS5ieihjOWKqOWTjeW6lF0nLCAnY29sb3I6ICMyMTk2ZjM7IGZvbnQtd2VpZ2h0OiBib2xkOycpO1xuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcblxuICAgICAgLy8g6Kej5p6Q57uT5p6cXG4gICAgICBjb25zdCByZWdleCA9IC88Z2FtZXRleHQ+KFtcXHNcXFNdKj8pPFxcL2dhbWV0ZXh0Pi87XG4gICAgICBjb25zdCBtYXRjaCA9IHJlc3VsdC5tYXRjaChyZWdleCk7XG5cbiAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCclY1vmib7liLDoh6rlrprkuYnooYzliqjmuLjmiI/nirbmgIFKU09OXScsICdjb2xvcjogIzRjYWY1MDsgZm9udC13ZWlnaHQ6IGJvbGQ7Jyk7XG4gICAgICAgICAgY29uc29sZS5sb2coanNvbkRhdGEpO1xuICAgICAgICAgIGNvbnN0IGdhbWVEYXRhID0gSlNPTi5wYXJzZShqc29uRGF0YSk7XG4gICAgICAgICAgcmV0dXJuIGdhbWVEYXRhO1xuICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q6Ieq5a6a5LmJ6KGM5Yqo5ri45oiP5pWw5o2uSlNPTuWksei0pTonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IG1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnJWNb6Kej5p6Q6Ieq5a6a5LmJ6KGM5YqoSlNPTuWksei0pV0nLCAnY29sb3I6ICNmNDQzMzY7IGZvbnQtd2VpZ2h0OiBib2xkOycsIGpzb25EYXRhKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCflpITnkIboh6rlrprkuYnooYzliqjlpLHotKU6JywgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOS4gOS4qui+heWKqeaWueazle+8jOWPr+S7pemAmui/h+aOp+WItuWPsOiwg+eUqOafpeeci+acgOWQjuS4gOasoeWTjeW6lFxuICAgKiDnlKjms5U6IHdpbmRvdy5kZWJ1Z0xMTVJlc3BvbnNlKClcbiAgICovXG4gIHB1YmxpYyBpbml0RGVidWdIZWxwZXJzKCk6IHZvaWQge1xuICAgICh3aW5kb3cgYXMgYW55KS5kZWJ1Z0xMTVJlc3BvbnNlID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJyVjW0RlYnVnXSDmnIDlkI7kuIDmrKFMTE3lk43lupQnLCAnYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNiYWRhNTUnKTtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMubGFzdFJhd1Jlc3BvbnNlKTtcblxuICAgICAgLy8g5bCd6K+V5o+Q5Y+WZ2FtZXRleHTpg6jliIZcbiAgICAgIGNvbnN0IHJlZ2V4ID0gLzxnYW1ldGV4dD4oW1xcc1xcU10qPyk8XFwvZ2FtZXRleHQ+LztcbiAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5sYXN0UmF3UmVzcG9uc2UubWF0Y2gocmVnZXgpO1xuXG4gICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgY29uc29sZS5sb2coJyVjW0RlYnVnXSDmj5Dlj5bnmoRnYW1ldGV4dOWGheWuuScsICdiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2ZmYTUwMCcpO1xuICAgICAgICBjb25zb2xlLmxvZyhtYXRjaFsxXSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKG1hdGNoWzFdKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnJWNbRGVidWddIOino+aekOWQjueahEpTT07lr7nosaEnLCAnYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICM0Y2FmNTAnKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhwYXJzZWQpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJyVjW0RlYnVnXSBKU09O6Kej5p6Q5aSx6LSlJywgJ2JhY2tncm91bmQ6ICMyMjI7IGNvbG9yOiAjZjQ0MzM2Jyk7XG4gICAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCclY1tEZWJ1Z10g5pyq5om+5YiwZ2FtZXRleHTmoIfnrb4nLCAnYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNmNDQzMzYnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICfosIPor5Xkv6Hmga/lt7LovpPlh7rliLDmjqfliLblj7AnO1xuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/services/game-state-generation.service.ts\n\n}");
  },
  "./src/圣约与静默/游戏界面/styles/main.scss"(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
    eval("{__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5Zyj57qm5LiO6Z2Z6buYL+a4uOaIj+eVjOmdoi9zdHlsZXMvbWFpbi5zY3NzIiwibWFwcGluZ3MiOiI7QUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+Wco+e6puS4jumdmem7mC/muLjmiI/nlYzpnaIvc3R5bGVzL21haW4uc2Nzcz8xMmQ2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/圣约与静默/游戏界面/styles/main.scss\n\n}");
  },
  lodash(module) {
    module.exports = _;
  }
};

var __webpack_module_cache__ = {};

function __webpack_require__(moduleId) {
  var cachedModule = __webpack_module_cache__[moduleId];
  if (cachedModule !== undefined) {
    return cachedModule.exports;
  }
  if (__webpack_modules__[moduleId] === undefined) {
    var e = new Error("Cannot find module '" + moduleId + "'");
    e.code = "MODULE_NOT_FOUND";
    throw e;
  }
  var module = __webpack_module_cache__[moduleId] = {
    exports: {}
  };
  __webpack_modules__[moduleId](module, module.exports, __webpack_require__);
  return module.exports;
}

(() => {
  __webpack_require__.n = module => {
    var getter = module && module.__esModule ? () => module["default"] : () => module;
    __webpack_require__.d(getter, {
      a: getter
    });
    return getter;
  };
})();

(() => {
  __webpack_require__.d = (exports, definition) => {
    for (var key in definition) {
      if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
        Object.defineProperty(exports, key, {
          enumerable: true,
          get: definition[key]
        });
      }
    }
  };
})();

(() => {
  __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);
})();

(() => {
  __webpack_require__.r = exports => {
    if (typeof Symbol !== "undefined" && Symbol.toStringTag) {
      Object.defineProperty(exports, Symbol.toStringTag, {
        value: "Module"
      });
    }
    Object.defineProperty(exports, "__esModule", {
      value: true
    });
  };
})();

var __webpack_exports__ = __webpack_require__("./src/圣约与静默/游戏界面/index.ts");</script><style>/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** css ./node_modules/.pnpm/css-loader@7.1.2_webpack@5.104.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-455.use[1]!./node_modules/.pnpm/postcss-loader@8.2.0_postcss@8.5.6_typescript@6.0.0-dev.20250807_webpack@5.104.1/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@16.0.6_sass@1.97.2_webpack@5.104.1/node_modules/sass-loader/dist/cjs.js!./src/圣约与静默/游戏界面/styles/main.scss ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
@charset "UTF-8";:root{--color-primary:#8a6d3b;--color-secondary:#a85832;--color-tertiary:#5d6e41;--color-bg-dark:#2a2a2a;--color-bg-light:#333333;--color-bg-lighter:#3c3c3c;--color-text-primary:#d1d1d1;--color-text-secondary:#888888;--color-text-whisper:#a8c5e9;--color-text-shocked:#e9a8a8;--color-text-special:#d6c8a4;--color-memory-primary:#c99e51;--color-memory-secondary:#9c7f46;--color-memory-highlight:#e4c987;--color-memory-bg:#2e2a25;--color-save-primary:#9e8148;--color-save-secondary:#b29656;--color-save-highlight:#d5b978;--color-save-bg:#2d2a24;--color-save-delete:#a85832;--font-heading:'Cinzel',serif;--font-body:'Lato',sans-serif;--header-height:60px;--tab-height:40px;--dialogue-height:200px;--border-radius:6px;--spacing-xs:4px;--spacing-sm:8px;--spacing-md:16px;--spacing-lg:24px;--spacing-xl:32px;--transition-fast:0.2s;--transition-normal:0.3s;--transition-slow:0.5s;--z-background:1;--z-characters:2;--z-dialogue:3;--z-choices:4;--z-header:5;--z-sidebar:10;--z-modal:20;--font-size-base:1rem;--font-size-small:0.9rem;--font-size-large:1.1rem}*{margin:0;padding:0;box-sizing:border-box}html{height:100%}button{cursor:pointer;font-family:inherit;background:none;border:none;color:inherit}button:focus{outline:none}ul{list-style:none}.hidden{display:none !important}.game-container{position:relative;width:100%;display:flex;flex-direction:column;overflow:hidden;background-color:var(--color-bg-dark);z-index:1}.game-header{height:var(--header-height);min-height:var(--header-height);background-color:rgba(20,20,20,0.9);border-bottom:1px solid var(--color-primary);display:flex;justify-content:space-between;align-items:center;padding:0 var(--spacing-md);z-index:var(--z-header)}.header-left,.header-right{display:flex;align-items:center;gap:var(--spacing-md)}.game-title{font-family:var(--font-heading);font-size:1.5rem;color:var(--color-primary);margin-left:var(--spacing-md)}.game-date{font-family:var(--font-heading);font-size:0.9rem;color:var(--color-text-secondary)}.game-controls{display:flex;align-items:center;gap:var(--spacing-sm)}.icon-button{background:none;border:none;font-size:1.5rem;color:var(--color-text-primary);cursor:pointer;display:flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:50%;transition:background-color var(--transition-fast),color var(--transition-fast)}.icon-button:hover{background-color:rgba(255,255,255,0.1)}.icon-button.small{font-size:1rem;width:28px;height:28px}.icon-button.gold{color:var(--color-primary)}.icon-button.gold:hover{background-color:rgba(138,109,59,0.2)}.content-wrapper{display:flex;flex-direction:column;position:relative;flex:1;overflow:hidden}.tab-navigation{display:flex;height:var(--tab-height);min-height:var(--tab-height);background-color:rgba(20,20,20,0.9);border-bottom:1px solid var(--color-primary)}.tab-button{padding:0 var(--spacing-lg);height:100%;display:flex;align-items:center;gap:var(--spacing-sm);color:var(--color-text-secondary);font-family:var(--font-heading);border-bottom:3px solid transparent;transition:all var(--transition-fast)}.tab-button i{font-size:1rem}.tab-button:hover{color:var(--color-text-primary);background-color:rgba(255,255,255,0.05)}.tab-button.active{color:var(--color-primary);border-bottom-color:var(--color-primary)}.tab-content{position:relative;aspect-ratio:16/9;overflow:hidden}.tab-pane{position:absolute;top:0;left:0;width:100%;height:100%;display:none;overflow:hidden;z-index:1}.tab-pane.active{display:flex;flex-direction:column;z-index:2}#story-tab{position:relative;overflow:hidden;display:flex;flex-direction:column}.background-container{position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;background-position:center;z-index:var(--z-background);transition:opacity var(--transition-slow)}.characters-container{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:var(--z-characters);display:flex;justify-content:space-between}.character-left,.character-right{height:100%;width:40%;background-size:contain;background-position:bottom;background-repeat:no-repeat;transition:transform var(--transition-normal),opacity var(--transition-normal)}.character-left{transform-origin:bottom left}.character-right{transform-origin:bottom right}.dialogue-container{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);width:90%;max-width:900px;height:var(--dialogue-height);background-color:rgba(20,20,20,0.85);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);border:1px solid var(--color-primary);border-radius:var(--border-radius);z-index:var(--z-dialogue);display:flex;flex-direction:column;box-shadow:0 5px 15px rgba(0,0,0,0.3);cursor:pointer}.dialogue-header{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid rgba(138,109,59,0.3);background-color:rgba(0,0,0,0.2)}.speaker-name{font-family:var(--font-heading);font-size:1.125rem;color:var(--color-primary);text-shadow:0 1px 2px rgba(0,0,0,0.5)}.dialogue-controls{display:flex;gap:var(--spacing-sm)}.dialogue-content{flex:1;padding:var(--spacing-md);overflow-y:auto;font-size:1rem;line-height:1.6}.dialogue-text{margin-bottom:var(--spacing-md)}.dialogue-text.style-normal{color:var(--color-text-primary)}.dialogue-text.style-whisper{color:var(--color-text-whisper);font-style:italic}.dialogue-text.style-shocked{color:var(--color-text-shocked)}.dialogue-text.style-special{color:var(--color-text-special);font-weight:500}.choices-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:70%;max-width:650px;background-color:rgba(20,20,20,0.85);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);border:1px solid var(--color-primary);border-radius:var(--border-radius);z-index:var(--z-choices);padding:var(--spacing-sm);display:flex;flex-direction:column;gap:var(--spacing-sm);box-shadow:0 5px 15px rgba(0,0,0,0.5)}.choices-container.compact-choices{width:60%;max-width:500px;padding:var(--spacing-xs)}.choices-header{padding-bottom:var(--spacing-xs);margin-bottom:var(--spacing-xs);border-bottom:1px solid rgba(138,109,59,0.3);display:flex;justify-content:space-between;align-items:center}.choices-header h3{font-family:var(--font-heading);font-size:1rem;color:var(--color-primary);margin:0;text-align:left}.choices-header{}.compact-choices .choices-header{margin-bottom:0;padding-bottom:var(--spacing-xs)}.compact-choices .choices-header h3{font-size:0.9rem}.preset-choices{display:flex;flex-direction:column;gap:0}.choice-button{background-color:transparent;border:none;border-radius:0;padding:var(--spacing-sm) var(--spacing-md);text-align:left;color:var(--color-text-primary);font-size:0.95rem;transition:background-color var(--transition-fast),color var(--transition-fast);position:relative;overflow:hidden}.choice-button::before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);height:0;width:3px;background-color:var(--color-primary);transition:height var(--transition-fast)}.choice-button:hover{background-color:rgba(255,255,255,0.05);color:var(--color-primary)}.choice-button:hover::before{height:70%}.choice-button{}.compact-choices .choice-button{padding:var(--spacing-xs) var(--spacing-md)}.custom-choice{display:flex;gap:var(--spacing-xs);margin-top:var(--spacing-xs);align-items:center;height:32px;border-top:1px solid rgba(138,109,59,0.2);padding-top:var(--spacing-xs)}.custom-choice input{flex:1;background-color:rgba(255,255,255,0.03);border:none;border-bottom:1px solid rgba(138,109,59,0.3);border-radius:0;padding:4px var(--spacing-sm);color:var(--color-text-primary);font-size:0.95rem;height:100%;box-sizing:border-box;transition:all var(--transition-fast);position:relative}.custom-choice input:focus{outline:none;border-bottom-color:var(--color-primary);background-color:rgba(255,255,255,0.05);color:var(--color-primary)}.custom-choice input::placeholder{color:var(--color-text-secondary);opacity:0.7}.custom-choice input{}.compact-choices .custom-choice input{padding:2px var(--spacing-sm)}.custom-choice button{background-color:transparent;color:var(--color-text-secondary);padding:0 var(--spacing-md);border:none;border-radius:0;border-bottom:1px solid rgba(138,109,59,0.3);transition:all var(--transition-fast);font-size:0.95rem;height:100%;white-space:nowrap;position:relative}.custom-choice button::before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);height:0;width:2px;background-color:var(--color-primary);transition:height var(--transition-fast)}.custom-choice button:hover{background-color:rgba(255,255,255,0.05);color:var(--color-primary);border-bottom-color:var(--color-primary)}.custom-choice button:hover::before{height:70%}.custom-choice button{}.compact-choices .custom-choice button{padding:0 var(--spacing-sm)}.choices-header .icon-button.small{width:24px;height:24px;border-radius:50%;display:flex;justify-content:center;align-items:center;color:var(--color-text-secondary);transition:background-color var(--transition-fast),color var(--transition-fast)}.choices-header .icon-button.small:hover{background-color:rgba(255,255,255,0.1);color:var(--color-text-primary)}.journal-container{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--color-bg-light)}.journal-nav{display:flex;gap:var(--spacing-md);padding:var(--spacing-md);background-color:rgba(20,20,20,0.8);border-bottom:1px solid var(--color-tertiary)}.journal-nav-item{padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--border-radius);color:var(--color-text-secondary);transition:all var(--transition-fast);display:flex;align-items:center;gap:var(--spacing-sm)}.journal-nav-item i{font-size:1rem}.journal-nav-item:hover{color:var(--color-text-primary);background-color:rgba(255,255,255,0.05)}.journal-nav-item.active{color:var(--color-tertiary);background-color:rgba(93,110,65,0.2)}.journal-content{flex:1;padding:var(--spacing-md);overflow-y:auto}.journal-section{display:none;height:100%}.journal-section.active{display:flex}#characters-section{display:flex;gap:var(--spacing-lg)}.character-cards{width:30%;display:flex;flex-direction:column;gap:var(--spacing-md);overflow-y:auto}.character-card{display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);background-color:var(--color-bg-lighter);border-radius:var(--border-radius);cursor:pointer;transition:all var(--transition-fast)}.character-card:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.2)}.character-card.active{border-left:3px solid var(--color-tertiary)}.character-avatar{width:60px;height:60px;border-radius:50%;object-fit:cover;border:2px solid var(--color-tertiary)}.character-info{flex:1}.character-name{font-size:1.1rem;font-weight:bold;margin-bottom:var(--spacing-xs)}.character-role{font-size:0.9rem;color:var(--color-text-secondary)}.character-details{flex:1;padding:var(--spacing-lg);background-color:var(--color-bg-lighter);border-radius:var(--border-radius);display:flex;flex-direction:column;gap:var(--spacing-lg)}.monastery-info{padding:var(--spacing-lg);background-color:var(--color-bg-lighter);border-radius:var(--border-radius)}#knowledge-section{display:flex;gap:var(--spacing-lg)}.knowledge-categories{width:30%;display:flex;flex-direction:column;gap:var(--spacing-sm);overflow-y:auto}.knowledge-category{padding:var(--spacing-md);background-color:var(--color-bg-lighter);border-radius:var(--border-radius);cursor:pointer;transition:all var(--transition-fast)}.knowledge-category:hover{background-color:rgba(93,110,65,0.2)}.knowledge-category.active{background-color:rgba(93,110,65,0.3);border-left:3px solid var(--color-tertiary)}.knowledge-entries{flex:1;display:flex;flex-direction:column;gap:var(--spacing-md);overflow-y:auto}.knowledge-entry{padding:var(--spacing-lg);background-color:var(--color-bg-lighter);border-radius:var(--border-radius)}.knowledge-title{font-size:1.2rem;font-family:var(--font-heading);color:var(--color-tertiary);margin-bottom:var(--spacing-md);border-bottom:1px solid rgba(93,110,65,0.3);padding-bottom:var(--spacing-sm)}.knowledge-content{line-height:1.6}.memory-container{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--color-memory-bg)}.memory-header{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);border-bottom:1px solid var(--color-memory-secondary);background-color:rgba(0,0,0,0.2)}.memory-header h2{color:var(--color-memory-primary);font-family:var(--font-heading);display:flex;align-items:center;gap:var(--spacing-sm)}.memory-button{background-color:var(--color-memory-secondary);color:#fff;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--border-radius);display:flex;align-items:center;gap:var(--spacing-sm);transition:background-color var(--transition-fast)}.memory-button:hover{background-color:var(--color-memory-primary)}.memory-button:disabled{cursor:not-allowed}.memory-timeline-container{padding:var(--spacing-md);background-color:rgba(0,0,0,0.15);border-bottom:1px solid rgba(158,129,72,0.3)}.memory-timeline{position:relative;display:flex;align-items:center;justify-content:center;padding:var(--spacing-sm) 0;overflow-x:auto;scrollbar-width:thin;scrollbar-color:var(--color-memory-secondary) rgba(0,0,0,0.2);gap:var(--spacing-md);height:60px}.memory-timeline::-webkit-scrollbar{height:4px}.memory-timeline::-webkit-scrollbar-track{background:rgba(0,0,0,0.2)}.memory-timeline::-webkit-scrollbar-thumb{background-color:var(--color-memory-secondary);border-radius:2px}.memory-timeline::before{content:"";position:absolute;top:50%;left:0;right:0;height:2px;background-color:var(--color-memory-secondary);z-index:1}.memory-node-simple{position:relative;width:24px;height:24px;border-radius:50%;background-color:var(--color-memory-secondary);z-index:2;cursor:pointer;box-shadow:0 0 0 0 rgba(201,158,81,0);transition:all 0.3s ease-in-out}.memory-node-simple::before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:2px;height:16px;background-color:var(--color-memory-secondary);z-index:1}.memory-node-simple:hover{background-color:var(--color-memory-primary);transform:scale(1.2);box-shadow:0 0 10px 2px rgba(201,158,81,0.3)}.memory-node-simple.selected{background-color:var(--color-memory-highlight);transform:scale(1.3);box-shadow:0 0 15px 5px rgba(201,158,81,0.5);animation:memory-pulse 2s infinite}@keyframes memory-pulse{0%{box-shadow:0 0 0 0 rgba(201,158,81,0.7)}70%{box-shadow:0 0 0 10px rgba(201,158,81,0)}100%{box-shadow:0 0 0 0 rgba(201,158,81,0)}}.memory-node{display:none}.memory-detail-container{flex:1;display:flex;flex-direction:column;padding:var(--spacing-md);gap:var(--spacing-md);overflow-y:auto}.memory-content{flex:1;padding:var(--spacing-lg);background-color:rgba(0,0,0,0.2);border:1px solid var(--color-memory-secondary);border-radius:var(--border-radius);line-height:1.6;overflow-y:auto}.memory-content-image{width:100%;height:200px;background-size:cover;background-position:center;border-radius:var(--border-radius);margin-bottom:var(--spacing-md)}.memory-content-text{color:var(--color-text-primary)}.memory-actions{display:flex;justify-content:center;gap:var(--spacing-md)}.memory-travel-button{background-color:var(--color-memory-primary);color:#000;padding:var(--spacing-md) var(--spacing-xl);border-radius:var(--border-radius);font-family:var(--font-heading);font-weight:bold;display:flex;align-items:center;gap:var(--spacing-md);transition:all var(--transition-fast)}.memory-travel-button i{font-size:1.25rem}.memory-travel-button:hover{background-color:var(--color-memory-highlight);transform:translateY(-2px);box-shadow:0 4px 12px rgba(201,158,81,0.3)}.memory-travel-button:disabled{opacity:0.5;background-color:var(--color-memory-secondary);transform:none;box-shadow:none;cursor:not-allowed}.memory-empty-message{text-align:center;color:var(--color-text-secondary);font-style:italic;margin-top:var(--spacing-xl)}.memory-empty-timeline{padding:var(--spacing-md);text-align:center;color:var(--color-text-secondary);font-style:italic;width:100%}.loading-indicator{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);z-index:var(--z-modal);display:flex;flex-direction:column;justify-content:center;align-items:center;gap:var(--spacing-lg)}.loading-spinner{width:50px;height:50px;border:4px solid rgba(138,109,59,0.3);border-radius:50%;border-top-color:var(--color-primary);animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.loading-text{color:var(--color-text-primary);font-size:1.125rem}.confirm-container{position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000;display:flex;justify-content:center;align-items:center;pointer-events:none}.modal-backdrop{display:none}.confirm-dialog{position:relative;background-color:var(--color-bg-light);border:1px solid var(--color-primary);border-radius:var(--border-radius);padding:var(--spacing-lg);width:400px;max-width:90%;z-index:2;box-shadow:0 8px 24px rgba(0,0,0,0.7);pointer-events:auto;animation:dialogPop 0.2s ease-out forwards}@keyframes dialogPop{0%{opacity:0;transform:scale(0.9)}100%{opacity:1;transform:scale(1)}}.confirm-message{margin-bottom:var(--spacing-lg);text-align:center;font-size:1.1rem;line-height:1.5;color:#fff}.confirm-buttons{display:flex;justify-content:center;gap:var(--spacing-md);margin-top:var(--spacing-lg)}.confirm-button{padding:10px 20px;border-radius:var(--border-radius);min-width:100px;font-weight:bold;font-size:1rem;transition:all var(--transition-fast);border:1px solid transparent;cursor:pointer;margin:0 10px;pointer-events:auto !important}.confirm-button:active{transform:scale(0.95)}.confirm-yes{background-color:var(--color-primary);color:#fff;border:1px solid var(--color-memory-highlight)}.confirm-yes:hover{background-color:var(--color-memory-highlight);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,0.3)}.confirm-no{background-color:rgba(80,80,80,0.5);color:var(--color-text-primary);border:1px solid rgba(255,255,255,0.1)}.confirm-no:hover{background-color:rgba(100,100,100,0.7);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,0.3)}#notification-container{position:fixed;top:var(--spacing-md);right:var(--spacing-md);z-index:var(--z-modal);display:flex;flex-direction:column;gap:var(--spacing-sm);max-width:300px}.notification{padding:var(--spacing-md);border-radius:var(--border-radius);background-color:var(--color-bg-light);box-shadow:0 4px 8px rgba(0,0,0,0.3);opacity:0;transform:translateX(20px);transition:all var(--transition-normal)}.notification-show{opacity:1;transform:translateX(0)}.notification-hide{opacity:0;transform:translateX(20px)}.notification-info{border-left:4px solid #3498db}.notification-success{border-left:4px solid #2ecc71}.notification-warning{border-left:4px solid #f39c12}.notification-error{border-left:4px solid #e74c3c}@media (max-width:768px){html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) :root{--header-height:50px}html:not(.mobile-ui):not(.desktop-ui) .game-container{display:flex;flex-direction:column;height:auto;overflow-y:hidden}html:not(.mobile-ui):not(.desktop-ui) .game-header{height:auto;min-height:auto;padding:var(--spacing-sm);flex-shrink:0;z-index:10}html:not(.mobile-ui):not(.desktop-ui) .header-left,html:not(.mobile-ui):not(.desktop-ui) .header-right{gap:var(--spacing-sm)}html:not(.mobile-ui):not(.desktop-ui) .game-title{font-size:1.2rem;margin-left:0}html:not(.mobile-ui):not(.desktop-ui) .game-date{font-size:0.8rem}html:not(.mobile-ui):not(.desktop-ui) .icon-button{width:32px;height:32px;font-size:1.2rem}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .content-wrapper{flex:1;position:relative;overflow:hidden;display:flex;flex-direction:column}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .tab-navigation{height:36px;min-height:36px;flex-shrink:0;z-index:9}html:not(.mobile-ui):not(.desktop-ui) .tab-button{padding:0 var(--spacing-sm);font-size:0.9rem}html:not(.mobile-ui):not(.desktop-ui) .tab-button i{font-size:0.9rem}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .tab-content{flex:1;position:relative;display:flex;flex-direction:column;overflow:hidden}html:not(.mobile-ui):not(.desktop-ui) .tab-pane.active{position:relative;height:100%;display:flex;flex-direction:column}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) #story-tab{display:flex;flex-direction:column;position:relative;height:100%}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .background-container{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:56.25vw;z-index:1}html:not(.mobile-ui):not(.desktop-ui) .characters-container{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:56.25vw;z-index:2}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .dialogue-container{position:fixed;top:calc(var(--header-height) + 36px + 56.25vw);left:0;right:0;width:100%;height:calc(100vh - (var(--header-height) + 36px + 56.25vw));bottom:0;max-width:none;max-height:none;transform:none;border-radius:0;border-left:none;border-right:none;border-bottom:none;border-top:1px solid var(--color-primary);z-index:3;background-color:rgba(20,20,20,0.95);box-shadow:none;cursor:default}html:not(.mobile-ui):not(.desktop-ui) .dialogue-header{padding:var(--spacing-xs) var(--spacing-sm)}html:not(.mobile-ui):not(.desktop-ui) .dialogue-content{padding:var(--spacing-sm);height:calc(100% - 35px);overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--color-primary) rgba(20,20,20,0.3)}html:not(.mobile-ui):not(.desktop-ui) .dialogue-content::-webkit-scrollbar{width:4px}html:not(.mobile-ui):not(.desktop-ui) .dialogue-content::-webkit-scrollbar-track{background:rgba(20,20,20,0.3)}html:not(.mobile-ui):not(.desktop-ui) .dialogue-content::-webkit-scrollbar-thumb{background-color:var(--color-primary);border-radius:2px}html:not(.mobile-ui):not(.desktop-ui) .speaker-name{font-size:1rem}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .choices-container{width:90%;max-width:90%;padding:var(--spacing-xs);z-index:4}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .character-left,html:not(.mobile-ui):not(.desktop-ui) .character-right{height:100%;transform-origin:center bottom}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) #journal-tab,html:not(.mobile-ui):not(.desktop-ui) #memory-tab{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:calc(100vh - (var(--header-height) + 36px));bottom:0;z-index:3}html:not(.mobile-ui):not(.desktop-ui) .journal-container,html:not(.mobile-ui):not(.desktop-ui) .memory-container{padding:0;height:100%;width:100%;overflow-y:auto;display:flex;flex-direction:column}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-container{background-color:var(--color-memory-bg)}html:not(.mobile-ui):not(.desktop-ui) .memory-header{padding:var(--spacing-sm);border-bottom:1px solid var(--color-memory-secondary);background-color:rgba(0,0,0,0.2);position:sticky;top:0;z-index:1}html:not(.mobile-ui):not(.desktop-ui) .memory-header h2{font-size:1.2rem;margin-bottom:var(--spacing-sm)}html:not(.mobile-ui):not(.desktop-ui) .memory-button{background-color:var(--color-memory-primary);padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--border-radius);font-size:0.9rem;display:flex;align-items:center;justify-content:center;width:100%}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-timeline-container{padding:var(--spacing-sm);border-bottom:1px solid rgba(158,129,72,0.3);background-color:rgba(0,0,0,0.15)}html:not(.mobile-ui):not(.desktop-ui) .memory-timeline{padding:var(--spacing-sm) 0;height:50px;gap:var(--spacing-sm)}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-node-simple{width:20px;height:20px}html:not(.mobile-ui):not(.desktop-ui) .memory-node-simple::before{height:12px}html:not(.mobile-ui):not(.desktop-ui) .memory-node-simple.selected{transform:scale(1.25);box-shadow:0 0 10px 3px rgba(201,158,81,0.5)}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-node{display:none}html:not(.mobile-ui):not(.desktop-ui) .memory-node-content,html:not(.mobile-ui):not(.desktop-ui) .memory-timestamp{display:none}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-detail-container{flex:1;padding:var(--spacing-sm);display:flex;flex-direction:column}html:not(.mobile-ui):not(.desktop-ui) .memory-content{flex:1;padding:var(--spacing-md);background-color:rgba(0,0,0,0.2);border:1px solid var(--color-memory-secondary);overflow-y:auto;font-size:0.95rem;line-height:1.5}html:not(.mobile-ui):not(.desktop-ui) .memory-actions{padding:var(--spacing-sm) 0}html:not(.mobile-ui):not(.desktop-ui) .memory-travel-button{width:100%;justify-content:center;padding:var(--spacing-sm);background-color:var(--color-memory-primary);font-size:1rem}html:not(.mobile-ui):not(.desktop-ui) .memory-empty-timeline{padding:var(--spacing-md);font-size:0.9rem}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .journal-container{background-color:var(--color-bg-light)}html:not(.mobile-ui):not(.desktop-ui) .journal-nav{flex-wrap:wrap;padding:var(--spacing-sm);border-bottom:1px solid var(--color-tertiary);background-color:rgba(0,0,0,0.2);position:sticky;top:0;z-index:1}html:not(.mobile-ui):not(.desktop-ui) .journal-nav-item{font-size:0.9rem;padding:var(--spacing-xs) var(--spacing-sm);margin-right:var(--spacing-xs);margin-bottom:var(--spacing-xs);border-radius:var(--border-radius)}html:not(.mobile-ui):not(.desktop-ui) .journal-content{flex:1;padding:var(--spacing-sm);overflow-y:auto}html:not(.mobile-ui):not(.desktop-ui) .journal-section{background-color:var(--color-bg-lighter);border-radius:var(--border-radius);padding:var(--spacing-sm);margin-bottom:var(--spacing-sm)}}@media (max-width:768px) and (orientation:portrait){html:not(.mobile-ui):not(.desktop-ui) .game-header{--header-height:50px}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .character-left,html:not(.mobile-ui):not(.desktop-ui) .character-right{transform:scale(0.9)}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .dialogue-container{backdrop-filter:blur(8px)}}@media (max-width:768px) and (orientation:landscape){html:not(.mobile-ui):not(.desktop-ui) .game-header{--header-height:40px}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .background-container,html:not(.mobile-ui):not(.desktop-ui) .characters-container{height:40vh;top:calc(var(--header-height) + 36px)}html:not(.mobile-ui):not(.desktop-ui) .dialogue-container{top:calc(var(--header-height) + 36px + 40vh);height:calc(100vh - (var(--header-height) + 36px + 40vh));min-height:0}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) #journal-tab,html:not(.mobile-ui):not(.desktop-ui) #memory-tab{top:calc(var(--header-height) + 36px);height:calc(100vh - (var(--header-height) + 36px))}html:not(.mobile-ui):not(.desktop-ui){}html:not(.mobile-ui):not(.desktop-ui) .memory-detail-container,html:not(.mobile-ui):not(.desktop-ui) .journal-content{padding:var(--spacing-xs)}html:not(.mobile-ui):not(.desktop-ui) .memory-content,html:not(.mobile-ui):not(.desktop-ui) .journal-section{padding:var(--spacing-sm)}html:not(.mobile-ui):not(.desktop-ui) .memory-header h2,html:not(.mobile-ui):not(.desktop-ui) .journal-nav-item{font-size:0.85rem}}.modal{z-index:9999}.modal-dialog:not(.monastery-dialog){max-width:90%;width:800px}.modal-content:not(.monastery-dialog .modal-content){background-color:var(--color-bg-light);color:var(--color-text-primary);border:1px solid var(--color-primary);border-radius:var(--border-radius);box-shadow:0 5px 15px rgba(0,0,0,0.5)}.modal-header:not(.monastery-dialog .modal-header),.modal-footer:not(.monastery-dialog .modal-footer){border-color:rgba(138,109,59,0.3);padding:var(--spacing-sm) var(--spacing-md)}.modal-header .close{color:var(--color-text-primary);opacity:0.7;transition:opacity var(--transition-fast)}.modal-header .close:hover{opacity:1}.btn-secondary:not(.monastery-btn){background-color:var(--color-bg-lighter);border-color:var(--color-bg-lighter);color:var(--color-text-primary);transition:all var(--transition-fast)}.btn-secondary:not(.monastery-btn):hover{background-color:var(--color-bg-light);border-color:var(--color-primary)}.modal-backdrop{z-index:9998}.modal-open{overflow:hidden;padding-right:0 !important}.modal.fade .modal-dialog{transform:translate(0,-50px);transition:transform var(--transition-normal) ease}.modal.show .modal-dialog{transform:none}#load-game-modal .modal-dialog{max-width:700px}#load-game-modal .modal-content{background-color:var(--color-save-bg);border:1px solid var(--color-save-primary);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px)}#load-game-modal .modal-header{background-color:rgba(0,0,0,0.2);border-bottom:1px solid var(--color-save-primary)}#load-game-modal .modal-header .modal-title{color:var(--color-save-highlight);font-family:var(--font-heading);font-size:1.3rem}#load-game-modal .modal-header .close{color:var(--color-save-highlight);text-shadow:none;opacity:0.7}#load-game-modal .modal-header .close:hover{opacity:1}#load-game-modal .modal-body{padding:var(--spacing-md);max-height:70vh;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--color-save-primary) rgba(0,0,0,0.2)}#load-game-modal .modal-body::-webkit-scrollbar{width:8px}#load-game-modal .modal-body::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);border-radius:var(--border-radius)}#load-game-modal .modal-body::-webkit-scrollbar-thumb{background:var(--color-save-primary);border-radius:var(--border-radius)}#load-game-modal .modal-body::-webkit-scrollbar-thumb:hover{background:var(--color-save-highlight)}#load-game-modal .modal-footer{background-color:rgba(0,0,0,0.2);border-top:1px solid var(--color-save-primary)}.save-tabs{display:flex;margin-bottom:var(--spacing-md);background-color:rgba(0,0,0,0.15);border-radius:var(--border-radius);padding:0;overflow:hidden}.save-tab-btn{flex:1;padding:var(--spacing-sm) 0;background:none;border:none;color:var(--color-text-secondary);cursor:pointer;font-family:var(--font-heading);font-size:1rem;transition:all var(--transition-fast);position:relative}.save-tab-btn::after{content:"";position:absolute;bottom:0;left:0;width:100%;height:3px;background-color:transparent;transition:background-color var(--transition-fast)}.save-tab-btn:hover{color:var(--color-text-primary)}.save-tab-btn.active{color:var(--color-save-highlight);background-color:rgba(158,129,72,0.1)}.save-tab-btn.active::after{background-color:var(--color-save-primary)}.save-tab-content{position:relative}.save-tab-pane{display:none;animation:fadeIn 0.3s ease}.save-tab-pane.active{display:block}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.save-list{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--spacing-md)}.save-item{background-color:rgba(255,255,255,0.05);border:1px solid rgba(158,129,72,0.3);border-radius:var(--border-radius);overflow:hidden;transition:border-color var(--transition-fast),box-shadow var(--transition-fast);position:relative;cursor:pointer}.save-item:hover{border-color:var(--color-save-highlight);box-shadow:0 3px 10px rgba(0,0,0,0.2)}.save-item.empty{grid-column:1/-1;padding:var(--spacing-lg);text-align:center;color:var(--color-text-secondary);cursor:default}.save-item.empty:hover{box-shadow:none;border-color:rgba(158,129,72,0.3)}.save-item-thumbnail{height:120px;background-size:cover;background-position:center;border-bottom:1px solid rgba(158,129,72,0.2);position:relative;transition:filter var(--transition-fast)}.save-item-thumbnail::after{content:"";position:absolute;bottom:0;left:0;right:0;height:40px;background:linear-gradient(to top,rgba(0,0,0,0.7),transparent)}.save-item:hover .save-item-thumbnail{filter:brightness(1.1)}.save-item-header{padding:var(--spacing-sm) var(--spacing-md);display:flex;justify-content:space-between;align-items:center;background-color:rgba(0,0,0,0.2);border-bottom:1px solid rgba(158,129,72,0.2);backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px)}.save-item-title{font-weight:bold;font-family:var(--font-heading);font-size:1rem;color:var(--color-save-highlight);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60%;transition:color var(--transition-fast)}.save-item:hover .save-item-title{color:var(--color-save-highlight)}.save-item-date{font-size:0.8rem;color:var(--color-text-secondary)}.save-item-content{padding:var(--spacing-sm) var(--spacing-md);font-size:0.9rem;color:var(--color-text-primary);max-height:60px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.save-item-actions{padding:var(--spacing-xs) var(--spacing-md);display:flex;justify-content:flex-end;background-color:rgba(0,0,0,0.2);border-top:1px solid rgba(158,129,72,0.2);opacity:0;transition:opacity var(--transition-fast)}.save-item-actions button{background-color:transparent;color:var(--color-text-secondary);border:1px solid rgba(158,129,72,0.3);border-radius:4px;padding:var(--spacing-xs) var(--spacing-sm);font-size:0.8rem;transition:all var(--transition-fast)}.save-item-actions button:hover{background-color:var(--color-save-delete);color:#fff;border-color:var(--color-save-delete)}.save-item:hover .save-item-actions{opacity:1}#btn-create-manual-save{background-color:var(--color-save-primary);color:#fff;border:none;font-family:var(--font-heading);padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--border-radius);transition:background-color var(--transition-fast),box-shadow var(--transition-fast);display:flex;align-items:center}#btn-create-manual-save i{margin-right:var(--spacing-sm)}#btn-create-manual-save:hover{background-color:var(--color-save-highlight);color:#000;box-shadow:0 2px 5px rgba(0,0,0,0.2)}#load-game-modal .btn-secondary{background-color:rgba(255,255,255,0.1);border:1px solid rgba(158,129,72,0.3);color:var(--color-text-primary)}#load-game-modal .btn-secondary:hover{background-color:rgba(255,255,255,0.15);border-color:var(--color-save-secondary)}.input-dialog-container input{background-color:rgba(255,255,255,0.1);border:1px solid var(--color-save-secondary);color:var(--color-text-primary);border-radius:var(--border-radius);padding:var(--spacing-sm);width:100%;margin-bottom:var(--spacing-md)}.input-dialog-container input:focus{outline:none;border-color:var(--color-save-highlight);box-shadow:0 0 0 2px rgba(213,185,120,0.25)}html.font-small .dialogue-content,html.font-small .choice-button,html.font-small .custom-choice input,html.font-small .memory-content-text,html.font-small .journal-content,html.font-small .knowledge-content{font-size:var(--font-size-small)}html.font-small .speaker-name,html.font-small .memory-header h2,html.font-small .journal-nav-item,html.font-small .tab-button{font-size:0.95rem}html.font-small .dialogue-container{--dialogue-height:180px}html.font-large .dialogue-content,html.font-large .choice-button,html.font-large .custom-choice input,html.font-large .memory-content-text,html.font-large .journal-content,html.font-large .knowledge-content{font-size:var(--font-size-large);line-height:1.7}html.font-large .speaker-name,html.font-large .memory-header h2,html.font-large .journal-nav-item,html.font-large .tab-button{font-size:1.15rem}html.font-large .dialogue-container{--dialogue-height:230px}html.mobile-ui{}html.mobile-ui :root{--header-height:50px}html.mobile-ui .game-container{display:flex;flex-direction:column;height:100vh;overflow-y:hidden}html.mobile-ui .game-header{height:auto;min-height:auto;padding:var(--spacing-sm);flex-shrink:0;z-index:10}html.mobile-ui .header-left,html.mobile-ui .header-right{gap:var(--spacing-sm)}html.mobile-ui .game-title{font-size:1.2rem;margin-left:0}html.mobile-ui .game-date{font-size:0.8rem}html.mobile-ui .icon-button{width:32px;height:32px;font-size:1.2rem}html.mobile-ui .content-wrapper{flex:1;position:relative;overflow:hidden;display:flex;flex-direction:column}html.mobile-ui .tab-navigation{height:36px;min-height:36px;flex-shrink:0;z-index:9}html.mobile-ui .tab-button{padding:0 var(--spacing-sm);font-size:0.9rem}html.mobile-ui .tab-button i{font-size:0.9rem}html.mobile-ui .tab-content{flex:1;position:relative;display:flex;flex-direction:column;overflow:hidden}html.mobile-ui .tab-pane.active{position:relative;height:100%;display:flex;flex-direction:column}html.mobile-ui #story-tab{display:flex;flex-direction:column;position:relative;height:100%}html.mobile-ui .background-container{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:56.25vw;z-index:1}html.mobile-ui .characters-container{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:56.25vw;z-index:2}html.mobile-ui .dialogue-container{position:fixed;top:calc(var(--header-height) + 36px + 56.25vw);left:0;right:0;width:100%;height:calc(100vh - (var(--header-height) + 36px + 56.25vw));bottom:0;max-width:none;max-height:none;transform:none;border-radius:0;border-left:none;border-right:none;border-bottom:none;border-top:1px solid var(--color-primary);z-index:3;background-color:rgba(20,20,20,0.95);box-shadow:none;cursor:default}html.mobile-ui .dialogue-header{padding:var(--spacing-xs) var(--spacing-sm)}html.mobile-ui .dialogue-content{padding:var(--spacing-sm);height:calc(100% - 35px);overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--color-primary) rgba(20,20,20,0.3)}html.mobile-ui .dialogue-content::-webkit-scrollbar{width:4px}html.mobile-ui .dialogue-content::-webkit-scrollbar-track{background:rgba(20,20,20,0.3)}html.mobile-ui .dialogue-content::-webkit-scrollbar-thumb{background-color:var(--color-primary);border-radius:2px}html.mobile-ui .speaker-name{font-size:1rem}html.mobile-ui .choices-container{width:90%;max-width:90%;padding:var(--spacing-xs);z-index:4}html.mobile-ui .character-left,html.mobile-ui .character-right{height:100%;transform-origin:center bottom}html.mobile-ui #journal-tab,html.mobile-ui #memory-tab{position:fixed;top:calc(var(--header-height) + 36px);left:0;width:100%;height:calc(100vh - (var(--header-height) + 36px));bottom:0;z-index:3}html.mobile-ui .journal-container,html.mobile-ui .memory-container{padding:0;height:100%;width:100%;overflow-y:auto;display:flex;flex-direction:column}html.mobile-ui{}html.mobile-ui .memory-container{background-color:var(--color-memory-bg)}html.mobile-ui .memory-header{padding:var(--spacing-sm);border-bottom:1px solid var(--color-memory-secondary);background-color:rgba(0,0,0,0.2);position:sticky;top:0;z-index:1}html.mobile-ui .memory-header h2{font-size:1.2rem;margin-bottom:var(--spacing-sm)}html.mobile-ui .memory-button{padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--border-radius);font-size:0.9rem}html.mobile-ui{}html.mobile-ui .memory-timeline-container{padding:var(--spacing-sm);border-bottom:1px solid rgba(158,129,72,0.3);background-color:rgba(0,0,0,0.15)}html.mobile-ui .memory-timeline{padding:var(--spacing-sm) 0;height:50px;gap:var(--spacing-sm)}html.mobile-ui{}html.mobile-ui .memory-node-simple{width:20px;height:20px}html.mobile-ui .memory-node-simple::before{height:12px}html.mobile-ui .memory-node-simple.selected{transform:scale(1.25);box-shadow:0 0 10px 3px rgba(201,158,81,0.5)}html.mobile-ui{}html.mobile-ui .memory-detail-container{flex:1;padding:var(--spacing-sm);display:flex;flex-direction:column}html.mobile-ui .memory-content{flex:1;padding:var(--spacing-md);background-color:rgba(0,0,0,0.2);border:1px solid var(--color-memory-secondary);overflow-y:auto;font-size:0.95rem;line-height:1.5}html.mobile-ui .memory-actions{padding:var(--spacing-sm) 0}html.mobile-ui .memory-travel-button{width:100%;justify-content:center;padding:var(--spacing-sm);background-color:var(--color-memory-primary);font-size:1rem}html.mobile-ui{}html.mobile-ui .journal-container{background-color:var(--color-bg-light)}html.mobile-ui .journal-nav{flex-wrap:wrap;padding:var(--spacing-sm);border-bottom:1px solid var(--color-tertiary);background-color:rgba(0,0,0,0.2);position:sticky;top:0;z-index:1}html.mobile-ui .journal-nav-item{font-size:0.9rem;padding:var(--spacing-xs) var(--spacing-sm);margin-right:var(--spacing-xs);margin-bottom:var(--spacing-xs);border-radius:var(--border-radius)}html.mobile-ui .journal-content{flex:1;padding:var(--spacing-sm);overflow-y:auto}html.mobile-ui .journal-section{background-color:var(--color-bg-lighter);border-radius:var(--border-radius);padding:var(--spacing-sm);margin-bottom:var(--spacing-sm)}.monastery-dialog{max-width:500px;width:90%;margin:auto}.modal-content{background-color:var(--color-bg-light);color:var(--color-text-primary);border:1px solid var(--color-primary);border-radius:var(--border-radius);box-shadow:0 5px 25px rgba(0,0,0,0.7)}.modal-header{background-color:rgba(0,0,0,0.2);border-bottom:1px solid var(--color-primary);padding:var(--spacing-sm) var(--spacing-md)}.modal-title{color:var(--color-primary);font-family:var(--font-heading);display:flex;align-items:center;gap:var(--spacing-sm)}.modal-title i{font-size:1.1em}.modal-body{padding:var(--spacing-md);background-color:rgba(0,0,0,0.1)}.modal-footer{background-color:rgba(0,0,0,0.2);border-top:1px solid var(--color-primary);padding:var(--spacing-sm) var(--spacing-md)}.monastery-btn{padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--border-radius);font-family:var(--font-heading);font-size:0.95rem;transition:all var(--transition-fast);display:flex;align-items:center;gap:var(--spacing-sm)}.monastery-btn i{font-size:1em}.monastery-btn-primary{background-color:var(--color-primary);border-color:var(--color-primary);color:#fff}.monastery-btn-primary:hover{background-color:rgb(102.2741116751,80.7817258883,43.7258883249);border-color:rgb(102.2741116751,80.7817258883,43.7258883249);transform:translateY(-2px);box-shadow:0 3px 8px rgba(0,0,0,0.3)}.monastery-btn-secondary{background-color:var(--color-tertiary);border-color:var(--color-tertiary);color:#fff}.monastery-btn-secondary:hover{background-color:rgb(65.8971428571,77.9428571429,46.0571428571);border-color:rgb(65.8971428571,77.9428571429,46.0571428571);transform:translateY(-2px);box-shadow:0 3px 8px rgba(0,0,0,0.3)}.monastery-btn-cancel{background-color:rgba(255,255,255,0.1);border-color:rgba(255,255,255,0.2);color:var(--color-text-primary)}.monastery-btn-cancel:hover{background-color:rgba(255,255,255,0.15);border-color:rgba(255,255,255,0.25)}.monastery-form-group{margin-bottom:var(--spacing-md)}.monastery-label{color:var(--color-primary);font-family:var(--font-heading);margin-bottom:var(--spacing-xs);display:flex;align-items:center;gap:var(--spacing-sm)}.monastery-label i{color:var(--color-primary);font-size:1.1em}.monastery-input,.monastery-select{background-color:rgba(255,255,255,0.05);border:1px solid rgba(138,109,59,0.4);color:var(--color-text-primary);border-radius:var(--border-radius);padding:var(--spacing-sm);transition:all var(--transition-fast)}.monastery-input:focus,.monastery-select:focus{background-color:rgba(255,255,255,0.1);border-color:var(--color-primary);box-shadow:0 0 0 2px rgba(138,109,59,0.2)}.monastery-help-text{margin-top:var(--spacing-xs);font-style:italic;opacity:0.8}.monastery-switch .custom-control-input:checked~.custom-control-label::before{background-color:var(--color-primary);border-color:var(--color-primary)}.monastery-switch .custom-control-label{cursor:pointer}.monastery-switch .custom-control-label::before{background-color:rgba(255,255,255,0.1);border-color:rgba(138,109,59,0.4)}.input-dialog-container{display:flex;flex-direction:column;gap:var(--spacing-sm)}#load-game-modal .modal-dialog{max-width:700px;width:95%;margin:auto}@media (max-width:768px){#load-game-modal .save-list{grid-template-columns:1fr}#load-game-modal .save-item{margin-bottom:var(--spacing-sm)}#load-game-modal .save-item-thumbnail{height:80px}#load-game-modal .save-item-actions{opacity:1}#load-game-modal .modal-dialog{margin:0.5rem auto}#load-game-modal .modal-body{padding:var(--spacing-sm);max-height:70vh}#load-game-modal .save-tabs{margin-bottom:var(--spacing-sm)}#load-game-modal .save-tab-btn{font-size:0.9rem;padding:var(--spacing-xs) 0}#load-game-modal #btn-create-manual-save{width:100%;justify-content:center;margin-bottom:var(--spacing-sm)}#load-game-modal .modal-footer{padding:var(--spacing-xs) var(--spacing-sm);flex-wrap:wrap;justify-content:center}#load-game-modal .modal-footer .btn{margin:var(--spacing-xs);flex:1;min-width:80px}}html.desktop-ui{}html.desktop-ui .game-container{display:flex;flex-direction:column;height:100vh}html.desktop-ui .game-header{height:var(--header-height);min-height:var(--header-height);padding:0 var(--spacing-md)}html.desktop-ui .content-wrapper{flex:1;display:flex;flex-direction:column}html.desktop-ui .tab-navigation{height:var(--tab-height);min-height:var(--tab-height)}html.desktop-ui .tab-button{padding:0 var(--spacing-lg);height:100%;font-size:1rem}html.desktop-ui{}html.desktop-ui .tab-content{position:relative;aspect-ratio:16/9;overflow:hidden;flex:none}html.desktop-ui .tab-pane{position:absolute;top:0;left:0;width:100%;height:100%}html.desktop-ui{}html.desktop-ui .background-container,html.desktop-ui .characters-container{position:absolute;top:0;left:0;width:100%;height:100%}html.desktop-ui{}html.desktop-ui .dialogue-container{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);width:90%;max-width:900px;height:var(--dialogue-height);border:1px solid var(--color-primary);border-radius:var(--border-radius);cursor:pointer}html.desktop-ui .dialogue-header{padding:var(--spacing-sm) var(--spacing-md)}html.desktop-ui .dialogue-content{padding:var(--spacing-md);overflow-y:auto;height:auto}html.desktop-ui{}html.desktop-ui .choices-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:70%;max-width:650px;padding:var(--spacing-sm)}html.desktop-ui{}html.desktop-ui #journal-tab,html.desktop-ui #memory-tab{position:absolute;top:0;left:0;width:100%;height:100%}html.desktop-ui .journal-container,html.desktop-ui .memory-container{display:flex;flex-direction:column;height:100%;width:100%;padding:0}html.desktop-ui .memory-header,html.desktop-ui .journal-nav{position:static;padding:var(--spacing-md)}html.desktop-ui .journal-nav{display:flex;gap:var(--spacing-md);flex-wrap:nowrap}html.desktop-ui .journal-nav-item{padding:var(--spacing-sm) var(--spacing-md);margin:0;font-size:1rem}html.desktop-ui .memory-detail-container,html.desktop-ui .journal-content{flex:1;padding:var(--spacing-md)}html.desktop-ui{}html.desktop-ui .character-left,html.desktop-ui .character-right{height:100%;width:40%;transform-origin:bottom center;transform:none}html.desktop-ui .character-left{transform-origin:bottom left}html.desktop-ui .character-right{transform-origin:bottom right}
</style></head>
  <body>
    <div class="game-container">
      <!-- 游戏标题栏 -->
      <header class="game-header">
        <div class="header-left">
          <h1 class="game-title">Saint Aurelia</h1>
        </div>
        <div class="header-right">
          <span class="game-date" id="game-date">Anno Domini 1250, Martius XII</span>
          <div class="game-controls">
            <button id="save-game" class="icon-button gold" title="记录典籍"><i class="fas fa-feather-alt"></i></button>
            <button id="load-game" class="icon-button gold" title="查看典籍"><i class="fas fa-book-open"></i></button>
            <button id="settings-button" class="icon-button" title="设置"><i class="fas fa-cog"></i></button>
          </div>
        </div>
      </header>

      <!-- 主要内容区域 -->
      <div class="content-wrapper">
        <!-- 标签导航栏 -->
        <div class="tab-navigation">
          <button id="tab-story" class="tab-button active" data-tab="story-tab">
            <i class="fas fa-book-open"></i> 正文
          </button>
          <button id="tab-journal" class="tab-button" data-tab="journal-tab">
            <i class="fas fa-journal-whills"></i> 日记
          </button>
          <button id="tab-memory" class="tab-button" data-tab="memory-tab">
            <i class="fas fa-clock-rotate-left"></i> 记忆
          </button>
        </div>

        <!-- 标签内容区域 -->
        <div class="tab-content">
          <!-- 正文标签 - 主游戏区域 -->
          <div id="story-tab" class="tab-pane active">
            <!-- 游戏核心区域 - 严格16:9比例 -->
            <div class="game-core">
              <!-- 背景区域 -->
              <div class="background-container" id="background-container">
                <!-- 背景图将通过CSS插入 -->
              </div>

              <!-- 角色立绘区域 -->
              <div class="characters-container" id="characters-container">
                <div class="character-left" id="character-left"></div>
                <div class="character-right" id="character-right"></div>
              </div>

              <!-- 对话框区域 - 漂浮在画面下方 -->
              <div class="dialogue-container" id="dialogue-container">
                <div class="dialogue-header">
                  <span class="speaker-name" id="speaker-name">Sister Cecilia</span>
                  <div class="dialogue-controls">
                    <button id="auto-play" class="icon-button small" title="自动播放">
                      <i class="fas fa-play"></i>
                    </button>
                    <button id="dialogue-history" class="icon-button small" title="历史记录">
                      <i class="fas fa-history"></i>
                    </button>
                  </div>
                </div>
                <div class="dialogue-content" id="dialogue-content">
                  <!-- 对话内容将通过脚本插入 -->
                </div>
              </div>

              <!-- 选择区域 - 漂浮在游戏画面中央，更加紧凑 -->
              <div class="choices-container hidden" id="choices-container">
                <div class="choices-header">
                  <h3>接下来的行动</h3>
                  <button id="hide-choices-btn" class="icon-button small" title="隐藏选项">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
                <div class="preset-choices" id="preset-choices">
                  <!-- 预设选项将通过脚本插入 -->
                </div>
                <div class="custom-choice">
                  <input type="text" id="custom-choice-input" placeholder="自定义回应..." />
                  <button id="custom-choice-button" type="button">确定</button>
                </div>
              </div>
            </div>
          </div>

          <!-- 日记标签 - 角色/修道院信息等 -->
          <div id="journal-tab" class="tab-pane">
            <div class="journal-container">
              <!-- 日记导航栏 -->
              <div class="journal-nav">
                <button class="journal-nav-item active" data-section="characters">
                  <i class="fas fa-users"></i> 角色信息
                </button>
                <button class="journal-nav-item" data-section="monastery">
                  <i class="fas fa-church"></i> 修道院状态
                </button>
                <button class="journal-nav-item" data-section="knowledge"><i class="fas fa-book"></i> 知识库</button>
              </div>

              <!-- 日记内容区域 -->
              <div class="journal-content">
                <!-- 角色信息部分 -->
                <div id="characters-section" class="journal-section active">
                  <div class="character-cards" id="character-cards">
                    <!-- 角色卡片将通过脚本插入 -->
                  </div>
                  <div class="character-details" id="character-details">
                    <!-- 角色详情将通过脚本插入 -->
                  </div>
                </div>

                <!-- 修道院状态部分 -->
                <div id="monastery-section" class="journal-section">
                  <div class="monastery-info" id="monastery-info">
                    <!-- 修道院信息将通过脚本插入 -->
                  </div>
                </div>

                <!-- 知识库部分 -->
                <div id="knowledge-section" class="journal-section">
                  <div class="knowledge-categories" id="knowledge-categories">
                    <!-- 知识分类将通过脚本插入 -->
                  </div>
                  <div class="knowledge-entries" id="knowledge-entries">
                    <!-- 知识条目将通过脚本插入 -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 记忆标签 - 记忆与时间旅行功能 -->
          <div id="memory-tab" class="tab-pane">
            <div class="memory-container">
              <div class="memory-header">
                <h2><i class="fas fa-hourglass-half"></i> 穿越记忆点</h2>
                <button id="save-memory" class="memory-button"><i class="fas fa-bookmark"></i> 保存此刻</button>
              </div>

              <!-- 记忆时间轴 -->
              <div class="memory-timeline-container">
                <div class="memory-timeline" id="memory-timeline">
                  <!-- 记忆节点将通过脚本插入 -->
                </div>
              </div>

              <!-- 记忆详情 -->
              <div class="memory-detail-container">
                <div class="memory-content" id="memory-content">
                  <!-- 记忆内容将通过脚本插入 -->
                </div>
                <div class="memory-actions">
                  <button id="travel-to-memory" class="memory-travel-button">
                    <i class="fas fa-clock-rotate-left"></i> 穿越到此刻
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 加载提示 - 默认隐藏 -->
        <div class="loading-indicator hidden" id="loading-indicator">
          <div class="loading-spinner"></div>
          <div class="loading-text">加载中...</div>
        </div>

        <!-- 通知容器 -->
        <div id="notification-container"></div>
      </div>
    </div>

    <!-- 确认对话框容器 - 位于DOM树的最外层，脱离游戏容器限制 -->
    <div class="confirm-container hidden" id="confirm-container">
      <div class="modal-backdrop" id="modal-backdrop"></div>
      <div class="confirm-dialog" id="confirm-dialog">
        <div class="confirm-message" id="confirm-message">确定要执行此操作吗？</div>
        <div class="confirm-buttons">
          <button class="confirm-button confirm-yes" id="confirm-yes">确认</button>
          <button class="confirm-button confirm-no" id="confirm-no">取消</button>
        </div>
      </div>
    </div>
  </body>
</html>
