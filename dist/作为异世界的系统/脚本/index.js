import{klona as e}from'https://testingcf.jsdelivr.net/npm/klona/+esm';const r=z,c=r.z.object({世界:r.z.object({当前时间:r.z.coerce.string(),当前地点:r.z.coerce.string()}),主角:r.z.object({姓名:r.z.coerce.string(),性别:r.z.coerce.string(),年龄:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),外貌:r.z.object({描述:r.z.coerce.string(),主角评价:r.z.coerce.string()}),能力面板:r.z.object({力量:r.z.object({数值:r.z.union([r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('体能与攻击能力，决定近战输出与负重'),敏捷:r.z.object({数值:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('移动、闪避与反应速度，影响先手与命中'),体质:r.z.object({数值:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('生命力与耐久度，决定抗性与恢复速度'),感知:r.z.object({数值:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('观察与洞察能力，影响侦查与魔力控制'),意志:r.z.object({数值:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('精神力与抗干扰能力，决定技能稳定性'),魅力:r.z.object({数值:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),主角评价:r.z.coerce.string()}).describe('影响交涉、统御与社交反馈的综合指标')}),装备栏:r.z.object({主手:r.z.object({装备:r.z.coerce.string(),主角评价:r.z.coerce.string()}),副手:r.z.object({装备:r.z.coerce.string(),主角评价:r.z.coerce.string()}),防具:r.z.object({装备:r.z.coerce.string(),主角评价:r.z.coerce.string()}),饰品:r.z.object({装备:r.z.coerce.string(),主角评价:r.z.coerce.string()})}),物品栏:r.z.record(r.z.coerce.string().describe('物品名'),r.z.object({描述:r.z.coerce.string(),主角评价:r.z.coerce.string()})),持有能力:r.z.record(r.z.coerce.string().describe('物品名'),r.z.object({描述:r.z.coerce.string(),主角评价:r.z.coerce.string()})),当前状态:r.z.record(r.z.coerce.string().describe('状态名'),r.z.object({类型:r.z.enum(['增益','减益']),持续时间:r.z.union([r.z.literal('永久'),r.z.coerce.string()]),触发条件:r.z.coerce.string(),描述:r.z.coerce.string(),主角评价:r.z.coerce.string()}))}),系统状态:r.z.object({可用积分:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')]),对主角可见形象:r.z.coerce.string(),玩家ID:r.z.coerce.string()}),商品列表:r.z.record(r.z.coerce.string().describe('商品名'),r.z.object({描述:r.z.coerce.string(),主角评价:r.z.coerce.string(),积分价格:r.z.union([r.z.coerce.number(),r.z.literal('待初始化')])})),任务列表:r.z.record(r.z.coerce.string().describe('任务名'),r.z.object({类型:r.z.enum(['主线','支线','每日','临危受命']),说明:r.z.coerce.string(),目标:r.z.coerce.string(),奖励:r.z.coerce.string(),惩罚:r.z.coerce.string()}))});function t(e){return e.replace(/^[\\"'` ]*(.*?)[\\"'` ]*$/,'$1')}function n(e){const r=e.trim();if('true'===r)return!0;if('false'===r)return!1;if('null'===r)return null;if('undefined'!==r){try{return JSON.parse(r)}catch(e){if(r.startsWith('{')&&r.endsWith('}')||r.startsWith('[')&&r.endsWith(']'))try{const e=new Function(`return ${r};`)();if(_.isObject(e)||Array.isArray(e))return e}catch(e){}}try{return YAML.parse(r)}catch(e){}return t(e)}}$(async()=>{await waitGlobalInitialized('Mvu'),eventOn(Mvu.events.COMMAND_PARSED,(r,i)=>{for(const s of i){const i=e(r.stat_data),o=t(s.args[0]);switch(s.type){case'set':3===s.args.length&&s.args.splice(1,1),_.set(i,o,n(s.args[1]));break;case'insert':{const e=_.get(i,o),r=_.isArray(e),c=_.isPlainObject(e);if(!r&&!c)continue;const t=n(s.args.at(-1));if(2===s.args.length)r?e.push(t):_.assign(e,t);else{const c=n(s.args[1]);r?e.splice(c,0,t):e[String(c)]=t}break}case'delete':_.unset(i,s.args)}const a=c.safeParse(i);a.success&&(r.stat_data=a.data)}i.length=0})});
//# sourceMappingURL=index.js.map